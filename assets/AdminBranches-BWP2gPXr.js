import{j as e}from"./ui-vendor-CDeHCoCT.js";import{r as a}from"./react-vendor-ylmX0jv_.js";import{v as C,A as l,V as L,B as m,j as w,k as A,l as E,n as v}from"./index-88HeHBU_.js";import{I as u}from"./input-BBxKqSGF.js";import{T as P,a as H,b as c,c as n,d as I,e as r}from"./table-D5_bpSso.js";import{P as k}from"./PageHeader-DFhk-L31.js";import{P as D}from"./plus-B5gctVKY.js";import{S as G}from"./save-CZ4jDeAJ.js";import{L as R}from"./loader-circle-X6qRBHih.js";import{T as q}from"./trash-2-94VVF7R_.js";import"./utils-B3_ieZWp.js";import"./animation-b3c-J9zS.js";import"./excel-uoQkVabA.js";function _(){const[x,b]=a.useState([]),[T,h]=a.useState(!0),[o,j]=a.useState(!1),[i,g]=a.useState(""),[t,d]=a.useState(""),[p,N]=a.useState("");a.useEffect(()=>{f()},[]);const f=async()=>{h(!0);const{data:s,error:S}=await C.from("branches").select("*").order("name");S?(l.error("Error de carga","No se pudieron cargar las sucursales"),console.error(S)):b(s||[]),h(!1)},y=async()=>{if(!i||!t){l.error("Datos incompletos","Nombre y Slug son requeridos");return}const{error:s}=await C.from("branches").insert({name:i,slug:t,address:p});s?l.error("Error al crear","No se pudo crear la sucursal: "+s.message):(l.success("Sucursal creada","La sucursal se cre贸 exitosamente"),g(""),d(""),N(""),j(!1),f())},B=s=>s.toLowerCase().trim().replace(/\s+/g,"");return e.jsxs(L,{children:[e.jsx(k,{title:"Administraci贸n de Sucursales",subtitle:"Gestiona las sucursales del sistema",actions:e.jsx(m,{onClick:()=>j(!o),children:o?"Cancelar":e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4"})," Nueva Sucursal"]})})}),o&&e.jsxs(w,{children:[e.jsx(A,{children:e.jsx(E,{children:"Nueva Sucursal"})}),e.jsxs(v,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(u,{placeholder:"Nombre (ej: Belgrano X)",value:i,onChange:s=>{g(s.target.value),t||d(B(s.target.value))}}),e.jsx(u,{placeholder:"Slug (ej: belgranox)",value:t,onChange:s=>d(s.target.value)}),e.jsx(u,{placeholder:"Direcci贸n",value:p,onChange:s=>N(s.target.value)})]}),e.jsxs(m,{onClick:y,className:"w-fit",children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Guardar"]})]})]}),e.jsx(w,{children:e.jsx(v,{className:"p-0",children:e.jsxs(P,{children:[e.jsx(H,{children:e.jsxs(c,{children:[e.jsx(n,{children:"Nombre"}),e.jsx(n,{children:"Slug (Usuario)"}),e.jsx(n,{children:"Direcci贸n"}),e.jsx(n,{className:"text-right",children:"Acciones"})]})}),e.jsx(I,{children:T?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:e.jsx(R,{className:"h-6 w-6 animate-spin mx-auto"})})}):x.length===0?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"text-center py-4",children:"No hay sucursales registradas"})}):x.map(s=>e.jsxs(c,{children:[e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{className:"font-mono text-xs",children:s.slug}),e.jsx(r,{children:s.address||"-"}),e.jsx(r,{className:"text-right",children:e.jsx(m,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(q,{className:"h-4 w-4"})})})]},s.id))})]})})})]})}export{_ as default};
