import{j as e}from"./ui-vendor-CwIRxpyq.js";import{r as a}from"./react-vendor-ylmX0jv_.js";import{s as C,A as l,L as B,B as m,i as w,j as A,k as E,m as b,N as P}from"./index-4S8qSKY8.js";import{I as u}from"./input-N8FoNaiK.js";import{T as H,a as I,b as c,c as n,d as k,e as r}from"./table-BiveKZVQ.js";import{P as D}from"./PageHeader-D_cQL7_x.js";import{P as G}from"./plus-Ds5SGdqx.js";import{S as R}from"./save-DU2NgoBT.js";import{L as q}from"./loader-circle-DBkHespF.js";import"./utils-DNiwW225.js";import"./animation-DbfETv0H.js";import"./excel-uoQkVabA.js";function Z(){const[x,v]=a.useState([]),[T,h]=a.useState(!0),[o,j]=a.useState(!1),[i,g]=a.useState(""),[t,d]=a.useState(""),[p,N]=a.useState("");a.useEffect(()=>{f()},[]);const f=async()=>{h(!0);const{data:s,error:S}=await C.from("branches").select("*").order("name");S?(l.error("Error de carga","No se pudieron cargar las sucursales"),console.error(S)):v(s||[]),h(!1)},y=async()=>{if(!i||!t){l.error("Datos incompletos","Nombre y Slug son requeridos");return}const{error:s}=await C.from("branches").insert({name:i,slug:t,address:p});s?l.error("Error al crear","No se pudo crear la sucursal: "+s.message):(l.success("Sucursal creada","La sucursal se cre贸 exitosamente"),g(""),d(""),N(""),j(!1),f())},L=s=>s.toLowerCase().trim().replace(/\s+/g,"");return e.jsxs(B,{children:[e.jsx(D,{title:"Administraci贸n de Sucursales",subtitle:"Gestiona las sucursales del sistema",actions:e.jsx(m,{onClick:()=>j(!o),children:o?"Cancelar":e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Nueva Sucursal"]})})}),o&&e.jsxs(w,{children:[e.jsx(A,{children:e.jsx(E,{children:"Nueva Sucursal"})}),e.jsxs(b,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(u,{placeholder:"Nombre (ej: Belgrano X)",value:i,onChange:s=>{g(s.target.value),t||d(L(s.target.value))}}),e.jsx(u,{placeholder:"Slug (ej: belgranox)",value:t,onChange:s=>d(s.target.value)}),e.jsx(u,{placeholder:"Direcci贸n",value:p,onChange:s=>N(s.target.value)})]}),e.jsxs(m,{onClick:y,className:"w-fit",children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Guardar"]})]})]}),e.jsx(w,{children:e.jsx(b,{className:"p-0",children:e.jsxs(H,{children:[e.jsx(I,{children:e.jsxs(c,{children:[e.jsx(n,{children:"Nombre"}),e.jsx(n,{children:"Slug (Usuario)"}),e.jsx(n,{children:"Direcci贸n"}),e.jsx(n,{className:"text-right",children:"Acciones"})]})}),e.jsx(k,{children:T?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:e.jsx(q,{className:"h-6 w-6 animate-spin mx-auto"})})}):x.length===0?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"text-center py-4",children:"No hay sucursales registradas"})}):x.map(s=>e.jsxs(c,{children:[e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{className:"font-mono text-xs",children:s.slug}),e.jsx(r,{children:s.address||"-"}),e.jsx(r,{className:"text-right",children:e.jsx(m,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(P,{className:"h-4 w-4"})})})]},s.id))})]})})})]})}export{Z as default};
