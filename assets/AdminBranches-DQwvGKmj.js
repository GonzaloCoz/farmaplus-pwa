import{j as e}from"./ui-vendor-DWmIoBIJ.js";import{r as a}from"./react-vendor-ylmX0jv_.js";import{s as C,r as l,P as E,B as m,d as w,e as L,f as P,h as b,E as A}from"./index-WTpjueDr.js";import{I as u}from"./input-Cw2nBV2E.js";import{T as H,a as I,b as c,c as n,d as k,e as r}from"./table-CfsAIsus.js";import{P as D}from"./PageHeader-hxnM-jS5.js";import{P as G}from"./plus-B2BzAFO4.js";import{S as R}from"./save-_sxj1L4H.js";import{L as q}from"./loader-circle-g467miAt.js";import"./utils-CUsTgaRG.js";import"./animation-Ch0GoCcm.js";import"./excel-uoQkVabA.js";function Z(){const[h,v]=a.useState([]),[T,x]=a.useState(!0),[i,j]=a.useState(!1),[o,g]=a.useState(""),[t,d]=a.useState(""),[p,f]=a.useState("");a.useEffect(()=>{N()},[]);const N=async()=>{x(!0);const{data:s,error:S}=await C.from("branches").select("*").order("name");S?(l.error("Error al cargar sucursales"),console.error(S)):v(s||[]),x(!1)},y=async()=>{if(!o||!t){l.error("Nombre y Slug son requeridos");return}const{error:s}=await C.from("branches").insert({name:o,slug:t,address:p});s?l.error("Error al crear sucursal: "+s.message):(l.success("Sucursal creada exitosamente"),g(""),d(""),f(""),j(!1),N())},B=s=>s.toLowerCase().trim().replace(/\s+/g,"");return e.jsxs(E,{children:[e.jsx(D,{title:"Administración de Sucursales",subtitle:"Gestiona las sucursales del sistema",actions:e.jsx(m,{onClick:()=>j(!i),children:i?"Cancelar":e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Nueva Sucursal"]})})}),i&&e.jsxs(w,{children:[e.jsx(L,{children:e.jsx(P,{children:"Nueva Sucursal"})}),e.jsxs(b,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(u,{placeholder:"Nombre (ej: Belgrano X)",value:o,onChange:s=>{g(s.target.value),t||d(B(s.target.value))}}),e.jsx(u,{placeholder:"Slug (ej: belgranox)",value:t,onChange:s=>d(s.target.value)}),e.jsx(u,{placeholder:"Dirección",value:p,onChange:s=>f(s.target.value)})]}),e.jsxs(m,{onClick:y,className:"w-fit",children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Guardar"]})]})]}),e.jsx(w,{children:e.jsx(b,{className:"p-0",children:e.jsxs(H,{children:[e.jsx(I,{children:e.jsxs(c,{children:[e.jsx(n,{children:"Nombre"}),e.jsx(n,{children:"Slug (Usuario)"}),e.jsx(n,{children:"Dirección"}),e.jsx(n,{className:"text-right",children:"Acciones"})]})}),e.jsx(k,{children:T?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:e.jsx(q,{className:"h-6 w-6 animate-spin mx-auto"})})}):h.length===0?e.jsx(c,{children:e.jsx(r,{colSpan:4,className:"text-center py-4",children:"No hay sucursales registradas"})}):h.map(s=>e.jsxs(c,{children:[e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{className:"font-mono text-xs",children:s.slug}),e.jsx(r,{children:s.address||"-"}),e.jsx(r,{className:"text-right",children:e.jsx(m,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(A,{className:"h-4 w-4"})})})]},s.id))})]})})})]})}export{Z as default};
