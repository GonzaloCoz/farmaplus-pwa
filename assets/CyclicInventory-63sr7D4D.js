import{j as e,r as K,s as Q,t as k,v as D,w as W,x as L,y as I,z as V,B as R,E as A,L as T,G as E}from"./ui-vendor-CMKjsfuk.js";import{r as l,u as X}from"./react-vendor-C2WMxTOF.js";import{c as Y,g as v,k as ee,e as $,l as z,a as m,u as se,C as ae,S as te,B as M,n as oe,o as S}from"./index-ByHsDfok.js";import{I as re}from"./input-CYgORuOT.js";import{B as ne}from"./badge-Ck-z6OjO.js";import{a as P,P as le,b as ce,M as ie,A as de}from"./progress-BTCLwLTM.js";import{C as x}from"./CounterAnimation-BgfPRDaD.js";import{C as me}from"./check-BAvRFWCi.js";import{D as ue}from"./dollar-sign-CWcuV6K9.js";import{T as xe}from"./trending-down-DlZZB6ZW.js";import{T as pe}from"./trending-up-DZeKfQ9n.js";import"./utils-CUsTgaRG.js";import"./animation-DioOyNca.js";import"./excel-uoQkVabA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=Y("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function ge({name:o,negativeValue:a,positiveValue:t,differenceValue:r,status:c,progress:j=0,onClick:p}){const i=(g=>{switch(g){case"controlado":return{color:"text-success",bgColor:"bg-success/10",borderColor:"border-success/20",icon:z,label:"Controlado",barColor:"bg-success"};case"por_controlar":return{color:"text-warning",bgColor:"bg-warning/10",borderColor:"border-warning/20",icon:ce,label:"En Proceso",barColor:"bg-warning"};case"pendiente":return{color:"text-muted-foreground",bgColor:"bg-muted",borderColor:"border-muted",icon:$,label:"Pendiente",barColor:"bg-muted-foreground"}}})(c),N=i.icon,d=c==="controlado"?100:c==="pendiente"?0:j||0;return e.jsxs(v,{className:"group hover:shadow-md transition-all duration-200 border cursor-pointer overflow-hidden relative",onClick:p,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${i.barColor}`}),e.jsxs(ee,{className:"p-4 pl-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:`p-1.5 rounded-full ${i.bgColor}`,children:e.jsx(N,{className:`w-4 h-4 ${i.color}`})}),e.jsx("h3",{className:"font-semibold text-base truncate",title:o,children:o})]}),e.jsx(P,{className:"w-4 h-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"Valorizado (Diferencias)"}),e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:`text-lg font-bold font-mono tracking-tight ${r<0?"text-destructive":r>0?"text-success":"text-foreground"}`,children:[r>0?"+":"",e.jsx(x,{value:r,prefix:"$"})]})}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono mt-1",children:[e.jsxs("span",{className:"text-destructive flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-destructive mr-1"}),e.jsx(x,{value:a,prefix:"$"})]}),e.jsxs("span",{className:"text-success flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-success mr-1"}),"+",e.jsx(x,{value:t,prefix:"$"})]})]})]}),e.jsxs("div",{className:"space-y-1.5 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ne,{variant:"outline",className:`${i.color} ${i.borderColor} bg-transparent h-5 px-1.5 text-[10px]`,children:i.label})}),e.jsxs("span",{children:[d,"%"]})]}),e.jsx(le,{value:d,className:"h-1.5",indicatorClassName:i.barColor})]})]})]})]})}const he=K,be=Q,ve=l.forwardRef(({className:o,inset:a,children:t,...r},c)=>e.jsxs(k,{ref:c,className:m("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",a&&"pl-8",o),...r,children:[t,e.jsx(P,{className:"ml-auto h-4 w-4"})]}));ve.displayName=k.displayName;const je=l.forwardRef(({className:o,...a},t)=>e.jsx(D,{ref:t,className:m("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...a}));je.displayName=D.displayName;const B=l.forwardRef(({className:o,sideOffset:a=4,...t},r)=>e.jsx(W,{children:e.jsx(L,{ref:r,sideOffset:a,className:m("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...t})}));B.displayName=L.displayName;const b=l.forwardRef(({className:o,inset:a,...t},r)=>e.jsx(I,{ref:r,className:m("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a&&"pl-8",o),...t}));b.displayName=I.displayName;const Ne=l.forwardRef(({className:o,children:a,checked:t,...r},c)=>e.jsxs(V,{ref:c,className:m("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",o),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(R,{children:e.jsx(me,{className:"h-4 w-4"})})}),a]}));Ne.displayName=V.displayName;const we=l.forwardRef(({className:o,children:a,...t},r)=>e.jsxs(A,{ref:r,className:m("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",o),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(R,{children:e.jsx(fe,{className:"h-2 w-2 fill-current"})})}),a]}));we.displayName=A.displayName;const ye=l.forwardRef(({className:o,inset:a,...t},r)=>e.jsx(T,{ref:r,className:m("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",o),...t}));ye.displayName=T.displayName;const Ce=l.forwardRef(({className:o,...a},t)=>e.jsx(E,{ref:t,className:m("-mx-1 my-1 h-px bg-muted",o),...a}));Ce.displayName=E.displayName;function Be(){const o=X(),{user:a}=se(),[t,r]=l.useState(""),[c,j]=l.useState("MEDICAMENTOS"),[p,f]=l.useState("name-asc"),[i,N]=l.useState([]);l.useEffect(()=>{(async()=>{if(!(a!=null&&a.branchSheet))return;const u=(await oe(a.branchSheet)).map((C,H)=>{const J=S.getLabInventory(C.name),h=S.calculateStats(J);return{id:H,name:C.name,category:C.category,status:h.status,progress:h.progress,negativeValue:h.negative,positiveValue:h.positive,differenceValue:h.net}});N(u)})()},[a]);const d=i.filter(s=>s.category===c),g=d.length,w=d.filter(s=>s.status==="controlado").length,O=d.filter(s=>s.status==="pendiente").length,y=d.reduce((s,n)=>s+n.differenceValue,0),U=d.reduce((s,n)=>s+n.negativeValue,0),F=d.reduce((s,n)=>s+n.positiveValue,0),Z=g>0?Math.round(w/g*100):0,G=l.useMemo(()=>{let s=[...i];return t&&(s=s.filter(n=>n.name.toLowerCase().includes(t.toLowerCase()))),s=s.filter(n=>n.category===c),s.sort((n,u)=>{switch(p){case"name-asc":return n.name.localeCompare(u.name);case"name-desc":return u.name.localeCompare(n.name);case"value-asc":return n.differenceValue-u.differenceValue;case"value-desc":return u.differenceValue-n.differenceValue;default:return 0}}),s},[t,c,p,i]),_=s=>{switch(s){case"name-asc":return"Nombre (A-Z)";case"name-desc":return"Nombre (Z-A)";case"value-asc":return"Valor (Menor a Mayor)";case"value-desc":return"Valor (Mayor a Menor)"}},q=["MEDICAMENTOS","PERFUMERIA","ACCESORIOS","VARIOS"];return e.jsxs("div",{className:"p-4 md:p-6 space-y-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(v,{className:"p-4 flex flex-col justify-between bg-primary/5 border-primary/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary mb-2",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Avance Global"})]}),e.jsxs("div",{className:"text-2xl font-bold",children:[e.jsx(x,{value:Z}),"%"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[w," de ",g," laboratorios"]})]}),e.jsxs(v,{className:"p-4 flex flex-col justify-between bg-success/5 border-success/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-success mb-2",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Controlados"})]}),e.jsx("div",{className:"text-2xl font-bold text-success",children:e.jsx(x,{value:w})})]}),e.jsxs(v,{className:"p-4 flex flex-col justify-between bg-muted/50 border-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-2",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Pendientes"})]}),e.jsx("div",{className:"text-2xl font-bold text-muted-foreground",children:e.jsx(x,{value:O})})]}),e.jsx(ie,{items:[{id:"net",label:"Diferencia Neta",value:y,color:y<0?"text-destructive":y>0?"text-success":"text-foreground",icon:ue,prefix:"$"},{id:"negative",label:"Negativo Total",value:U,color:"text-destructive",icon:xe,prefix:"$"},{id:"positive",label:"Positivo Total",value:F,color:"text-success",icon:pe,prefix:"$"}]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sticky top-0 bg-background/95 backdrop-blur z-10 py-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(re,{placeholder:"Buscar laboratorio...",value:t,onChange:s=>r(s.target.value),className:"pl-9"})]}),e.jsxs(he,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(M,{variant:"outline",size:"sm",className:"whitespace-nowrap",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),_(p)]})}),e.jsxs(B,{align:"end",children:[e.jsx(b,{onClick:()=>f("name-asc"),children:"Nombre (A-Z)"}),e.jsx(b,{onClick:()=>f("name-desc"),children:"Nombre (Z-A)"}),e.jsx(b,{onClick:()=>f("value-asc"),children:"Valor (Menor a Mayor)"}),e.jsx(b,{onClick:()=>f("value-desc"),children:"Valor (Mayor a Menor)"})]})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:q.map(s=>e.jsx(M,{variant:c===s?"default":"outline",size:"sm",onClick:()=>j(s),className:"whitespace-nowrap rounded-full px-4",children:s==="MEDICAMENTOS"?"Medicamentos":s.charAt(0)+s.slice(1).toLowerCase()},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:G.map(s=>e.jsx(ge,{name:s.name,negativeValue:s.negativeValue,positiveValue:s.positiveValue,differenceValue:s.differenceValue,status:s.status,progress:s.progress,onClick:()=>o(`/cyclic-inventory/${encodeURIComponent(s.name)}`)},s.id))})]})}export{Be as default};
