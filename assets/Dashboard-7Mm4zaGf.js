import{j as t}from"./ui-vendor-Bx5BjJRa.js";import{r as i,c as J,a as st,u as _n}from"./react-vendor-ylmX0jv_.js";import{c as L,C as It,a as Mt,T as ts,B as R,b as $,X as Ks,P as Yn,D as Zs,d as Js,e as Qs,f as en,g as Xn,S as tn,h as re,i as P,j as q,k as G,l as Kn,m as _,n as Zn,o as Jn,u as ze,p as it,s as Ft,q as At,r as Rt,t as Tt,v as zt,w as Qn,x as er,y as de,z as tr,U as sn,W as sr,R as nr,A as rr,E as ar,F as or,I as ir,G as lr,H as cr,J as dr,K as ur,L as mr,M as nn,N as hr}from"./index-CS0nazQo.js";import{D as lt,c as Se}from"./cyclicInventoryService-CJ2zF2fw.js";import{T as Be}from"./trending-up-D2249C0Q.js";import{U as rn,h as nt}from"./permissions-Zz7VTeGz.js";import{C as ht}from"./clock-DDjxM_Jd.js";import{H as fr}from"./history-CIThmA2B.js";import{T as an}from"./target-Cm_I6VCQ.js";import{W as on}from"./wifi-DNVF7FVd.js";import{C as Ct}from"./calendar-Bq5kohqE.js";import{A as xr}from"./AnimatedCard-BmgKByT4.js";import{D as pr,a as gr,b as vr,c as br,M as yr,A as Cs,P as ln}from"./progress-B01hbz1N.js";import{I as ne}from"./input-_EHRjJ1d.js";import{S as jr,A as Vt}from"./AnimatedProgressBar-C5FNlRkT.js";import{P as Ye}from"./plus-Ctdd-Tbg.js";import{g as wr}from"./expirationDB-BNRLh_3L.js";import{m as W,A as ss}from"./animation-B_tN6Csa.js";import{A as Nr}from"./arrow-right-BfJxBz9N.js";import{T as ns}from"./trending-down-DYBCprg4.js";import{C as cn}from"./CounterAnimation-aQux4gln.js";import{L as Te}from"./label-4ZjPx1AB.js";import{S as Ss,a as Ds,b as ks,c as Es,d as bt}from"./select-BxzRktV2.js";import{L as Cr}from"./loader-circle-nAAUBWoY.js";import{T as Sr,a as Dr,b as Ht,c as Ne,d as kr,e as V}from"./table-Bwd0-Wkj.js";import{R as dn,L as Er,C as Ir,X as Mr,Y as Ar,T as un,a as Rr,b as Is,P as Tr,c as zr,d as Pr}from"./chart-vendor-l_5q1Ysf.js";import{E as Or}from"./eye-BeHs1vDe.js";import{s as Lr,e as Br,a as Ur,b as $r,g as Wr,f as Ms,i as Fr,h as Vr,p as Hr,d as qr,j as Gr,k as _r}from"./utils-Cem6hW2W.js";import{C as Yr}from"./chevron-left-BCBS7MFa.js";import{e as yt}from"./es-CtQxi55C.js";import{C as mn}from"./check-CMft6c7q.js";import{R as Xr}from"./rotate-ccw-DOcY3WXV.js";import"./excel-uoQkVabA.js";import"./circle-ByBQ2X8a.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=L("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=L("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=L("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=L("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=L("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=L("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=L("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=L("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=L("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=L("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=L("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=L("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=L("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=L("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=L("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=L("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=L("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=L("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=L("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=L("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=L("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=L("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=L("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ha(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i.useMemo(()=>r=>{s.forEach(a=>a(r))},s)}const Pt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Xe(e){const s=Object.prototype.toString.call(e);return s==="[object Window]"||s==="[object global]"}function os(e){return"nodeType"in e}function ae(e){var s,n;return e?Xe(e)?e:os(e)&&(s=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function is(e){const{Document:s}=ae(e);return e instanceof s}function ft(e){return Xe(e)?!1:e instanceof ae(e).HTMLElement}function xn(e){return e instanceof ae(e).SVGElement}function Ke(e){return e?Xe(e)?e.document:os(e)?is(e)?e:ft(e)||xn(e)?e.ownerDocument:document:document:document}const be=Pt?i.useLayoutEffect:i.useEffect;function ls(e){const s=i.useRef(e);return be(()=>{s.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return s.current==null?void 0:s.current(...r)},[])}function fa(){const e=i.useRef(null),s=i.useCallback((r,a)=>{e.current=setInterval(r,a)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[s,n]}function ct(e,s){s===void 0&&(s=[e]);const n=i.useRef(e);return be(()=>{n.current!==e&&(n.current=e)},s),n}function xt(e,s){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...s])}function St(e){const s=ls(e),n=i.useRef(null),r=i.useCallback(a=>{a!==n.current&&(s==null||s(a,n.current)),n.current=a},[]);return[n,r]}function Kt(e){const s=i.useRef();return i.useEffect(()=>{s.current=e},[e]),s.current}let qt={};function pt(e,s){return i.useMemo(()=>{if(s)return s;const n=qt[e]==null?0:qt[e]+1;return qt[e]=n,e+"-"+n},[e,s])}function pn(e){return function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((o,l)=>{const d=Object.entries(l);for(const[u,h]of d){const m=o[u];m!=null&&(o[u]=m+e*h)}return o},{...s})}}const Ge=pn(1),dt=pn(-1);function xa(e){return"clientX"in e&&"clientY"in e}function cs(e){if(!e)return!1;const{KeyboardEvent:s}=ae(e.target);return s&&e instanceof s}function pa(e){if(!e)return!1;const{TouchEvent:s}=ae(e.target);return s&&e instanceof s}function Zt(e){if(pa(e)){if(e.touches&&e.touches.length){const{clientX:s,clientY:n}=e.touches[0];return{x:s,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:s,clientY:n}=e.changedTouches[0];return{x:s,y:n}}}return xa(e)?{x:e.clientX,y:e.clientY}:null}const ut=Object.freeze({Translate:{toString(e){if(!e)return;const{x:s,y:n}=e;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:s,scaleY:n}=e;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ut.Translate.toString(e),ut.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:s,duration:n,easing:r}=e;return s+" "+n+"ms "+r}}}),Ts="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ga(e){return e.matches(Ts)?e:e.querySelector(Ts)}const va={display:"none"};function ba(e){let{id:s,value:n}=e;return J.createElement("div",{id:s,style:va},n)}function ya(e){let{id:s,announcement:n,ariaLiveType:r="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return J.createElement("div",{id:s,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function ja(){const[e,s]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&s(r)},[]),announcement:e}}const gn=i.createContext(null);function wa(e){const s=i.useContext(gn);i.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(e)},[e,s])}function Na(){const[e]=i.useState(()=>new Set),s=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:a,event:o}=r;e.forEach(l=>{var d;return(d=l[a])==null?void 0:d.call(l,o)})},[e]),s]}const Ca={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Sa={onDragStart(e){let{active:s}=e;return"Picked up draggable item "+s.id+"."},onDragOver(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(e){let{active:s}=e;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function Da(e){let{announcements:s=Sa,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=Ca}=e;const{announce:o,announcement:l}=ja(),d=pt("DndLiveRegion"),[u,h]=i.useState(!1);if(i.useEffect(()=>{h(!0)},[]),wa(i.useMemo(()=>({onDragStart(c){let{active:f}=c;o(s.onDragStart({active:f}))},onDragMove(c){let{active:f,over:x}=c;s.onDragMove&&o(s.onDragMove({active:f,over:x}))},onDragOver(c){let{active:f,over:x}=c;o(s.onDragOver({active:f,over:x}))},onDragEnd(c){let{active:f,over:x}=c;o(s.onDragEnd({active:f,over:x}))},onDragCancel(c){let{active:f,over:x}=c;o(s.onDragCancel({active:f,over:x}))}}),[o,s])),!u)return null;const m=J.createElement(J.Fragment,null,J.createElement(ba,{id:r,value:a.draggable}),J.createElement(ya,{id:d,announcement:l}));return n?st.createPortal(m,n):m}var H;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(H||(H={}));function Dt(){}function zs(e,s){return i.useMemo(()=>({sensor:e,options:s??{}}),[e,s])}function ka(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i.useMemo(()=>[...s].filter(r=>r!=null),[...s])}const pe=Object.freeze({x:0,y:0});function vn(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function bn(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return n-r}function Ea(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return r-n}function Ps(e){let{left:s,top:n,height:r,width:a}=e;return[{x:s,y:n},{x:s+a,y:n},{x:s,y:n+r},{x:s+a,y:n+r}]}function yn(e,s){if(!e||e.length===0)return null;const[n]=e;return n[s]}function Os(e,s,n){return s===void 0&&(s=e.left),n===void 0&&(n=e.top),{x:s+e.width*.5,y:n+e.height*.5}}const Ia=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=Os(s,s.left,s.top),o=[];for(const l of r){const{id:d}=l,u=n.get(d);if(u){const h=vn(Os(u),a);o.push({id:d,data:{droppableContainer:l,value:h}})}}return o.sort(bn)},Ma=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=Ps(s),o=[];for(const l of r){const{id:d}=l,u=n.get(d);if(u){const h=Ps(u),m=a.reduce((f,x,b)=>f+vn(h[b],x),0),c=Number((m/4).toFixed(4));o.push({id:d,data:{droppableContainer:l,value:c}})}}return o.sort(bn)};function Aa(e,s){const n=Math.max(s.top,e.top),r=Math.max(s.left,e.left),a=Math.min(s.left+s.width,e.left+e.width),o=Math.min(s.top+s.height,e.top+e.height),l=a-r,d=o-n;if(r<a&&n<o){const u=s.width*s.height,h=e.width*e.height,m=l*d,c=m/(u+h-m);return Number(c.toFixed(4))}return 0}const Ra=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=[];for(const o of r){const{id:l}=o,d=n.get(l);if(d){const u=Aa(d,s);u>0&&a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(Ea)};function Ta(e,s,n){return{...e,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function jn(e,s){return e&&s?{x:e.left-s.left,y:e.top-s.top}:pe}function za(e){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return a.reduce((l,d)=>({...l,top:l.top+e*d.y,bottom:l.bottom+e*d.y,left:l.left+e*d.x,right:l.right+e*d.x}),{...n})}}const Pa=za(1);function Oa(e){if(e.startsWith("matrix3d(")){const s=e.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(e.startsWith("matrix(")){const s=e.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function La(e,s,n){const r=Oa(s);if(!r)return e;const{scaleX:a,scaleY:o,x:l,y:d}=r,u=e.left-l-(1-a)*parseFloat(n),h=e.top-d-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),m=a?e.width/a:e.width,c=o?e.height/o:e.height;return{width:m,height:c,top:h,right:u+m,bottom:h+c,left:u}}const Ba={ignoreTransform:!1};function Ze(e,s){s===void 0&&(s=Ba);let n=e.getBoundingClientRect();if(s.ignoreTransform){const{transform:h,transformOrigin:m}=ae(e).getComputedStyle(e);h&&(n=La(n,h,m))}const{top:r,left:a,width:o,height:l,bottom:d,right:u}=n;return{top:r,left:a,width:o,height:l,bottom:d,right:u}}function Ls(e){return Ze(e,{ignoreTransform:!0})}function Ua(e){const s=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function $a(e,s){return s===void 0&&(s=ae(e).getComputedStyle(e)),s.position==="fixed"}function Wa(e,s){s===void 0&&(s=ae(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=s[a];return typeof o=="string"?n.test(o):!1})}function Ot(e,s){const n=[];function r(a){if(s!=null&&n.length>=s||!a)return n;if(is(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!ft(a)||xn(a)||n.includes(a))return n;const o=ae(e).getComputedStyle(a);return a!==e&&Wa(a,o)&&n.push(a),$a(a,o)?n:r(a.parentNode)}return e?r(e):n}function wn(e){const[s]=Ot(e,1);return s??null}function Gt(e){return!Pt||!e?null:Xe(e)?e:os(e)?is(e)||e===Ke(e).scrollingElement?window:ft(e)?e:null:null}function Nn(e){return Xe(e)?e.scrollX:e.scrollLeft}function Cn(e){return Xe(e)?e.scrollY:e.scrollTop}function Jt(e){return{x:Nn(e),y:Cn(e)}}var X;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(X||(X={}));function Sn(e){return!Pt||!e?!1:e===document.scrollingElement}function Dn(e){const s={x:0,y:0},n=Sn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=s.y,o=e.scrollLeft<=s.x,l=e.scrollTop>=r.y,d=e.scrollLeft>=r.x;return{isTop:a,isLeft:o,isBottom:l,isRight:d,maxScroll:r,minScroll:s}}const Fa={x:.2,y:.2};function Va(e,s,n,r,a){let{top:o,left:l,right:d,bottom:u}=n;r===void 0&&(r=10),a===void 0&&(a=Fa);const{isTop:h,isBottom:m,isLeft:c,isRight:f}=Dn(e),x={x:0,y:0},b={x:0,y:0},p={height:s.height*a.y,width:s.width*a.x};return!h&&o<=s.top+p.height?(x.y=X.Backward,b.y=r*Math.abs((s.top+p.height-o)/p.height)):!m&&u>=s.bottom-p.height&&(x.y=X.Forward,b.y=r*Math.abs((s.bottom-p.height-u)/p.height)),!f&&d>=s.right-p.width?(x.x=X.Forward,b.x=r*Math.abs((s.right-p.width-d)/p.width)):!c&&l<=s.left+p.width&&(x.x=X.Backward,b.x=r*Math.abs((s.left+p.width-l)/p.width)),{direction:x,speed:b}}function Ha(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:l}=window;return{top:0,left:0,right:o,bottom:l,width:o,height:l}}const{top:s,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:s,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function kn(e){return e.reduce((s,n)=>Ge(s,Jt(n)),pe)}function qa(e){return e.reduce((s,n)=>s+Nn(n),0)}function Ga(e){return e.reduce((s,n)=>s+Cn(n),0)}function _a(e,s){if(s===void 0&&(s=Ze),!e)return;const{top:n,left:r,bottom:a,right:o}=s(e);wn(e)&&(a<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ya=[["x",["left","right"],qa],["y",["top","bottom"],Ga]];class ds{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Ot(n),a=kn(r);this.rect={...s},this.width=s.width,this.height=s.height;for(const[o,l,d]of Ya)for(const u of l)Object.defineProperty(this,u,{get:()=>{const h=d(r),m=a[o]-h;return this.rect[u]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class rt{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=s}add(s,n,r){var a;(a=this.target)==null||a.addEventListener(s,n,r),this.listeners.push([s,n,r])}}function Xa(e){const{EventTarget:s}=ae(e);return e instanceof s?e:Ke(e)}function _t(e,s){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof s=="number"?Math.sqrt(n**2+r**2)>s:"x"in s&&"y"in s?n>s.x&&r>s.y:"x"in s?n>s.x:"y"in s?r>s.y:!1}var me;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(me||(me={}));function Bs(e){e.preventDefault()}function Ka(e){e.stopPropagation()}var I;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(I||(I={}));const En={start:[I.Space,I.Enter],cancel:[I.Esc],end:[I.Space,I.Enter,I.Tab]},Za=(e,s)=>{let{currentCoordinates:n}=s;switch(e.code){case I.Right:return{...n,x:n.x+25};case I.Left:return{...n,x:n.x-25};case I.Down:return{...n,y:n.y+25};case I.Up:return{...n,y:n.y-25}}};class us{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new rt(Ke(n)),this.windowListeners=new rt(ae(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(me.Resize,this.handleCancel),this.windowListeners.add(me.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(me.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,r=s.node.current;r&&_a(r),n(pe)}handleKeyDown(s){if(cs(s)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:o=En,coordinateGetter:l=Za,scrollBehavior:d="smooth"}=a,{code:u}=s;if(o.end.includes(u)){this.handleEnd(s);return}if(o.cancel.includes(u)){this.handleCancel(s);return}const{collisionRect:h}=r.current,m=h?{x:h.left,y:h.top}:pe;this.referenceCoordinates||(this.referenceCoordinates=m);const c=l(s,{active:n,context:r.current,currentCoordinates:m});if(c){const f=dt(c,m),x={x:0,y:0},{scrollableAncestors:b}=r.current;for(const p of b){const v=s.code,{isTop:w,isRight:g,isLeft:j,isBottom:N,maxScroll:y,minScroll:S}=Dn(p),k=Ha(p),C={x:Math.min(v===I.Right?k.right-k.width/2:k.right,Math.max(v===I.Right?k.left:k.left+k.width/2,c.x)),y:Math.min(v===I.Down?k.bottom-k.height/2:k.bottom,Math.max(v===I.Down?k.top:k.top+k.height/2,c.y))},E=v===I.Right&&!g||v===I.Left&&!j,T=v===I.Down&&!N||v===I.Up&&!w;if(E&&C.x!==c.x){const A=p.scrollLeft+f.x,B=v===I.Right&&A<=y.x||v===I.Left&&A>=S.x;if(B&&!f.y){p.scrollTo({left:A,behavior:d});return}B?x.x=p.scrollLeft-A:x.x=v===I.Right?p.scrollLeft-y.x:p.scrollLeft-S.x,x.x&&p.scrollBy({left:-x.x,behavior:d});break}else if(T&&C.y!==c.y){const A=p.scrollTop+f.y,B=v===I.Down&&A<=y.y||v===I.Up&&A>=S.y;if(B&&!f.x){p.scrollTo({top:A,behavior:d});return}B?x.y=p.scrollTop-A:x.y=v===I.Down?p.scrollTop-y.y:p.scrollTop-S.y,x.y&&p.scrollBy({top:-x.y,behavior:d});break}}this.handleMove(s,Ge(dt(c,this.referenceCoordinates),x))}}}handleMove(s,n){const{onMove:r}=this.props;s.preventDefault(),r(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}us.activators=[{eventName:"onKeyDown",handler:(e,s,n)=>{let{keyboardCodes:r=En,onActivation:a}=s,{active:o}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const d=o.activatorNode.current;return d&&e.target!==d?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Us(e){return!!(e&&"distance"in e)}function $s(e){return!!(e&&"delay"in e)}class ms{constructor(s,n,r){var a;r===void 0&&(r=Xa(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:o}=s,{target:l}=o;this.props=s,this.events=n,this.document=Ke(l),this.documentListeners=new rt(this.document),this.listeners=new rt(r),this.windowListeners=new rt(ae(l)),this.initialCoordinates=(a=Zt(o))!=null?a:pe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(me.Resize,this.handleCancel),this.windowListeners.add(me.DragStart,Bs),this.windowListeners.add(me.VisibilityChange,this.handleCancel),this.windowListeners.add(me.ContextMenu,Bs),this.documentListeners.add(me.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if($s(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Us(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:r,onPending:a}=this.props;a(r,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(me.Click,Ka,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(me.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:r,initialCoordinates:a,props:o}=this,{onMove:l,options:{activationConstraint:d}}=o;if(!a)return;const u=(n=Zt(s))!=null?n:pe,h=dt(a,u);if(!r&&d){if(Us(d)){if(d.tolerance!=null&&_t(h,d.tolerance))return this.handleCancel();if(_t(h,d.distance))return this.handleStart()}if($s(d)&&_t(h,d.tolerance))return this.handleCancel();this.handlePending(d,h);return}s.cancelable&&s.preventDefault(),l(u)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===I.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const Ja={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class hs extends ms{constructor(s){const{event:n}=s,r=Ke(n.target);super(s,Ja,r)}}hs.activators=[{eventName:"onPointerDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Qa={move:{name:"mousemove"},end:{name:"mouseup"}};var Qt;(function(e){e[e.RightClick=2]="RightClick"})(Qt||(Qt={}));class eo extends ms{constructor(s){super(s,Qa,Ke(s.event.target))}}eo.activators=[{eventName:"onMouseDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return n.button===Qt.RightClick?!1:(r==null||r({event:n}),!0)}}];const Yt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class to extends ms{constructor(s){super(s,Yt)}static setup(){return window.addEventListener(Yt.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(Yt.move.name,s)};function s(){}}}to.activators=[{eventName:"onTouchStart",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;const{touches:a}=n;return a.length>1?!1:(r==null||r({event:n}),!0)}}];var at;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(at||(at={}));var kt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(kt||(kt={}));function so(e){let{acceleration:s,activator:n=at.Pointer,canScroll:r,draggingRect:a,enabled:o,interval:l=5,order:d=kt.TreeOrder,pointerCoordinates:u,scrollableAncestors:h,scrollableAncestorRects:m,delta:c,threshold:f}=e;const x=ro({delta:c,disabled:!o}),[b,p]=fa(),v=i.useRef({x:0,y:0}),w=i.useRef({x:0,y:0}),g=i.useMemo(()=>{switch(n){case at.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case at.DraggableRect:return a}},[n,a,u]),j=i.useRef(null),N=i.useCallback(()=>{const S=j.current;if(!S)return;const k=v.current.x*w.current.x,C=v.current.y*w.current.y;S.scrollBy(k,C)},[]),y=i.useMemo(()=>d===kt.TreeOrder?[...h].reverse():h,[d,h]);i.useEffect(()=>{if(!o||!h.length||!g){p();return}for(const S of y){if((r==null?void 0:r(S))===!1)continue;const k=h.indexOf(S),C=m[k];if(!C)continue;const{direction:E,speed:T}=Va(S,C,g,s,f);for(const A of["x","y"])x[A][E[A]]||(T[A]=0,E[A]=0);if(T.x>0||T.y>0){p(),j.current=S,b(N,l),v.current=T,w.current=E;return}}v.current={x:0,y:0},w.current={x:0,y:0},p()},[s,N,r,p,o,l,JSON.stringify(g),JSON.stringify(x),b,h,y,m,JSON.stringify(f)])}const no={x:{[X.Backward]:!1,[X.Forward]:!1},y:{[X.Backward]:!1,[X.Forward]:!1}};function ro(e){let{delta:s,disabled:n}=e;const r=Kt(s);return xt(a=>{if(n||!r||!a)return no;const o={x:Math.sign(s.x-r.x),y:Math.sign(s.y-r.y)};return{x:{[X.Backward]:a.x[X.Backward]||o.x===-1,[X.Forward]:a.x[X.Forward]||o.x===1},y:{[X.Backward]:a.y[X.Backward]||o.y===-1,[X.Forward]:a.y[X.Forward]||o.y===1}}},[n,s,r])}function ao(e,s){const n=s!=null?e.get(s):void 0,r=n?n.node.current:null;return xt(a=>{var o;return s==null?null:(o=r??a)!=null?o:null},[r,s])}function oo(e,s){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:a}=r,o=a.activators.map(l=>({eventName:l.eventName,handler:s(l.handler,r)}));return[...n,...o]},[]),[e,s])}var mt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(mt||(mt={}));var es;(function(e){e.Optimized="optimized"})(es||(es={}));const Ws=new Map;function io(e,s){let{dragging:n,dependencies:r,config:a}=s;const[o,l]=i.useState(null),{frequency:d,measure:u,strategy:h}=a,m=i.useRef(e),c=v(),f=ct(c),x=i.useCallback(function(w){w===void 0&&(w=[]),!f.current&&l(g=>g===null?w:g.concat(w.filter(j=>!g.includes(j))))},[f]),b=i.useRef(null),p=xt(w=>{if(c&&!n)return Ws;if(!w||w===Ws||m.current!==e||o!=null){const g=new Map;for(let j of e){if(!j)continue;if(o&&o.length>0&&!o.includes(j.id)&&j.rect.current){g.set(j.id,j.rect.current);continue}const N=j.node.current,y=N?new ds(u(N),N):null;j.rect.current=y,y&&g.set(j.id,y)}return g}return w},[e,o,n,c,u]);return i.useEffect(()=>{m.current=e},[e]),i.useEffect(()=>{c||x()},[n,c]),i.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),i.useEffect(()=>{c||typeof d!="number"||b.current!==null||(b.current=setTimeout(()=>{x(),b.current=null},d))},[d,c,x,...r]),{droppableRects:p,measureDroppableContainers:x,measuringScheduled:o!=null};function v(){switch(h){case mt.Always:return!1;case mt.BeforeDragging:return n;default:return!n}}}function In(e,s){return xt(n=>e?n||(typeof s=="function"?s(e):e):null,[s,e])}function lo(e,s){return In(e,s)}function co(e){let{callback:s,disabled:n}=e;const r=ls(s),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Lt(e){let{callback:s,disabled:n}=e;const r=ls(s),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function uo(e){return new ds(Ze(e),e)}function Fs(e,s,n){s===void 0&&(s=uo);const[r,a]=i.useState(null);function o(){a(u=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=u??n)!=null?h:null}const m=s(e);return JSON.stringify(u)===JSON.stringify(m)?u:m})}const l=co({callback(u){if(e)for(const h of u){const{type:m,target:c}=h;if(m==="childList"&&c instanceof HTMLElement&&c.contains(e)){o();break}}}}),d=Lt({callback:o});return be(()=>{o(),e?(d==null||d.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(d==null||d.disconnect(),l==null||l.disconnect())},[e]),r}function mo(e){const s=In(e);return jn(e,s)}const Vs=[];function ho(e){const s=i.useRef(e),n=xt(r=>e?r&&r!==Vs&&e&&s.current&&e.parentNode===s.current.parentNode?r:Ot(e):Vs,[e]);return i.useEffect(()=>{s.current=e},[e]),n}function fo(e){const[s,n]=i.useState(null),r=i.useRef(e),a=i.useCallback(o=>{const l=Gt(o.target);l&&n(d=>d?(d.set(l,Jt(l)),new Map(d)):null)},[]);return i.useEffect(()=>{const o=r.current;if(e!==o){l(o);const d=e.map(u=>{const h=Gt(u);return h?(h.addEventListener("scroll",a,{passive:!0}),[h,Jt(h)]):null}).filter(u=>u!=null);n(d.length?new Map(d):null),r.current=e}return()=>{l(e),l(o)};function l(d){d.forEach(u=>{const h=Gt(u);h==null||h.removeEventListener("scroll",a)})}},[a,e]),i.useMemo(()=>e.length?s?Array.from(s.values()).reduce((o,l)=>Ge(o,l),pe):kn(e):pe,[e,s])}function Hs(e,s){s===void 0&&(s=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},s),i.useEffect(()=>{const r=e!==pe;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?dt(e,n.current):pe}function xo(e){i.useEffect(()=>{if(!Pt)return;const s=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of s)n==null||n()}},e.map(s=>{let{sensor:n}=s;return n}))}function po(e,s){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:a,handler:o}=r;return n[a]=l=>{o(l,s)},n},{}),[e,s])}function Mn(e){return i.useMemo(()=>e?Ua(e):null,[e])}const qs=[];function go(e,s){s===void 0&&(s=Ze);const[n]=e,r=Mn(n?ae(n):null),[a,o]=i.useState(qs);function l(){o(()=>e.length?e.map(u=>Sn(u)?r:new ds(s(u),u)):qs)}const d=Lt({callback:l});return be(()=>{d==null||d.disconnect(),l(),e.forEach(u=>d==null?void 0:d.observe(u))},[e]),a}function vo(e){if(!e)return null;if(e.children.length>1)return e;const s=e.children[0];return ft(s)?s:e}function bo(e){let{measure:s}=e;const[n,r]=i.useState(null),a=i.useCallback(h=>{for(const{target:m}of h)if(ft(m)){r(c=>{const f=s(m);return c?{...c,width:f.width,height:f.height}:f});break}},[s]),o=Lt({callback:a}),l=i.useCallback(h=>{const m=vo(h);o==null||o.disconnect(),m&&(o==null||o.observe(m)),r(m?s(m):null)},[s,o]),[d,u]=St(l);return i.useMemo(()=>({nodeRef:d,rect:n,setRef:u}),[n,d,u])}const yo=[{sensor:hs,options:{}},{sensor:us,options:{}}],jo={current:{}},Nt={draggable:{measure:Ls},droppable:{measure:Ls,strategy:mt.WhileDragging,frequency:es.Optimized},dragOverlay:{measure:Ze}};class ot extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,r;return(n=(r=this.get(s))==null?void 0:r.node.current)!=null?n:void 0}}const wo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ot,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Dt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Nt,measureDroppableContainers:Dt,windowRect:null,measuringScheduled:!1},No={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Dt,draggableNodes:new Map,over:null,measureDroppableContainers:Dt},Bt=i.createContext(No),An=i.createContext(wo);function Co(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ot}}}function So(e,s){switch(s.type){case H.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case H.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:s.coordinates.x-e.draggable.initialCoordinates.x,y:s.coordinates.y-e.draggable.initialCoordinates.y}}};case H.DragEnd:case H.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case H.RegisterDroppable:{const{element:n}=s,{id:r}=n,a=new ot(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case H.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=s,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const l=new ot(e.droppable.containers);return l.set(n,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case H.UnregisterDroppable:{const{id:n,key:r}=s,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const o=new ot(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Do(e){let{disabled:s}=e;const{active:n,activatorEvent:r,draggableNodes:a}=i.useContext(Bt),o=Kt(r),l=Kt(n==null?void 0:n.id);return i.useEffect(()=>{if(!s&&!r&&o&&l!=null){if(!cs(o)||document.activeElement===o.target)return;const d=a.get(l);if(!d)return;const{activatorNode:u,node:h}=d;if(!u.current&&!h.current)return;requestAnimationFrame(()=>{for(const m of[u.current,h.current]){if(!m)continue;const c=ga(m);if(c){c.focus();break}}})}},[r,s,a,l,o]),null}function ko(e,s){let{transform:n,...r}=s;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...r}),n):n}function Eo(e){return i.useMemo(()=>({draggable:{...Nt.draggable,...e==null?void 0:e.draggable},droppable:{...Nt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Nt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Io(e){let{activeNode:s,measure:n,initialRect:r,config:a=!0}=e;const o=i.useRef(!1),{x:l,y:d}=typeof a=="boolean"?{x:a,y:a}:a;be(()=>{if(!l&&!d||!s){o.current=!1;return}if(o.current||!r)return;const h=s==null?void 0:s.node.current;if(!h||h.isConnected===!1)return;const m=n(h),c=jn(m,r);if(l||(c.x=0),d||(c.y=0),o.current=!0,Math.abs(c.x)>0||Math.abs(c.y)>0){const f=wn(h);f&&f.scrollBy({top:c.y,left:c.x})}},[s,l,d,r,n])}const Rn=i.createContext({...pe,scaleX:1,scaleY:1});var Re;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Re||(Re={}));const Mo=i.memo(function(s){var n,r,a,o;let{id:l,accessibility:d,autoScroll:u=!0,children:h,sensors:m=yo,collisionDetection:c=Ra,measuring:f,modifiers:x,...b}=s;const p=i.useReducer(So,void 0,Co),[v,w]=p,[g,j]=Na(),[N,y]=i.useState(Re.Uninitialized),S=N===Re.Initialized,{draggable:{active:k,nodes:C,translate:E},droppable:{containers:T}}=v,A=k!=null?C.get(k):null,B=i.useRef({initial:null,translated:null}),F=i.useMemo(()=>{var ee;return k!=null?{id:k,data:(ee=A==null?void 0:A.data)!=null?ee:jo,rect:B}:null},[k,A]),se=i.useRef(null),[he,Pe]=i.useState(null),[K,Oe]=i.useState(null),fe=ct(b,Object.values(b)),De=pt("DndDescribedBy",l),Ue=i.useMemo(()=>T.getEnabled(),[T]),Q=Eo(f),{droppableRects:xe,measureDroppableContainers:ye,measuringScheduled:Le}=io(Ue,{dragging:S,dependencies:[E.x,E.y],config:Q.droppable}),D=ao(C,k),z=i.useMemo(()=>K?Zt(K):null,[K]),O=Gn(),U=lo(D,Q.draggable.measure);Io({activeNode:k!=null?C.get(k):null,config:O.layoutShiftCompensation,initialRect:U,measure:Q.draggable.measure});const M=Fs(D,Q.draggable.measure,U),oe=Fs(D?D.parentElement:null),Y=i.useRef({activatorEvent:null,active:null,activeNode:D,collisionRect:null,collisions:null,droppableRects:xe,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:T,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),$e=T.getNodeFor((n=Y.current.over)==null?void 0:n.id),je=bo({measure:Q.dragOverlay.measure}),We=(r=je.nodeRef.current)!=null?r:D,Fe=S?(a=je.rect)!=null?a:M:null,ps=!!(je.nodeRef.current&&je.rect),gs=mo(ps?null:M),Ut=Mn(We?ae(We):null),ke=ho(S?$e??D:null),gt=go(ke),vt=ko(x,{transform:{x:E.x-gs.x,y:E.y-gs.y,scaleX:1,scaleY:1},activatorEvent:K,active:F,activeNodeRect:M,containerNodeRect:oe,draggingNodeRect:Fe,over:Y.current.over,overlayNodeRect:je.rect,scrollableAncestors:ke,scrollableAncestorRects:gt,windowRect:Ut}),vs=z?Ge(z,E):null,bs=fo(ke),Un=Hs(bs),$n=Hs(bs,[M]),Ve=Ge(vt,Un),He=Fe?Pa(Fe,vt):null,Je=F&&He?c({active:F,collisionRect:He,droppableRects:xe,droppableContainers:Ue,pointerCoordinates:vs}):null,ys=yn(Je,"id"),[Ee,js]=i.useState(null),Wn=ps?vt:Ge(vt,$n),Fn=Ta(Wn,(o=Ee==null?void 0:Ee.rect)!=null?o:null,M),$t=i.useRef(null),ws=i.useCallback((ee,ie)=>{let{sensor:le,options:Ie}=ie;if(se.current==null)return;const ue=C.get(se.current);if(!ue)return;const ce=ee.nativeEvent,ge=new le({active:se.current,activeNode:ue,event:ce,options:Ie,context:Y,onAbort(Z){if(!C.get(Z))return;const{onDragAbort:ve}=fe.current,we={id:Z};ve==null||ve(we),g({type:"onDragAbort",event:we})},onPending(Z,Me,ve,we){if(!C.get(Z))return;const{onDragPending:et}=fe.current,Ae={id:Z,constraint:Me,initialCoordinates:ve,offset:we};et==null||et(Ae),g({type:"onDragPending",event:Ae})},onStart(Z){const Me=se.current;if(Me==null)return;const ve=C.get(Me);if(!ve)return;const{onDragStart:we}=fe.current,Qe={activatorEvent:ce,active:{id:Me,data:ve.data,rect:B}};st.unstable_batchedUpdates(()=>{we==null||we(Qe),y(Re.Initializing),w({type:H.DragStart,initialCoordinates:Z,active:Me}),g({type:"onDragStart",event:Qe}),Pe($t.current),Oe(ce)})},onMove(Z){w({type:H.DragMove,coordinates:Z})},onEnd:qe(H.DragEnd),onCancel:qe(H.DragCancel)});$t.current=ge;function qe(Z){return async function(){const{active:ve,collisions:we,over:Qe,scrollAdjustedTranslate:et}=Y.current;let Ae=null;if(ve&&et){const{cancelDrop:tt}=fe.current;Ae={activatorEvent:ce,active:ve,collisions:we,delta:et,over:Qe},Z===H.DragEnd&&typeof tt=="function"&&await Promise.resolve(tt(Ae))&&(Z=H.DragCancel)}se.current=null,st.unstable_batchedUpdates(()=>{w({type:Z}),y(Re.Uninitialized),js(null),Pe(null),Oe(null),$t.current=null;const tt=Z===H.DragEnd?"onDragEnd":"onDragCancel";if(Ae){const Wt=fe.current[tt];Wt==null||Wt(Ae),g({type:tt,event:Ae})}})}}},[C]),Vn=i.useCallback((ee,ie)=>(le,Ie)=>{const ue=le.nativeEvent,ce=C.get(Ie);if(se.current!==null||!ce||ue.dndKit||ue.defaultPrevented)return;const ge={active:ce};ee(le,ie.options,ge)===!0&&(ue.dndKit={capturedBy:ie.sensor},se.current=Ie,ws(le,ie))},[C,ws]),Ns=oo(m,Vn);xo(m),be(()=>{M&&N===Re.Initializing&&y(Re.Initialized)},[M,N]),i.useEffect(()=>{const{onDragMove:ee}=fe.current,{active:ie,activatorEvent:le,collisions:Ie,over:ue}=Y.current;if(!ie||!le)return;const ce={active:ie,activatorEvent:le,collisions:Ie,delta:{x:Ve.x,y:Ve.y},over:ue};st.unstable_batchedUpdates(()=>{ee==null||ee(ce),g({type:"onDragMove",event:ce})})},[Ve.x,Ve.y]),i.useEffect(()=>{const{active:ee,activatorEvent:ie,collisions:le,droppableContainers:Ie,scrollAdjustedTranslate:ue}=Y.current;if(!ee||se.current==null||!ie||!ue)return;const{onDragOver:ce}=fe.current,ge=Ie.get(ys),qe=ge&&ge.rect.current?{id:ge.id,rect:ge.rect.current,data:ge.data,disabled:ge.disabled}:null,Z={active:ee,activatorEvent:ie,collisions:le,delta:{x:ue.x,y:ue.y},over:qe};st.unstable_batchedUpdates(()=>{js(qe),ce==null||ce(Z),g({type:"onDragOver",event:Z})})},[ys]),be(()=>{Y.current={activatorEvent:K,active:F,activeNode:D,collisionRect:He,collisions:Je,droppableRects:xe,draggableNodes:C,draggingNode:We,draggingNodeRect:Fe,droppableContainers:T,over:Ee,scrollableAncestors:ke,scrollAdjustedTranslate:Ve},B.current={initial:Fe,translated:He}},[F,D,Je,He,C,We,Fe,xe,T,Ee,ke,Ve]),so({...O,delta:E,draggingRect:He,pointerCoordinates:vs,scrollableAncestors:ke,scrollableAncestorRects:gt});const Hn=i.useMemo(()=>({active:F,activeNode:D,activeNodeRect:M,activatorEvent:K,collisions:Je,containerNodeRect:oe,dragOverlay:je,draggableNodes:C,droppableContainers:T,droppableRects:xe,over:Ee,measureDroppableContainers:ye,scrollableAncestors:ke,scrollableAncestorRects:gt,measuringConfiguration:Q,measuringScheduled:Le,windowRect:Ut}),[F,D,M,K,Je,oe,je,C,T,xe,Ee,ye,ke,gt,Q,Le,Ut]),qn=i.useMemo(()=>({activatorEvent:K,activators:Ns,active:F,activeNodeRect:M,ariaDescribedById:{draggable:De},dispatch:w,draggableNodes:C,over:Ee,measureDroppableContainers:ye}),[K,Ns,F,M,w,De,C,Ee,ye]);return J.createElement(gn.Provider,{value:j},J.createElement(Bt.Provider,{value:qn},J.createElement(An.Provider,{value:Hn},J.createElement(Rn.Provider,{value:Fn},h)),J.createElement(Do,{disabled:(d==null?void 0:d.restoreFocus)===!1})),J.createElement(Da,{...d,hiddenTextDescribedById:De}));function Gn(){const ee=(he==null?void 0:he.autoScrollEnabled)===!1,ie=typeof u=="object"?u.enabled===!1:u===!1,le=S&&!ee&&!ie;return typeof u=="object"?{...u,enabled:le}:{enabled:le}}}),Ao=i.createContext(null),Gs="button",Ro="Draggable";function To(e){let{id:s,data:n,disabled:r=!1,attributes:a}=e;const o=pt(Ro),{activators:l,activatorEvent:d,active:u,activeNodeRect:h,ariaDescribedById:m,draggableNodes:c,over:f}=i.useContext(Bt),{role:x=Gs,roleDescription:b="draggable",tabIndex:p=0}=a??{},v=(u==null?void 0:u.id)===s,w=i.useContext(v?Rn:Ao),[g,j]=St(),[N,y]=St(),S=po(l,s),k=ct(n);be(()=>(c.set(s,{id:s,key:o,node:g,activatorNode:N,data:k}),()=>{const E=c.get(s);E&&E.key===o&&c.delete(s)}),[c,s]);const C=i.useMemo(()=>({role:x,tabIndex:p,"aria-disabled":r,"aria-pressed":v&&x===Gs?!0:void 0,"aria-roledescription":b,"aria-describedby":m.draggable}),[r,x,p,v,b,m.draggable]);return{active:u,activatorEvent:d,activeNodeRect:h,attributes:C,isDragging:v,listeners:r?void 0:S,node:g,over:f,setNodeRef:j,setActivatorNodeRef:y,transform:w}}function zo(){return i.useContext(An)}const Po="Droppable",Oo={timeout:25};function Lo(e){let{data:s,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const o=pt(Po),{active:l,dispatch:d,over:u,measureDroppableContainers:h}=i.useContext(Bt),m=i.useRef({disabled:n}),c=i.useRef(!1),f=i.useRef(null),x=i.useRef(null),{disabled:b,updateMeasurementsFor:p,timeout:v}={...Oo,...a},w=ct(p??r),g=i.useCallback(()=>{if(!c.current){c.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{h(Array.isArray(w.current)?w.current:[w.current]),x.current=null},v)},[v]),j=Lt({callback:g,disabled:b||!l}),N=i.useCallback((C,E)=>{j&&(E&&(j.unobserve(E),c.current=!1),C&&j.observe(C))},[j]),[y,S]=St(N),k=ct(s);return i.useEffect(()=>{!j||!y.current||(j.disconnect(),c.current=!1,j.observe(y.current))},[y,j]),i.useEffect(()=>(d({type:H.RegisterDroppable,element:{id:r,key:o,disabled:n,node:y,rect:f,data:k}}),()=>d({type:H.UnregisterDroppable,key:o,id:r})),[r]),i.useEffect(()=>{n!==m.current.disabled&&(d({type:H.SetDroppableDisabled,id:r,key:o,disabled:n}),m.current.disabled=n)},[r,o,n,d]),{active:l,rect:f,isOver:(u==null?void 0:u.id)===r,node:y,over:u,setNodeRef:S}}function fs(e,s,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(s,1)[0]),r}function Bo(e,s){return e.reduce((n,r,a)=>{const o=s.get(r);return o&&(n[a]=o),n},Array(e.length))}function jt(e){return e!==null&&e>=0}function Uo(e,s){if(e===s)return!0;if(e.length!==s.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==s[n])return!1;return!0}function $o(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const xs=e=>{let{rects:s,activeIndex:n,overIndex:r,index:a}=e;const o=fs(s,r,n),l=s[a],d=o[a];return!d||!l?null:{x:d.left-l.left,y:d.top-l.top,scaleX:d.width/l.width,scaleY:d.height/l.height}},Tn="Sortable",zn=J.createContext({activeIndex:-1,containerId:Tn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xs,disabled:{draggable:!1,droppable:!1}});function Wo(e){let{children:s,id:n,items:r,strategy:a=xs,disabled:o=!1}=e;const{active:l,dragOverlay:d,droppableRects:u,over:h,measureDroppableContainers:m}=zo(),c=pt(Tn,n),f=d.rect!==null,x=i.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),b=l!=null,p=l?x.indexOf(l.id):-1,v=h?x.indexOf(h.id):-1,w=i.useRef(x),g=!Uo(x,w.current),j=v!==-1&&p===-1||g,N=$o(o);be(()=>{g&&b&&m(x)},[g,x,b,m]),i.useEffect(()=>{w.current=x},[x]);const y=i.useMemo(()=>({activeIndex:p,containerId:c,disabled:N,disableTransforms:j,items:x,overIndex:v,useDragOverlay:f,sortedRects:Bo(x,u),strategy:a}),[p,c,N.draggable,N.droppable,j,x,v,u,f,a]);return J.createElement(zn.Provider,{value:y},s)}const Fo=e=>{let{id:s,items:n,activeIndex:r,overIndex:a}=e;return fs(n,r,a).indexOf(s)},Vo=e=>{let{containerId:s,isSorting:n,wasDragging:r,index:a,items:o,newIndex:l,previousItems:d,previousContainerId:u,transition:h}=e;return!h||!r||d!==o&&a===l?!1:n?!0:l!==a&&s===u},Ho={duration:200,easing:"ease"},Pn="transform",qo=ut.Transition.toString({property:Pn,duration:0,easing:"linear"}),Go={roleDescription:"sortable"};function _o(e){let{disabled:s,index:n,node:r,rect:a}=e;const[o,l]=i.useState(null),d=i.useRef(n);return be(()=>{if(!s&&n!==d.current&&r.current){const u=a.current;if(u){const h=Ze(r.current,{ignoreTransform:!0}),m={x:u.left-h.left,y:u.top-h.top,scaleX:u.width/h.width,scaleY:u.height/h.height};(m.x||m.y)&&l(m)}}n!==d.current&&(d.current=n)},[s,n,r,a]),i.useEffect(()=>{o&&l(null)},[o]),o}function Yo(e){let{animateLayoutChanges:s=Vo,attributes:n,disabled:r,data:a,getNewIndex:o=Fo,id:l,strategy:d,resizeObserverConfig:u,transition:h=Ho}=e;const{items:m,containerId:c,activeIndex:f,disabled:x,disableTransforms:b,sortedRects:p,overIndex:v,useDragOverlay:w,strategy:g}=i.useContext(zn),j=Xo(r,x),N=m.indexOf(l),y=i.useMemo(()=>({sortable:{containerId:c,index:N,items:m},...a}),[c,a,N,m]),S=i.useMemo(()=>m.slice(m.indexOf(l)),[m,l]),{rect:k,node:C,isOver:E,setNodeRef:T}=Lo({id:l,data:y,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...u}}),{active:A,activatorEvent:B,activeNodeRect:F,attributes:se,setNodeRef:he,listeners:Pe,isDragging:K,over:Oe,setActivatorNodeRef:fe,transform:De}=To({id:l,data:y,attributes:{...Go,...n},disabled:j.draggable}),Ue=ha(T,he),Q=!!A,xe=Q&&!b&&jt(f)&&jt(v),ye=!w&&K,Le=ye&&xe?De:null,z=xe?Le??(d??g)({rects:p,activeNodeRect:F,activeIndex:f,overIndex:v,index:N}):null,O=jt(f)&&jt(v)?o({id:l,items:m,activeIndex:f,overIndex:v}):N,U=A==null?void 0:A.id,M=i.useRef({activeId:U,items:m,newIndex:O,containerId:c}),oe=m!==M.current.items,Y=s({active:A,containerId:c,isDragging:K,isSorting:Q,id:l,index:N,items:m,newIndex:M.current.newIndex,previousItems:M.current.items,previousContainerId:M.current.containerId,transition:h,wasDragging:M.current.activeId!=null}),$e=_o({disabled:!Y,index:N,node:C,rect:k});return i.useEffect(()=>{Q&&M.current.newIndex!==O&&(M.current.newIndex=O),c!==M.current.containerId&&(M.current.containerId=c),m!==M.current.items&&(M.current.items=m)},[Q,O,c,m]),i.useEffect(()=>{if(U===M.current.activeId)return;if(U!=null&&M.current.activeId==null){M.current.activeId=U;return}const We=setTimeout(()=>{M.current.activeId=U},50);return()=>clearTimeout(We)},[U]),{active:A,activeIndex:f,attributes:se,data:y,rect:k,index:N,newIndex:O,items:m,isOver:E,isSorting:Q,isDragging:K,listeners:Pe,node:C,overIndex:v,over:Oe,setNodeRef:Ue,setActivatorNodeRef:fe,setDroppableNodeRef:T,setDraggableNodeRef:he,transform:$e??z,transition:je()};function je(){if($e||oe&&M.current.newIndex===N)return qo;if(!(ye&&!cs(B)||!h)&&(Q||Y))return ut.Transition.toString({...h,property:Pn})}}function Xo(e,s){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:s.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:s.droppable}}function Et(e){if(!e)return!1;const s=e.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const Ko=[I.Down,I.Right,I.Up,I.Left],Zo=(e,s)=>{let{context:{active:n,collisionRect:r,droppableRects:a,droppableContainers:o,over:l,scrollableAncestors:d}}=s;if(Ko.includes(e.code)){if(e.preventDefault(),!n||!r)return;const u=[];o.getEnabled().forEach(c=>{if(!c||c!=null&&c.disabled)return;const f=a.get(c.id);if(f)switch(e.code){case I.Down:r.top<f.top&&u.push(c);break;case I.Up:r.top>f.top&&u.push(c);break;case I.Left:r.left>f.left&&u.push(c);break;case I.Right:r.left<f.left&&u.push(c);break}});const h=Ma({active:n,collisionRect:r,droppableRects:a,droppableContainers:u,pointerCoordinates:null});let m=yn(h,"id");if(m===(l==null?void 0:l.id)&&h.length>1&&(m=h[1].id),m!=null){const c=o.get(n.id),f=o.get(m),x=f?a.get(f.id):null,b=f==null?void 0:f.node.current;if(b&&x&&c&&f){const v=Ot(b).some((S,k)=>d[k]!==S),w=On(c,f),g=Jo(c,f),j=v||!w?{x:0,y:0}:{x:g?r.width-x.width:0,y:g?r.height-x.height:0},N={x:x.left,y:x.top};return j.x&&j.y?N:dt(N,j)}}}};function On(e,s){return!Et(e)||!Et(s)?!1:e.data.current.sortable.containerId===s.data.current.sortable.containerId}function Jo(e,s){return!Et(e)||!Et(s)||!On(e,s)?!1:e.data.current.sortable.index<s.data.current.sortable.index}const wt=[{id:"smart-analyst",type:"smart-analyst",title:"Analista Inteligente",description:"Anlisis automtico de inventario",icon:Jr,visible:!0,order:0,size:"small",span:2,row:"top"},{id:"metrics-carousel",type:"metrics-carousel",title:"Mtricas Financieras",description:"Diferencia neta, negativos y positivos",icon:lt,visible:!0,order:1,size:"small",span:1,row:"top",mandatory:!0},{id:"active-products",type:"active-products",title:"Productos Activos",description:"Total de productos en inventarios",icon:rs,visible:!0,order:2,size:"small",span:1,row:"top"},{id:"inventory-summary",type:"inventory-summary",title:"Resumen de Inventario",description:"Progreso de productos en stock",icon:It,visible:!1,order:10,size:"large",span:1,row:"middle"},{id:"inventory-alerts",type:"inventory-alerts",title:"Alertas de Inventario",description:"Notificaciones importantes",icon:Mt,visible:!0,order:6,size:"large",span:1,row:"middle"},{id:"upcoming-inventories",type:"upcoming-inventories",title:"Prximos Inventarios",description:"Inventarios programados",icon:hn,visible:!0,order:5,size:"large",span:1,row:"middle"},{id:"branches-table",type:"branches-table",title:"Tabla de Sucursales",description:"Listado completo de sucursales",icon:Qr,visible:!0,order:7,size:"full",span:1,row:"bottom"},{id:"inventory-progress",type:"inventory-progress",title:"Progreso de Inventarios",description:"Porcentaje de inventarios completados",icon:Be,visible:!1,order:6,size:"small",span:1,row:"top"},{id:"critical-products",type:"critical-products",title:"Productos Crticos",description:"Productos con stock bajo o agotados",icon:ts,visible:!1,order:7,size:"small",span:1,row:"top"},{id:"total-stock-value",type:"total-stock-value",title:"Valor Total de Stock",description:"Valor monetario total del inventario",icon:lt,visible:!1,order:8,size:"small",span:1,row:"top"},{id:"active-users",type:"active-users",title:"Usuarios Activos",description:"Usuarios trabajando en tiempo real",icon:rn,visible:!1,order:9,size:"small",span:1,row:"top"},{id:"pending-inventories",type:"pending-inventories",title:"Inventarios Pendientes",description:"Inventarios sin completar",icon:ht,visible:!1,order:10,size:"small",span:1,row:"top"},{id:"trends-chart",type:"trends-chart",title:"Grfico de Tendencias",description:"Evolucin de diferencias en el tiempo",icon:ea,visible:!0,order:11,size:"large",span:1,row:"middle"},{id:"top-products",type:"top-products",title:"Top Productos con Diferencias",description:"Productos con mayores discrepancias",icon:ma,visible:!1,order:12,size:"large",span:1,row:"middle"},{id:"activity-timeline",type:"activity-timeline",title:"Actividad Reciente",description:"Timeline de ltimas acciones",icon:fr,visible:!1,order:13,size:"large",span:1,row:"middle"},{id:"category-distribution",type:"category-distribution",title:"Distribucin por Categora",description:"Porcentaje de productos por categora",icon:As,visible:!1,order:14,size:"large",span:1,row:"middle"},{id:"monthly-goals",type:"monthly-goals",title:"Objetivos del Mes",description:"Progreso hacia metas mensuales",icon:an,visible:!1,order:15,size:"large",span:1,row:"middle"},{id:"sync-status",type:"sync-status",title:"Estado de Sincronizacin",description:"Conexin y datos pendientes",icon:on,visible:!1,order:16,size:"large",span:1,row:"middle"},{id:"quick-actions",type:"quick-actions",title:"Acciones Rpidas",description:"Tareas frecuentes",icon:as,visible:!1,order:17,size:"large",span:1,row:"middle"},{id:"countdown",type:"countdown",title:"Contador de Das",description:"Das restantes para finalizar conteo cclico",icon:Ct,visible:!0,order:3,size:"small",span:1,row:"top"},{id:"category-progress",type:"category-progress",title:"Progreso por Rubros",description:"Avance de inventario por categora",icon:As,visible:!0,order:4,size:"large",span:1,row:"middle"}];function Qo(e){const s=`dashboard - layout - v5 - ${e||"default"} `,[n,r]=i.useState(()=>{try{const b=localStorage.getItem(s);if(b){const p=JSON.parse(b);return wt.map(w=>{const g=p.widgets.find(j=>j.id===w.id);return g?{...w,visible:g.visible,order:g.order,...w.mandatory?{visible:!0}:{}}:w}).sort((w,g)=>w.order-g.order)}}catch(b){console.error("Error loading dashboard layout:",b)}return wt}),[a,o]=i.useState(!1);i.useEffect(()=>{const p={widgets:n.map(({id:v,visible:w,order:g})=>({id:v,visible:w,order:g})),lastUpdated:Date.now()};localStorage.setItem(s,JSON.stringify(p))},[n,s]);const l=(b,p)=>{r(v=>{const w=v.findIndex(N=>N.id===b),g=v.findIndex(N=>N.id===p);return fs(v,w,g).map((N,y)=>({...N,order:y}))})},d=b=>{r(p=>p.map(v=>v.id===b&&!v.mandatory?{...v,visible:!v.visible}:v))},u=()=>{r(wt),o(!1)},h=(b,p)=>{r(v=>v.map(w=>w.id===b?{...w,size:p}:w))},m=(b,p)=>{r(v=>v.map(w=>w.id===b?{...w,span:p}:w))},c=b=>{r(p=>p.map(v=>({...v,visible:v.mandatory||b.includes(v.id)})))};i.useEffect(()=>{n.every(p=>p.title&&p.icon)||(console.warn("Detected corrupted widget state, resetting to defaults"),r(wt))},[n]);const f=n.filter(b=>b.visible).sort((b,p)=>b.order-p.order),x=n.filter(b=>!b.visible).sort((b,p)=>(b.title||"").localeCompare(p.title||""));return{widgets:n,visibleWidgets:f,hiddenWidgets:x,isEditMode:a,setIsEditMode:o,reorderWidgets:l,toggleWidgetVisibility:d,updateWidgetSize:h,updateWidgetSpan:m,applyPreset:c,resetLayout:u}}const ei={small:"h-[200px]",medium:"h-[300px]",large:"h-[400px]",full:"h-auto"},ti={small:"col-span-1",medium:"col-span-1",large:"col-span-1",full:"col-span-full"},_s={small:{label:"Pequeo",icon:aa,description:"1/4 ancho (3 cols)"},medium:{label:"Mediano",icon:da,description:"1/2 ancho (6 cols)"},large:{label:"Grande",icon:Rs,description:"1/3 ancho (4 cols)"},full:{label:"Ancho completo",icon:Rs,description:"Ancho completo (12 cols)"}};function si({currentSize:e,onChange:s,availableSizes:n=["small","medium","large"]}){const r=_s[e].icon;return t.jsxs(pr,{children:[t.jsx(gr,{asChild:!0,children:t.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6",title:"Cambiar tamao",children:t.jsx(r,{className:"h-4 w-4"})})}),t.jsx(vr,{align:"end",children:n.map(a=>{const o=_s[a],l=o.icon;return t.jsxs(br,{onClick:()=>s(a),className:$("flex items-center gap-2",e===a&&"bg-accent"),children:[t.jsx(l,{className:"h-4 w-4"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-medium",children:o.label}),t.jsx("span",{className:"text-xs text-muted-foreground",children:o.description})]})]},a)})})]})}function ni({widget:e,isEditMode:s,onRemove:n,onSizeChange:r,children:a}){const{attributes:o,listeners:l,setNodeRef:d,transform:u,transition:h,isDragging:m}=Yo({id:e.id,disabled:!s}),c={transform:ut.Transform.toString(u),transition:h};return t.jsx("div",{ref:d,style:c,className:$(ti[e.size],m&&"opacity-50 z-50",s&&"cursor-move",ei[e.size]),children:t.jsx(xr,{hoverEffect:s?"none":"lift",className:"h-full",children:t.jsxs("div",{className:$("relative h-full transition-all rounded-lg",s&&"ring-2 ring-primary/20 hover:ring-primary/40"),children:[s&&t.jsxs("div",{className:"absolute top-2 right-2 z-10 flex gap-1",children:[r&&t.jsx(si,{currentSize:e.size,onChange:r}),t.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-grab active:cursor-grabbing",...o,...l,children:t.jsx(sa,{className:"h-4 w-4"})}),!e.mandatory&&n&&t.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive hover:text-destructive-foreground",onClick:n,children:t.jsx(Ks,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"h-full",children:a})]})})})}const Ys={metrics:{id:"metrics",name:"Mtricas",icon:lt,description:"Indicadores financieros y de rendimiento"},inventory:{id:"inventory",name:"Inventario",icon:Yn,description:"Gestin y control de inventarios"},analytics:{id:"analytics",name:"Anlisis",icon:It,description:"Grficos y reportes analticos"},actions:{id:"actions",name:"Acciones",icon:as,description:"Acciones rpidas y utilidades"},alerts:{id:"alerts",name:"Alertas",icon:Mt,description:"Notificaciones y recordatorios"},activity:{id:"activity",name:"Actividad",icon:rs,description:"Seguimiento de actividad y usuarios"}},Xt={"metrics-carousel":"metrics","active-products":"inventory","inventory-summary":"inventory","inventory-alerts":"alerts","upcoming-inventories":"inventory","branches-table":"activity","inventory-progress":"inventory","critical-products":"alerts","total-stock-value":"metrics","active-users":"activity","pending-inventories":"inventory","trends-chart":"analytics","top-products":"analytics","activity-timeline":"activity","category-distribution":"analytics","monthly-goals":"metrics","sync-status":"actions","quick-actions":"actions",countdown:"alerts","category-progress":"analytics",calendar:"actions"},ri=new Set(["metrics-carousel","active-products","inventory-alerts","trends-chart","quick-actions"]);function ai({open:e,onOpenChange:s,hiddenWidgets:n,onAddWidget:r}){const[a,o]=i.useState(""),[l,d]=i.useState(null),u=i.useMemo(()=>{let c=n;return a&&(c=c.filter(f=>f.title.toLowerCase().includes(a.toLowerCase())||f.description.toLowerCase().includes(a.toLowerCase()))),l&&(c=c.filter(f=>Xt[f.type]===l)),c},[n,a,l]),h=i.useMemo(()=>{const c={};return u.forEach(f=>{const x=Xt[f.type]||"other";c[x]||(c[x]=[]),c[x].push(f)}),c},[u]),m=c=>{r(c),n.length===1&&s(!1)};return t.jsx(Zs,{open:e,onOpenChange:s,children:t.jsxs(Js,{className:"max-h-[90vh]",children:[t.jsxs(Qs,{children:[t.jsx(en,{children:"Galera de Widgets"}),t.jsx(Xn,{children:"Explora y agrega widgets para personalizar tu dashboard"})]}),t.jsxs("div",{className:"px-4 space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(ne,{placeholder:"Buscar widgets...",value:a,onChange:c=>o(c.target.value),className:"pl-9"})]}),t.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[t.jsx(R,{variant:l===null?"default":"outline",size:"sm",onClick:()=>d(null),children:"Todos"}),Object.values(Ys).map(c=>{const f=c.icon,x=n.filter(b=>Xt[b.type]===c.id).length;return x===0?null:t.jsxs(R,{variant:l===c.id?"default":"outline",size:"sm",onClick:()=>d(c.id),className:"flex items-center gap-2",children:[t.jsx(f,{className:"h-4 w-4"}),c.name,t.jsx(re,{variant:"secondary",className:"ml-1",children:x})]},c.id)})]})]}),t.jsx("div",{className:"px-4 pb-4 max-h-[50vh] overflow-y-auto",children:u.length===0?t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx("p",{className:"text-lg font-medium",children:n.length===0?"Todos los widgets estn visibles":"No se encontraron widgets"}),a&&t.jsx("p",{className:"text-sm mt-2",children:"Intenta con otra bsqueda o categora"})]}):t.jsx("div",{className:"space-y-6",children:Object.entries(h).map(([c,f])=>{const x=Ys[c];if(!x||f.length===0)return null;const b=x.icon;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-background py-2 z-10",children:[t.jsx(b,{className:"h-5 w-5 text-primary"}),t.jsx("h3",{className:"font-semibold",children:x.name}),t.jsx(re,{variant:"outline",children:f.length})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:f.map(p=>{const v=p.icon,w=ri.has(p.id);return t.jsxs(P,{className:$("hover:border-primary transition-all hover:shadow-md",w&&"border-primary/50"),children:[t.jsx(q,{className:"pb-3",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(v,{className:"h-4 w-4 text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(G,{className:"text-sm truncate",children:p.title}),w&&t.jsx(jr,{className:"h-3 w-3 fill-yellow-400 text-yellow-400 flex-shrink-0"})]}),t.jsx(Kn,{className:"text-xs mt-1 line-clamp-2",children:p.description})]})]})})}),t.jsx(_,{className:"pt-0",children:t.jsxs(R,{size:"sm",className:"w-full",onClick:()=>m(p.id),children:[t.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Agregar"]})})]},p.id)})})]},c)})})}),t.jsx(Zn,{children:t.jsx(Jn,{asChild:!0,children:t.jsx(R,{variant:"outline",children:"Cerrar"})})})]})})}function oi(){const{user:e}=ze(),[s,n]=i.useState([]),[r,a]=i.useState(!0),[o,l]=i.useState(0),d=_n();i.useEffect(()=>{u();const f=setInterval(u,5e3);return()=>clearInterval(f)},[e==null?void 0:e.branchName]),i.useEffect(()=>{if(s.length<=1)return;const f=setInterval(()=>{l(x=>(x+1)%s.length)},4e3);return()=>clearInterval(f)},[s.length]);const u=async()=>{try{const f=await wr(e==null?void 0:e.branchName),x=new Date,b=x.getMonth()+1,p=x.getFullYear(),v=p*100+b,w=[],g=new Map;f.forEach(j=>{const N=g.get(j.ean);(!N||j.timestamp>N.timestamp)&&g.set(j.ean,j)}),g.forEach(j=>{j.batches.forEach(N=>{if(N.quantity<=0||N.status&&N.status!=="active")return;const y=N.reminderMonths;if(!y)return;const S=N.expirationDate.split("/");if(S.length<2)return;let k=parseInt(S[0]),C=parseInt(S[1]);C<100&&(C+=2e3);const E=C*100+k,T=C*12+k,A=p*12+b;if(T-A<=y){const se=new Date(C,k-1,1).getTime()-x.getTime(),he=Math.ceil(se/(1e3*60*60*24));w.push({productName:j.productName,batchNumber:N.batchNumber,expirationDate:N.expirationDate,reminderMonths:y,daysUntilExpiry:he})}})}),w.sort((j,N)=>j.daysUntilExpiry-N.daysUntilExpiry),n(j=>JSON.stringify(j)===JSON.stringify(w)?j:w)}catch(f){console.error("Smart Analyst Error:",f)}finally{a(!1)}};if(r)return null;const h=s.length,m=h===0,c=s[o];return t.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-full",children:t.jsxs(P,{className:"flex flex-col h-full bg-card border-border/50 shadow-sm relative overflow-hidden group hover:shadow-md transition-all cursor-pointer",onClick:()=>d("/smart-analyst"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-50"}),t.jsx(q,{className:"pb-2 pt-4 px-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Control de Vencimientos"}),m?t.jsx(it,{className:"w-4 h-4 text-emerald-500"}):t.jsx(Zr,{className:"w-4 h-4 text-primary"})]})}),t.jsxs(_,{className:"flex-1 flex flex-col px-4 pb-4 pt-0 min-h-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[t.jsx("span",{className:`text-3xl font-bold ${m?"text-emerald-600 dark:text-emerald-400":"text-foreground"}`,children:m?"Todo en Orden":`${h}`}),!m&&t.jsx("span",{className:"text-sm text-muted-foreground",children:"Alertas"})]}),m&&t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:"No detectamos productos prximos a vencer segn tus recordatorios configurados."}),!m&&c&&t.jsx("div",{className:"flex-1 relative min-h-0 mb-2",children:t.jsx(ss,{mode:"wait",children:t.jsxs(W.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},className:"absolute inset-0 flex flex-col justify-center border-l-2 border-primary/50 pl-3 py-1",children:[t.jsx("p",{className:"font-medium text-sm truncate text-foreground leading-tight mb-1",title:c.productName,children:c.productName}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground/80",children:[t.jsxs("span",{className:"font-mono bg-muted/50 px-1 rounded text-[10px]",children:["Lote: ",c.batchNumber]}),t.jsx("span",{children:""}),t.jsxs("span",{className:c.daysUntilExpiry<=30?"text-red-500 font-medium":"text-amber-500",children:["Vence: ",c.expirationDate]})]})]},`${c.productName}-${c.batchNumber}`)})}),!m&&s.length>1&&t.jsx("div",{className:"flex gap-1 mb-2",children:s.slice(0,5).map((f,x)=>t.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${x===o%5?"w-4 bg-primary":"w-1.5 bg-primary/20"}`},x))}),!m&&t.jsxs(R,{className:"w-full h-8 text-xs mt-auto",size:"sm",variant:"outline",onClick:()=>d("/smart-analyst"),children:["Ver Detalles ",t.jsx(Nr,{className:"w-3 h-3 ml-2"})]})]})]})})}function ii({metrics:e}){const s=(o,l)=>{if(l===0)return{value:0,isPositive:!0};const d=o/l*100;return{value:Math.abs(Number(d.toFixed(1))),isPositive:d>=0}},n=s(e.negativeUnits+e.positiveUnits,e.totalSystemUnits),r=s(e.negativeUnits,e.totalSystemUnits),a=s(e.positiveUnits,e.totalSystemUnits);return t.jsx(yr,{items:[{id:"net",label:"Diferencia Neta",value:e.totalStock,color:e.totalStock<0?"text-destructive":e.totalStock>0?"text-success":"text-foreground",icon:lt,prefix:"$",trend:n},{id:"negative",label:"Negativo Total",value:e.negativeStock,color:"text-destructive",icon:ns,prefix:"$",trend:r},{id:"positive",label:"Positivo Total",value:e.positiveStock,color:"text-success",icon:Be,prefix:"$",trend:a}]})}function li({activeProducts:e}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:"Productos Activos"}),t.jsx(rs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(_,{children:[(()=>{const s=new Intl.NumberFormat("es-AR").format(e);let n="text-3xl";return s.length>8?n="text-xl":s.length>6&&(n="text-2xl"),t.jsx("div",{className:`${n} font-bold`,children:t.jsx(cn,{value:e})})})(),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total en base de datos"})]})]})}function ci(){return t.jsxs(P,{className:"p-6 h-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Resumen de Inventario"}),t.jsx("button",{className:"text-sm text-muted-foreground hover:text-foreground",children:"Ver detalles"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos en Stock"}),t.jsx("span",{className:"text-sm font-medium",children:"85%"})]}),t.jsx(Vt,{value:85})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos con Bajo Stock"}),t.jsx("span",{className:"text-sm font-medium text-warning",children:"12%"})]}),t.jsx(Vt,{value:12,variant:"warning"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos Agotados"}),t.jsx("span",{className:"text-sm font-medium text-destructive",children:"3%"})]}),t.jsx(Vt,{value:3,variant:"destructive"})]})]})]})}const di=[{label:"Diferencia de Stock",icon:ts,message:"Hola, he detectado una diferencia de stock importante en...",color:"bg-orange-500/10 text-orange-600 hover:bg-orange-500/20 border-orange-200"},{label:"Confirmar Cierre",icon:ta,message:"El cierre del inventario cclico ha sido completado y verificado.",color:"bg-green-500/10 text-green-600 hover:bg-green-500/20 border-green-200"},{label:"Solicitud Urgente",icon:na,message:"Necesito autorizacin urgente para...",color:"bg-blue-500/10 text-blue-600 hover:bg-blue-500/20 border-blue-200"}],te={dark:"#08102E",blue:"#045598",light:"#a5b1e1ff"},ui=()=>t.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center",children:[t.jsx(W.div,{className:"absolute inset-0 rounded-full blur-xl opacity-50",style:{background:`radial-gradient(circle at center, ${te.light}, ${te.blue})`},animate:{scale:[.8,1,.9,.8],opacity:[.4,.6,.5,.4]},transition:{duration:5,repeat:1/0,ease:"easeInOut",times:[0,.4,.8,1]}}),t.jsx(W.div,{className:"absolute w-28 h-28 rounded-full blur-lg mix-blend-screen",style:{background:`conic-gradient(from 0deg, ${te.dark}, ${te.blue}, ${te.light}, ${te.dark})`},animate:{rotate:360,scale:[.9,1.1,1,.9]},transition:{rotate:{duration:7,repeat:1/0,ease:"linear"},scale:{duration:6,repeat:1/0,ease:"easeInOut"}}}),t.jsx(W.div,{className:"absolute w-24 h-24 rounded-full blur-md mix-blend-overlay",style:{background:`conic-gradient(from 180deg, ${te.light}, ${te.blue}, ${te.dark}, ${te.light})`},animate:{rotate:-360,scale:[1.1,.9,.95,1.1]},transition:{rotate:{duration:9,repeat:1/0,ease:"linear"},scale:{duration:8,repeat:1/0,ease:"easeInOut"}}}),t.jsxs(W.div,{className:"absolute w-20 h-20 rounded-full backdrop-blur-md z-10 flex items-center justify-center overflow-hidden",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%)",border:"1px solid rgba(255,255,255,0.3)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37), inset 0 0 0 1px rgba(255,255,255,0.1)"},animate:{boxShadow:[`0 0 20px ${te.blue}40, inset 0 0 10px rgba(255,255,255,0.1)`,`0 0 35px ${te.light}50, inset 0 0 20px rgba(255,255,255,0.2)`,`0 0 20px ${te.blue}40, inset 0 0 10px rgba(255,255,255,0.1)`]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/20 to-transparent opacity-50 pointer-events-none"}),t.jsx(ra,{className:"w-10 h-10 text-white drop-shadow-md relative z-10",strokeWidth:2})]})]});function mi(){var m;const{user:e}=ze(),[s,n]=i.useState(""),r=i.useRef(null),[a,o]=i.useState(!1),l=c=>{const b=`https://teams.microsoft.com/l/chat/0/0?users=GHCoz@farmaplus.com.ar&message=${encodeURIComponent(c)}`;window.open(b,"_blank"),n("")},d=()=>{s.trim()&&l(s)},u=c=>{l(c)},h=c=>{c.key==="Enter"&&d()};return t.jsxs(P,{className:"h-full flex flex-col border-border/50 bg-gradient-to-br from-card/50 to-muted/20 backdrop-blur-sm overflow-hidden relative group",children:[t.jsx("div",{className:"absolute top-0 right-0 w-full h-full opacity-5 pointer-events-none",style:{background:`radial-gradient(circle at top right, ${te.light}, transparent 70%)`}}),t.jsx(q,{className:"pb-2 flex flex-row items-center justify-between space-y-0 relative z-10",children:t.jsx(G,{className:"text-lg font-medium tracking-tight",children:"Chat Teams"})}),t.jsxs(_,{className:"flex-1 flex flex-col gap-4 relative z-10 p-4",children:[t.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center text-center -mt-4",children:[t.jsx(ui,{}),t.jsxs(W.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"space-y-1 relative z-20 mt-2",children:[t.jsxs("h3",{className:"font-semibold text-lg",children:["Hola ",((m=e==null?void 0:e.name)==null?void 0:m.split(" ")[0])||"Gonzalo"]}),t.jsx("p",{className:"text-muted-foreground text-xs max-w-[200px] mx-auto",children:"En qu puedo ayudarte hoy?"})]})]}),t.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-1",children:di.map((c,f)=>t.jsxs(W.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.8+f*.1},onClick:()=>u(c.message),className:$("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[10px] font-medium border transition-all duration-200 hover:scale-105 active:scale-95 shadow-sm bg-background/50 backdrop-blur-sm",c.color),children:[t.jsx(c.icon,{className:"h-3 w-3"}),c.label]},c.label))}),t.jsx("div",{className:"relative mt-auto",children:t.jsxs("div",{className:"relative flex items-center bg-background/80 backdrop-blur border rounded-full shadow-sm focus-within:ring-2 transition-all group-hover:shadow-md",style:{borderColor:`${te.light}30`},children:[t.jsx(R,{variant:"ghost",size:"icon",className:"h-10 w-10 text-muted-foreground hover:text-primary rounded-full shrink-0 ml-1",onClick:()=>o(!a),title:"Adjuntar Reporte",children:t.jsx(oa,{className:"h-4 w-4"})}),t.jsx(ne,{ref:r,value:s,onChange:c=>n(c.target.value),onKeyDown:h,placeholder:"Escribe tu mensaje...",className:"border-none shadow-none focus-visible:ring-0 bg-transparent h-10 px-2 text-sm"}),t.jsx(R,{onClick:d,size:"icon",className:"h-9 w-9 rounded-full mr-1 transition-all shrink-0",style:{backgroundColor:s.trim()?te.blue:void 0,opacity:s.trim()?1:.5},disabled:!s.trim(),children:t.jsx(la,{className:"h-4 w-4 text-white"})})]})})]})]})}const _e={async getEvents(e,s=!1){let n=Ft.from("inventory_events").select("*").order("date",{ascending:!0});!s&&e&&(n=n.eq("branch_name",e));const{data:r,error:a}=await n;return a?(console.error("Error fetching events:",a),[]):r||[]},async addEvent(e){const{data:s,error:n}=await Ft.rpc("manage_inventory_event",{p_action:"CREATE",p_title:e.title,p_branch:e.branch_name,p_sector:e.sector,p_date:e.date});return n?(console.error("Error adding event via RPC:",n),null):s},async deleteEvent(e){const{error:s}=await Ft.rpc("manage_inventory_event",{p_action:"DELETE",p_id:e});return s?(console.error("Error deleting event via RPC:",s),!1):!0}};function hi({open:e,onOpenChange:s,onEventAdded:n}){const[r,a]=i.useState(!1),[o,l]=i.useState(""),[d,u]=i.useState(""),[h,m]=i.useState("Farmacia"),[c,f]=i.useState(new Date().toISOString().slice(0,10)),x=async b=>{if(b.preventDefault(),!d||!c){de.error("Datos incompletos","Sucursal y fecha son requeridas");return}a(!0);try{const p=await _e.addEvent({title:o||`Inventario ${d}`,branch_name:d,sector:h,date:c});p?(de.success("Evento agregado","El evento se cre correctamente"),n(p),s(!1),l(""),u(""),m("Farmacia")):de.error("Error","No se pudo crear el evento")}catch(p){console.error(p),de.error("Error inesperado","Ocurri un error al procesar la solicitud")}finally{a(!1)}};return t.jsx(At,{open:e,onOpenChange:s,children:t.jsxs(Rt,{className:"sm:max-w-[425px]",children:[t.jsxs(Tt,{children:[t.jsx(zt,{children:"Programar Inventario"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Complete los datos del nuevo evento de inventario."})]}),t.jsxs("form",{onSubmit:x,className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{htmlFor:"branch",children:"Sucursal"}),t.jsxs(Ss,{value:d,onValueChange:u,children:[t.jsx(Ds,{children:t.jsx(ks,{placeholder:"Seleccionar sucursal"})}),t.jsx(Es,{className:"max-h-[200px]",children:Qn.map(b=>t.jsx(bt,{value:b,children:b},b))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{htmlFor:"sector",children:"Sector"}),t.jsxs(Ss,{value:h,onValueChange:m,children:[t.jsx(Ds,{children:t.jsx(ks,{placeholder:"Seleccionar sector"})}),t.jsxs(Es,{children:[t.jsx(bt,{value:"Farmacia",children:"Farmacia"}),t.jsx(bt,{value:"Perfumera",children:"Perfumera"}),t.jsx(bt,{value:"General",children:"General"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{htmlFor:"date",children:"Fecha"}),t.jsx(ne,{id:"date",type:"date",value:c,onChange:b=>f(b.target.value),required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{htmlFor:"title",children:"Ttulo (Opcional)"}),t.jsx(ne,{id:"title",placeholder:"Ej. Inventario Anual",value:o,onChange:b=>l(b.target.value)})]}),t.jsxs(er,{className:"pt-4",children:[t.jsx(R,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancelar"}),t.jsxs(R,{type:"submit",disabled:r,children:[r&&t.jsx(Cr,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardar Evento"]})]})]})]})})}function fi({onDateClick:e}){const{user:s}=ze(),n=(s==null?void 0:s.role)==="admin",[r,a]=i.useState([]),[o,l]=i.useState(!0),[d,u]=i.useState(!1);i.useEffect(()=>{h()},[s==null?void 0:s.branchName]);const h=async()=>{try{const m=await _e.getEvents(s==null?void 0:s.branchName,n),c=new Date().toISOString().slice(0,10),f=m.filter(x=>x.date>=c).sort((x,b)=>x.date.localeCompare(b.date)).slice(0,5).map(x=>({id:x.id,branch:x.branch_name||x.branchId,sector:x.sector||x.description,date:x.date,formattedDate:new Date(x.date+"T12:00:00").toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}));a(f)}catch(m){console.error("Error loading upcoming inventories:",m)}finally{l(!1)}};return t.jsxs(P,{className:"p-6 h-full flex flex-col relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Prximos Inventarios"}),t.jsx("div",{className:"flex gap-1",children:nt(s,"MANAGE_CALENDAR_EVENTS")&&t.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>u(!0),title:"Programar Nuevo",children:t.jsx(Ye,{className:"h-4 w-4"})})})]}),t.jsx("div",{className:"space-y-4 flex-1",children:o?t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"})]}):r.length===0?t.jsx("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 border rounded-lg border-dashed bg-muted/20",children:t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No hay inventarios prximos"})}):r.map(m=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg cursor-pointer hover:bg-muted transition-colors",onClick:()=>e==null?void 0:e(m.date),children:[t.jsx(hn,{className:"w-5 h-5 text-primary mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-foreground",children:[m.branch," - ",m.sector]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-left block",children:m.formattedDate})]})]},m.id))}),t.jsx(hi,{open:d,onOpenChange:u,onSuccess:h})]})}const Xs=8;function xi({branches:e}){const{selectBranch:s,clearBranchSelection:n,user:r}=ze(),[a,o]=i.useState(""),[l,d]=i.useState(!1),[u,h]=i.useState([]),[m,c]=i.useState(!0),[f,x]=i.useState({key:"progress",direction:"descending"});i.useEffect(()=>{(async()=>{c(!0);try{const S=await Se.getBranchesSummary();h(S)}catch(S){console.error("Failed to load branch summaries",S)}finally{c(!1)}})()},[]);const b=i.useMemo(()=>u.filter(y=>y.branchName.toLowerCase().includes(a.toLowerCase())),[u,a]),p=i.useMemo(()=>{let y=[...b];return f.key&&y.sort((S,k)=>{const C=S[f.key],E=k[f.key];return C<E?f.direction==="ascending"?-1:1:C>E?f.direction==="ascending"?1:-1:0}),y},[b,f]),v=y=>{let S="ascending";f.key===y&&f.direction==="ascending"&&(S="descending"),x({key:y,direction:S})},w=l?p:p.slice(0,Xs),g=y=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(y),j=y=>{(r==null?void 0:r.branchName)===y?n==null||n():s&&(s(y),window.scrollTo({top:0,behavior:"smooth"}))},N=y=>(r==null?void 0:r.branchName)===y;return t.jsx(W.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full",children:t.jsxs(P,{className:"p-6 overflow-hidden border-t-4 border-t-primary shadow-md",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[t.jsx(Be,{className:"w-6 h-6 text-primary"}),"Monitor de Sucursales"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Estado en tiempo real de inventarios cclicos y cumplimiento."})]}),t.jsxs("div",{className:"relative w-full md:w-72",children:[t.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(ne,{placeholder:"Buscar sucursal...",value:a,onChange:y=>o(y.target.value),className:"pl-10 h-10 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary"})]})]}),t.jsx("div",{className:"rounded-xl border bg-card/50 overflow-hidden",children:t.jsxs(Sr,{children:[t.jsx(Dr,{className:"bg-muted/40 hover:bg-muted/50 transition-colors",children:t.jsxs(Ht,{children:[t.jsx(Ne,{className:"w-[200px] cursor-pointer",onClick:()=>v("branchName"),children:t.jsxs("div",{className:"flex items-center font-semibold text-foreground",children:["Sucursal",t.jsx(Cs,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(Ne,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>v("deploymentDate"),children:"Fecha Inicio"}),t.jsx(Ne,{className:"text-center hidden lg:table-cell",children:"Vuelta"}),t.jsx(Ne,{className:"text-center hidden lg:table-cell",children:"Obj. Mensual"}),t.jsx(Ne,{className:"text-center cursor-pointer",onClick:()=>v("progress"),children:t.jsxs("div",{className:"flex items-center justify-center font-semibold text-foreground",children:["% Avance",t.jsx(Cs,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(Ne,{className:"text-center hidden md:table-cell",children:"Un. Inventario"}),t.jsx(Ne,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>v("differenceUnits"),children:"Diferencia"}),t.jsx(Ne,{className:"text-right cursor-pointer",onClick:()=>v("adjustmentsValue"),children:"$ Ajustes"}),t.jsx(Ne,{className:"text-center w-[120px]",children:"Status"})]})}),t.jsx(kr,{children:m?Array.from({length:5}).map((y,S)=>t.jsxs(Ht,{children:[t.jsx(V,{children:t.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),t.jsx(V,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-20 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-10 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-12 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(V,{className:"text-right",children:t.jsx("div",{className:"h-5 w-24 bg-muted rounded animate-pulse ml-auto"})}),t.jsx(V,{children:t.jsx("div",{className:"h-6 w-20 bg-muted rounded-full animate-pulse mx-auto"})})]},S)):w.length>0?w.map((y,S)=>t.jsxs(W.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:S*.05},onClick:()=>j(y.branchName),className:$("group cursor-pointer hover:bg-muted/50 transition-all border-b last:border-0",N(y.branchName)&&"bg-primary/5 hover:bg-primary/10 border-l-4 border-l-primary"),children:[t.jsxs(V,{className:"font-medium text-foreground relative",children:[N(y.branchName)&&t.jsx(W.div,{layoutId:"active-indicator",className:"absolute left-0 top-0 bottom-0 w-1 bg-primary"}),y.branchName]}),t.jsx(V,{className:"text-center text-muted-foreground text-sm hidden md:table-cell",children:y.deploymentDate}),t.jsxs(V,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:[y.cyclicRound,""]}),t.jsx(V,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:y.monthlyGoal}),t.jsx(V,{className:"text-center",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:$("font-bold text-sm",y.progress>=y.monthlyGoal?"text-green-600":"text-foreground"),children:[y.progress,"%"]}),t.jsx("div",{className:"w-16 h-1.5 bg-muted rounded-full overflow-hidden mt-1",children:t.jsx("div",{className:$("h-full rounded-full transition-all",y.progress>=100?"bg-green-500":"bg-primary"),style:{width:`${Math.min(y.progress,100)}%`}})})]})}),t.jsx(V,{className:"text-center font-mono text-sm hidden md:table-cell",children:y.inventoryUnits}),t.jsx(V,{className:"text-center font-mono text-sm hidden md:table-cell",children:t.jsxs("span",{className:y.differenceUnits===0?"text-muted-foreground":y.differenceUnits>0?"text-green-600":"text-red-600",children:[y.differenceUnits>0?"+":"",y.differenceUnits]})}),t.jsx(V,{className:"text-right font-mono text-sm",children:t.jsx("span",{className:y.adjustmentsValue===0?"text-muted-foreground":y.adjustmentsValue>0?"text-green-600":"text-red-600",children:g(y.adjustmentsValue)})}),t.jsx(V,{className:"text-center",children:y.status==="controlado"?t.jsxs(re,{variant:"outline",className:"font-normal border bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30",children:[t.jsx(tr,{className:"w-3 h-3 mr-1"})," FINALIZADA"]}):y.status==="por_controlar"?t.jsxs(re,{variant:"outline",className:"font-normal border bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30",children:[t.jsx(ht,{className:"w-3 h-3 mr-1"})," EN PROCESO"]}):t.jsxs(re,{variant:"outline",className:"font-normal border bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30",children:[t.jsx(Mt,{className:"w-3 h-3 mr-1"})," PENDIENTE"]})})]},y.branchName)):t.jsx(Ht,{children:t.jsx(V,{colSpan:9,className:"h-24 text-center text-muted-foreground",children:"No se encontraron sucursales con esa bsqueda."})})})]})}),p.length>Xs&&t.jsx("div",{className:"mt-4 flex justify-center",children:t.jsx(R,{variant:"ghost",size:"sm",onClick:()=>d(!l),className:"text-muted-foreground hover:text-foreground",children:l?"Mostrar menos":`Ver todas las sucursales (${p.length})`})})]})})}function pi({completedCount:e,totalCount:s}){const n=s>0?Math.round(e/s*100):0,r=()=>n>=80?"text-success":n>=50?"text-warning":"text-destructive";return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:"Progreso"}),t.jsx(Be,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(_,{children:[t.jsxs("div",{className:`text-xl font-bold ${r()}`,children:[n,"%"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e," de ",s," completados"]}),t.jsx(ln,{value:n,className:"mt-2"})]})]})}function gi({criticalCount:e,outOfStockCount:s}){const n=e>0||s>0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:"Crticos"}),t.jsx(ts,{className:`h-4 w-4 ${n?"text-destructive":"text-muted-foreground"}`})]}),t.jsxs(_,{children:[t.jsx("div",{className:`text-xl font-bold ${n?"text-destructive":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Productos con stock bajo"}),s>0&&t.jsxs(re,{variant:"destructive",className:"mt-2",children:[s," agotados"]})]})]})}function vi({totalValue:e,changePercentage:s}){const n=s!==void 0&&s>=0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Valor Total"}),t.jsx(lt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(_,{children:[t.jsxs("div",{className:"text-xl font-bold",children:["$",t.jsx(cn,{value:e})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Valor de inventario"}),s!==void 0&&t.jsxs("div",{className:`flex items-center gap-1 mt-2 text-xs ${n?"text-success":"text-destructive"}`,children:[n?t.jsx(Be,{className:"h-3 w-3"}):t.jsx(ns,{className:"h-3 w-3"}),t.jsxs("span",{children:[Math.abs(s).toFixed(1),"% vs mes anterior"]})]})]})]})}function bi({activeCount:e,activeBranches:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:"Activos"}),t.jsxs("div",{className:"relative",children:[t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"}),e>0&&t.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 bg-success rounded-full animate-pulse"})]})]}),t.jsxs(_,{children:[t.jsx("div",{className:"text-xl font-bold",children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usuarios trabajando"}),s.length>0&&t.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[s.slice(0,2).map((n,r)=>t.jsx(re,{variant:"secondary",className:"text-xs",children:n},r)),s.length>2&&t.jsxs(re,{variant:"secondary",className:"text-xs",children:["+",s.length-2]})]})]})]})}function yi({pendingCount:e,urgentCount:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:"Pendientes"}),t.jsx(ht,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(_,{children:[t.jsx("div",{className:`text-xl font-bold ${e>0?"text-warning":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Inventarios sin completar"}),s>0&&t.jsxs(re,{variant:"destructive",className:"mt-2",children:[s," urgentes"]})]})]})}function ji({data:e=[]}){const[s,n]=i.useState("7d"),r=[{date:"01/12",negative:-1200,positive:800},{date:"02/12",negative:-950,positive:1100},{date:"03/12",negative:-1500,positive:900},{date:"04/12",negative:-800,positive:1300},{date:"05/12",negative:-1100,positive:950},{date:"06/12",negative:-900,positive:1200},{date:"07/12",negative:-1300,positive:1e3}],a=e.length>0?e:r;return t.jsxs(P,{className:"h-full",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Tendencias"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(R,{variant:s==="7d"?"default":"outline",size:"sm",onClick:()=>n("7d"),children:"7 das"}),t.jsx(R,{variant:s==="30d"?"default":"outline",size:"sm",onClick:()=>n("30d"),children:"30 das"})]})]}),t.jsx(_,{children:t.jsx(dn,{width:"100%",height:200,children:t.jsxs(Er,{data:a,children:[t.jsx(Ir,{strokeDasharray:"3 3"}),t.jsx(Mr,{dataKey:"date",fontSize:12}),t.jsx(Ar,{fontSize:12}),t.jsx(un,{}),t.jsx(Rr,{}),t.jsx(Is,{type:"monotone",dataKey:"negative",stroke:"hsl(var(--destructive))",name:"Negativo",strokeWidth:2}),t.jsx(Is,{type:"monotone",dataKey:"positive",stroke:"hsl(var(--success))",name:"Positivo",strokeWidth:2})]})})})]})}function wi({products:e=[]}){const s=[{name:"Ibuprofeno 600mg",ean:"7798140250685",difference:-45,value:-2250,type:"negative"},{name:"Paracetamol 500mg",ean:"7798140250692",difference:32,value:1600,type:"positive"},{name:"Amoxicilina 500mg",ean:"7798140250708",difference:-28,value:-1680,type:"negative"},{name:"Omeprazol 20mg",ean:"7798140250715",difference:25,value:1500,type:"positive"},{name:"Losartn 50mg",ean:"7798140250722",difference:-20,value:-1200,type:"negative"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs(q,{className:"pb-3",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Top Diferencias"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos con mayores discrepancias"})]}),t.jsx(_,{children:t.jsx("div",{className:"space-y-3",children:n.map((r,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-sm font-medium",children:r.name}),t.jsx(re,{variant:r.type==="negative"?"destructive":"default",className:"text-xs",children:r.type==="negative"?"Faltante":"Sobrante"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["EAN: ",r.ean]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:`flex items-center gap-1 ${r.type==="negative"?"text-destructive":"text-success"}`,children:[r.type==="negative"?t.jsx(ns,{className:"h-3 w-3"}):t.jsx(Be,{className:"h-3 w-3"}),t.jsx("span",{className:"text-sm font-semibold",children:Math.abs(r.difference)})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Math.abs(r.value)]})]}),t.jsx(R,{variant:"ghost",size:"icon",className:"h-8 w-8",children:t.jsx(Or,{className:"h-4 w-4"})})]})]},a))})})]})}function Ni({activities:e=[]}){const s=[{id:"1",type:"completed",title:"Inventario Farmacia completado",branch:"Belgrano IV",timestamp:"Hace 5 minutos",user:"Juan Prez"},{id:"2",type:"adjusted",title:"Ajustes realizados en Perfumera",branch:"Recoleta",timestamp:"Hace 15 minutos",user:"Mara Gonzlez"},{id:"3",type:"imported",title:"Inventario importado",branch:"Palermo II",timestamp:"Hace 1 hora",user:"Carlos Rodrguez"},{id:"4",type:"completed",title:"Pre-conteo finalizado",branch:"Microcentro",timestamp:"Hace 2 horas",user:"Ana Martnez"}],n=e.length>0?e:s,r=o=>{switch(o){case"completed":return t.jsx(it,{className:"h-4 w-4 text-success"});case"adjusted":return t.jsx(ca,{className:"h-4 w-4 text-warning"});case"imported":return t.jsx(sn,{className:"h-4 w-4 text-primary"})}},a=o=>{switch(o){case"completed":return"Completado";case"adjusted":return"Ajustado";case"imported":return"Importado"}};return t.jsxs(P,{className:"h-full",children:[t.jsxs(q,{className:"pb-3",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Actividad Reciente"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"ltimas acciones realizadas"})]}),t.jsx(_,{children:t.jsx("div",{className:"space-y-4",children:n.map((o,l)=>t.jsxs("div",{className:"relative",children:[l<n.length-1&&t.jsx("div",{className:"absolute left-2 top-8 bottom-0 w-px bg-border"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"relative z-10 mt-1 rounded-full bg-background p-1 border",children:r(o.type)}),t.jsxs("div",{className:"flex-1 pb-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:o.title}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.branch,"  ",o.user]})]}),t.jsx(re,{variant:"secondary",className:"text-xs",children:a(o.type)})]}),t.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[t.jsx(ht,{className:"h-3 w-3"}),t.jsx("span",{children:o.timestamp})]})]})]})]},o.id))})})]})}const Ce=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"];function Ci({data:e=[]}){const s=[{name:"Farmacia",value:450,color:Ce[0]},{name:"Perfumera",value:280,color:Ce[1]},{name:"Higiene",value:180,color:Ce[2]},{name:"Bebs",value:120,color:Ce[3]},{name:"Otros",value:90,color:Ce[4]}],n=e.length>0?e:s,r=n.reduce((a,o)=>a+o.value,0);return t.jsxs(P,{className:"h-full",children:[t.jsxs(q,{className:"pb-3",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Distribucin por Categora"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos por categora"})]}),t.jsxs(_,{children:[t.jsx(dn,{width:"100%",height:200,children:t.jsxs(Tr,{children:[t.jsx(zr,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:o})=>`${a} ${(o*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((a,o)=>t.jsx(Pr,{fill:a.color||Ce[o%Ce.length]},`cell-${o}`))}),t.jsx(un,{})]})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2",children:n.map((a,o)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color||Ce[o%Ce.length]}}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.name,": ",a.value," (",(a.value/r*100).toFixed(1),"%)"]})]},o))})]})]})}function Si({goals:e=[]}){const s=[{title:"Inventarios Completados",current:45,target:60,badge:"75%"},{title:"Productos Controlados",current:1250,target:1500,badge:"83%"},{title:"Diferencias Resueltas",current:28,target:35,badge:"80%"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsx(q,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(G,{className:"text-lg font-semibold",children:"Objetivos del Mes"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Progreso hacia metas"})]}),t.jsx(an,{className:"h-5 w-5 text-primary"})]})}),t.jsx(_,{children:t.jsx("div",{className:"space-y-4",children:n.map((r,a)=>{const o=Math.round(r.current/r.target*100),l=o>=100;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium",children:r.title}),l&&t.jsx(Kr,{className:"h-4 w-4 text-success"})]}),t.jsxs(re,{variant:l?"default":"secondary",children:[r.current,"/",r.target]})]}),t.jsx(ln,{value:o,className:"h-2"}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[o,"% completado"]})]},a)})})})]})}function Di({isOnline:e=!0,pendingCount:s=0,lastSync:n="Hace 5 minutos",onSync:r}){return t.jsxs(P,{className:"h-full",children:[t.jsx(q,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Sincronizacin"}),e?t.jsx(on,{className:"h-5 w-5 text-success"}):t.jsx(sr,{className:"h-5 w-5 text-destructive"})]})}),t.jsxs(_,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Estado de Conexin"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e?"Conectado":"Sin conexin"})]}),t.jsx(re,{variant:e?"default":"destructive",children:e?"Online":"Offline"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Datos Pendientes"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s>0?`${s} elementos`:"Todo sincronizado"})]}),s>0?t.jsx(re,{variant:"warning",children:s}):t.jsx(it,{className:"h-5 w-5 text-success"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(ht,{className:"h-3 w-3"}),t.jsxs("span",{children:["ltima sincronizacin: ",n]})]}),t.jsxs(R,{className:"w-full",variant:s>0?"default":"outline",onClick:r,disabled:!e,children:[t.jsx(nr,{className:"h-4 w-4 mr-2"}),s>0?"Sincronizar Ahora":"Actualizar"]})]})]})}function ki({actions:e=[]}){const s=[{title:"Nuevo Pre-Conteo",description:"Iniciar nuevo pre-conteo",icon:Ye,onClick:()=>console.log("Nuevo Pre-Conteo"),variant:"default"},{title:"Importar Inventario",description:"Cargar desde Excel",icon:sn,onClick:()=>console.log("Importar"),variant:"outline"},{title:"Ver Reportes",description:"Anlisis y estadsticas",icon:It,onClick:()=>console.log("Reportes"),variant:"outline"},{title:"Exportar Datos",description:"Descargar informacin",icon:rr,onClick:()=>console.log("Exportar"),variant:"outline"},{title:"Configuracin",description:"Ajustes del sistema",icon:ar,onClick:()=>console.log("Configuracin"),variant:"secondary"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs(q,{className:"pb-3",children:[t.jsx(G,{className:"text-lg font-semibold",children:"Acciones Rpidas"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Tareas frecuentes"})]}),t.jsx(_,{children:t.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.map((r,a)=>{const o=r.icon;return t.jsxs(R,{variant:r.variant||"outline",className:"h-auto flex-col items-start p-4 gap-2",onClick:r.onClick,children:[t.jsx(o,{className:"h-5 w-5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"text-sm font-medium",children:r.title}),t.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:r.description})]})]},a)})})})]})}function Ei({assignedDays:e=0,startDate:s,totalProgress:n=0,isEditable:r=!1,onEdit:a}){const o=i.useMemo(()=>{if(!s||e===0)return{daysRemaining:0,daysElapsed:0,timeProgress:0,status:"pending",expectedProgress:0,isDelayed:!1,segments:[0,0,0]};const h=new Date(s),c=new Date().getTime()-h.getTime(),f=Math.max(0,Math.floor(c/(1e3*60*60*24))),x=Math.max(0,e-f),b=Math.min(100,f/e*100),p=Math.round(b),v=n<p-5,w=n>p+15;let g="on-track";v?g="behind":w&&(g="ahead");const j=3,N=100/j,y=Array.from({length:j}).map((S,k)=>{const C=(k+1)*N;return n>=C?100:n<=k*N?0:(n-k*N)/N*100});return{daysRemaining:x,daysElapsed:f,timeProgress:b,status:g,expectedProgress:p,isDelayed:v,segments:y}},[s,e,n]),l=()=>e===0?"text-muted-foreground":o.status==="behind"?"text-destructive":o.status==="ahead"?"text-blue-500":"text-green-500",d=()=>e===0?"Sin configurar":o.status==="behind"?"Retrasado":o.status==="ahead"?"Adelantado":"Al da",u=()=>e===0?t.jsx(ua,{className:"h-4 w-4"}):o.status==="behind"?t.jsx(Mt,{className:"h-4 w-4"}):o.status==="ahead"?t.jsx(it,{className:"h-4 w-4"}):t.jsx(it,{className:"h-4 w-4"});return t.jsxs(P,{className:"h-full flex flex-col overflow-hidden relative group/card border-border/50 bg-card/50 backdrop-blur-sm",children:[t.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 px-5 pt-4 pb-2",children:[t.jsx(G,{className:"text-sm font-semibold tracking-tight",children:"Plazo de Inventario"}),t.jsxs("div",{className:"flex items-center gap-2",children:[r&&t.jsx("button",{onPointerDown:h=>h.stopPropagation(),onClick:h=>{h.stopPropagation(),a==null||a()},className:"relative z-50 text-muted-foreground hover:text-primary transition-colors opacity-0 group-hover/card:opacity-100 cursor-pointer",title:"Configurar plazo",children:t.jsx(Ct,{className:"h-4 w-4"})}),!r&&t.jsx(Ct,{className:"h-4 w-4 text-muted-foreground"})]})]}),t.jsxs(_,{className:"flex flex-col justify-between flex-1 px-5 pb-5 pt-1 gap-4",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-widest mb-0.5",children:"Asignados"}),t.jsx("span",{className:"text-3xl font-black tracking-tighter text-foreground leading-none",children:e>0?e:"--"})]}),t.jsx("div",{className:"h-10 w-px bg-border/40 mx-2"}),t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsx("span",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-widest mb-0.5",children:"Restantes"}),t.jsx("span",{className:$("text-3xl font-black tracking-tighter leading-none",o.daysRemaining<7&&e>0?"text-destructive":"text-foreground"),children:e>0?o.daysRemaining:"--"})]})]}),t.jsxs("div",{className:"bg-muted/30 rounded-xl p-3 border border-border/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"flex items-center gap-1.5",children:t.jsxs("span",{className:$("flex items-center gap-1 text-[10px] font-bold uppercase tracking-wider",l()),children:[u(),d()]})}),t.jsxs("span",{className:"text-xs font-bold",children:[n,"% ",t.jsx("span",{className:"text-[10px] font-normal text-muted-foreground ml-1",children:"real"})]})]}),t.jsxs("div",{className:"h-1.5 w-full bg-muted/50 rounded-full overflow-hidden relative",children:[t.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-foreground/20 z-10",style:{left:`${o.expectedProgress}%`}}),t.jsx("div",{className:$("h-full transition-all duration-700 rounded-full",o.status==="behind"?"bg-destructive":"bg-primary"),style:{width:`${n}%`}})]}),t.jsxs("div",{className:"flex justify-between mt-1 text-[9px] text-muted-foreground font-medium uppercase tracking-tighter",children:[t.jsx("span",{children:"Inicio"}),t.jsx("span",{style:{marginLeft:`${o.expectedProgress-5}%`},children:"Objetivo Hoy"}),t.jsx("span",{children:"Meta"})]})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider block",children:"Avance por Periodos"}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:o.segments.map((h,m)=>t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"h-1 w-full bg-muted/50 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-foreground/40 transition-all duration-1000",style:{width:`${h}%`}})}),t.jsxs("div",{className:"text-[9px] text-center font-bold text-muted-foreground/70",children:["M",m+1,": ",Math.round(h),"%"]})]},m))})]})]})]})}function Ii(){const{user:e}=ze(),[s,n]=i.useState([]),[r,a]=i.useState(!0),[o,l]=i.useState(null);i.useEffect(()=>{(async()=>{if(!(e!=null&&e.branchSheet)){a(!1);return}try{const h=await lr(e.branchSheet),m=await Se.getAllCyclicInventories(e.branchSheet)||[],c=new Map(m.map(g=>[g.labName,g.status])),f=await Se.getBranchConfig(e.branchSheet);let x=0;if(f.startDate){const g=new Date(f.startDate),N=Math.abs(new Date().getTime()-g.getTime());x=Math.ceil(N/864e5)}const b=async(g,j,N)=>{if(x>=j){const y=await Se.getCycleClosures(e.branchSheet,g);if(!(Object.keys(y).length>0)){console.log(`Auto-closing Period ${g} (Day ${j} reached)`);const k=Object.entries(N).map(([C,E])=>({name:C,percentage:E.total>0?Math.round(E.controlled/E.total*100):0}));return await Se.saveCycleClosure(e.branchSheet,g,k),de.success(`Cierre automtico del Periodo ${g} completado.`),!0}}return!1},p={Medicamentos:{total:0,controlled:0},Perfumera:{total:0,controlled:0},Accesorios:{total:0,controlled:0},Varios:{total:0,controlled:0}};h.forEach(g=>{let j="Varios";const N=(g.category||"").toUpperCase();N==="MEDICAMENTOS"?j="Medicamentos":N==="PERFUMERIA"?j="Perfumera":N==="ACCESORIOS"&&(j="Accesorios");const S=c.get(g.name)==="controlado";p[j].total+=1,S&&(p[j].controlled+=1)}),await b(1,30,p),await b(2,60,p);const v=await Se.getCycleClosures(e.branchSheet||"",1),w=Object.entries(p).map(([g,j])=>{const N=j.total>0?Math.round(j.controlled/j.total*100):0,y=v[g.toUpperCase()]||0;return{name:g,totalItems:j.total,controlledItems:j.controlled,percentage:N,previousPercentage:Math.min(y,N)}});n(w)}catch(h){console.error("Error loading category progress:",h)}finally{a(!1)}})()},[e]);const d=i.useMemo(()=>{if(o)return s.find(c=>c.name===o)||null;const u=s.reduce((c,f)=>c+f.totalItems,0),h=s.reduce((c,f)=>c+f.controlledItems,0);return{name:"Avance Global",percentage:u>0?Math.round(h/u*100):0,totalItems:u,controlledItems:h}},[s,o]);return r?t.jsx(P,{className:"h-full border-none shadow-none flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t.jsxs(P,{className:"h-full flex flex-col border-border/50 bg-card/50 backdrop-blur-sm overflow-hidden",children:[t.jsxs(q,{className:"pb-0 pt-4 px-5 flex flex-row items-center justify-between space-y-0 text-foreground",children:[t.jsx(G,{className:"text-xl font-medium tracking-tight",children:o?`Rubro: ${o}`:"Progreso de Inventario"}),t.jsx("div",{className:"flex items-center gap-1",children:t.jsx("button",{onClick:()=>l(null),className:"h-8 w-8 rounded-full bg-muted/50 flex items-center justify-center hover:bg-muted transition-colors",title:"Ver Avance Global",children:t.jsx(or,{className:$("h-4 w-4 transition-transform",!o&&"rotate-180")})})})]}),t.jsxs(_,{className:"flex-1 p-5 pt-4 flex flex-col gap-6",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"flex items-baseline gap-2",children:t.jsx(ss,{mode:"wait",children:t.jsxs(W.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-6xl font-bold tracking-tighter",children:[d==null?void 0:d.percentage,"%"]},d==null?void 0:d.percentage)})}),t.jsx("p",{className:"text-sm text-muted-foreground font-medium mt-1",children:o?`Avance en ${o}`:"Avance total acumulado"})]}),t.jsx("div",{className:"flex-1 flex flex-col justify-end",children:t.jsx("div",{className:"flex items-end justify-between gap-3 h-48 mb-2 px-1",children:s.map(u=>{const h=o===u.name,m=u.previousPercentage>0,c=Math.max(...s.map(x=>x.totalItems)),f=c>0?Math.max(20,u.totalItems/c*100):20;return t.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group cursor-pointer h-full justify-end",onClick:()=>l(o===u.name?null:u.name),children:[t.jsx("span",{className:$("text-[10px] font-bold transition-colors mb-1",h?"text-primary":"text-muted-foreground/70"),children:u.totalItems}),t.jsxs(W.div,{className:$("w-full rounded-2xl overflow-hidden flex flex-col justify-end relative transition-all duration-300 bg-secondary dark:bg-muted/20",h?"ring-2 ring-primary ring-offset-2 ring-offset-background":"hover:bg-secondary/80 dark:hover:bg-muted/30"),initial:{height:0},animate:{height:`${f}%`},transition:{type:"spring",stiffness:300,damping:30},children:[t.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-foreground text-background text-[10px] font-bold px-2 py-1 rounded-md opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20 shadow-lg pointer-events-none",children:[u.percentage,"% (",u.controlledItems,"/",u.totalItems,")"]}),t.jsx(W.div,{className:$("w-full absolute bottom-0 left-0 right-0 z-10 transition-colors duration-300",h?"bg-primary":"bg-muted-foreground/40 group-hover:bg-muted-foreground/50"),initial:{height:0},animate:{height:`${u.percentage}%`},transition:{duration:.5,delay:.1}}),m&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-20 opacity-30 pointer-events-none",style:{height:`${u.previousPercentage}%`,backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 4px, currentColor 4px, currentColor 8px)",color:h?"white":"inherit"}}),u.percentage>0&&t.jsx(W.div,{className:"absolute left-1/2 -translate-x-1/2 w-1.5 h-1.5 bg-white rounded-full z-30 shadow-sm",style:{bottom:`calc(${u.percentage}% - 3px)`}})]}),t.jsx("span",{className:$("text-[10px] font-bold uppercase tracking-wider transition-colors",h?"text-foreground":"text-muted-foreground"),children:u.name.substring(0,3)})]},u.name)})})}),t.jsxs("div",{className:"pt-2 border-t border-border/40 flex justify-between items-center h-10",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-widest leading-none",children:"Hechos"}),t.jsx("span",{className:"text-sm font-bold",children:d==null?void 0:d.controlledItems})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-widest leading-none",children:"Pendientes"}),t.jsx("span",{className:"text-sm font-bold",children:((d==null?void 0:d.totalItems)||0)-((d==null?void 0:d.controlledItems)||0)})]})]}),t.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-muted-foreground bg-muted/30 px-2 py-1 rounded-full border border-border/50",children:[t.jsx(ir,{className:"h-3 w-3"}),"Refresca cada 30 min"]})]})]})]})}function Ln({events:e=[],selected:s,onSelect:n}){const[r,a]=J.useState(s||new Date);J.useEffect(()=>{s&&a(s)},[s]);const o=Lr(r),l=Br(o),d=Ur(o,{locale:yt,weekStartsOn:1}),u=$r(l,{locale:yt,weekStartsOn:1}),h=[];let m=d;for(;m<=u;){const v=[];for(let w=0;w<7;w++)v.push(m),m=Wr(m,1);h.push(v)}const c=J.useMemo(()=>{const v=new Map;return e.forEach(w=>{const g=w.date;v.has(g)||v.set(g,[]),v.get(g).push(w)}),v},[e]),f=new Date,x=()=>a(v=>Gr(v,1)),b=()=>a(v=>_r(v,1)),p="h-10 w-10";return t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between px-2 pb-2",children:[t.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-muted/50",children:t.jsx(Yr,{className:"h-5 w-5 text-muted-foreground"})}),t.jsx("div",{className:"text-sm font-semibold",children:Ms(o,"LLLL yyyy",{locale:yt})}),t.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-muted/50",children:t.jsx(cr,{className:"h-5 w-5 text-muted-foreground"})})]}),t.jsx("div",{className:"grid grid-cols-7 gap-1 px-1 text-xs text-muted-foreground mb-1",children:["LU","MA","MI","JU","VI","SA","DO"].map((v,w)=>t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"h-10 w-10 flex items-center justify-center font-medium uppercase",children:v})},w))}),t.jsx("div",{className:"space-y-1",children:h.map((v,w)=>t.jsx("div",{className:"grid grid-cols-7 gap-1",children:v.map(g=>{const j=g.toISOString().slice(0,10),N=Fr(g,o),y=c.get(j)||[],S=y.length>0,k=s?Vr(g,s):!1,C=y.some(A=>{const B=Hr(A.date),F=qr(B,f);return F>=2&&F<=5}),E=k?"bg-primary text-primary-foreground":C?"hover:bg-primary/10 ring-2 ring-accent":"hover:bg-primary/10",T=t.jsx("button",{onClick:()=>n&&n(g),className:`flex items-center justify-center ${p} rounded-full transition-colors focus:outline-none ${N?"text-foreground":"text-muted-foreground"} ${E}`,children:t.jsxs("div",{className:"relative flex items-center justify-center w-full h-full",children:[t.jsx("span",{className:"text-sm font-medium",children:Ms(g,"d",{locale:yt})}),S&&t.jsx("span",{className:"absolute bottom-1.5 h-1.5 w-1.5 rounded-full bg-blue-500"})]})},j);if(S){const A=t.jsxs("div",{className:"space-y-1",children:[y.slice(0,5).map(B=>t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-medium",children:B.title}),t.jsxs("div",{className:"text-muted-foreground",children:[B.branch,"  ",B.sector]})]},B.id)),y.length>5&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",y.length-5," ms"]})]});return t.jsxs(dr,{children:[t.jsx(ur,{asChild:!0,children:T}),t.jsx(mr,{side:"top",children:A})]},j)}return T})},w))})]})}function Mi(){const{user:e}=ze(),[s,n]=i.useState(new Date),[r,a]=i.useState([]),[o,l]=i.useState(!1),[d,u]=i.useState(""),[h,m]=i.useState(""),[c,f]=i.useState(""),[x,b]=i.useState(new Date().toISOString().slice(0,10));i.useEffect(()=>{p()},[e==null?void 0:e.branchName]);const p=async()=>{try{const j=(await _e.getEvents()).map(N=>({id:N.id,title:N.title,branch:N.branch_name||N.branchId||"General",sector:N.sector||N.description||"",date:N.date.split("T")[0]}));a(j)}catch(g){console.error("Error loading events:",g)}},v=async()=>{if(!d||!h||!c||!x){de.error("Error","Por favor completa todos los campos");return}try{await _e.addEvent({title:d,branch_name:h,sector:c,date:x}),de.success("Operacin exitosa","Evento agregado"),l(!1),u(""),m(""),f(""),b(new Date().toISOString().slice(0,10)),p()}catch{de.error("Error","Error al crear evento")}},w=g=>{const j=g.toISOString().split("T")[0];return r.filter(N=>N.date===j)};return t.jsxs(P,{className:"h-full flex flex-col",children:[t.jsx(q,{className:"pb-2",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ct,{className:"w-5 h-5 text-primary"}),t.jsx(G,{children:"Calendario"})]})})}),t.jsx(_,{className:"flex-1 p-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-full",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Ln,{selected:s,onSelect:n,events:r})}),t.jsxs("div",{className:"w-full md:w-80 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-semibold capitalize",children:s.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),t.jsx(R,{size:"sm",variant:o?"ghost":"outline",onClick:()=>l(!o),children:o?"Cancelar":t.jsxs(t.Fragment,{children:[t.jsx(Ye,{className:"w-4 h-4 mr-1"})," Evento"]})})]}),o?t.jsxs("div",{className:"p-3 bg-muted/50 border rounded-md space-y-3 mb-4 animate-in slide-in-from-top-2",children:[t.jsx(ne,{placeholder:"Ttulo",value:d,onChange:g=>u(g.target.value),className:"bg-background h-8"}),t.jsx(ne,{placeholder:"Sucursal",value:h,onChange:g=>m(g.target.value),className:"bg-background h-8"}),t.jsx(ne,{placeholder:"Sector",value:c,onChange:g=>f(g.target.value),className:"bg-background h-8"}),t.jsx(ne,{type:"date",value:x,onChange:g=>b(g.target.value),className:"bg-background h-8"}),t.jsx(R,{size:"sm",className:"w-full",onClick:v,children:"Guardar Evento"})]}):t.jsx("div",{className:"flex-1 overflow-auto space-y-2 pr-1",children:w(s).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground text-sm border-2 border-dashed rounded-lg",children:"No hay eventos"}):w(s).map(g=>t.jsxs("div",{className:"p-3 bg-muted/50 hover:bg-muted border rounded-md transition-colors text-sm",children:[t.jsx("p",{className:"font-medium text-foreground",children:g.title}),t.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[t.jsx("span",{children:g.branch}),t.jsx("span",{children:g.sector})]})]},g.id))})]})]})})]})}function Ai(e){const[s,n]=i.useState(!1);return i.useEffect(()=>{function r(o){n(o.matches)}const a=matchMedia(e);return a.addEventListener("change",r),n(a.matches),()=>a.removeEventListener("change",r)},[e]),s}function Ri({open:e,onOpenChange:s,initialDate:n}){const r=Ai("(min-width: 768px)"),{user:a}=ze(),o=(a==null?void 0:a.role)==="admin",[l,d]=i.useState(n||new Date),[u,h]=i.useState([]),[m,c]=i.useState(!1),[f,x]=i.useState(""),[b,p]=i.useState(""),[v,w]=i.useState(""),[g,j]=i.useState(new Date().toISOString().slice(0,10));i.useEffect(()=>{e&&(N(),n&&(d(n),j(n.toISOString().slice(0,10))))},[e,n,a==null?void 0:a.branchName]);const N=async()=>{try{const C=await _e.getEvents(a==null?void 0:a.branchName,o);h(C)}catch(C){console.error("Error loading events",C)}},y=async()=>{if(!f||!b||!v||!g){de.error("Error","Completa todos los campos");return}try{const C=await _e.addEvent({title:f,branch_name:b,sector:v,date:g});C&&(de.success("Operacin exitosa","Evento creado"),h(E=>[...E,C]),c(!1),x(""),p(""),w(""))}catch{de.error("Error","Error al crear evento")}},S=C=>{const E=C.toISOString().slice(0,10);return u.filter(T=>T.date===E)},k=()=>t.jsxs("div",{className:`flex ${r?"flex-row gap-6":"flex-col gap-4"} mt-4 h-full`,children:[t.jsx("div",{className:r?"w-1/2":"w-full",children:t.jsx(Ln,{events:u.map(C=>({...C,branch:C.branch_name})),selected:l,onSelect:C=>{C&&(d(C),j(C.toISOString().slice(0,10)))}})}),t.jsxs("div",{className:r?"w-1/2 flex flex-col":"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-medium capitalize",children:l.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),o&&t.jsxs(R,{size:"sm",onClick:()=>c(!m),variant:m?"ghost":"default",children:[m?t.jsx(Ks,{className:"w-4 h-4"}):t.jsx(Ye,{className:"w-4 h-4 mr-2"}),m?"Cancelar":"Evento"]})]}),m?t.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/40 animate-in slide-in-from-top-2",children:[t.jsx("h4",{className:"font-medium text-sm",children:"Nuevo Evento"}),t.jsx(ne,{placeholder:"Ttulo",value:f,onChange:C=>x(C.target.value)}),t.jsx(ne,{placeholder:"Sucursal",value:b,onChange:C=>p(C.target.value)}),t.jsx(ne,{placeholder:"Sector",value:v,onChange:C=>w(C.target.value)}),t.jsx(ne,{type:"date",value:g,onChange:C=>j(C.target.value)}),t.jsx(R,{className:"w-full",onClick:y,children:"Guardar"})]}):t.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 max-h-[500px]",children:S(l).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center py-10 text-muted-foreground border-2 border-dashed rounded-lg",children:t.jsx("p",{children:"No hay eventos para este da"})}):S(l).map(C=>t.jsx("div",{className:"p-3 bg-card border rounded-lg shadow-sm",children:t.jsx("div",{className:"flex justify-between items-start",children:t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-foreground",children:C.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[C.branch_name," - ",C.sector]})]})})},C.id))})]})]});return r?t.jsx(At,{open:e,onOpenChange:s,children:t.jsxs(Rt,{className:"max-w-4xl w-[90vw] h-[80vh] flex flex-col",children:[t.jsx(Tt,{children:t.jsx(zt,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"flex-1 overflow-hidden",children:t.jsx(k,{})})]})}):t.jsx(Zs,{open:e,onOpenChange:s,children:t.jsxs(Js,{className:"h-[90vh]",children:[t.jsx(Qs,{children:t.jsx(en,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"px-4 pb-8 h-full overflow-y-auto",children:t.jsx(k,{})})]})})}const Bn=[{id:"executive",name:"Ejecutivo",description:"Vista enfocada en mtricas financieras y tendencias",icon:Be,widgetIds:["metrics-carousel","total-stock-value","trends-chart","category-distribution","monthly-goals","branches-table"]},{id:"operational",name:"Operativo",description:"Vista para operaciones diarias e inventarios",icon:as,widgetIds:["metrics-carousel","active-products","countdown","inventory-alerts","upcoming-inventories","pending-inventories","quick-actions","category-progress"]},{id:"analytical",name:"Analtico",description:"Vista con grficos y anlisis detallados",icon:It,widgetIds:["metrics-carousel","trends-chart","category-distribution","top-products","category-progress","inventory-progress","critical-products"]},{id:"complete",name:"Completo",description:"Todos los widgets disponibles",icon:fn,widgetIds:["metrics-carousel","active-products","countdown","inventory-summary","inventory-alerts","upcoming-inventories","branches-table","inventory-progress","critical-products","total-stock-value","active-users","pending-inventories","trends-chart","top-products","activity-timeline","category-distribution","monthly-goals","sync-status","quick-actions","category-progress"]}];function Ti({open:e,onOpenChange:s,onApplyPreset:n}){const r=a=>{n(a),s(!1)};return t.jsx(At,{open:e,onOpenChange:s,children:t.jsxs(Rt,{className:"max-w-3xl",children:[t.jsxs(Tt,{children:[t.jsx(zt,{children:"Layouts Predefinidos"}),t.jsx(nn,{children:"Selecciona un layout predefinido para configurar tu dashboard rpidamente"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:Bn.map(a=>{const o=a.icon;return t.jsxs(P,{className:$("p-4 cursor-pointer transition-all hover:border-primary hover:shadow-md","flex flex-col gap-3"),onClick:()=>r(a.id),children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(o,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-base",children:a.name}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.description})]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(mn,{className:"h-3 w-3"}),t.jsxs("span",{children:[a.widgetIds.length," widgets incluidos"]})]}),t.jsx(R,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:l=>{l.stopPropagation(),r(a.id)},children:"Aplicar Layout"})]},a.id)})}),t.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t",children:t.jsx(R,{variant:"outline",onClick:()=>s(!1),children:"Cancelar"})})]})})}const zi=[{name:"Belgrano IV",address:"Av. Cabildo 2040",zonal:"Zona Norte",email:"belgrano4@farmaplus.com"},{name:"Recoleta",address:"Av. Santa Fe 1860",zonal:"Zona Centro",email:"recoleta@farmaplus.com"},{name:"Palermo II",address:"Av. Las Heras 3520",zonal:"Zona Norte",email:"palermo2@farmaplus.com"},{name:"Microcentro",address:"Florida 520",zonal:"Zona Centro",email:"microcentro@farmaplus.com"},{name:"Belgrano III",address:"Av. Cabildo 1520",zonal:"Zona Norte",email:"belgrano3@farmaplus.com"},{name:"Villa Urquiza II",address:"Av. Triunvirato 4280",zonal:"Zona Norte",email:"villaurquiza2@farmaplus.com"}],Pi={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},Oi={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function gl(){const{user:e}=ze(),{visibleWidgets:s,hiddenWidgets:n,isEditMode:r,setIsEditMode:a,reorderWidgets:o,toggleWidgetVisibility:l,updateWidgetSize:d,applyPreset:u,resetLayout:h}=Qo(e==null?void 0:e.branchName),[m,c]=i.useState(!1),[f,x]=i.useState(!1),b=ka(zs(hs,{activationConstraint:{distance:8}}),zs(us,{coordinateGetter:Zo})),p=i.useMemo(()=>s.filter(D=>D.type==="branches-table"?nt(e,"VIEW_BRANCH_MONITOR"):!0),[s,e]),v=D=>{const{active:z,over:O}=D;O&&z.id!==O.id&&o(z.id,O.id)},[w,g]=i.useState({totalStock:0,activeProducts:0,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0}),[j,N]=i.useState(0),[y,S]=i.useState(null),[k,C]=i.useState(0),[E,T]=i.useState(!1),[A,B]=i.useState(""),[F,se]=i.useState(90),[he,Pe]=i.useState(new Date().toISOString().split("T")[0]),[K,Oe]=i.useState(0),[fe,De]=i.useState(!1),[Ue,Q]=i.useState(void 0),xe=D=>{const z=D?new Date(D):new Date;z.setHours(12,0,0,0),Q(z),De(!0)};i.useEffect(()=>{(async()=>{if(e!=null&&e.branchName){const z=await Se.getBranchConfig(e.branchName);N(z.days),S(z.startDate)}})()},[e]),i.useEffect(()=>{(async()=>{let z=0;try{z=await hr()}catch(O){console.error("Error fetching product count:",O)}if(!(e!=null&&e.branchSheet)){g({totalStock:0,activeProducts:z,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});return}try{const O=await Se.getAllCyclicInventories(e.branchSheet),U=O.reduce((oe,Y)=>({negativeStock:oe.negativeStock+Y.negativeValue,positiveStock:oe.positiveStock+Y.positiveValue,totalStock:oe.totalStock+Y.differenceValue,negativeUnits:oe.negativeUnits+Y.negativeUnits,positiveUnits:oe.positiveUnits+Y.positiveUnits,totalSystemUnits:oe.totalSystemUnits+Y.totalSystemUnits,controlledCount:oe.controlledCount+(Y.status==="controlado"?1:0)}),{negativeStock:0,positiveStock:0,totalStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0,controlledCount:0}),M=O.length>0?Math.round(U.controlledCount/O.length*100):0;C(M),g({totalStock:U.totalStock,activeProducts:z,negativeStock:U.negativeStock,positiveStock:U.positiveStock,negativeUnits:U.negativeUnits,positiveUnits:U.positiveUnits,totalSystemUnits:U.totalSystemUnits})}catch(O){console.error("Error loading metrics:",O)}})()},[e]);const ye=()=>{const D=new Date().getHours();return D>=6&&D<12?"Buenos das":D>=12&&D<20?"Buenas tardes":"Buenas noches"},Le=D=>{switch(D){case"smart-analyst":return t.jsx(oi,{});case"metrics-carousel":return t.jsx(ii,{metrics:w});case"active-products":return t.jsx(li,{activeProducts:w.activeProducts});case"inventory-summary":return t.jsx(ci,{});case"inventory-alerts":return t.jsx(mi,{});case"upcoming-inventories":return t.jsx(fi,{onDateClick:xe});case"branches-table":return nt(e,"VIEW_BRANCH_MONITOR")?t.jsx(xi,{branches:zi}):null;case"inventory-progress":return t.jsx(pi,{completedCount:k,totalCount:100});case"critical-products":return t.jsx(gi,{criticalCount:15,outOfStockCount:3});case"total-stock-value":return t.jsx(vi,{totalValue:w.totalStock,changePercentage:5.2});case"active-users":return t.jsx(bi,{activeCount:5,activeBranches:["Belgrano IV","Recoleta","Palermo II"]});case"pending-inventories":return t.jsx(yi,{pendingCount:7,urgentCount:2});case"trends-chart":return t.jsx(ji,{});case"top-products":return t.jsx(wi,{});case"activity-timeline":return t.jsx(Ni,{});case"category-distribution":return t.jsx(Ci,{});case"monthly-goals":return t.jsx(Si,{});case"sync-status":return t.jsx(Di,{isOnline:navigator.onLine,pendingCount:0});case"quick-actions":return t.jsx(ki,{});case"calendar":return t.jsx(Mi,{});case"countdown":return t.jsx(Ei,{assignedDays:j,startDate:y,totalProgress:k,isEditable:nt(e,"MANAGE_INVENTORY_CONFIG"),onEdit:()=>T(!0)});case"category-progress":return t.jsx(Ii,{});default:return null}};return t.jsxs(W.div,{className:"pt-3 pb-6 px-6 space-y-6",variants:Pi,initial:"hidden",animate:"show",children:[t.jsxs(W.div,{variants:Oi,className:"space-y-1",children:[t.jsx("div",{className:"text-muted-foreground text-xs font-normal",children:new Date().toLocaleDateString("es-AR",{weekday:"long",month:"short",day:"2-digit",year:"numeric"})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-2xl font-medium tracking-tight text-foreground",children:[ye(),", ",(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="mod"?e==null?void 0:e.name.split(" ")[0]:(e==null?void 0:e.branchName)||"Sucursal"," "]}),t.jsxs("div",{className:"flex gap-2",children:[r&&t.jsxs(t.Fragment,{children:[t.jsxs(R,{variant:"outline",size:"sm",onClick:()=>x(!0),children:[t.jsx(fn,{className:"h-4 w-4 mr-2"}),"Presets"]}),t.jsxs(R,{variant:"outline",size:"sm",onClick:()=>c(!0),disabled:n.length===0,children:[t.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Agregar Widget"]}),t.jsxs(R,{variant:"outline",size:"sm",onClick:h,children:[t.jsx(Xr,{className:"h-4 w-4 mr-2"}),"Resetear"]})]}),nt(e,"EDIT_DASHBOARD_LAYOUT")&&t.jsx(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(R,{variant:r?"default":"outline",size:"sm",onClick:()=>a(!r),className:$("relative overflow-hidden transition-all duration-300",r&&"bg-green-600 hover:bg-green-700"),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ss,{mode:"wait",children:r?t.jsx(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(mn,{className:"h-4 w-4"})},"check"):t.jsx(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(ia,{className:"h-4 w-4"})},"edit")}),t.jsx("span",{children:r?"Guardar":"Editar Dashboard"})]})})})]})]})]}),t.jsx(Mo,{sensors:b,collisionDetection:Ia,onDragEnd:v,children:t.jsx(Wo,{items:p.map(D=>D.id),strategy:xs,children:t.jsx("div",{className:"grid grid-cols-12 gap-6 auto-rows-auto",children:p.map(D=>t.jsx("div",{className:$(D.size==="small"&&"col-span-12 md:col-span-6 lg:col-span-3",D.size==="large"&&"col-span-12 md:col-span-6 lg:col-span-4",D.size==="full"&&"col-span-12"),children:t.jsx(ni,{widget:D,isEditMode:r,onRemove:()=>l(D.id),onSizeChange:z=>d(D.id,z),children:Le(D.type)})},D.id))})})}),t.jsx(Ti,{open:f,onOpenChange:x,onApplyPreset:D=>{const z=Bn.find(O=>O.id===D);z&&u(z.widgetIds)}}),t.jsx(ai,{open:m,onOpenChange:c,hiddenWidgets:n,onAddWidget:l}),t.jsx(At,{open:E,onOpenChange:D=>{if(T(D),D){const z=j||90,U=[180,150,120,90].find(M=>M<=z)||90;B((e==null?void 0:e.branchName)||""),se(U),Oe(Math.max(0,z-U)),Pe(y?y.split("T")[0]:new Date().toISOString().split("T")[0])}},children:t.jsxs(Rt,{className:"max-w-md",children:[t.jsxs(Tt,{children:[t.jsx(zt,{children:"Configurar Plazo de Inventario"}),t.jsx(nn,{children:"Ajusta los parmetros del ciclo de inventario para esta sucursal."})]}),t.jsxs("div",{className:"space-y-6 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{className:"text-muted-foreground",children:"Sucursal Seleccionada"}),t.jsx("div",{className:"text-lg font-semibold border p-3 rounded-md bg-muted/50",children:(e==null?void 0:e.branchName)||"Sin sucursal asignada"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(Te,{children:"Das Base"}),t.jsx("div",{className:"grid grid-cols-4 gap-3",children:[90,120,150,180].map(D=>t.jsx("button",{onClick:()=>se(D),className:$("flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all",F===D?"border-primary bg-primary/10 text-primary font-bold":"border-muted hover:border-primary/50 text-muted-foreground"),children:t.jsx("span",{className:"text-xl",children:D})},D))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{children:"Prroga (Das adicionales)"}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(ne,{type:"number",placeholder:"0",className:"text-lg font-medium",value:K,onChange:D=>Oe(Number(D.target.value)),min:0}),t.jsxs("div",{className:"text-sm text-muted-foreground text-nowrap",children:["Total: ",t.jsx("span",{className:"font-bold text-foreground mx-1 text-lg",children:F+K})," das"]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Te,{children:"Fecha de Inicio del Ciclo"}),t.jsx(ne,{type:"date",value:he,onChange:D=>Pe(D.target.value),className:"bg-background"}),t.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Esta fecha se usa para calcular los das restantes y el ritmo de avance."})]}),t.jsx(R,{className:"w-full mt-2",onClick:async()=>{if(!(e!=null&&e.branchName))return;const D=F+K;try{await Se.saveBranchConfig(e.branchName,D,he),de.success("Operacin exitosa",`Plazo actualizado a ${D} das`),T(!1),N(D),S(he)}catch{de.error("Error","Error al guardar")}},children:"Guardar Configuracin"})]})]})}),t.jsx(Ri,{open:fe,onOpenChange:De,initialDate:Ue})]})}export{gl as default};
