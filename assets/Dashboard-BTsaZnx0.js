import{j as n,O as hs,a as gs,k as ps,b as xs,c as vs,D as bs,d as ys,e as ws}from"./ui-vendor-DWmIoBIJ.js";import{r as c,c as D,a as gt,u as js}from"./react-vendor-ylmX0jv_.js";import{c as ve,C as mr,a as pt,T as Dn,b as Ne,B as oe,X as hr,d as K,e as ce,f as de,g as Ns,h as ue,i as En,s as sn,u as tt,S as Ss,j as Cs,k as xt,U as gr,W as Ds,R as Es,D as Rs,l as Ts,I as Is,m as ks,n as As,o as Ms,p as Os,q as Ps,r as Ke,t as pr,v as xr,w as vr,x as br,y as zs}from"./index-DbwJGGea.js";import{D as Ft}from"./dollar-sign-3C4PX9Wr.js";import{T as nt}from"./trending-up-BTBHZGPd.js";import{C as Dt}from"./clock-DaLBEFtK.js";import{H as Ls}from"./history-DFbGHGPK.js";import{T as yr}from"./target-x766BHcb.js";import{W as wr}from"./wifi-DHI8ddU4.js";import{C as Ht,e as zt}from"./es-BwL_KD0l.js";import{P as Et}from"./plus-CeeIkDpR.js";import{g as $s}from"./expirationDB-RbdgDSbm.js";import{B as Se}from"./badge-DKLc_DLM.js";import{m as Ze,A as Bs}from"./animation-Ch0GoCcm.js";import{A as Us}from"./arrow-right-BDPz5MGJ.js";import{M as Ws,A as Vn,P as jr,C as Fs}from"./progress-Bg3zQE63.js";import{T as Rn}from"./trending-down-DmLsS8rq.js";import{C as Nr}from"./CounterAnimation-BByUy0p8.js";import{A as an}from"./AnimatedProgressBar-CRPlKgnl.js";import{I as ze}from"./input-BacYCGan.js";import{T as Hs,a as Vs,b as on,c as Ve,d as _s,e as ne}from"./table-DEno13cP.js";import{R as Sr,L as qs,C as Ys,X as Gs,Y as Xs,T as Cr,a as Ks,b as _n,P as Js,c as Zs,d as Qs}from"./chart-vendor-Cu80epCr.js";import{E as ea}from"./eye-BglBrqyi.js";import{s as ta,e as na,a as ra,b as sa,g as aa,f as qn,i as oa,h as ia,p as la,d as ca,j as da,k as ua}from"./utils-CUsTgaRG.js";import{L as ln}from"./label-DGYK63qN.js";import"./excel-uoQkVabA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=ve("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=ve("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ve("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=ve("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=ve("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=ve("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=ve("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=ve("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=ve("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=ve("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=ve("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=ve("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ja(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return c.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Gt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function rt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Tn(e){return"nodeType"in e}function be(e){var t,r;return e?rt(e)?e:Tn(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function In(e){const{Document:t}=be(e);return e instanceof t}function Rt(e){return rt(e)?!1:e instanceof be(e).HTMLElement}function Tr(e){return e instanceof be(e).SVGElement}function st(e){return e?rt(e)?e.document:Tn(e)?In(e)?e:Rt(e)||Tr(e)?e.ownerDocument:document:document:document}const Le=Gt?c.useLayoutEffect:c.useEffect;function kn(e){const t=c.useRef(e);return Le(()=>{t.current=e}),c.useCallback(function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function Na(){const e=c.useRef(null),t=c.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),r=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function wt(e,t){t===void 0&&(t=[e]);const r=c.useRef(e);return Le(()=>{r.current!==e&&(r.current=e)},t),r}function Tt(e,t){const r=c.useRef();return c.useMemo(()=>{const s=e(r.current);return r.current=s,s},[...t])}function Vt(e){const t=kn(e),r=c.useRef(null),s=c.useCallback(a=>{a!==r.current&&(t==null||t(a,r.current)),r.current=a},[]);return[r,s]}function bn(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let cn={};function It(e,t){return c.useMemo(()=>{if(t)return t;const r=cn[e]==null?0:cn[e]+1;return cn[e]=r,e+"-"+r},[e,t])}function Ir(e){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((o,i)=>{const d=Object.entries(i);for(const[u,m]of d){const f=o[u];f!=null&&(o[u]=f+e*m)}return o},{...t})}}const et=Ir(1),jt=Ir(-1);function Sa(e){return"clientX"in e&&"clientY"in e}function An(e){if(!e)return!1;const{KeyboardEvent:t}=be(e.target);return t&&e instanceof t}function Ca(e){if(!e)return!1;const{TouchEvent:t}=be(e.target);return t&&e instanceof t}function yn(e){if(Ca(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Sa(e)?{x:e.clientX,y:e.clientY}:null}const Nt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Nt.Translate.toString(e),Nt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:s}=e;return t+" "+r+"ms "+s}}}),Gn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Da(e){return e.matches(Gn)?e:e.querySelector(Gn)}const Ea={display:"none"};function Ra(e){let{id:t,value:r}=e;return D.createElement("div",{id:t,style:Ea},r)}function Ta(e){let{id:t,announcement:r,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return D.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},r)}function Ia(){const[e,t]=c.useState("");return{announce:c.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const kr=c.createContext(null);function ka(e){const t=c.useContext(kr);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Aa(){const[e]=c.useState(()=>new Set),t=c.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[c.useCallback(s=>{let{type:a,event:o}=s;e.forEach(i=>{var d;return(d=i[a])==null?void 0:d.call(i,o)})},[e]),t]}const Ma={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Oa={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Pa(e){let{announcements:t=Oa,container:r,hiddenTextDescribedById:s,screenReaderInstructions:a=Ma}=e;const{announce:o,announcement:i}=Ia(),d=It("DndLiveRegion"),[u,m]=c.useState(!1);if(c.useEffect(()=>{m(!0)},[]),ka(c.useMemo(()=>({onDragStart(l){let{active:g}=l;o(t.onDragStart({active:g}))},onDragMove(l){let{active:g,over:p}=l;t.onDragMove&&o(t.onDragMove({active:g,over:p}))},onDragOver(l){let{active:g,over:p}=l;o(t.onDragOver({active:g,over:p}))},onDragEnd(l){let{active:g,over:p}=l;o(t.onDragEnd({active:g,over:p}))},onDragCancel(l){let{active:g,over:p}=l;o(t.onDragCancel({active:g,over:p}))}}),[o,t])),!u)return null;const f=D.createElement(D.Fragment,null,D.createElement(Ra,{id:s,value:a.draggable}),D.createElement(Ta,{id:d,announcement:i}));return r?gt.createPortal(f,r):f}var ae;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ae||(ae={}));function _t(){}function Xn(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function za(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return c.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ae=Object.freeze({x:0,y:0});function Ar(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Mr(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return r-s}function La(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return s-r}function Kn(e){let{left:t,top:r,height:s,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+s},{x:t+a,y:r+s}]}function Or(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function Jn(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const $a=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Jn(t,t.left,t.top),o=[];for(const i of s){const{id:d}=i,u=r.get(d);if(u){const m=Ar(Jn(u),a);o.push({id:d,data:{droppableContainer:i,value:m}})}}return o.sort(Mr)},Ba=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Kn(t),o=[];for(const i of s){const{id:d}=i,u=r.get(d);if(u){const m=Kn(u),f=a.reduce((g,p,S)=>g+Ar(m[S],p),0),l=Number((f/4).toFixed(4));o.push({id:d,data:{droppableContainer:i,value:l}})}}return o.sort(Mr)};function Ua(e,t){const r=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=a-s,d=o-r;if(s<a&&r<o){const u=t.width*t.height,m=e.width*e.height,f=i*d,l=f/(u+m-f);return Number(l.toFixed(4))}return 0}const Wa=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=[];for(const o of s){const{id:i}=o,d=r.get(i);if(d){const u=Ua(d,t);u>0&&a.push({id:i,data:{droppableContainer:o,value:u}})}}return a.sort(La)};function Fa(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function Pr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ae}function Ha(e){return function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return a.reduce((i,d)=>({...i,top:i.top+e*d.y,bottom:i.bottom+e*d.y,left:i.left+e*d.x,right:i.right+e*d.x}),{...r})}}const Va=Ha(1);function _a(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function qa(e,t,r){const s=_a(t);if(!s)return e;const{scaleX:a,scaleY:o,x:i,y:d}=s,u=e.left-i-(1-a)*parseFloat(r),m=e.top-d-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),f=a?e.width/a:e.width,l=o?e.height/o:e.height;return{width:f,height:l,top:m,right:u+f,bottom:m+l,left:u}}const Ya={ignoreTransform:!1};function at(e,t){t===void 0&&(t=Ya);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:m,transformOrigin:f}=be(e).getComputedStyle(e);m&&(r=qa(r,m,f))}const{top:s,left:a,width:o,height:i,bottom:d,right:u}=r;return{top:s,left:a,width:o,height:i,bottom:d,right:u}}function Zn(e){return at(e,{ignoreTransform:!0})}function Ga(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function Xa(e,t){return t===void 0&&(t=be(e).getComputedStyle(e)),t.position==="fixed"}function Ka(e,t){t===void 0&&(t=be(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?r.test(o):!1})}function Xt(e,t){const r=[];function s(a){if(t!=null&&r.length>=t||!a)return r;if(In(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!Rt(a)||Tr(a)||r.includes(a))return r;const o=be(e).getComputedStyle(a);return a!==e&&Ka(a,o)&&r.push(a),Xa(a,o)?r:s(a.parentNode)}return e?s(e):r}function zr(e){const[t]=Xt(e,1);return t??null}function dn(e){return!Gt||!e?null:rt(e)?e:Tn(e)?In(e)||e===st(e).scrollingElement?window:Rt(e)?e:null:null}function Lr(e){return rt(e)?e.scrollX:e.scrollLeft}function $r(e){return rt(e)?e.scrollY:e.scrollTop}function wn(e){return{x:Lr(e),y:$r(e)}}var le;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(le||(le={}));function Br(e){return!Gt||!e?!1:e===document.scrollingElement}function Ur(e){const t={x:0,y:0},r=Br(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=s.y,d=e.scrollLeft>=s.x;return{isTop:a,isLeft:o,isBottom:i,isRight:d,maxScroll:s,minScroll:t}}const Ja={x:.2,y:.2};function Za(e,t,r,s,a){let{top:o,left:i,right:d,bottom:u}=r;s===void 0&&(s=10),a===void 0&&(a=Ja);const{isTop:m,isBottom:f,isLeft:l,isRight:g}=Ur(e),p={x:0,y:0},S={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!m&&o<=t.top+b.height?(p.y=le.Backward,S.y=s*Math.abs((t.top+b.height-o)/b.height)):!f&&u>=t.bottom-b.height&&(p.y=le.Forward,S.y=s*Math.abs((t.bottom-b.height-u)/b.height)),!g&&d>=t.right-b.width?(p.x=le.Forward,S.x=s*Math.abs((t.right-b.width-d)/b.width)):!l&&i<=t.left+b.width&&(p.x=le.Backward,S.x=s*Math.abs((t.left+b.width-i)/b.width)),{direction:p,speed:S}}function Qa(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:r,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Wr(e){return e.reduce((t,r)=>et(t,wn(r)),Ae)}function eo(e){return e.reduce((t,r)=>t+Lr(r),0)}function to(e){return e.reduce((t,r)=>t+$r(r),0)}function no(e,t){if(t===void 0&&(t=at),!e)return;const{top:r,left:s,bottom:a,right:o}=t(e);zr(e)&&(a<=0||o<=0||r>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ro=[["x",["left","right"],eo],["y",["top","bottom"],to]];class Mn{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Xt(r),a=Wr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,d]of ro)for(const u of i)Object.defineProperty(this,u,{get:()=>{const m=d(s),f=a[o]-m;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class vt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...r)})},this.target=t}add(t,r,s){var a;(a=this.target)==null||a.addEventListener(t,r,s),this.listeners.push([t,r,s])}}function so(e){const{EventTarget:t}=be(e);return e instanceof t?e:st(e)}function un(e,t){const r=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+s**2)>t:"x"in t&&"y"in t?r>t.x&&s>t.y:"x"in t?r>t.x:"y"in t?s>t.y:!1}var Re;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Re||(Re={}));function Qn(e){e.preventDefault()}function ao(e){e.stopPropagation()}var $;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})($||($={}));const Fr={start:[$.Space,$.Enter],cancel:[$.Esc],end:[$.Space,$.Enter,$.Tab]},oo=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case $.Right:return{...r,x:r.x+25};case $.Left:return{...r,x:r.x-25};case $.Down:return{...r,y:r.y+25};case $.Up:return{...r,y:r.y-25}}};class On{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new vt(st(r)),this.windowListeners=new vt(be(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Re.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,s=t.node.current;s&&no(s),r(Ae)}handleKeyDown(t){if(An(t)){const{active:r,context:s,options:a}=this.props,{keyboardCodes:o=Fr,coordinateGetter:i=oo,scrollBehavior:d="smooth"}=a,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:m}=s.current,f=m?{x:m.left,y:m.top}:Ae;this.referenceCoordinates||(this.referenceCoordinates=f);const l=i(t,{active:r,context:s.current,currentCoordinates:f});if(l){const g=jt(l,f),p={x:0,y:0},{scrollableAncestors:S}=s.current;for(const b of S){const w=t.code,{isTop:x,isRight:v,isLeft:j,isBottom:h,maxScroll:E,minScroll:T}=Ur(b),N=Qa(b),y={x:Math.min(w===$.Right?N.right-N.width/2:N.right,Math.max(w===$.Right?N.left:N.left+N.width/2,l.x)),y:Math.min(w===$.Down?N.bottom-N.height/2:N.bottom,Math.max(w===$.Down?N.top:N.top+N.height/2,l.y))},I=w===$.Right&&!v||w===$.Left&&!j,P=w===$.Down&&!h||w===$.Up&&!x;if(I&&y.x!==l.x){const C=b.scrollLeft+g.x,z=w===$.Right&&C<=E.x||w===$.Left&&C>=T.x;if(z&&!g.y){b.scrollTo({left:C,behavior:d});return}z?p.x=b.scrollLeft-C:p.x=w===$.Right?b.scrollLeft-E.x:b.scrollLeft-T.x,p.x&&b.scrollBy({left:-p.x,behavior:d});break}else if(P&&y.y!==l.y){const C=b.scrollTop+g.y,z=w===$.Down&&C<=E.y||w===$.Up&&C>=T.y;if(z&&!g.x){b.scrollTo({top:C,behavior:d});return}z?p.y=b.scrollTop-C:p.y=w===$.Down?b.scrollTop-E.y:b.scrollTop-T.y,p.y&&b.scrollBy({top:-p.y,behavior:d});break}}this.handleMove(t,et(jt(l,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:s}=this.props;t.preventDefault(),s(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}On.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:s=Fr,onActivation:a}=t,{active:o}=r;const{code:i}=e.nativeEvent;if(s.start.includes(i)){const d=o.activatorNode.current;return d&&e.target!==d?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function er(e){return!!(e&&"distance"in e)}function tr(e){return!!(e&&"delay"in e)}class Pn{constructor(t,r,s){var a;s===void 0&&(s=so(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:i}=o;this.props=t,this.events=r,this.document=st(i),this.documentListeners=new vt(this.document),this.listeners=new vt(s),this.windowListeners=new vt(be(i)),this.initialCoordinates=(a=yn(o))!=null?a:Ae,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.DragStart,Qn),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),this.windowListeners.add(Re.ContextMenu,Qn),this.documentListeners.add(Re.Keydown,this.handleKeydown),r){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(tr(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(er(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Re.Click,ao,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Re.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:s,initialCoordinates:a,props:o}=this,{onMove:i,options:{activationConstraint:d}}=o;if(!a)return;const u=(r=yn(t))!=null?r:Ae,m=jt(a,u);if(!s&&d){if(er(d)){if(d.tolerance!=null&&un(m,d.tolerance))return this.handleCancel();if(un(m,d.distance))return this.handleStart()}if(tr(d)&&un(m,d.tolerance))return this.handleCancel();this.handlePending(d,m);return}t.cancelable&&t.preventDefault(),i(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===$.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const io={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class zn extends Pn{constructor(t){const{event:r}=t,s=st(r.target);super(t,io,s)}}zn.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return!r.isPrimary||r.button!==0?!1:(s==null||s({event:r}),!0)}}];const lo={move:{name:"mousemove"},end:{name:"mouseup"}};var jn;(function(e){e[e.RightClick=2]="RightClick"})(jn||(jn={}));class co extends Pn{constructor(t){super(t,lo,st(t.event.target))}}co.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return r.button===jn.RightClick?!1:(s==null||s({event:r}),!0)}}];const fn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class uo extends Pn{constructor(t){super(t,fn)}static setup(){return window.addEventListener(fn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(fn.move.name,t)};function t(){}}}uo.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;const{touches:a}=r;return a.length>1?!1:(s==null||s({event:r}),!0)}}];var bt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(bt||(bt={}));var qt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(qt||(qt={}));function fo(e){let{acceleration:t,activator:r=bt.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:i=5,order:d=qt.TreeOrder,pointerCoordinates:u,scrollableAncestors:m,scrollableAncestorRects:f,delta:l,threshold:g}=e;const p=ho({delta:l,disabled:!o}),[S,b]=Na(),w=c.useRef({x:0,y:0}),x=c.useRef({x:0,y:0}),v=c.useMemo(()=>{switch(r){case bt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case bt.DraggableRect:return a}},[r,a,u]),j=c.useRef(null),h=c.useCallback(()=>{const T=j.current;if(!T)return;const N=w.current.x*x.current.x,y=w.current.y*x.current.y;T.scrollBy(N,y)},[]),E=c.useMemo(()=>d===qt.TreeOrder?[...m].reverse():m,[d,m]);c.useEffect(()=>{if(!o||!m.length||!v){b();return}for(const T of E){if((s==null?void 0:s(T))===!1)continue;const N=m.indexOf(T),y=f[N];if(!y)continue;const{direction:I,speed:P}=Za(T,y,v,t,g);for(const C of["x","y"])p[C][I[C]]||(P[C]=0,I[C]=0);if(P.x>0||P.y>0){b(),j.current=T,S(h,i),w.current=P,x.current=I;return}}w.current={x:0,y:0},x.current={x:0,y:0},b()},[t,h,s,b,o,i,JSON.stringify(v),JSON.stringify(p),S,m,E,f,JSON.stringify(g)])}const mo={x:{[le.Backward]:!1,[le.Forward]:!1},y:{[le.Backward]:!1,[le.Forward]:!1}};function ho(e){let{delta:t,disabled:r}=e;const s=bn(t);return Tt(a=>{if(r||!s||!a)return mo;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[le.Backward]:a.x[le.Backward]||o.x===-1,[le.Forward]:a.x[le.Forward]||o.x===1},y:{[le.Backward]:a.y[le.Backward]||o.y===-1,[le.Forward]:a.y[le.Forward]||o.y===1}}},[r,t,s])}function go(e,t){const r=t!=null?e.get(t):void 0,s=r?r.node.current:null;return Tt(a=>{var o;return t==null?null:(o=s??a)!=null?o:null},[s,t])}function po(e,t){return c.useMemo(()=>e.reduce((r,s)=>{const{sensor:a}=s,o=a.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,s)}));return[...r,...o]},[]),[e,t])}var St;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(St||(St={}));var Nn;(function(e){e.Optimized="optimized"})(Nn||(Nn={}));const nr=new Map;function xo(e,t){let{dragging:r,dependencies:s,config:a}=t;const[o,i]=c.useState(null),{frequency:d,measure:u,strategy:m}=a,f=c.useRef(e),l=w(),g=wt(l),p=c.useCallback(function(x){x===void 0&&(x=[]),!g.current&&i(v=>v===null?x:v.concat(x.filter(j=>!v.includes(j))))},[g]),S=c.useRef(null),b=Tt(x=>{if(l&&!r)return nr;if(!x||x===nr||f.current!==e||o!=null){const v=new Map;for(let j of e){if(!j)continue;if(o&&o.length>0&&!o.includes(j.id)&&j.rect.current){v.set(j.id,j.rect.current);continue}const h=j.node.current,E=h?new Mn(u(h),h):null;j.rect.current=E,E&&v.set(j.id,E)}return v}return x},[e,o,r,l,u]);return c.useEffect(()=>{f.current=e},[e]),c.useEffect(()=>{l||p()},[r,l]),c.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),c.useEffect(()=>{l||typeof d!="number"||S.current!==null||(S.current=setTimeout(()=>{p(),S.current=null},d))},[d,l,p,...s]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:o!=null};function w(){switch(m){case St.Always:return!1;case St.BeforeDragging:return r;default:return!r}}}function Hr(e,t){return Tt(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function vo(e,t){return Hr(e,t)}function bo(e){let{callback:t,disabled:r}=e;const s=kn(t),a=c.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,r]);return c.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Kt(e){let{callback:t,disabled:r}=e;const s=kn(t),a=c.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[r]);return c.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function yo(e){return new Mn(at(e),e)}function rr(e,t,r){t===void 0&&(t=yo);const[s,a]=c.useState(null);function o(){a(u=>{if(!e)return null;if(e.isConnected===!1){var m;return(m=u??r)!=null?m:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const i=bo({callback(u){if(e)for(const m of u){const{type:f,target:l}=m;if(f==="childList"&&l instanceof HTMLElement&&l.contains(e)){o();break}}}}),d=Kt({callback:o});return Le(()=>{o(),e?(d==null||d.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(d==null||d.disconnect(),i==null||i.disconnect())},[e]),s}function wo(e){const t=Hr(e);return Pr(e,t)}const sr=[];function jo(e){const t=c.useRef(e),r=Tt(s=>e?s&&s!==sr&&e&&t.current&&e.parentNode===t.current.parentNode?s:Xt(e):sr,[e]);return c.useEffect(()=>{t.current=e},[e]),r}function No(e){const[t,r]=c.useState(null),s=c.useRef(e),a=c.useCallback(o=>{const i=dn(o.target);i&&r(d=>d?(d.set(i,wn(i)),new Map(d)):null)},[]);return c.useEffect(()=>{const o=s.current;if(e!==o){i(o);const d=e.map(u=>{const m=dn(u);return m?(m.addEventListener("scroll",a,{passive:!0}),[m,wn(m)]):null}).filter(u=>u!=null);r(d.length?new Map(d):null),s.current=e}return()=>{i(e),i(o)};function i(d){d.forEach(u=>{const m=dn(u);m==null||m.removeEventListener("scroll",a)})}},[a,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>et(o,i),Ae):Wr(e):Ae,[e,t])}function ar(e,t){t===void 0&&(t=[]);const r=c.useRef(null);return c.useEffect(()=>{r.current=null},t),c.useEffect(()=>{const s=e!==Ae;s&&!r.current&&(r.current=e),!s&&r.current&&(r.current=null)},[e]),r.current?jt(e,r.current):Ae}function So(e){c.useEffect(()=>{if(!Gt)return;const t=e.map(r=>{let{sensor:s}=r;return s.setup==null?void 0:s.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function Co(e,t){return c.useMemo(()=>e.reduce((r,s)=>{let{eventName:a,handler:o}=s;return r[a]=i=>{o(i,t)},r},{}),[e,t])}function Vr(e){return c.useMemo(()=>e?Ga(e):null,[e])}const or=[];function Do(e,t){t===void 0&&(t=at);const[r]=e,s=Vr(r?be(r):null),[a,o]=c.useState(or);function i(){o(()=>e.length?e.map(u=>Br(u)?s:new Mn(t(u),u)):or)}const d=Kt({callback:i});return Le(()=>{d==null||d.disconnect(),i(),e.forEach(u=>d==null?void 0:d.observe(u))},[e]),a}function Eo(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Rt(t)?t:e}function Ro(e){let{measure:t}=e;const[r,s]=c.useState(null),a=c.useCallback(m=>{for(const{target:f}of m)if(Rt(f)){s(l=>{const g=t(f);return l?{...l,width:g.width,height:g.height}:g});break}},[t]),o=Kt({callback:a}),i=c.useCallback(m=>{const f=Eo(m);o==null||o.disconnect(),f&&(o==null||o.observe(f)),s(f?t(f):null)},[t,o]),[d,u]=Vt(i);return c.useMemo(()=>({nodeRef:d,rect:r,setRef:u}),[r,d,u])}const To=[{sensor:zn,options:{}},{sensor:On,options:{}}],Io={current:{}},Wt={draggable:{measure:Zn},droppable:{measure:Zn,strategy:St.WhileDragging,frequency:Nn.Optimized},dragOverlay:{measure:at}};class yt extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,s;return(r=(s=this.get(t))==null?void 0:s.node.current)!=null?r:void 0}}const ko={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new yt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_t},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Wt,measureDroppableContainers:_t,windowRect:null,measuringScheduled:!1},Ao={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_t,draggableNodes:new Map,over:null,measureDroppableContainers:_t},Jt=c.createContext(Ao),_r=c.createContext(ko);function Mo(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new yt}}}function Oo(e,t){switch(t.type){case ae.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ae.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ae.DragEnd:case ae.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ae.RegisterDroppable:{const{element:r}=t,{id:s}=r,a=new yt(e.droppable.containers);return a.set(s,r),{...e,droppable:{...e.droppable,containers:a}}}case ae.SetDroppableDisabled:{const{id:r,key:s,disabled:a}=t,o=e.droppable.containers.get(r);if(!o||s!==o.key)return e;const i=new yt(e.droppable.containers);return i.set(r,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:i}}}case ae.UnregisterDroppable:{const{id:r,key:s}=t,a=e.droppable.containers.get(r);if(!a||s!==a.key)return e;const o=new yt(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Po(e){let{disabled:t}=e;const{active:r,activatorEvent:s,draggableNodes:a}=c.useContext(Jt),o=bn(s),i=bn(r==null?void 0:r.id);return c.useEffect(()=>{if(!t&&!s&&o&&i!=null){if(!An(o)||document.activeElement===o.target)return;const d=a.get(i);if(!d)return;const{activatorNode:u,node:m}=d;if(!u.current&&!m.current)return;requestAnimationFrame(()=>{for(const f of[u.current,m.current]){if(!f)continue;const l=Da(f);if(l){l.focus();break}}})}},[s,t,a,i,o]),null}function zo(e,t){let{transform:r,...s}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...s}),r):r}function Lo(e){return c.useMemo(()=>({draggable:{...Wt.draggable,...e==null?void 0:e.draggable},droppable:{...Wt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Wt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function $o(e){let{activeNode:t,measure:r,initialRect:s,config:a=!0}=e;const o=c.useRef(!1),{x:i,y:d}=typeof a=="boolean"?{x:a,y:a}:a;Le(()=>{if(!i&&!d||!t){o.current=!1;return}if(o.current||!s)return;const m=t==null?void 0:t.node.current;if(!m||m.isConnected===!1)return;const f=r(m),l=Pr(f,s);if(i||(l.x=0),d||(l.y=0),o.current=!0,Math.abs(l.x)>0||Math.abs(l.y)>0){const g=zr(m);g&&g.scrollBy({top:l.y,left:l.x})}},[t,i,d,s,r])}const qr=c.createContext({...Ae,scaleX:1,scaleY:1});var Xe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Xe||(Xe={}));const Bo=c.memo(function(t){var r,s,a,o;let{id:i,accessibility:d,autoScroll:u=!0,children:m,sensors:f=To,collisionDetection:l=Wa,measuring:g,modifiers:p,...S}=t;const b=c.useReducer(Oo,void 0,Mo),[w,x]=b,[v,j]=Aa(),[h,E]=c.useState(Xe.Uninitialized),T=h===Xe.Initialized,{draggable:{active:N,nodes:y,translate:I},droppable:{containers:P}}=w,C=N!=null?y.get(N):null,z=c.useRef({initial:null,translated:null}),L=c.useMemo(()=>{var M;return N!=null?{id:N,data:(M=C==null?void 0:C.data)!=null?M:Io,rect:z}:null},[N,C]),F=c.useRef(null),[Y,R]=c.useState(null),[O,J]=c.useState(null),q=wt(S,Object.values(S)),ie=It("DndDescribedBy",i),ye=c.useMemo(()=>P.getEnabled(),[P]),fe=Lo(g),{droppableRects:he,measureDroppableContainers:Ce,measuringScheduled:Be}=xo(ye,{dragging:T,dependencies:[I.x,I.y],config:fe.droppable}),ge=go(y,N),Ue=c.useMemo(()=>O?yn(O):null,[O]),pe=V(),we=vo(ge,fe.draggable.measure);$o({activeNode:N!=null?y.get(N):null,config:pe.layoutShiftCompensation,initialRect:we,measure:fe.draggable.measure});const B=rr(ge,fe.draggable.measure,we),De=rr(ge?ge.parentElement:null),je=c.useRef({activatorEvent:null,active:null,activeNode:ge,collisionRect:null,collisions:null,droppableRects:he,draggableNodes:y,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),A=P.getNodeFor((r=je.current.over)==null?void 0:r.id),Ee=Ro({measure:fe.dragOverlay.measure}),We=(s=Ee.nodeRef.current)!=null?s:ge,Me=T?(a=Ee.rect)!=null?a:B:null,kt=!!(Ee.nodeRef.current&&Ee.rect),At=wo(kt?null:B),Fe=Vr(We?be(We):null),Te=jo(T?A??ge:null),Qe=Do(Te),Oe=zo(p,{transform:{x:I.x-At.x,y:I.y-At.y,scaleX:1,scaleY:1},activatorEvent:O,active:L,activeNodeRect:B,containerNodeRect:De,draggingNodeRect:Me,over:je.current.over,overlayNodeRect:Ee.rect,scrollableAncestors:Te,scrollableAncestorRects:Qe,windowRect:Fe}),Mt=Ue?et(Ue,I):null,it=No(Te),Zt=ar(it),Qt=ar(it,[B]),Ie=et(Oe,Zt),qe=Me?Va(Me,Oe):null,Ye=L&&qe?l({active:L,collisionRect:qe,droppableRects:he,droppableContainers:ye,pointerCoordinates:Mt}):null,Ot=Or(Ye,"id"),[xe,lt]=c.useState(null),en=kt?Oe:et(Oe,Qt),tn=Fa(en,(o=xe==null?void 0:xe.rect)!=null?o:null,B),ct=c.useRef(null),Pt=c.useCallback((M,_)=>{let{sensor:W,options:Z}=_;if(F.current==null)return;const G=y.get(F.current);if(!G)return;const ee=M.nativeEvent,te=new W({active:F.current,activeNode:G,event:ee,options:Z,context:je,onAbort(Q){if(!y.get(Q))return;const{onDragAbort:Pe}=q.current,He={id:Q};Pe==null||Pe(He),v({type:"onDragAbort",event:He})},onPending(Q,ke,Pe,He){if(!y.get(Q))return;const{onDragPending:ut}=q.current,Ge={id:Q,constraint:ke,initialCoordinates:Pe,offset:He};ut==null||ut(Ge),v({type:"onDragPending",event:Ge})},onStart(Q){const ke=F.current;if(ke==null)return;const Pe=y.get(ke);if(!Pe)return;const{onDragStart:He}=q.current,dt={activatorEvent:ee,active:{id:ke,data:Pe.data,rect:z}};gt.unstable_batchedUpdates(()=>{He==null||He(dt),E(Xe.Initializing),x({type:ae.DragStart,initialCoordinates:Q,active:ke}),v({type:"onDragStart",event:dt}),R(ct.current),J(ee)})},onMove(Q){x({type:ae.DragMove,coordinates:Q})},onEnd:me(ae.DragEnd),onCancel:me(ae.DragCancel)});ct.current=te;function me(Q){return async function(){const{active:Pe,collisions:He,over:dt,scrollAdjustedTranslate:ut}=je.current;let Ge=null;if(Pe&&ut){const{cancelDrop:ft}=q.current;Ge={activatorEvent:ee,active:Pe,collisions:He,delta:ut,over:dt},Q===ae.DragEnd&&typeof ft=="function"&&await Promise.resolve(ft(Ge))&&(Q=ae.DragCancel)}F.current=null,gt.unstable_batchedUpdates(()=>{x({type:Q}),E(Xe.Uninitialized),lt(null),R(null),J(null),ct.current=null;const ft=Q===ae.DragEnd?"onDragEnd":"onDragCancel";if(Ge){const rn=q.current[ft];rn==null||rn(Ge),v({type:ft,event:Ge})}})}}},[y]),nn=c.useCallback((M,_)=>(W,Z)=>{const G=W.nativeEvent,ee=y.get(Z);if(F.current!==null||!ee||G.dndKit||G.defaultPrevented)return;const te={active:ee};M(W,_.options,te)===!0&&(G.dndKit={capturedBy:_.sensor},F.current=Z,Pt(W,_))},[y,Pt]),k=po(f,nn);So(f),Le(()=>{B&&h===Xe.Initializing&&E(Xe.Initialized)},[B,h]),c.useEffect(()=>{const{onDragMove:M}=q.current,{active:_,activatorEvent:W,collisions:Z,over:G}=je.current;if(!_||!W)return;const ee={active:_,activatorEvent:W,collisions:Z,delta:{x:Ie.x,y:Ie.y},over:G};gt.unstable_batchedUpdates(()=>{M==null||M(ee),v({type:"onDragMove",event:ee})})},[Ie.x,Ie.y]),c.useEffect(()=>{const{active:M,activatorEvent:_,collisions:W,droppableContainers:Z,scrollAdjustedTranslate:G}=je.current;if(!M||F.current==null||!_||!G)return;const{onDragOver:ee}=q.current,te=Z.get(Ot),me=te&&te.rect.current?{id:te.id,rect:te.rect.current,data:te.data,disabled:te.disabled}:null,Q={active:M,activatorEvent:_,collisions:W,delta:{x:G.x,y:G.y},over:me};gt.unstable_batchedUpdates(()=>{lt(me),ee==null||ee(Q),v({type:"onDragOver",event:Q})})},[Ot]),Le(()=>{je.current={activatorEvent:O,active:L,activeNode:ge,collisionRect:qe,collisions:Ye,droppableRects:he,draggableNodes:y,draggingNode:We,draggingNodeRect:Me,droppableContainers:P,over:xe,scrollableAncestors:Te,scrollAdjustedTranslate:Ie},z.current={initial:Me,translated:qe}},[L,ge,Ye,qe,y,We,Me,he,P,xe,Te,Ie]),fo({...pe,delta:I,draggingRect:qe,pointerCoordinates:Mt,scrollableAncestors:Te,scrollableAncestorRects:Qe});const U=c.useMemo(()=>({active:L,activeNode:ge,activeNodeRect:B,activatorEvent:O,collisions:Ye,containerNodeRect:De,dragOverlay:Ee,draggableNodes:y,droppableContainers:P,droppableRects:he,over:xe,measureDroppableContainers:Ce,scrollableAncestors:Te,scrollableAncestorRects:Qe,measuringConfiguration:fe,measuringScheduled:Be,windowRect:Fe}),[L,ge,B,O,Ye,De,Ee,y,P,he,xe,Ce,Te,Qe,fe,Be,Fe]),H=c.useMemo(()=>({activatorEvent:O,activators:k,active:L,activeNodeRect:B,ariaDescribedById:{draggable:ie},dispatch:x,draggableNodes:y,over:xe,measureDroppableContainers:Ce}),[O,k,L,B,x,ie,y,xe,Ce]);return D.createElement(kr.Provider,{value:j},D.createElement(Jt.Provider,{value:H},D.createElement(_r.Provider,{value:U},D.createElement(qr.Provider,{value:tn},m)),D.createElement(Po,{disabled:(d==null?void 0:d.restoreFocus)===!1})),D.createElement(Pa,{...d,hiddenTextDescribedById:ie}));function V(){const M=(Y==null?void 0:Y.autoScrollEnabled)===!1,_=typeof u=="object"?u.enabled===!1:u===!1,W=T&&!M&&!_;return typeof u=="object"?{...u,enabled:W}:{enabled:W}}}),Uo=c.createContext(null),ir="button",Wo="Draggable";function Fo(e){let{id:t,data:r,disabled:s=!1,attributes:a}=e;const o=It(Wo),{activators:i,activatorEvent:d,active:u,activeNodeRect:m,ariaDescribedById:f,draggableNodes:l,over:g}=c.useContext(Jt),{role:p=ir,roleDescription:S="draggable",tabIndex:b=0}=a??{},w=(u==null?void 0:u.id)===t,x=c.useContext(w?qr:Uo),[v,j]=Vt(),[h,E]=Vt(),T=Co(i,t),N=wt(r);Le(()=>(l.set(t,{id:t,key:o,node:v,activatorNode:h,data:N}),()=>{const I=l.get(t);I&&I.key===o&&l.delete(t)}),[l,t]);const y=c.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":s,"aria-pressed":w&&p===ir?!0:void 0,"aria-roledescription":S,"aria-describedby":f.draggable}),[s,p,b,w,S,f.draggable]);return{active:u,activatorEvent:d,activeNodeRect:m,attributes:y,isDragging:w,listeners:s?void 0:T,node:v,over:g,setNodeRef:j,setActivatorNodeRef:E,transform:x}}function Ho(){return c.useContext(_r)}const Vo="Droppable",_o={timeout:25};function qo(e){let{data:t,disabled:r=!1,id:s,resizeObserverConfig:a}=e;const o=It(Vo),{active:i,dispatch:d,over:u,measureDroppableContainers:m}=c.useContext(Jt),f=c.useRef({disabled:r}),l=c.useRef(!1),g=c.useRef(null),p=c.useRef(null),{disabled:S,updateMeasurementsFor:b,timeout:w}={..._o,...a},x=wt(b??s),v=c.useCallback(()=>{if(!l.current){l.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{m(Array.isArray(x.current)?x.current:[x.current]),p.current=null},w)},[w]),j=Kt({callback:v,disabled:S||!i}),h=c.useCallback((y,I)=>{j&&(I&&(j.unobserve(I),l.current=!1),y&&j.observe(y))},[j]),[E,T]=Vt(h),N=wt(t);return c.useEffect(()=>{!j||!E.current||(j.disconnect(),l.current=!1,j.observe(E.current))},[E,j]),c.useEffect(()=>(d({type:ae.RegisterDroppable,element:{id:s,key:o,disabled:r,node:E,rect:g,data:N}}),()=>d({type:ae.UnregisterDroppable,key:o,id:s})),[s]),c.useEffect(()=>{r!==f.current.disabled&&(d({type:ae.SetDroppableDisabled,id:s,key:o,disabled:r}),f.current.disabled=r)},[s,o,r,d]),{active:i,rect:g,isOver:(u==null?void 0:u.id)===s,node:E,over:u,setNodeRef:T}}function Ln(e,t,r){const s=e.slice();return s.splice(r<0?s.length+r:r,0,s.splice(t,1)[0]),s}function Yo(e,t){return e.reduce((r,s,a)=>{const o=t.get(s);return o&&(r[a]=o),r},Array(e.length))}function Lt(e){return e!==null&&e>=0}function Go(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Xo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const $n=e=>{let{rects:t,activeIndex:r,overIndex:s,index:a}=e;const o=Ln(t,s,r),i=t[a],d=o[a];return!d||!i?null:{x:d.left-i.left,y:d.top-i.top,scaleX:d.width/i.width,scaleY:d.height/i.height}},Yr="Sortable",Gr=D.createContext({activeIndex:-1,containerId:Yr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:$n,disabled:{draggable:!1,droppable:!1}});function Ko(e){let{children:t,id:r,items:s,strategy:a=$n,disabled:o=!1}=e;const{active:i,dragOverlay:d,droppableRects:u,over:m,measureDroppableContainers:f}=Ho(),l=It(Yr,r),g=d.rect!==null,p=c.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),S=i!=null,b=i?p.indexOf(i.id):-1,w=m?p.indexOf(m.id):-1,x=c.useRef(p),v=!Go(p,x.current),j=w!==-1&&b===-1||v,h=Xo(o);Le(()=>{v&&S&&f(p)},[v,p,S,f]),c.useEffect(()=>{x.current=p},[p]);const E=c.useMemo(()=>({activeIndex:b,containerId:l,disabled:h,disableTransforms:j,items:p,overIndex:w,useDragOverlay:g,sortedRects:Yo(p,u),strategy:a}),[b,l,h.draggable,h.droppable,j,p,w,u,g,a]);return D.createElement(Gr.Provider,{value:E},t)}const Jo=e=>{let{id:t,items:r,activeIndex:s,overIndex:a}=e;return Ln(r,s,a).indexOf(t)},Zo=e=>{let{containerId:t,isSorting:r,wasDragging:s,index:a,items:o,newIndex:i,previousItems:d,previousContainerId:u,transition:m}=e;return!m||!s||d!==o&&a===i?!1:r?!0:i!==a&&t===u},Qo={duration:200,easing:"ease"},Xr="transform",ei=Nt.Transition.toString({property:Xr,duration:0,easing:"linear"}),ti={roleDescription:"sortable"};function ni(e){let{disabled:t,index:r,node:s,rect:a}=e;const[o,i]=c.useState(null),d=c.useRef(r);return Le(()=>{if(!t&&r!==d.current&&s.current){const u=a.current;if(u){const m=at(s.current,{ignoreTransform:!0}),f={x:u.left-m.left,y:u.top-m.top,scaleX:u.width/m.width,scaleY:u.height/m.height};(f.x||f.y)&&i(f)}}r!==d.current&&(d.current=r)},[t,r,s,a]),c.useEffect(()=>{o&&i(null)},[o]),o}function ri(e){let{animateLayoutChanges:t=Zo,attributes:r,disabled:s,data:a,getNewIndex:o=Jo,id:i,strategy:d,resizeObserverConfig:u,transition:m=Qo}=e;const{items:f,containerId:l,activeIndex:g,disabled:p,disableTransforms:S,sortedRects:b,overIndex:w,useDragOverlay:x,strategy:v}=c.useContext(Gr),j=si(s,p),h=f.indexOf(i),E=c.useMemo(()=>({sortable:{containerId:l,index:h,items:f},...a}),[l,a,h,f]),T=c.useMemo(()=>f.slice(f.indexOf(i)),[f,i]),{rect:N,node:y,isOver:I,setNodeRef:P}=qo({id:i,data:E,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...u}}),{active:C,activatorEvent:z,activeNodeRect:L,attributes:F,setNodeRef:Y,listeners:R,isDragging:O,over:J,setActivatorNodeRef:q,transform:ie}=Fo({id:i,data:E,attributes:{...ti,...r},disabled:j.draggable}),ye=ja(P,Y),fe=!!C,he=fe&&!S&&Lt(g)&&Lt(w),Ce=!x&&O,Be=Ce&&he?ie:null,Ue=he?Be??(d??v)({rects:b,activeNodeRect:L,activeIndex:g,overIndex:w,index:h}):null,pe=Lt(g)&&Lt(w)?o({id:i,items:f,activeIndex:g,overIndex:w}):h,we=C==null?void 0:C.id,B=c.useRef({activeId:we,items:f,newIndex:pe,containerId:l}),De=f!==B.current.items,je=t({active:C,containerId:l,isDragging:O,isSorting:fe,id:i,index:h,items:f,newIndex:B.current.newIndex,previousItems:B.current.items,previousContainerId:B.current.containerId,transition:m,wasDragging:B.current.activeId!=null}),A=ni({disabled:!je,index:h,node:y,rect:N});return c.useEffect(()=>{fe&&B.current.newIndex!==pe&&(B.current.newIndex=pe),l!==B.current.containerId&&(B.current.containerId=l),f!==B.current.items&&(B.current.items=f)},[fe,pe,l,f]),c.useEffect(()=>{if(we===B.current.activeId)return;if(we!=null&&B.current.activeId==null){B.current.activeId=we;return}const We=setTimeout(()=>{B.current.activeId=we},50);return()=>clearTimeout(We)},[we]),{active:C,activeIndex:g,attributes:F,data:E,rect:N,index:h,newIndex:pe,items:f,isOver:I,isSorting:fe,isDragging:O,listeners:R,node:y,overIndex:w,over:J,setNodeRef:ye,setActivatorNodeRef:q,setDroppableNodeRef:P,setDraggableNodeRef:Y,transform:A??Ue,transition:Ee()};function Ee(){if(A||De&&B.current.newIndex===h)return ei;if(!(Ce&&!An(z)||!m)&&(fe||je))return Nt.Transition.toString({...m,property:Xr})}}function si(e,t){var r,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}function Yt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ai=[$.Down,$.Right,$.Up,$.Left],oi=(e,t)=>{let{context:{active:r,collisionRect:s,droppableRects:a,droppableContainers:o,over:i,scrollableAncestors:d}}=t;if(ai.includes(e.code)){if(e.preventDefault(),!r||!s)return;const u=[];o.getEnabled().forEach(l=>{if(!l||l!=null&&l.disabled)return;const g=a.get(l.id);if(g)switch(e.code){case $.Down:s.top<g.top&&u.push(l);break;case $.Up:s.top>g.top&&u.push(l);break;case $.Left:s.left>g.left&&u.push(l);break;case $.Right:s.left<g.left&&u.push(l);break}});const m=Ba({active:r,collisionRect:s,droppableRects:a,droppableContainers:u,pointerCoordinates:null});let f=Or(m,"id");if(f===(i==null?void 0:i.id)&&m.length>1&&(f=m[1].id),f!=null){const l=o.get(r.id),g=o.get(f),p=g?a.get(g.id):null,S=g==null?void 0:g.node.current;if(S&&p&&l&&g){const w=Xt(S).some((T,N)=>d[N]!==T),x=Kr(l,g),v=ii(l,g),j=w||!x?{x:0,y:0}:{x:v?s.width-p.width:0,y:v?s.height-p.height:0},h={x:p.left,y:p.top};return j.x&&j.y?h:jt(h,j)}}}};function Kr(e,t){return!Yt(e)||!Yt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ii(e,t){return!Yt(e)||!Yt(t)||!Kr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const $t=[{id:"metrics-carousel",type:"metrics-carousel",title:"Mtricas Financieras",description:"Diferencia neta, negativos y positivos",icon:Ft,visible:!0,order:0,size:"small",mandatory:!0},{id:"active-products",type:"active-products",title:"Productos Activos",description:"Total de productos en inventarios",icon:Dr,visible:!0,order:1,size:"small"},{id:"inventory-summary",type:"inventory-summary",title:"Resumen de Inventario",description:"Progreso de productos en stock",icon:mr,visible:!0,order:2,size:"large"},{id:"inventory-alerts",type:"inventory-alerts",title:"Alertas de Inventario",description:"Notificaciones importantes",icon:pt,visible:!0,order:3,size:"large"},{id:"upcoming-inventories",type:"upcoming-inventories",title:"Prximos Inventarios",description:"Inventarios programados",icon:Er,visible:!0,order:4,size:"large"},{id:"branches-table",type:"branches-table",title:"Tabla de Sucursales",description:"Listado completo de sucursales",icon:ha,visible:!0,order:5,size:"full"},{id:"inventory-progress",type:"inventory-progress",title:"Progreso de Inventarios",description:"Porcentaje de inventarios completados",icon:nt,visible:!1,order:6,size:"small"},{id:"critical-products",type:"critical-products",title:"Productos Crticos",description:"Productos con stock bajo o agotados",icon:Dn,visible:!1,order:7,size:"small"},{id:"total-stock-value",type:"total-stock-value",title:"Valor Total de Stock",description:"Valor monetario total del inventario",icon:Ft,visible:!1,order:8,size:"small"},{id:"active-users",type:"active-users",title:"Usuarios Activos",description:"Usuarios trabajando en tiempo real",icon:Rr,visible:!1,order:9,size:"small"},{id:"pending-inventories",type:"pending-inventories",title:"Inventarios Pendientes",description:"Inventarios sin completar",icon:Dt,visible:!1,order:10,size:"small"},{id:"trends-chart",type:"trends-chart",title:"Grfico de Tendencias",description:"Evolucin de diferencias en el tiempo",icon:ga,visible:!1,order:11,size:"large"},{id:"top-products",type:"top-products",title:"Top Productos con Diferencias",description:"Productos con mayores discrepancias",icon:ya,visible:!1,order:12,size:"large"},{id:"activity-timeline",type:"activity-timeline",title:"Actividad Reciente",description:"Timeline de ltimas acciones",icon:Ls,visible:!1,order:13,size:"large"},{id:"category-distribution",type:"category-distribution",title:"Distribucin por Categora",description:"Porcentaje de productos por categora",icon:Yn,visible:!1,order:14,size:"large"},{id:"monthly-goals",type:"monthly-goals",title:"Objetivos del Mes",description:"Progreso hacia metas mensuales",icon:yr,visible:!1,order:15,size:"large"},{id:"sync-status",type:"sync-status",title:"Estado de Sincronizacin",description:"Conexin y datos pendientes",icon:wr,visible:!1,order:16,size:"large"},{id:"quick-actions",type:"quick-actions",title:"Acciones Rpidas",description:"Tareas frecuentes",icon:wa,visible:!1,order:17,size:"large"},{id:"countdown",type:"countdown",title:"Contador de Das",description:"Das restantes para finalizar conteo cclico",icon:Ht,visible:!0,order:6,size:"small"},{id:"category-progress",type:"category-progress",title:"Progreso por Rubros",description:"Avance de inventario por categora",icon:Yn,visible:!0,order:7,size:"large"}];function li(e){const t=`dashboard-layout-v2-${e||"default"}`,[r,s]=c.useState(()=>{try{const l=localStorage.getItem(t);if(l){const g=JSON.parse(l);return $t.map(S=>{const b=g.widgets.find(w=>w.id===S.id);return b?{...S,visible:b.visible,order:b.order,...S.mandatory?{visible:!0}:{}}:S}).sort((S,b)=>S.order-b.order)}}catch(l){console.error("Error loading dashboard layout:",l)}return $t}),[a,o]=c.useState(!1);c.useEffect(()=>{const g={widgets:r.map(({id:p,visible:S,order:b})=>({id:p,visible:S,order:b})),lastUpdated:Date.now()};localStorage.setItem(t,JSON.stringify(g))},[r,t]);const i=(l,g)=>{s(p=>{const S=p.findIndex(x=>x.id===l),b=p.findIndex(x=>x.id===g);return Ln(p,S,b).map((x,v)=>({...x,order:v}))})},d=l=>{s(g=>g.map(p=>p.id===l&&!p.mandatory?{...p,visible:!p.visible}:p))},u=()=>{s($t),o(!1)};c.useEffect(()=>{r.every(g=>g.title&&g.icon)||(console.warn("Detected corrupted widget state, resetting to defaults"),s($t))},[r]);const m=r.filter(l=>l.visible).sort((l,g)=>l.order-g.order),f=r.filter(l=>!l.visible).sort((l,g)=>(l.title||"").localeCompare(g.title||""));return{widgets:r,visibleWidgets:m,hiddenWidgets:f,isEditMode:a,setIsEditMode:o,reorderWidgets:i,toggleWidgetVisibility:d,resetLayout:u}}const ci={small:"col-span-1",medium:"col-span-1 md:col-span-2",large:"col-span-1",full:"col-span-full"};function mn({widget:e,isEditMode:t,onRemove:r,children:s}){const{attributes:a,listeners:o,setNodeRef:i,transform:d,transition:u,isDragging:m}=ri({id:e.id,disabled:!t}),f={transform:Nt.Transform.toString(d),transition:u};return n.jsx("div",{ref:i,style:f,className:Ne(ci[e.size],m&&"opacity-50 z-50",t&&"cursor-move"),children:n.jsxs("div",{className:Ne("relative h-full transition-all rounded-lg",t&&"ring-2 ring-primary/20 hover:ring-primary/40"),children:[t&&n.jsxs("div",{className:"absolute top-2 right-2 z-10 flex gap-1",children:[n.jsx(oe,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-grab active:cursor-grabbing",...a,...o,children:n.jsx(pa,{className:"h-4 w-4"})}),!e.mandatory&&r&&n.jsx(oe,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive hover:text-destructive-foreground",onClick:r,children:n.jsx(hr,{className:"h-4 w-4"})})]}),s]})})}function di(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Jr=D.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),ot=()=>{const e=D.useContext(Jr);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};di(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const ui=24,fi=typeof window<"u"?c.useLayoutEffect:c.useEffect;function lr(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}function mi(){return Bn(/^Mac/)}function hi(){return Bn(/^iPhone/)}function cr(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function gi(){return Bn(/^iPad/)||mi()&&navigator.maxTouchPoints>1}function Zr(){return hi()||gi()}function Bn(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const hn=typeof document<"u"&&window.visualViewport;function dr(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function Qr(e){for(dr(e)&&(e=e.parentElement);e&&!dr(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const pi=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Bt=0,gn;function xi(e={}){let{isDisabled:t}=e;fi(()=>{if(!t)return Bt++,Bt===1&&Zr()&&(gn=vi()),()=>{Bt--,Bt===0&&(gn==null||gn())}},[t])}function vi(){let e,t=0,r=l=>{e=Qr(l.target),!(e===document.documentElement&&e===document.body)&&(t=l.changedTouches[0].pageY)},s=l=>{if(!e||e===document.documentElement||e===document.body){l.preventDefault();return}let g=l.changedTouches[0].pageY,p=e.scrollTop,S=e.scrollHeight-e.clientHeight;S!==0&&((p<=0&&g>t||p>=S&&g<t)&&l.preventDefault(),t=g)},a=l=>{let g=l.target;Sn(g)&&g!==document.activeElement&&(l.preventDefault(),g.style.transform="translateY(-2000px)",g.focus(),requestAnimationFrame(()=>{g.style.transform=""}))},o=l=>{let g=l.target;Sn(g)&&(g.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{g.style.transform="",hn&&(hn.height<window.innerHeight?requestAnimationFrame(()=>{ur(g)}):hn.addEventListener("resize",()=>ur(g),{once:!0}))}))},i=()=>{window.scrollTo(0,0)},d=window.pageXOffset,u=window.pageYOffset,m=lr(bi(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let f=lr(mt(document,"touchstart",r,{passive:!1,capture:!0}),mt(document,"touchmove",s,{passive:!1,capture:!0}),mt(document,"touchend",a,{passive:!1,capture:!0}),mt(document,"focus",o,!0),mt(window,"scroll",i));return()=>{m(),f(),window.scrollTo(d,u)}}function bi(e,t,r){let s=e.style[t];return e.style[t]=r,()=>{e.style[t]=s}}function mt(e,t,r,s){return e.addEventListener(t,r,s),()=>{e.removeEventListener(t,r,s)}}function ur(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=Qr(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let s=r.getBoundingClientRect().top,a=e.getBoundingClientRect().top,o=e.getBoundingClientRect().bottom;const i=r.getBoundingClientRect().bottom+ui;o>i&&(r.scrollTop+=a-s)}e=r.parentElement}}function Sn(e){return e instanceof HTMLInputElement&&!pi.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function yi(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function wi(...e){return t=>e.forEach(r=>yi(r,t))}function es(...e){return c.useCallback(wi(...e),e)}const ts=new WeakMap;function re(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let s={};Object.entries(t).forEach(([a,o])=>{if(a.startsWith("--")){e.style.setProperty(a,o);return}s[a]=e.style[a],e.style[a]=o}),!r&&ts.set(e,s)}function ji(e,t){if(!e||!(e instanceof HTMLElement))return;let r=ts.get(e);r&&(e.style[t]=r[t])}const se=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function Ut(e,t){if(!e)return null;const r=window.getComputedStyle(e),s=r.transform||r.webkitTransform||r.mozTransform;let a=s.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[se(t)?13:12]):(a=s.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[se(t)?5:4]):null)}function Ni(e){return 8*(Math.log(e+1)-2)}function pn(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function Si(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const X={DURATION:.5,EASE:[.32,.72,0,1]},ns=.4,Ci=.25,Di=100,rs=8,Je=16,Cn=26,xn="vaul-dragging";function ss(e){const t=D.useRef(e);return D.useEffect(()=>{t.current=e}),D.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function Ei({defaultProp:e,onChange:t}){const r=D.useState(e),[s]=r,a=D.useRef(s),o=ss(t);return D.useEffect(()=>{a.current!==s&&(o(s),a.current=s)},[s,a,o]),r}function as({prop:e,defaultProp:t,onChange:r=()=>{}}){const[s,a]=Ei({defaultProp:t,onChange:r}),o=e!==void 0,i=o?e:s,d=ss(r),u=D.useCallback(m=>{if(o){const l=typeof m=="function"?m(e):m;l!==e&&d(l)}else a(m)},[o,e,a,d]);return[i,u]}function Ri({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:s,overlayRef:a,fadeFromIndex:o,onSnapPointChange:i,direction:d="bottom",container:u,snapToSequentialPoint:m}){const[f,l]=as({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[g,p]=D.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);D.useEffect(()=>{function N(){p({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const S=D.useMemo(()=>f===(r==null?void 0:r[r.length-1])||null,[r,f]),b=D.useMemo(()=>r==null?void 0:r.findIndex(N=>N===f),[r,f]),w=r&&r.length>0&&(o||o===0)&&!Number.isNaN(o)&&r[o]===f||!r,x=D.useMemo(()=>{const N=u?{width:u.getBoundingClientRect().width,height:u.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var y;return(y=r==null?void 0:r.map(I=>{const P=typeof I=="string";let C=0;if(P&&(C=parseInt(I,10)),se(d)){const L=P?C:g?I*N.height:0;return g?d==="bottom"?N.height-L:-N.height+L:L}const z=P?C:g?I*N.width:0;return g?d==="right"?N.width-z:-N.width+z:z}))!=null?y:[]},[r,g,u]),v=D.useMemo(()=>b!==null?x==null?void 0:x[b]:null,[x,b]),j=D.useCallback(N=>{var y;const I=(y=x==null?void 0:x.findIndex(P=>P===N))!=null?y:null;i(I),re(s.current,{transition:`transform ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,transform:se(d)?`translate3d(0, ${N}px, 0)`:`translate3d(${N}px, 0, 0)`}),x&&I!==x.length-1&&I!==o&&I<o?re(a.current,{transition:`opacity ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,opacity:"0"}):re(a.current,{transition:`opacity ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,opacity:"1"}),l(r==null?void 0:r[Math.max(I,0)])},[s.current,r,x,o,a,l]);D.useEffect(()=>{if(f||e){var N;const y=(N=r==null?void 0:r.findIndex(I=>I===e||I===f))!=null?N:-1;x&&y!==-1&&typeof x[y]=="number"&&j(x[y])}},[f,e,r,x,j]);function h({draggedDistance:N,closeDrawer:y,velocity:I,dismissible:P}){if(o===void 0)return;const C=d==="bottom"||d==="right"?(v??0)-N:(v??0)+N,z=b===o-1,L=b===0,F=N>0;if(z&&re(a.current,{transition:`opacity ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`}),!m&&I>2&&!F){P?y():j(x[0]);return}if(!m&&I>2&&F&&x&&r){j(x[r.length-1]);return}const Y=x==null?void 0:x.reduce((O,J)=>typeof O!="number"||typeof J!="number"?O:Math.abs(J-C)<Math.abs(O-C)?J:O),R=se(d)?window.innerHeight:window.innerWidth;if(I>ns&&Math.abs(N)<R*.4){const O=F?1:-1;if(O>0&&S){j(x[r.length-1]);return}if(L&&O<0&&P&&y(),b===null)return;j(x[b+O]);return}j(Y)}function E({draggedDistance:N}){if(v===null)return;const y=d==="bottom"||d==="right"?v-N:v+N;(d==="bottom"||d==="right")&&y<x[x.length-1]||(d==="top"||d==="left")&&y>x[x.length-1]||re(s.current,{transform:se(d)?`translate3d(0, ${y}px, 0)`:`translate3d(${y}px, 0, 0)`})}function T(N,y){if(!r||typeof b!="number"||!x||o===void 0)return null;const I=b===o-1;if(b>=o&&y)return 0;if(I&&!y)return 1;if(!w&&!I)return null;const C=I?b+1:b-1,z=I?x[C]-x[C-1]:x[C+1]-x[C],L=N/Math.abs(z);return I?1-L:L}return{isLastSnapPoint:S,activeSnapPoint:f,shouldFade:w,getPercentageDragged:T,setActiveSnapPoint:l,activeSnapPointIndex:b,onRelease:h,onDrag:E,snapPointsOffset:x}}const Ti=()=>()=>{};function Ii(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:s,noBodyStyles:a}=ot(),o=D.useRef(null),i=c.useMemo(()=>document.body.style.backgroundColor,[]);function d(){return(window.innerWidth-Cn)/window.innerWidth}D.useEffect(()=>{if(t&&r){o.current&&clearTimeout(o.current);const u=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!u)return;Si(s&&!a?pn(document.body,{background:"black"}):Ti,pn(u,{transformOrigin:se(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${X.DURATION}s`,transitionTimingFunction:`cubic-bezier(${X.EASE.join(",")})`}));const m=pn(u,{borderRadius:`${rs}px`,overflow:"hidden",...se(e)?{transform:`scale(${d()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${d()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{m(),o.current=window.setTimeout(()=>{i?document.body.style.background=i:document.body.style.removeProperty("background")},X.DURATION*1e3)}}},[t,r,i])}let ht=null;function ki({isOpen:e,modal:t,nested:r,hasBeenOpened:s,preventScrollRestoration:a,noBodyStyles:o}){const[i,d]=D.useState(()=>typeof window<"u"?window.location.href:""),u=D.useRef(0),m=D.useCallback(()=>{if(cr()&&ht===null&&e&&!o){ht={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:l,innerHeight:g}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-u.current}px`,left:`${-l}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const p=g-window.innerHeight;p&&u.current>=g&&(document.body.style.top=`${-(u.current+p)}px`)}),300)}},[e]),f=D.useCallback(()=>{if(cr()&&ht!==null&&!o){const l=-parseInt(document.body.style.top,10),g=-parseInt(document.body.style.left,10);Object.assign(document.body.style,ht),window.requestAnimationFrame(()=>{if(a&&i!==window.location.href){d(window.location.href);return}window.scrollTo(g,l)}),ht=null}},[i]);return D.useEffect(()=>{function l(){u.current=window.scrollY}return l(),window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}},[]),D.useEffect(()=>{r||!s||(e?(!window.matchMedia("(display-mode: standalone)").matches&&m(),t||window.setTimeout(()=>{f()},500)):f())},[e,s,i,t,r,m,f]),{restorePositionSetting:f}}function os({open:e,onOpenChange:t,children:r,onDrag:s,onRelease:a,snapPoints:o,shouldScaleBackground:i=!1,setBackgroundColorOnScale:d=!0,closeThreshold:u=Ci,scrollLockTimeout:m=Di,dismissible:f=!0,handleOnly:l=!1,fadeFromIndex:g=o&&o.length-1,activeSnapPoint:p,setActiveSnapPoint:S,fixed:b,modal:w=!0,onClose:x,nested:v,noBodyStyles:j,direction:h="bottom",defaultOpen:E=!1,disablePreventScroll:T=!0,snapToSequentialPoint:N=!1,preventScrollRestoration:y=!1,repositionInputs:I=!0,onAnimationEnd:P,container:C,autoFocus:z=!1}){var L,F;const[Y=!1,R]=as({defaultProp:E,prop:e,onChange:k=>{t==null||t(k),!k&&!v&&Qt(),setTimeout(()=>{P==null||P(k)},X.DURATION*1e3),k&&!w&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),k||(document.body.style.pointerEvents="auto")}}),[O,J]=D.useState(!1),[q,ie]=D.useState(!1),[ye,fe]=D.useState(!1),he=D.useRef(null),Ce=D.useRef(null),Be=D.useRef(null),ge=D.useRef(null),Ue=D.useRef(null),pe=D.useRef(!1),we=D.useRef(null),B=D.useRef(0),De=D.useRef(!1),je=D.useRef(0),A=D.useRef(null),Ee=D.useRef(((L=A.current)==null?void 0:L.getBoundingClientRect().height)||0),We=D.useRef(((F=A.current)==null?void 0:F.getBoundingClientRect().width)||0),Me=D.useRef(0),kt=D.useCallback(k=>{o&&k===Oe.length-1&&(Ce.current=new Date)},[]),{activeSnapPoint:At,activeSnapPointIndex:Fe,setActiveSnapPoint:Te,onRelease:Qe,snapPointsOffset:Oe,onDrag:Mt,shouldFade:it,getPercentageDragged:Zt}=Ri({snapPoints:o,activeSnapPointProp:p,setActiveSnapPointProp:S,drawerRef:A,fadeFromIndex:g,overlayRef:he,onSnapPointChange:kt,direction:h,container:C,snapToSequentialPoint:N});xi({isDisabled:!Y||q||!w||ye||!O||!I||!T});const{restorePositionSetting:Qt}=ki({isOpen:Y,modal:w,nested:v,hasBeenOpened:O,preventScrollRestoration:y,noBodyStyles:j});function Ie(){return(window.innerWidth-Cn)/window.innerWidth}function qe(k){var U,H;!f&&!o||A.current&&!A.current.contains(k.target)||(Ee.current=((U=A.current)==null?void 0:U.getBoundingClientRect().height)||0,We.current=((H=A.current)==null?void 0:H.getBoundingClientRect().width)||0,ie(!0),Be.current=new Date,Zr()&&window.addEventListener("touchend",()=>pe.current=!1,{once:!0}),k.target.setPointerCapture(k.pointerId),B.current=se(h)?k.pageY:k.pageX)}function Ye(k,U){var H,V;let M=k;const _=(H=window.getSelection())==null?void 0:H.toString(),W=A.current?Ut(A.current,h):null,Z=new Date;if(M.hasAttribute("data-vaul-no-drag")||M.closest("[data-vaul-no-drag]"))return!1;if(h==="right"||h==="left")return!0;if(Ce.current&&Z.getTime()-Ce.current.getTime()<500)return!1;if(W!==null&&(h==="bottom"?W>0:W<0))return!0;if(_&&_.length>0)return!1;if(Z.getTime()-((V=Ue.current)==null?void 0:V.getTime())<m&&W===0||U)return Ue.current=Z,!1;for(;M;){if(M.scrollHeight>M.clientHeight){if(M.scrollTop!==0)return Ue.current=new Date,!1;if(M.getAttribute("role")==="dialog")return!0}M=M.parentNode}return!0}function Ot(k){if(A.current&&q){const U=h==="bottom"||h==="right"?1:-1,H=(B.current-(se(h)?k.pageY:k.pageX))*U,V=H>0,M=o&&!f&&!V;if(M&&Fe===0)return;const _=Math.abs(H),W=document.querySelector("[data-vaul-drawer-wrapper]"),Z=h==="bottom"||h==="top"?Ee.current:We.current;let G=_/Z;const ee=Zt(_,V);if(ee!==null&&(G=ee),M&&G>=1||!pe.current&&!Ye(k.target,V))return;if(A.current.classList.add(xn),pe.current=!0,re(A.current,{transition:"none"}),re(he.current,{transition:"none"}),o&&Mt({draggedDistance:H}),V&&!o){const me=Ni(H),Q=Math.min(me*-1,0)*U;re(A.current,{transform:se(h)?`translate3d(0, ${Q}px, 0)`:`translate3d(${Q}px, 0, 0)`});return}const te=1-G;if((it||g&&Fe===g-1)&&(s==null||s(k,G),re(he.current,{opacity:`${te}`,transition:"none"},!0)),W&&he.current&&i){const me=Math.min(Ie()+G*(1-Ie()),1),Q=8-G*8,ke=Math.max(0,14-G*14);re(W,{borderRadius:`${Q}px`,transform:se(h)?`scale(${me}) translate3d(0, ${ke}px, 0)`:`scale(${me}) translate3d(${ke}px, 0, 0)`,transition:"none"},!0)}if(!o){const me=_*U;re(A.current,{transform:se(h)?`translate3d(0, ${me}px, 0)`:`translate3d(${me}px, 0, 0)`})}}}D.useEffect(()=>{var k;function U(){if(!A.current||!I)return;const H=document.activeElement;if(Sn(H)||De.current){var V;const M=((V=window.visualViewport)==null?void 0:V.height)||0,_=window.innerHeight;let W=_-M;const Z=A.current.getBoundingClientRect().height||0,G=Z>_*.8;Me.current||(Me.current=Z);const ee=A.current.getBoundingClientRect().top;if(Math.abs(je.current-W)>60&&(De.current=!De.current),o&&o.length>0&&Oe&&Fe){const te=Oe[Fe]||0;W+=te}if(je.current=W,Z>M||De.current){const te=A.current.getBoundingClientRect().height;let me=te;te>M&&(me=M-(G?ee:Cn)),b?A.current.style.height=`${te-Math.max(W,0)}px`:A.current.style.height=`${Math.max(me,M-ee)}px`}else A.current.style.height=`${Me.current}px`;o&&o.length>0&&!De.current?A.current.style.bottom="0px":A.current.style.bottom=`${Math.max(W,0)}px`}}return(k=window.visualViewport)==null||k.addEventListener("resize",U),()=>{var H;return(H=window.visualViewport)==null?void 0:H.removeEventListener("resize",U)}},[Fe,o,Oe]);function xe(k){en(),x==null||x(),k||R(!1),setTimeout(()=>{o&&Te(o[0])},X.DURATION*1e3)}function lt(){if(!A.current)return;const k=document.querySelector("[data-vaul-drawer-wrapper]"),U=Ut(A.current,h);re(A.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`}),re(he.current,{transition:`opacity ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,opacity:"1"}),i&&U&&U>0&&Y&&re(k,{borderRadius:`${rs}px`,overflow:"hidden",...se(h)?{transform:`scale(${Ie()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Ie()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${X.DURATION}s`,transitionTimingFunction:`cubic-bezier(${X.EASE.join(",")})`},!0)}function en(){!q||!A.current||(A.current.classList.remove(xn),pe.current=!1,ie(!1),ge.current=new Date)}function tn(k){if(!q||!A.current)return;A.current.classList.remove(xn),pe.current=!1,ie(!1),ge.current=new Date;const U=Ut(A.current,h);if(!Ye(k.target,!1)||!U||Number.isNaN(U)||Be.current===null)return;const H=ge.current.getTime()-Be.current.getTime(),V=B.current-(se(h)?k.pageY:k.pageX),M=Math.abs(V)/H;if(M>.05&&(fe(!0),setTimeout(()=>{fe(!1)},200)),o){Qe({draggedDistance:V*(h==="bottom"||h==="right"?1:-1),closeDrawer:xe,velocity:M,dismissible:f}),a==null||a(k,!0);return}if(h==="bottom"||h==="right"?V>0:V<0){lt(),a==null||a(k,!0);return}if(M>ns){xe(),a==null||a(k,!1);return}var _;const W=Math.min((_=A.current.getBoundingClientRect().height)!=null?_:0,window.innerHeight);var Z;const G=Math.min((Z=A.current.getBoundingClientRect().width)!=null?Z:0,window.innerWidth),ee=h==="left"||h==="right";if(Math.abs(U)>=(ee?G:W)*u){xe(),a==null||a(k,!1);return}a==null||a(k,!0),lt()}D.useEffect(()=>(Y&&(re(document.documentElement,{scrollBehavior:"auto"}),Ce.current=new Date),()=>{ji(document.documentElement,"scrollBehavior")}),[Y]);function ct(k){const U=k?(window.innerWidth-Je)/window.innerWidth:1,H=k?-Je:0;we.current&&window.clearTimeout(we.current),re(A.current,{transition:`transform ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,transform:`scale(${U}) translate3d(0, ${H}px, 0)`}),!k&&A.current&&(we.current=setTimeout(()=>{const V=Ut(A.current,h);re(A.current,{transition:"none",transform:se(h)?`translate3d(0, ${V}px, 0)`:`translate3d(${V}px, 0, 0)`})},500))}function Pt(k,U){if(U<0)return;const H=(window.innerWidth-Je)/window.innerWidth,V=H+U*(1-H),M=-Je+U*Je;re(A.current,{transform:se(h)?`scale(${V}) translate3d(0, ${M}px, 0)`:`scale(${V}) translate3d(${M}px, 0, 0)`,transition:"none"})}function nn(k,U){const H=se(h)?window.innerHeight:window.innerWidth,V=U?(H-Je)/H:1,M=U?-Je:0;U&&re(A.current,{transition:`transform ${X.DURATION}s cubic-bezier(${X.EASE.join(",")})`,transform:se(h)?`scale(${V}) translate3d(0, ${M}px, 0)`:`scale(${V}) translate3d(${M}px, 0, 0)`})}return D.createElement(ys,{defaultOpen:E,onOpenChange:k=>{!f&&!k||(k?J(!0):xe(!0),R(k))},open:Y},D.createElement(Jr.Provider,{value:{activeSnapPoint:At,snapPoints:o,setActiveSnapPoint:Te,drawerRef:A,overlayRef:he,onOpenChange:t,onPress:qe,onRelease:tn,onDrag:Ot,dismissible:f,handleOnly:l,isOpen:Y,isDragging:q,shouldFade:it,closeDrawer:xe,onNestedDrag:Pt,onNestedOpenChange:ct,onNestedRelease:nn,keyboardIsOpen:De,modal:w,snapPointsOffset:Oe,direction:h,shouldScaleBackground:i,setBackgroundColorOnScale:d,noBodyStyles:j,container:C,autoFocus:z}},r))}const is=D.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:s,onRelease:a,shouldFade:o,isOpen:i,modal:d}=ot(),u=es(t,r),m=s&&s.length>0;return d?D.createElement(hs,{onMouseUp:a,ref:u,"data-vaul-overlay":"","data-vaul-snap-points":i&&m?"true":"false","data-vaul-snap-points-overlay":i&&o?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});is.displayName="Drawer.Overlay";const ls=D.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...s},a){const{drawerRef:o,onPress:i,onRelease:d,onDrag:u,keyboardIsOpen:m,snapPointsOffset:f,modal:l,isOpen:g,direction:p,snapPoints:S,container:b,handleOnly:w,autoFocus:x}=ot(),[v,j]=D.useState(!1),h=es(a,o),E=D.useRef(null),T=D.useRef(null),N=D.useRef(!1),y=S&&S.length>0;Ii();const I=(C,z,L=0)=>{if(N.current)return!0;const F=Math.abs(C.y),Y=Math.abs(C.x),R=Y>F,O=["bottom","right"].includes(z)?1:-1;if(z==="left"||z==="right"){if(!(C.x*O<0)&&Y>=0&&Y<=L)return R}else if(!(C.y*O<0)&&F>=0&&F<=L)return!R;return N.current=!0,!0};D.useEffect(()=>{y&&window.requestAnimationFrame(()=>{j(!0)})},[]);function P(C){E.current=null,N.current=!1,d(C)}return D.createElement(gs,{"data-vaul-drawer-direction":p,"data-vaul-drawer":"","data-vaul-delayed-snap-points":v?"true":"false","data-vaul-snap-points":g&&y?"true":"false","data-vaul-custom-container":b?"true":"false",...s,ref:h,style:f&&f.length>0?{"--snap-point-height":`${f[0]}px`,...t}:t,onPointerDown:C=>{w||(s.onPointerDown==null||s.onPointerDown.call(s,C),E.current={x:C.pageX,y:C.pageY},i(C))},onOpenAutoFocus:C=>{r==null||r(C),x||C.preventDefault()},onPointerDownOutside:C=>{if(e==null||e(C),!l||C.defaultPrevented){C.preventDefault();return}m.current&&(m.current=!1)},onFocusOutside:C=>{if(!l){C.preventDefault();return}},onPointerMove:C=>{if(T.current=C,w||(s.onPointerMove==null||s.onPointerMove.call(s,C),!E.current))return;const z=C.pageY-E.current.y,L=C.pageX-E.current.x,F=C.pointerType==="touch"?10:2;I({x:L,y:z},p,F)?u(C):(Math.abs(L)>F||Math.abs(z)>F)&&(E.current=null)},onPointerUp:C=>{s.onPointerUp==null||s.onPointerUp.call(s,C),E.current=null,N.current=!1,d(C)},onPointerOut:C=>{s.onPointerOut==null||s.onPointerOut.call(s,C),P(T.current)},onContextMenu:C=>{s.onContextMenu==null||s.onContextMenu.call(s,C),P(T.current)}})});ls.displayName="Drawer.Content";const Ai=250,Mi=120,cs=D.forwardRef(function({preventCycle:e=!1,children:t,...r},s){const{closeDrawer:a,isDragging:o,snapPoints:i,activeSnapPoint:d,setActiveSnapPoint:u,dismissible:m,handleOnly:f,isOpen:l,onPress:g,onDrag:p}=ot(),S=D.useRef(null),b=D.useRef(!1);function w(){if(b.current){j();return}window.setTimeout(()=>{x()},Mi)}function x(){if(o||e||b.current){j();return}if(j(),(!i||i.length===0)&&m){a();return}if(d===i[i.length-1]&&m){a();return}const E=i.findIndex(N=>N===d);if(E===-1)return;const T=i[E+1];u(T)}function v(){S.current=window.setTimeout(()=>{b.current=!0},Ai)}function j(){window.clearTimeout(S.current),b.current=!1}return D.createElement("div",{onClick:w,onPointerCancel:j,onPointerDown:h=>{f&&g(h),v()},onPointerMove:h=>{f&&p(h)},ref:s,"data-vaul-drawer-visible":l?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},D.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});cs.displayName="Drawer.Handle";function Oi({onDrag:e,onOpenChange:t,...r}){const{onNestedDrag:s,onNestedOpenChange:a,onNestedRelease:o}=ot();if(!s)throw new Error("Drawer.NestedRoot must be placed in another drawer");return D.createElement(os,{nested:!0,onClose:()=>{a(!1)},onDrag:(i,d)=>{s(i,d),e==null||e(i,d)},onOpenChange:i=>{i&&a(i)},onRelease:o,...r})}function Pi(e){const t=ot(),{container:r=t.container,...s}=e;return D.createElement(ws,{container:r,...s})}const $e={Root:os,NestedRoot:Oi,Content:ls,Overlay:is,Trigger:ps,Portal:Pi,Handle:cs,Close:xs,Title:vs,Description:bs},Un=({shouldScaleBackground:e=!0,...t})=>n.jsx($e.Root,{shouldScaleBackground:e,...t});Un.displayName="Drawer";const zi=$e.Portal,Li=$e.Close,ds=c.forwardRef(({className:e,...t},r)=>n.jsx($e.Overlay,{ref:r,className:Ne("fixed inset-0 z-50 bg-black/80",e),...t}));ds.displayName=$e.Overlay.displayName;const Wn=c.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(zi,{children:[n.jsx(ds,{}),n.jsxs($e.Content,{ref:s,className:Ne("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...r,children:[n.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));Wn.displayName="DrawerContent";const Fn=({className:e,...t})=>n.jsx("div",{className:Ne("grid gap-1.5 p-4 text-center sm:text-left",e),...t});Fn.displayName="DrawerHeader";const us=({className:e,...t})=>n.jsx("div",{className:Ne("mt-auto flex flex-col gap-2 p-4",e),...t});us.displayName="DrawerFooter";const Hn=c.forwardRef(({className:e,...t},r)=>n.jsx($e.Title,{ref:r,className:Ne("text-lg font-semibold leading-none tracking-tight",e),...t}));Hn.displayName=$e.Title.displayName;const fs=c.forwardRef(({className:e,...t},r)=>n.jsx($e.Description,{ref:r,className:Ne("text-sm text-muted-foreground",e),...t}));fs.displayName=$e.Description.displayName;function $i({open:e,onOpenChange:t,hiddenWidgets:r,onAddWidget:s}){return n.jsx(Un,{open:e,onOpenChange:t,children:n.jsxs(Wn,{children:[n.jsxs(Fn,{children:[n.jsx(Hn,{children:"Agregar Widgets"}),n.jsx(fs,{children:"Selecciona los widgets que deseas agregar al dashboard"})]}),n.jsx("div",{className:"px-4 pb-4 max-h-[60vh] overflow-y-auto",children:r.length===0?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n.jsx("p",{children:"Todos los widgets estn visibles en el dashboard"})}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(a=>{const o=a.icon;return n.jsxs(K,{className:"hover:border-primary transition-colors",children:[n.jsx(ce,{className:"pb-3",children:n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:n.jsx(o,{className:"h-4 w-4 text-primary"})}),n.jsxs("div",{children:[n.jsx(de,{className:"text-sm",children:a.title}),n.jsx(Ns,{className:"text-xs mt-1",children:a.description})]})]})})}),n.jsx(ue,{className:"pt-0",children:n.jsxs(oe,{size:"sm",className:"w-full",onClick:()=>{s(a.id),r.length===1&&t(!1)},children:[n.jsx(Et,{className:"h-4 w-4 mr-2"}),"Agregar"]})})]},a.id)})})}),n.jsx(us,{children:n.jsx(Li,{asChild:!0,children:n.jsx(oe,{variant:"outline",children:"Cerrar"})})})]})})}function Bi(){const[e,t]=c.useState([]),[r,s]=c.useState(!0),[a,o]=c.useState(0),i=js();c.useEffect(()=>{d();const l=setInterval(d,5e3);return()=>clearInterval(l)},[]),c.useEffect(()=>{if(e.length<=1)return;const l=setInterval(()=>{o(g=>(g+1)%e.length)},4e3);return()=>clearInterval(l)},[e.length]);const d=async()=>{try{const l=await $s(),g=new Date,p=g.getMonth()+1,S=g.getFullYear(),b=S*100+p,w=[];l.forEach(x=>{x.batches.forEach(v=>{const j=v.reminderMonths;if(!j)return;const h=v.expirationDate.split("/");if(h.length<2)return;let E=parseInt(h[0]),T=parseInt(h[1]);T<100&&(T+=2e3);const N=T*100+E,y=T*12+E,I=S*12+p;if(y-I<=j){const z=new Date(T,E-1,1).getTime()-g.getTime(),L=Math.ceil(z/(1e3*60*60*24));w.push({productName:x.productName,batchNumber:v.batchNumber,expirationDate:v.expirationDate,reminderMonths:j,daysUntilExpiry:L})}})}),w.sort((x,v)=>x.daysUntilExpiry-v.daysUntilExpiry),t(x=>JSON.stringify(x)===JSON.stringify(w)?x:w)}catch(l){console.error("Smart Analyst Error:",l)}finally{s(!1)}};if(r)return null;const u=e.length,m=u===0,f=e[a];return n.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-full",children:n.jsxs(K,{className:"h-full flex flex-col relative overflow-hidden shadow-none border",children:[n.jsx(ce,{className:"pb-2",children:n.jsx("div",{className:"flex justify-between items-start",children:n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("div",{className:`p-1.5 rounded-lg ${m?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700"}`,children:m?n.jsx(En,{className:"w-4 h-4"}):n.jsx(ma,{className:"w-4 h-4"})}),n.jsx(de,{className:"text-sm font-bold uppercase tracking-wider text-muted-foreground",children:"Analista Inteligente"})]}),n.jsx("div",{className:"flex items-baseline gap-2",children:n.jsx("span",{className:`text-3xl font-black ${m?"text-green-600":"text-indigo-600"}`,children:m?"Todo en Orden":`${u} Alertas`})})]})})}),n.jsxs(ue,{className:"flex-1 flex flex-col justify-between",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-4 line-clamp-2",children:m?"No detectamos productos prximos a vencer segn tus recordatorios configurados.":`Hemos detectado ${u} lotes que requieren tu atencin inmediata.`}),!m&&f&&n.jsx("div",{className:"relative h-20 mb-2",children:n.jsx(Bs,{mode:"wait",children:n.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"absolute inset-0 flex items-center justify-between p-3 bg-muted/40 rounded border shadow-sm",children:[n.jsxs("div",{className:"overflow-hidden pr-2",children:[n.jsx("p",{className:"font-bold text-sm truncate text-foreground",children:f.productName}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Lote: ",n.jsx("span",{className:"font-mono",children:f.batchNumber})]}),n.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Vence: ",f.expirationDate]})]}),n.jsxs(Se,{variant:"secondary",className:"bg-orange-100 text-orange-700 border-orange-200 shrink-0 flex flex-col items-center gap-0.5 py-1",children:[n.jsx(Dn,{className:"w-3 h-3"}),n.jsx("span",{className:"text-[10px] font-bold",children:f.daysUntilExpiry<=0?"VENCIDO!":`${Math.floor(f.daysUntilExpiry/30)||"<1"} Meses`})]})]},`${f.productName}-${f.batchNumber}`)})}),!m&&e.length>1&&n.jsxs("div",{className:"flex justify-center gap-1 mb-3",children:[e.slice(0,5).map((l,g)=>n.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${g===a%5?"w-4 bg-indigo-500":"w-1.5 bg-indigo-200"}`},g)),e.length>5&&n.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-indigo-100"})]}),!m&&n.jsxs(oe,{className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white mt-auto",size:"sm",onClick:()=>i("/vencimientos"),children:["Revisar Vencimientos ",n.jsx(Us,{className:"w-4 h-4 ml-2"})]})]})]})})}function Ui({metrics:e}){const t=(o,i)=>{if(i===0)return{value:0,isPositive:!0};const d=o/i*100;return{value:Math.abs(Number(d.toFixed(1))),isPositive:d>=0}},r=t(e.negativeUnits+e.positiveUnits,e.totalSystemUnits),s=t(e.negativeUnits,e.totalSystemUnits),a=t(e.positiveUnits,e.totalSystemUnits);return n.jsx(Ws,{items:[{id:"net",label:"Diferencia Neta",value:e.totalStock,color:e.totalStock<0?"text-destructive":e.totalStock>0?"text-success":"text-foreground",icon:Ft,prefix:"$",trend:r},{id:"negative",label:"Negativo Total",value:e.negativeStock,color:"text-destructive",icon:Rn,prefix:"$",trend:s},{id:"positive",label:"Positivo Total",value:e.positiveStock,color:"text-success",icon:nt,prefix:"$",trend:a}]})}function Wi({activeProducts:e}){return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Productos Activos"}),n.jsx(Dr,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ue,{children:[(()=>{const t=new Intl.NumberFormat("es-AR").format(e);let r="text-3xl";return t.length>8?r="text-xl":t.length>6&&(r="text-2xl"),n.jsx("div",{className:`${r} font-bold`,children:n.jsx(Nr,{value:e})})})(),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Total en base de datos"})]})]})}function Fi(){return n.jsxs(K,{className:"p-6 h-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Resumen de Inventario"}),n.jsx("button",{className:"text-sm text-muted-foreground hover:text-foreground",children:"Ver detalles"})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos en Stock"}),n.jsx("span",{className:"text-sm font-medium",children:"85%"})]}),n.jsx(an,{value:85})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos con Bajo Stock"}),n.jsx("span",{className:"text-sm font-medium text-warning",children:"12%"})]}),n.jsx(an,{value:12,variant:"warning"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos Agotados"}),n.jsx("span",{className:"text-sm font-medium text-destructive",children:"3%"})]}),n.jsx(an,{value:3,variant:"destructive"})]})]})]})}function Hi(){return n.jsxs(K,{className:"p-6 h-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Alertas de Inventario"}),n.jsx("span",{className:"px-3 py-1 bg-warning/10 text-warning text-xs font-medium rounded-full",children:"3 Activas"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsx(pt,{className:"w-5 h-5 text-warning mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-foreground",children:"Stock bajo en Sucursal Palermo II"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"15 productos necesitan reabastecimiento"})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsx(pt,{className:"w-5 h-5 text-warning mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-foreground",children:"Inventario cclico pendiente"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sucursal Microcentro - Vence en 2 das"})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsx(pt,{className:"w-5 h-5 text-destructive mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-foreground",children:"Diferencia significativa detectada"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sucursal Belgrano III - Revisar urgente"})]})]})]})]})}const Ct={async getEvents(e,t=!1){let r=sn.from("inventory_events").select("*").order("date",{ascending:!0});!t&&e&&(r=r.eq("branch_name",e));const{data:s,error:a}=await r;return a?(console.error("Error fetching events:",a),[]):s||[]},async addEvent(e){const{data:t,error:r}=await sn.rpc("manage_inventory_event",{p_action:"CREATE",p_title:e.title,p_branch:e.branch_name,p_sector:e.sector,p_date:e.date});return r?(console.error("Error adding event via RPC:",r),null):t},async deleteEvent(e){const{error:t}=await sn.rpc("manage_inventory_event",{p_action:"DELETE",p_id:e});return t?(console.error("Error deleting event via RPC:",t),!1):!0}};function Vi({onDateClick:e}){const{user:t}=tt(),r=(t==null?void 0:t.role)==="admin",[s,a]=c.useState([]),[o,i]=c.useState(!0);c.useState(!1),c.useEffect(()=>{d()},[t==null?void 0:t.branchName]);const d=async()=>{try{const u=await Ct.getEvents(t==null?void 0:t.branchName,r),m=new Date().toISOString().slice(0,10),f=u.filter(l=>l.date>=m).sort((l,g)=>l.date.localeCompare(g.date)).slice(0,3).map(l=>({id:l.id,branch:l.branch_name||l.branchId,sector:l.sector||l.description,date:l.date,formattedDate:new Date(l.date+"T12:00:00").toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}));a(f)}catch(u){console.error("Error loading upcoming inventories:",u)}finally{i(!1)}};return n.jsxs(K,{className:"p-6 h-full flex flex-col relative",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Prximos Inventarios"}),n.jsx("div",{className:"flex gap-1"})]}),n.jsx("div",{className:"space-y-4 flex-1",children:o?n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),n.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),n.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"})]}):s.length===0?n.jsx("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 border rounded-lg border-dashed bg-muted/20",children:n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No hay inventarios prximos"})}):s.map(u=>n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg cursor-pointer hover:bg-muted transition-colors",onClick:()=>e==null?void 0:e(u.date),children:[n.jsx(Er,{className:"w-5 h-5 text-primary mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"text-sm font-medium text-foreground",children:[u.branch," - ",u.sector]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-left block",children:u.formattedDate})]})]},u.id))})]})}const fr=8;function _i({branches:e}){const{selectBranch:t,user:r}=tt(),[s,a]=c.useState(""),[o,i]=c.useState(!1),[d,u]=c.useState([]),[m,f]=c.useState(!0),[l,g]=c.useState({key:"progress",direction:"descending"});c.useEffect(()=>{(async()=>{f(!0);try{const E=await xt.getBranchesSummary();u(E)}catch(E){console.error("Failed to load branch summaries",E)}finally{f(!1)}})()},[]);const p=c.useMemo(()=>d.filter(h=>h.branchName.toLowerCase().includes(s.toLowerCase())),[d,s]),S=c.useMemo(()=>{let h=[...p];return l.key&&h.sort((E,T)=>{const N=E[l.key],y=T[l.key];return N<y?l.direction==="ascending"?-1:1:N>y?l.direction==="ascending"?1:-1:0}),h},[p,l]),b=h=>{let E="ascending";l.key===h&&l.direction==="ascending"&&(E="descending"),g({key:h,direction:E})},w=o?S:S.slice(0,fr),x=h=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(h),v=h=>{t&&(t(h),window.scrollTo({top:0,behavior:"smooth"}))},j=h=>(r==null?void 0:r.branchName)===h;return n.jsx(Ze.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full",children:n.jsxs(K,{className:"p-6 overflow-hidden border-t-4 border-t-primary shadow-md",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-4",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[n.jsx(nt,{className:"w-6 h-6 text-primary"}),"Monitor de Sucursales"]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Estado en tiempo real de inventarios cclicos y cumplimiento."})]}),n.jsxs("div",{className:"relative w-full md:w-72",children:[n.jsx(Ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(ze,{placeholder:"Buscar sucursal...",value:s,onChange:h=>a(h.target.value),className:"pl-10 h-10 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary"})]})]}),n.jsx("div",{className:"rounded-xl border bg-card/50 overflow-hidden",children:n.jsxs(Hs,{children:[n.jsx(Vs,{className:"bg-muted/40 hover:bg-muted/50 transition-colors",children:n.jsxs(on,{children:[n.jsx(Ve,{className:"w-[200px] cursor-pointer",onClick:()=>b("branchName"),children:n.jsxs("div",{className:"flex items-center font-semibold text-foreground",children:["Sucursal",n.jsx(Vn,{className:"ml-2 h-3 w-3 opacity-50"})]})}),n.jsx(Ve,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>b("deploymentDate"),children:"Fecha Inicio"}),n.jsx(Ve,{className:"text-center hidden lg:table-cell",children:"Vuelta"}),n.jsx(Ve,{className:"text-center hidden lg:table-cell",children:"Obj. Mensual"}),n.jsx(Ve,{className:"text-center cursor-pointer",onClick:()=>b("progress"),children:n.jsxs("div",{className:"flex items-center justify-center font-semibold text-foreground",children:["% Avance",n.jsx(Vn,{className:"ml-2 h-3 w-3 opacity-50"})]})}),n.jsx(Ve,{className:"text-center hidden md:table-cell",children:"Un. Inventario"}),n.jsx(Ve,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>b("differenceUnits"),children:"Diferencia"}),n.jsx(Ve,{className:"text-right cursor-pointer",onClick:()=>b("adjustmentsValue"),children:"$ Ajustes"}),n.jsx(Ve,{className:"text-center w-[120px]",children:"Status"})]})}),n.jsx(_s,{children:m?Array.from({length:5}).map((h,E)=>n.jsxs(on,{children:[n.jsx(ne,{children:n.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),n.jsx(ne,{className:"hidden md:table-cell",children:n.jsx("div",{className:"h-5 w-20 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{className:"hidden lg:table-cell",children:n.jsx("div",{className:"h-5 w-10 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{className:"hidden lg:table-cell",children:n.jsx("div",{className:"h-5 w-12 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{children:n.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{className:"hidden md:table-cell",children:n.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{className:"hidden md:table-cell",children:n.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),n.jsx(ne,{className:"text-right",children:n.jsx("div",{className:"h-5 w-24 bg-muted rounded animate-pulse ml-auto"})}),n.jsx(ne,{children:n.jsx("div",{className:"h-6 w-20 bg-muted rounded-full animate-pulse mx-auto"})})]},E)):w.length>0?w.map((h,E)=>n.jsxs(Ze.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:E*.05},onClick:()=>v(h.branchName),className:Ne("group cursor-pointer hover:bg-muted/50 transition-all border-b last:border-0",j(h.branchName)&&"bg-primary/5 hover:bg-primary/10 border-l-4 border-l-primary"),children:[n.jsxs(ne,{className:"font-medium text-foreground relative",children:[j(h.branchName)&&n.jsx(Ze.div,{layoutId:"active-indicator",className:"absolute left-0 top-0 bottom-0 w-1 bg-primary"}),h.branchName]}),n.jsx(ne,{className:"text-center text-muted-foreground text-sm hidden md:table-cell",children:h.deploymentDate}),n.jsxs(ne,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:[h.cyclicRound,""]}),n.jsx(ne,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:h.monthlyGoal}),n.jsx(ne,{className:"text-center",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("span",{className:Ne("font-bold text-sm",h.progress>=h.monthlyGoal?"text-green-600":"text-foreground"),children:[h.progress,"%"]}),n.jsx("div",{className:"w-16 h-1.5 bg-muted rounded-full overflow-hidden mt-1",children:n.jsx("div",{className:Ne("h-full rounded-full transition-all",h.progress>=100?"bg-green-500":"bg-primary"),style:{width:`${Math.min(h.progress,100)}%`}})})]})}),n.jsx(ne,{className:"text-center font-mono text-sm hidden md:table-cell",children:h.inventoryUnits}),n.jsx(ne,{className:"text-center font-mono text-sm hidden md:table-cell",children:n.jsxs("span",{className:h.differenceUnits===0?"text-muted-foreground":h.differenceUnits>0?"text-green-600":"text-red-600",children:[h.differenceUnits>0?"+":"",h.differenceUnits]})}),n.jsx(ne,{className:"text-right font-mono text-sm",children:n.jsx("span",{className:h.adjustmentsValue===0?"text-muted-foreground":h.adjustmentsValue>0?"text-green-600":"text-red-600",children:x(h.adjustmentsValue)})}),n.jsx(ne,{className:"text-center",children:h.status==="controlado"?n.jsxs(Se,{variant:"outline",className:"font-normal border bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30",children:[n.jsx(Cs,{className:"w-3 h-3 mr-1"})," FINALIZADA"]}):h.status==="por_controlar"?n.jsxs(Se,{variant:"outline",className:"font-normal border bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30",children:[n.jsx(Dt,{className:"w-3 h-3 mr-1"})," EN PROCESO"]}):n.jsxs(Se,{variant:"outline",className:"font-normal border bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30",children:[n.jsx(pt,{className:"w-3 h-3 mr-1"})," PENDIENTE"]})})]},h.branchName)):n.jsx(on,{children:n.jsx(ne,{colSpan:9,className:"h-24 text-center text-muted-foreground",children:"No se encontraron sucursales con esa bsqueda."})})})]})}),S.length>fr&&n.jsx("div",{className:"mt-4 flex justify-center",children:n.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>i(!o),className:"text-muted-foreground hover:text-foreground",children:o?"Mostrar menos":`Ver todas las sucursales (${S.length})`})})]})})}function qi({completedCount:e,totalCount:t}){const r=t>0?Math.round(e/t*100):0,s=()=>r>=80?"text-success":r>=50?"text-warning":"text-destructive";return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Progreso"}),n.jsx(nt,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ue,{children:[n.jsxs("div",{className:`text-xl font-bold ${s()}`,children:[r,"%"]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e," de ",t," completados"]}),n.jsx(jr,{value:r,className:"mt-2"})]})]})}function Yi({criticalCount:e,outOfStockCount:t}){const r=e>0||t>0;return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Crticos"}),n.jsx(Dn,{className:`h-4 w-4 ${r?"text-destructive":"text-muted-foreground"}`})]}),n.jsxs(ue,{children:[n.jsx("div",{className:`text-xl font-bold ${r?"text-destructive":"text-foreground"}`,children:e}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Productos con stock bajo"}),t>0&&n.jsxs(Se,{variant:"destructive",className:"mt-2",children:[t," agotados"]})]})]})}function Gi({totalValue:e,changePercentage:t}){const r=t!==void 0&&t>=0;return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium text-muted-foreground",children:"Valor Total"}),n.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ue,{children:[n.jsxs("div",{className:"text-xl font-bold",children:["$",n.jsx(Nr,{value:e})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Valor de inventario"}),t!==void 0&&n.jsxs("div",{className:`flex items-center gap-1 mt-2 text-xs ${r?"text-success":"text-destructive"}`,children:[r?n.jsx(nt,{className:"h-3 w-3"}):n.jsx(Rn,{className:"h-3 w-3"}),n.jsxs("span",{children:[Math.abs(t).toFixed(1),"% vs mes anterior"]})]})]})]})}function Xi({activeCount:e,activeBranches:t}){return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Activos"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{className:"h-4 w-4 text-muted-foreground"}),e>0&&n.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 bg-success rounded-full animate-pulse"})]})]}),n.jsxs(ue,{children:[n.jsx("div",{className:"text-xl font-bold",children:e}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usuarios trabajando"}),t.length>0&&n.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[t.slice(0,2).map((r,s)=>n.jsx(Se,{variant:"secondary",className:"text-xs",children:r},s)),t.length>2&&n.jsxs(Se,{variant:"secondary",className:"text-xs",children:["+",t.length-2]})]})]})]})}function Ki({pendingCount:e,urgentCount:t}){return n.jsxs(K,{className:"h-full flex flex-col justify-between",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Pendientes"}),n.jsx(Dt,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ue,{children:[n.jsx("div",{className:`text-xl font-bold ${e>0?"text-warning":"text-foreground"}`,children:e}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Inventarios sin completar"}),t>0&&n.jsxs(Se,{variant:"destructive",className:"mt-2",children:[t," urgentes"]})]})]})}function Ji({data:e=[]}){const[t,r]=c.useState("7d"),s=[{date:"01/12",negative:-1200,positive:800},{date:"02/12",negative:-950,positive:1100},{date:"03/12",negative:-1500,positive:900},{date:"04/12",negative:-800,positive:1300},{date:"05/12",negative:-1100,positive:950},{date:"06/12",negative:-900,positive:1200},{date:"07/12",negative:-1300,positive:1e3}],a=e.length>0?e:s;return n.jsxs(K,{className:"h-full",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Tendencias"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(oe,{variant:t==="7d"?"default":"outline",size:"sm",onClick:()=>r("7d"),children:"7 das"}),n.jsx(oe,{variant:t==="30d"?"default":"outline",size:"sm",onClick:()=>r("30d"),children:"30 das"})]})]}),n.jsx(ue,{children:n.jsx(Sr,{width:"100%",height:200,children:n.jsxs(qs,{data:a,children:[n.jsx(Ys,{strokeDasharray:"3 3"}),n.jsx(Gs,{dataKey:"date",fontSize:12}),n.jsx(Xs,{fontSize:12}),n.jsx(Cr,{}),n.jsx(Ks,{}),n.jsx(_n,{type:"monotone",dataKey:"negative",stroke:"hsl(var(--destructive))",name:"Negativo",strokeWidth:2}),n.jsx(_n,{type:"monotone",dataKey:"positive",stroke:"hsl(var(--success))",name:"Positivo",strokeWidth:2})]})})})]})}function Zi({products:e=[]}){const t=[{name:"Ibuprofeno 600mg",ean:"7798140250685",difference:-45,value:-2250,type:"negative"},{name:"Paracetamol 500mg",ean:"7798140250692",difference:32,value:1600,type:"positive"},{name:"Amoxicilina 500mg",ean:"7798140250708",difference:-28,value:-1680,type:"negative"},{name:"Omeprazol 20mg",ean:"7798140250715",difference:25,value:1500,type:"positive"},{name:"Losartn 50mg",ean:"7798140250722",difference:-20,value:-1200,type:"negative"}],r=e.length>0?e:t;return n.jsxs(K,{className:"h-full",children:[n.jsxs(ce,{className:"pb-3",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Top Diferencias"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos con mayores discrepancias"})]}),n.jsx(ue,{children:n.jsx("div",{className:"space-y-3",children:r.map((s,a)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"text-sm font-medium",children:s.name}),n.jsx(Se,{variant:s.type==="negative"?"destructive":"default",className:"text-xs",children:s.type==="negative"?"Faltante":"Sobrante"})]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["EAN: ",s.ean]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`flex items-center gap-1 ${s.type==="negative"?"text-destructive":"text-success"}`,children:[s.type==="negative"?n.jsx(Rn,{className:"h-3 w-3"}):n.jsx(nt,{className:"h-3 w-3"}),n.jsx("span",{className:"text-sm font-semibold",children:Math.abs(s.difference)})]}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Math.abs(s.value)]})]}),n.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8",children:n.jsx(ea,{className:"h-4 w-4"})})]})]},a))})})]})}function Qi({activities:e=[]}){const t=[{id:"1",type:"completed",title:"Inventario Farmacia completado",branch:"Belgrano IV",timestamp:"Hace 5 minutos",user:"Juan Prez"},{id:"2",type:"adjusted",title:"Ajustes realizados en Perfumera",branch:"Recoleta",timestamp:"Hace 15 minutos",user:"Mara Gonzlez"},{id:"3",type:"imported",title:"Inventario importado",branch:"Palermo II",timestamp:"Hace 1 hora",user:"Carlos Rodrguez"},{id:"4",type:"completed",title:"Pre-conteo finalizado",branch:"Microcentro",timestamp:"Hace 2 horas",user:"Ana Martnez"}],r=e.length>0?e:t,s=o=>{switch(o){case"completed":return n.jsx(En,{className:"h-4 w-4 text-success"});case"adjusted":return n.jsx(ba,{className:"h-4 w-4 text-warning"});case"imported":return n.jsx(gr,{className:"h-4 w-4 text-primary"})}},a=o=>{switch(o){case"completed":return"Completado";case"adjusted":return"Ajustado";case"imported":return"Importado"}};return n.jsxs(K,{className:"h-full",children:[n.jsxs(ce,{className:"pb-3",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Actividad Reciente"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"ltimas acciones realizadas"})]}),n.jsx(ue,{children:n.jsx("div",{className:"space-y-4",children:r.map((o,i)=>n.jsxs("div",{className:"relative",children:[i<r.length-1&&n.jsx("div",{className:"absolute left-2 top-8 bottom-0 w-px bg-border"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"relative z-10 mt-1 rounded-full bg-background p-1 border",children:s(o.type)}),n.jsxs("div",{className:"flex-1 pb-4",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:o.title}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.branch,"  ",o.user]})]}),n.jsx(Se,{variant:"secondary",className:"text-xs",children:a(o.type)})]}),n.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[n.jsx(Dt,{className:"h-3 w-3"}),n.jsx("span",{children:o.timestamp})]})]})]})]},o.id))})})]})}const _e=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"];function el({data:e=[]}){const t=[{name:"Farmacia",value:450,color:_e[0]},{name:"Perfumera",value:280,color:_e[1]},{name:"Higiene",value:180,color:_e[2]},{name:"Bebs",value:120,color:_e[3]},{name:"Otros",value:90,color:_e[4]}],r=e.length>0?e:t,s=r.reduce((a,o)=>a+o.value,0);return n.jsxs(K,{className:"h-full",children:[n.jsxs(ce,{className:"pb-3",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Distribucin por Categora"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos por categora"})]}),n.jsxs(ue,{children:[n.jsx(Sr,{width:"100%",height:200,children:n.jsxs(Js,{children:[n.jsx(Zs,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:o})=>`${a} ${(o*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((a,o)=>n.jsx(Qs,{fill:a.color||_e[o%_e.length]},`cell-${o}`))}),n.jsx(Cr,{})]})}),n.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2",children:r.map((a,o)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color||_e[o%_e.length]}}),n.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.name,": ",a.value," (",(a.value/s*100).toFixed(1),"%)"]})]},o))})]})]})}function tl({goals:e=[]}){const t=[{title:"Inventarios Completados",current:45,target:60,badge:"75%"},{title:"Productos Controlados",current:1250,target:1500,badge:"83%"},{title:"Diferencias Resueltas",current:28,target:35,badge:"80%"}],r=e.length>0?e:t;return n.jsxs(K,{className:"h-full",children:[n.jsx(ce,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(de,{className:"text-lg font-semibold",children:"Objetivos del Mes"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Progreso hacia metas"})]}),n.jsx(yr,{className:"h-5 w-5 text-primary"})]})}),n.jsx(ue,{children:n.jsx("div",{className:"space-y-4",children:r.map((s,a)=>{const o=Math.round(s.current/s.target*100),i=o>=100;return n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-medium",children:s.title}),i&&n.jsx(fa,{className:"h-4 w-4 text-success"})]}),n.jsxs(Se,{variant:i?"default":"secondary",children:[s.current,"/",s.target]})]}),n.jsx(jr,{value:o,className:"h-2"}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[o,"% completado"]})]},a)})})})]})}function nl({isOnline:e=!0,pendingCount:t=0,lastSync:r="Hace 5 minutos",onSync:s}){return n.jsxs(K,{className:"h-full",children:[n.jsx(ce,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Sincronizacin"}),e?n.jsx(wr,{className:"h-5 w-5 text-success"}):n.jsx(Ds,{className:"h-5 w-5 text-destructive"})]})}),n.jsxs(ue,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:"Estado de Conexin"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e?"Conectado":"Sin conexin"})]}),n.jsx(Se,{variant:e?"default":"destructive",children:e?"Online":"Offline"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:"Datos Pendientes"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t>0?`${t} elementos`:"Todo sincronizado"})]}),t>0?n.jsx(Se,{variant:"warning",children:t}):n.jsx(En,{className:"h-5 w-5 text-success"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[n.jsx(Dt,{className:"h-3 w-3"}),n.jsxs("span",{children:["ltima sincronizacin: ",r]})]}),n.jsxs(oe,{className:"w-full",variant:t>0?"default":"outline",onClick:s,disabled:!e,children:[n.jsx(Es,{className:"h-4 w-4 mr-2"}),t>0?"Sincronizar Ahora":"Actualizar"]})]})]})}function rl({actions:e=[]}){const t=[{title:"Nuevo Pre-Conteo",description:"Iniciar nuevo pre-conteo",icon:Et,onClick:()=>console.log("Nuevo Pre-Conteo"),variant:"default"},{title:"Importar Inventario",description:"Cargar desde Excel",icon:gr,onClick:()=>console.log("Importar"),variant:"outline"},{title:"Ver Reportes",description:"Anlisis y estadsticas",icon:mr,onClick:()=>console.log("Reportes"),variant:"outline"},{title:"Exportar Datos",description:"Descargar informacin",icon:Rs,onClick:()=>console.log("Exportar"),variant:"outline"},{title:"Configuracin",description:"Ajustes del sistema",icon:Ts,onClick:()=>console.log("Configuracin"),variant:"secondary"}],r=e.length>0?e:t;return n.jsxs(K,{className:"h-full",children:[n.jsxs(ce,{className:"pb-3",children:[n.jsx(de,{className:"text-lg font-semibold",children:"Acciones Rpidas"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Tareas frecuentes"})]}),n.jsx(ue,{children:n.jsx("div",{className:"grid grid-cols-2 gap-3",children:r.map((s,a)=>{const o=s.icon;return n.jsxs(oe,{variant:s.variant||"outline",className:"h-auto flex-col items-start p-4 gap-2",onClick:s.onClick,children:[n.jsx(o,{className:"h-5 w-5"}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"text-sm font-medium",children:s.title}),n.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:s.description})]})]},a)})})})]})}function sl({assignedDays:e=0,daysRemaining:t=0,totalProgress:r=0,monthlyProgress:s=[],isEditable:a=!1,onEdit:o}){const i=e>0?Math.ceil(e/30):3,d=Array.from({length:i});return n.jsxs(K,{className:"h-full flex flex-col overflow-hidden relative group/card",children:[n.jsxs(ce,{className:"flex flex-row items-center justify-between space-y-0 px-5 pt-4 pb-2",children:[n.jsx(de,{className:"text-sm font-medium",children:"Plazo de Inventario"}),n.jsxs("div",{className:"flex items-center gap-2",children:[a&&n.jsx("button",{onPointerDown:u=>u.stopPropagation(),onClick:u=>{u.stopPropagation(),o==null||o()},className:"relative z-50 text-muted-foreground hover:text-primary transition-colors opacity-0 group-hover/card:opacity-100 cursor-pointer",title:"Configurar plazo",children:n.jsx(Ht,{className:"h-4 w-4"})}),!a&&n.jsx(Ht,{className:"h-4 w-4 text-muted-foreground"})]})]}),n.jsxs(ue,{className:"flex flex-col justify-between flex-1 px-5 pb-4 pt-1 gap-4",children:[n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-3xl font-bold tracking-tight text-foreground",children:e>0?e:"-"}),n.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide",children:"Das Asignados"})]}),n.jsx("div",{className:"h-8 w-px bg-border/60 mx-2 mb-1"}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsx("span",{className:"text-3xl font-bold tracking-tight text-foreground",children:e>0?t:"-"}),n.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide text-right",children:"Das Restantes"})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Avance Global"}),n.jsxs("span",{className:"text-sm font-bold text-primary",children:[r,"%"]})]}),n.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${i}, 1fr)`},children:d.map((u,m)=>{const f=s[m]||0,l=e===0;return n.jsxs("div",{className:"space-y-1.5 group",children:[n.jsx("div",{className:"h-2 w-full bg-muted/50 rounded-full overflow-hidden relative",children:n.jsx("div",{className:Ne("h-full bg-primary transition-all duration-500 rounded-full",l&&"w-0"),style:{width:l?"0%":`${Math.min(f,100)}%`}})}),n.jsx("div",{className:"text-[10px] text-center text-muted-foreground font-medium",children:l?"-":`${f}%`})]},m)})})]})]})]})}const al=e=>{const t=Math.min(120,Math.max(0,e*1.2));return{background:`linear-gradient(135deg, hsl(${t}, 85%, 60%), hsl(${t}, 90%, 40%))`,color:"white"}};function ol(){const{user:e}=tt(),[t,r]=c.useState([]),[s,a]=c.useState(null),[o,i]=c.useState(!0);c.useEffect(()=>{const u=async()=>{if(!(e!=null&&e.branchSheet)){i(!1);return}try{const f=await ks(e.branchSheet),l=await xt.getAllCyclicInventories(e.branchSheet)||[],g=new Map(l.map(v=>[v.labName,v.status])),p={Farmacia:{total:0,controlled:0},Perfumera:{total:0,controlled:0},Accesorios:{total:0,controlled:0},Varios:{total:0,controlled:0}};let S=0,b=0;f.forEach(v=>{let j="Varios";const h=v.category.toUpperCase();h==="MEDICAMENTOS"?j="Farmacia":h==="PERFUMERIA"?j="Perfumera":h==="ACCESORIOS"&&(j="Accesorios");const T=g.get(v.name)==="controlado";p[j]?(p[j].total+=1,T&&(p[j].controlled+=1)):(p.Varios.total+=1,T&&(p.Varios.controlled+=1)),S+=1,T&&(b+=1)});const w=Object.entries(p).map(([v,j])=>{const h=j.total>0?Math.round(j.controlled/j.total*100):0;return{name:v,totalItems:j.total,controlledItems:j.controlled,percentage:h,pendingPercentage:100-h}}),x=S>0?Math.round(b/S*100):0;a({name:"Global",totalItems:S,controlledItems:b,percentage:x,pendingPercentage:100-x}),r(w)}catch(f){console.error("Error loading category progress:",f)}finally{i(!1)}};u();const m=setInterval(u,3e4);return()=>clearInterval(m)},[e]);const d=[...t].sort((u,m)=>u.percentage-m.percentage);return o?n.jsx(K,{className:"h-full flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):n.jsxs(K,{className:"h-full flex flex-col border-border/50 shadow-sm bg-card/50 backdrop-blur-sm",children:[n.jsx(ce,{className:"pb-2 px-4 pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(de,{className:"text-base font-semibold tracking-tight",children:"Progreso de Inventario"}),n.jsxs("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded-full",children:[s==null?void 0:s.totalItems," Laboratorios"]})]})}),n.jsx(ue,{className:"flex-1 p-4 pt-2",children:n.jsxs("div",{className:"grid grid-cols-12 gap-3 h-full",children:[n.jsx("div",{className:"col-span-7 h-full",children:n.jsxs("div",{className:"h-full rounded-xl bg-muted/30 border border-border/50 p-5 flex flex-col justify-between relative overflow-hidden group hover:bg-muted/50 transition-colors",children:[n.jsx("div",{className:"flex justify-between items-start z-10",children:n.jsx("div",{className:"p-2 bg-background/50 backdrop-blur rounded-lg",children:n.jsx(Is,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsxs("div",{className:"z-10",children:[n.jsxs("h3",{className:"text-4xl font-bold tracking-tighter text-foreground mb-1",children:[s==null?void 0:s.percentage,"%"]}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"AVANCE TOTAL"})]}),n.jsx("div",{className:"absolute -right-4 -bottom-4 w-32 h-32 bg-foreground/5 rounded-full blur-3xl group-hover:bg-foreground/10 transition-colors"})]})}),n.jsx("div",{className:"col-span-5 grid grid-cols-1 grid-rows-4 gap-2 h-full",children:d.map(u=>n.jsxs("div",{className:"relative overflow-hidden rounded-lg p-3 flex items-center justify-between transition-all hover:scale-[1.02] cursor-pointer group shadow-sm",style:al(u.percentage),children:[n.jsxs("div",{className:"z-10 flex flex-col",children:[n.jsx("span",{className:"text-[10px] font-bold uppercase text-white/90 tracking-wider",children:u.name}),n.jsxs("span",{className:"text-lg font-bold text-white drop-shadow-sm",children:[u.percentage,"%"]})]}),n.jsx("div",{className:"z-10 text-right",children:n.jsxs("span",{className:"text-[10px] font-medium text-white/90 bg-black/20 px-1.5 py-0.5 rounded backdrop-blur-sm",children:[u.controlledItems,"/",u.totalItems]})}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shimmer"})]},u.name))})]})})]})}function ms({events:e=[],selected:t,onSelect:r}){const[s,a]=D.useState(t||new Date);D.useEffect(()=>{t&&a(t)},[t]);const o=ta(s),i=na(o),d=ra(o,{locale:zt,weekStartsOn:1}),u=sa(i,{locale:zt,weekStartsOn:1}),m=[];let f=d;for(;f<=u;){const w=[];for(let x=0;x<7;x++)w.push(f),f=aa(f,1);m.push(w)}const l=D.useMemo(()=>{const w=new Map;return e.forEach(x=>{const v=x.date;w.has(v)||w.set(v,[]),w.get(v).push(x)}),w},[e]),g=new Date,p=()=>a(w=>da(w,1)),S=()=>a(w=>ua(w,1)),b="h-10 w-10";return n.jsxs("div",{className:"w-full",children:[n.jsxs("div",{className:"flex items-center justify-between px-2 pb-2",children:[n.jsx("button",{onClick:p,className:"p-1 rounded hover:bg-muted/50",children:n.jsx(Fs,{className:"h-5 w-5 text-muted-foreground"})}),n.jsx("div",{className:"text-sm font-semibold",children:qn(o,"LLLL yyyy",{locale:zt})}),n.jsx("button",{onClick:S,className:"p-1 rounded hover:bg-muted/50",children:n.jsx(As,{className:"h-5 w-5 text-muted-foreground"})})]}),n.jsx("div",{className:"grid grid-cols-7 gap-1 px-1 text-xs text-muted-foreground mb-1",children:["LU","MA","MI","JU","VI","SA","DO"].map((w,x)=>n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("div",{className:"h-10 w-10 flex items-center justify-center font-medium uppercase",children:w})},x))}),n.jsx("div",{className:"space-y-1",children:m.map((w,x)=>n.jsx("div",{className:"grid grid-cols-7 gap-1",children:w.map(v=>{const j=v.toISOString().slice(0,10),h=oa(v,o),E=l.get(j)||[],T=E.length>0,N=t?ia(v,t):!1,y=E.some(C=>{const z=la(C.date),L=ca(z,g);return L>=2&&L<=5}),I=N?"bg-primary text-primary-foreground":y?"hover:bg-primary/10 ring-2 ring-accent":"hover:bg-primary/10",P=n.jsx("button",{onClick:()=>r&&r(v),className:`flex items-center justify-center ${b} rounded-full transition-colors focus:outline-none ${h?"text-foreground":"text-muted-foreground"} ${I}`,children:n.jsxs("div",{className:"relative flex items-center justify-center w-full h-full",children:[n.jsx("span",{className:"text-sm font-medium",children:qn(v,"d",{locale:zt})}),T&&n.jsx("span",{className:`absolute -bottom-2 h-1.5 w-1.5 rounded-full ${y?"bg-primary":"bg-accent"}`})]})},j);if(T){const C=n.jsxs("div",{className:"space-y-1",children:[E.slice(0,5).map(z=>n.jsxs("div",{className:"text-xs",children:[n.jsx("div",{className:"font-medium",children:z.title}),n.jsxs("div",{className:"text-muted-foreground",children:[z.branch,"  ",z.sector]})]},z.id)),E.length>5&&n.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",E.length-5," ms"]})]});return n.jsxs(Ms,{children:[n.jsx(Os,{asChild:!0,children:P}),n.jsx(Ps,{side:"top",children:C})]},j)}return P})},x))})]})}function il(){const{user:e}=tt(),[t,r]=c.useState(new Date),[s,a]=c.useState([]),[o,i]=c.useState(!1),[d,u]=c.useState(""),[m,f]=c.useState(""),[l,g]=c.useState(""),[p,S]=c.useState(new Date().toISOString().slice(0,10));c.useEffect(()=>{b()},[e==null?void 0:e.branchName]);const b=async()=>{try{const j=(await Ct.getEvents()).map(h=>({id:h.id,title:h.title,branch:h.branch_name||h.branchId||"General",sector:h.sector||h.description||"",date:h.date.split("T")[0]}));a(j)}catch(v){console.error("Error loading events:",v)}},w=async()=>{if(!d||!m||!l||!p){Ke.error("Por favor completa todos los campos");return}try{await Ct.addEvent({title:d,branch_name:m,sector:l,date:p}),Ke.success("Evento agregado"),i(!1),u(""),f(""),g(""),S(new Date().toISOString().slice(0,10)),b()}catch{Ke.error("Error al crear evento")}},x=v=>{const j=v.toISOString().split("T")[0];return s.filter(h=>h.date===j)};return n.jsxs(K,{className:"h-full flex flex-col",children:[n.jsx(ce,{className:"pb-2",children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ht,{className:"w-5 h-5 text-primary"}),n.jsx(de,{children:"Calendario"})]})})}),n.jsx(ue,{className:"flex-1 p-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-full",children:[n.jsx("div",{className:"flex-1",children:n.jsx(ms,{selected:t,onSelect:r,events:s})}),n.jsxs("div",{className:"w-full md:w-80 flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"font-semibold capitalize",children:t.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),n.jsx(oe,{size:"sm",variant:o?"ghost":"outline",onClick:()=>i(!o),children:o?"Cancelar":n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"w-4 h-4 mr-1"})," Evento"]})})]}),o?n.jsxs("div",{className:"p-3 bg-muted/50 border rounded-md space-y-3 mb-4 animate-in slide-in-from-top-2",children:[n.jsx(ze,{placeholder:"Ttulo",value:d,onChange:v=>u(v.target.value),className:"bg-background h-8"}),n.jsx(ze,{placeholder:"Sucursal",value:m,onChange:v=>f(v.target.value),className:"bg-background h-8"}),n.jsx(ze,{placeholder:"Sector",value:l,onChange:v=>g(v.target.value),className:"bg-background h-8"}),n.jsx(ze,{type:"date",value:p,onChange:v=>S(v.target.value),className:"bg-background h-8"}),n.jsx(oe,{size:"sm",className:"w-full",onClick:w,children:"Guardar Evento"})]}):n.jsx("div",{className:"flex-1 overflow-auto space-y-2 pr-1",children:x(t).length===0?n.jsx("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground text-sm border-2 border-dashed rounded-lg",children:"No hay eventos"}):x(t).map(v=>n.jsxs("div",{className:"p-3 bg-muted/50 hover:bg-muted border rounded-md transition-colors text-sm",children:[n.jsx("p",{className:"font-medium text-foreground",children:v.title}),n.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[n.jsx("span",{children:v.branch}),n.jsx("span",{children:v.sector})]})]},v.id))})]})]})})]})}function ll(e){const[t,r]=c.useState(!1);return c.useEffect(()=>{function s(o){r(o.matches)}const a=matchMedia(e);return a.addEventListener("change",s),r(a.matches),()=>a.removeEventListener("change",s)},[e]),t}function cl({open:e,onOpenChange:t,initialDate:r}){const s=ll("(min-width: 768px)"),{user:a}=tt(),o=(a==null?void 0:a.role)==="admin",[i,d]=c.useState(r||new Date),[u,m]=c.useState([]),[f,l]=c.useState(!1),[g,p]=c.useState(""),[S,b]=c.useState(""),[w,x]=c.useState(""),[v,j]=c.useState(new Date().toISOString().slice(0,10));c.useEffect(()=>{e&&(h(),r&&(d(r),j(r.toISOString().slice(0,10))))},[e,r,a==null?void 0:a.branchName]);const h=async()=>{try{const y=await Ct.getEvents(a==null?void 0:a.branchName,o);m(y)}catch(y){console.error("Error loading events",y)}},E=async()=>{if(!g||!S||!w||!v){Ke.error("Completa todos los campos");return}try{const y=await Ct.addEvent({title:g,branch_name:S,sector:w,date:v});y&&(Ke.success("Evento creado"),m(I=>[...I,y]),l(!1),p(""),b(""),x(""))}catch{Ke.error("Error al crear evento")}},T=y=>{const I=y.toISOString().slice(0,10);return u.filter(P=>P.date===I)},N=()=>n.jsxs("div",{className:`flex ${s?"flex-row gap-6":"flex-col gap-4"} mt-4 h-full`,children:[n.jsx("div",{className:s?"w-1/2":"w-full",children:n.jsx(ms,{events:u.map(y=>({...y,branch:y.branch_name})),selected:i,onSelect:y=>{y&&(d(y),j(y.toISOString().slice(0,10)))}})}),n.jsxs("div",{className:s?"w-1/2 flex flex-col":"w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-medium capitalize",children:i.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),o&&n.jsxs(oe,{size:"sm",onClick:()=>l(!f),variant:f?"ghost":"default",children:[f?n.jsx(hr,{className:"w-4 h-4"}):n.jsx(Et,{className:"w-4 h-4 mr-2"}),f?"Cancelar":"Evento"]})]}),f?n.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/40 animate-in slide-in-from-top-2",children:[n.jsx("h4",{className:"font-medium text-sm",children:"Nuevo Evento"}),n.jsx(ze,{placeholder:"Ttulo",value:g,onChange:y=>p(y.target.value)}),n.jsx(ze,{placeholder:"Sucursal",value:S,onChange:y=>b(y.target.value)}),n.jsx(ze,{placeholder:"Sector",value:w,onChange:y=>x(y.target.value)}),n.jsx(ze,{type:"date",value:v,onChange:y=>j(y.target.value)}),n.jsx(oe,{className:"w-full",onClick:E,children:"Guardar"})]}):n.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 max-h-[500px]",children:T(i).length===0?n.jsx("div",{className:"flex flex-col items-center justify-center py-10 text-muted-foreground border-2 border-dashed rounded-lg",children:n.jsx("p",{children:"No hay eventos para este da"})}):T(i).map(y=>n.jsx("div",{className:"p-3 bg-card border rounded-lg shadow-sm",children:n.jsx("div",{className:"flex justify-between items-start",children:n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-foreground",children:y.title}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[y.branch_name," - ",y.sector]})]})})},y.id))})]})]});return s?n.jsx(pr,{open:e,onOpenChange:t,children:n.jsxs(xr,{className:"max-w-4xl w-[90vw] h-[80vh] flex flex-col",children:[n.jsx(vr,{children:n.jsx(br,{children:"Calendario de Inventarios"})}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx(N,{})})]})}):n.jsx(Un,{open:e,onOpenChange:t,children:n.jsxs(Wn,{className:"h-[90vh]",children:[n.jsx(Fn,{children:n.jsx(Hn,{children:"Calendario de Inventarios"})}),n.jsx("div",{className:"px-4 pb-8 h-full overflow-y-auto",children:n.jsx(N,{})})]})})}const dl={admin:["VIEW_ADMIN_DASHBOARD","MANAGE_INVENTORY_CONFIG","VIEW_BRANCH_MONITOR","EDIT_SETTINGS","IMPERSONATE_BRANCH"],branch:[]};function vn(e,t){return e?(dl[e.role]||[]).includes(t):!1}const ul=[{name:"Belgrano IV",address:"Av. Cabildo 2040",zonal:"Zona Norte",email:"belgrano4@farmaplus.com"},{name:"Recoleta",address:"Av. Santa Fe 1860",zonal:"Zona Centro",email:"recoleta@farmaplus.com"},{name:"Palermo II",address:"Av. Las Heras 3520",zonal:"Zona Norte",email:"palermo2@farmaplus.com"},{name:"Microcentro",address:"Florida 520",zonal:"Zona Centro",email:"microcentro@farmaplus.com"},{name:"Belgrano III",address:"Av. Cabildo 1520",zonal:"Zona Norte",email:"belgrano3@farmaplus.com"},{name:"Villa Urquiza II",address:"Av. Triunvirato 4280",zonal:"Zona Norte",email:"villaurquiza2@farmaplus.com"}],fl={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},ml={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function Ul(){const{user:e}=tt(),{visibleWidgets:t,hiddenWidgets:r,isEditMode:s,setIsEditMode:a,reorderWidgets:o,toggleWidgetVisibility:i,resetLayout:d}=li(e==null?void 0:e.branchName),[u,m]=c.useState(!1),f=za(Xn(zn,{activationConstraint:{distance:8}}),Xn(On,{coordinateGetter:oi})),l=c.useMemo(()=>t.filter(R=>R.type==="branches-table"?vn(e,"VIEW_BRANCH_MONITOR"):!0),[t,e]),g=R=>{const{active:O,over:J}=R;J&&O.id!==J.id&&o(O.id,J.id)},[p,S]=c.useState({totalStock:0,activeProducts:0,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0}),[b,w]=c.useState(0),[x,v]=c.useState(!1),[j,h]=c.useState(""),[E,T]=c.useState(90),[N,y]=c.useState(0),[I,P]=c.useState(!1),[C,z]=c.useState(void 0),L=R=>{const O=R?new Date(R):new Date;O.setHours(12,0,0,0),z(O),P(!0)};c.useEffect(()=>{(async()=>{if(e!=null&&e.branchName){const O=await xt.getBranchConfig(e.branchName);w(O)}})()},[e]),c.useEffect(()=>{(async()=>{let O=0;try{O=await zs()}catch(J){console.error("Error fetching product count:",J)}if(!(e!=null&&e.branchSheet)){S({totalStock:0,activeProducts:O,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});return}try{const q=(await xt.getAllCyclicInventories(e.branchSheet)).reduce((ie,ye)=>({negativeStock:ie.negativeStock+ye.negativeValue,positiveStock:ie.positiveStock+ye.positiveValue,totalStock:ie.totalStock+ye.differenceValue,negativeUnits:ie.negativeUnits+ye.negativeUnits,positiveUnits:ie.positiveUnits+ye.positiveUnits,totalSystemUnits:ie.totalSystemUnits+ye.totalSystemUnits}),{negativeStock:0,positiveStock:0,totalStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});S({totalStock:q.totalStock,activeProducts:O,negativeStock:q.negativeStock,positiveStock:q.positiveStock,negativeUnits:q.negativeUnits,positiveUnits:q.positiveUnits,totalSystemUnits:q.totalSystemUnits})}catch(J){console.error("Error loading metrics:",J)}})()},[e]);const F=()=>{const R=new Date().getHours();return R>=6&&R<12?"Buenos das":R>=12&&R<20?"Buenas tardes":"Buenas noches"},Y=R=>{switch(R){case"metrics-carousel":return n.jsx(Ui,{metrics:p});case"active-products":return n.jsx(Wi,{activeProducts:p.activeProducts});case"inventory-summary":return n.jsx(Fi,{});case"inventory-alerts":return n.jsx(Hi,{});case"upcoming-inventories":return n.jsx(Vi,{onDateClick:L});case"branches-table":return vn(e,"VIEW_BRANCH_MONITOR")?n.jsx(_i,{branches:ul}):null;case"inventory-progress":return n.jsx(qi,{completedCount:3,totalCount:10});case"critical-products":return n.jsx(Yi,{criticalCount:15,outOfStockCount:3});case"total-stock-value":return n.jsx(Gi,{totalValue:p.totalStock,changePercentage:5.2});case"active-users":return n.jsx(Xi,{activeCount:5,activeBranches:["Belgrano IV","Recoleta","Palermo II"]});case"pending-inventories":return n.jsx(Ki,{pendingCount:7,urgentCount:2});case"trends-chart":return n.jsx(Ji,{});case"top-products":return n.jsx(Zi,{});case"activity-timeline":return n.jsx(Qi,{});case"category-distribution":return n.jsx(el,{});case"monthly-goals":return n.jsx(tl,{});case"sync-status":return n.jsx(nl,{isOnline:navigator.onLine,pendingCount:0});case"quick-actions":return n.jsx(rl,{});case"calendar":return n.jsx(il,{});case"countdown":return n.jsx(sl,{assignedDays:b,daysRemaining:b,totalProgress:0,monthlyProgress:[],isEditable:vn(e,"MANAGE_INVENTORY_CONFIG"),onEdit:()=>v(!0)});case"category-progress":return n.jsx(ol,{});default:return null}};return n.jsxs(Ze.div,{className:"pt-3 pb-6 px-6 space-y-6",variants:fl,initial:"hidden",animate:"show",children:[n.jsxs(Ze.div,{variants:ml,className:"space-y-1",children:[n.jsx("div",{className:"text-muted-foreground text-xs font-normal",children:new Date().toLocaleDateString("es-AR",{weekday:"long",month:"short",day:"2-digit",year:"numeric"})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h1",{className:"text-2xl font-medium tracking-tight text-foreground",children:[F(),", ",(e==null?void 0:e.role)==="admin"?e==null?void 0:e.name.split(" ")[0]:(e==null?void 0:e.branchName)||"Sucursal"," "]}),n.jsxs("div",{className:"flex gap-2",children:[s&&n.jsxs(n.Fragment,{children:[n.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>m(!0),disabled:r.length===0,children:[n.jsx(Et,{className:"h-4 w-4 mr-2"}),"Agregar Widget"]}),n.jsxs(oe,{variant:"outline",size:"sm",onClick:d,children:[n.jsx(va,{className:"h-4 w-4 mr-2"}),"Resetear"]})]}),n.jsxs(oe,{variant:s?"default":"outline",size:"sm",onClick:()=>a(!s),children:[n.jsx(xa,{className:"h-4 w-4 mr-2"}),s?"Guardar":"Editar Dashboard"]})]})]})]}),n.jsx(Bo,{sensors:f,collisionDetection:$a,onDragEnd:g,children:n.jsxs(Ko,{items:l.map(R=>R.id),strategy:$n,children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx("div",{className:"md:col-span-2 lg:col-span-1",children:n.jsx(Bi,{})}),l.filter(R=>R.size==="small").slice(0,3).map(R=>n.jsx(mn,{widget:R,isEditMode:s,onRemove:()=>i(R.id),children:Y(R.type)},R.id))]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.filter(R=>R.size==="large").map(R=>n.jsx(mn,{widget:R,isEditMode:s,onRemove:()=>i(R.id),children:Y(R.type)},R.id))}),n.jsx("div",{className:"space-y-6",children:l.filter(R=>R.size==="full").map(R=>n.jsx(mn,{widget:R,isEditMode:s,onRemove:()=>i(R.id),children:Y(R.type)},R.id))})]})}),n.jsx($i,{open:u,onOpenChange:m,hiddenWidgets:r,onAddWidget:i}),n.jsx(pr,{open:x,onOpenChange:R=>{if(v(R),R){const O=b||90,q=[180,150,120,90].find(ie=>ie<=O)||90;h((e==null?void 0:e.branchName)||""),T(q),y(Math.max(0,O-q))}},children:n.jsxs(xr,{className:"max-w-md",children:[n.jsx(vr,{children:n.jsx(br,{children:"Configurar Plazo de Inventario"})}),n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(ln,{className:"text-muted-foreground",children:"Sucursal Seleccionada"}),n.jsx("div",{className:"text-lg font-semibold border p-3 rounded-md bg-muted/50",children:(e==null?void 0:e.branchName)||"Sin sucursal asignada"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(ln,{children:"Das Base"}),n.jsx("div",{className:"grid grid-cols-4 gap-3",children:[90,120,150,180].map(R=>n.jsx("button",{onClick:()=>T(R),className:Ne("flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all",E===R?"border-primary bg-primary/10 text-primary font-bold":"border-muted hover:border-primary/50 text-muted-foreground"),children:n.jsx("span",{className:"text-xl",children:R})},R))})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(ln,{children:"Prroga (Das adicionales)"}),n.jsxs("div",{className:"flex gap-4 items-center",children:[n.jsx(ze,{type:"number",placeholder:"0",className:"text-lg font-medium",value:N,onChange:R=>y(Number(R.target.value)),min:0}),n.jsxs("div",{className:"text-sm text-muted-foreground text-nowrap",children:["Total: ",n.jsx("span",{className:"font-bold text-foreground mx-1 text-lg",children:E+N})," das"]})]})]}),n.jsx(oe,{className:"w-full mt-2",onClick:async()=>{if(!(e!=null&&e.branchName))return;const R=E+N;try{await xt.saveBranchConfig(e.branchName,R),Ke.success(`Plazo actualizado a ${R} das`),v(!1),w(R)}catch{Ke.error("Error al guardar")}},children:"Guardar Configuracin"})]})]})}),n.jsx(cl,{open:I,onOpenChange:P,initialDate:C})]})}export{Ul as default};
