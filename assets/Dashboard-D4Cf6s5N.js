import{j as t}from"./ui-vendor-CwIRxpyq.js";import{r as o,c as Y,a as Ze,u as Wn}from"./react-vendor-ylmX0jv_.js";import{c as V,C as St,a as Ve,T as Fs,B as O,b as le,X as $s,P as Vn,D as _s,d as Gs,e as Hs,f as qs,g as Fn,S as Ys,h as Q,i as P,j as $,k as _,l as $n,m as G,n as _n,o as Gn,u as Me,p as Yt,s as Tt,q as Hn,U as Xs,W as qn,R as Yn,r as Xn,t as Kn,I as Zn,v as Jn,w as Qn,x as er,y as tr,z as sr,A as Ae,E as Xt,F as Kt,G as Zt,H as Jt,J as nr,K as rr}from"./index-4S8qSKY8.js";import{D as st,c as Je}from"./cyclicInventoryService-K8MCqZkd.js";import{T as Re}from"./trending-up-1iujbUMO.js";import{C as lt}from"./clock-9bgXU4PT.js";import{H as ar}from"./history-p48GtpW_.js";import{T as Ks}from"./target-audn23Tb.js";import{W as Zs}from"./wifi-Yt91KO94.js";import{C as yt,e as pt}from"./es-K6a7ZvuD.js";import{A as ir}from"./AnimatedCard-CqjuAElZ.js";import{D as or,a as lr,b as cr,c as dr,M as ur,A as ys,P as Js}from"./progress-BsQoly8O.js";import{I as de}from"./input-N8FoNaiK.js";import{S as mr,A as zt}from"./AnimatedProgressBar-BSngoSex.js";import{P as ct}from"./plus-Ds5SGdqx.js";import{g as fr}from"./expirationDB-CDs0AeDx.js";import{m as xe,A as Qs}from"./animation-DbfETv0H.js";import{A as hr}from"./arrow-right-BYGU_Lql.js";import{T as Qt}from"./trending-down-DeOMxKN6.js";import{C as en}from"./CounterAnimation-DSOCKTOo.js";import{T as xr,a as pr,b as Ot,c as je,d as gr,e as U}from"./table-BiveKZVQ.js";import{R as tn,L as vr,C as br,X as yr,Y as jr,T as sn,a as Nr,b as js,P as wr,c as Cr,d as Sr}from"./chart-vendor-DCWeqmYi.js";import{E as Dr}from"./eye-eiyR5p8T.js";import{s as kr,e as Er,a as Ir,b as Ar,g as Mr,f as Ns,i as Rr,h as Tr,p as zr,d as Or,j as Pr,k as Lr}from"./utils-DNiwW225.js";import{C as Br}from"./chevron-left-txmMB_mc.js";import{L as Pt}from"./label-Bq-JCdPU.js";import{C as nn}from"./check-znI9iVYe.js";import"./excel-uoQkVabA.js";import"./circle-CFt03vzg.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=V("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=V("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=V("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=V("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=V("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=V("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=V("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=V("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=V("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=V("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=V("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=V("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=V("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=V("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=V("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=V("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=V("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=V("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=V("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Zr(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return o.useMemo(()=>r=>{s.forEach(a=>a(r))},s)}const Dt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $e(e){const s=Object.prototype.toString.call(e);return s==="[object Window]"||s==="[object global]"}function ss(e){return"nodeType"in e}function ee(e){var s,n;return e?$e(e)?e:ss(e)&&(s=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function ns(e){const{Document:s}=ee(e);return e instanceof s}function dt(e){return $e(e)?!1:e instanceof ee(e).HTMLElement}function ln(e){return e instanceof ee(e).SVGElement}function _e(e){return e?$e(e)?e.document:ss(e)?ns(e)?e:dt(e)||ln(e)?e.ownerDocument:document:document:document}const pe=Dt?o.useLayoutEffect:o.useEffect;function rs(e){const s=o.useRef(e);return pe(()=>{s.current=e}),o.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return s.current==null?void 0:s.current(...r)},[])}function Jr(){const e=o.useRef(null),s=o.useCallback((r,a)=>{e.current=setInterval(r,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[s,n]}function nt(e,s){s===void 0&&(s=[e]);const n=o.useRef(e);return pe(()=>{n.current!==e&&(n.current=e)},s),n}function ut(e,s){const n=o.useRef();return o.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...s])}function jt(e){const s=rs(e),n=o.useRef(null),r=o.useCallback(a=>{a!==n.current&&(s==null||s(a,n.current)),n.current=a},[]);return[n,r]}function $t(e){const s=o.useRef();return o.useEffect(()=>{s.current=e},[e]),s.current}let Lt={};function mt(e,s){return o.useMemo(()=>{if(s)return s;const n=Lt[e]==null?0:Lt[e]+1;return Lt[e]=n,e+"-"+n},[e,s])}function cn(e){return function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((i,l)=>{const u=Object.entries(l);for(const[d,f]of u){const m=i[d];m!=null&&(i[d]=m+e*f)}return i},{...s})}}const Fe=cn(1),rt=cn(-1);function Qr(e){return"clientX"in e&&"clientY"in e}function as(e){if(!e)return!1;const{KeyboardEvent:s}=ee(e.target);return s&&e instanceof s}function ea(e){if(!e)return!1;const{TouchEvent:s}=ee(e.target);return s&&e instanceof s}function _t(e){if(ea(e)){if(e.touches&&e.touches.length){const{clientX:s,clientY:n}=e.touches[0];return{x:s,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:s,clientY:n}=e.changedTouches[0];return{x:s,y:n}}}return Qr(e)?{x:e.clientX,y:e.clientY}:null}const at=Object.freeze({Translate:{toString(e){if(!e)return;const{x:s,y:n}=e;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:s,scaleY:n}=e;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[at.Translate.toString(e),at.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:s,duration:n,easing:r}=e;return s+" "+n+"ms "+r}}}),Ss="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ta(e){return e.matches(Ss)?e:e.querySelector(Ss)}const sa={display:"none"};function na(e){let{id:s,value:n}=e;return Y.createElement("div",{id:s,style:sa},n)}function ra(e){let{id:s,announcement:n,ariaLiveType:r="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:s,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function aa(){const[e,s]=o.useState("");return{announce:o.useCallback(r=>{r!=null&&s(r)},[]),announcement:e}}const dn=o.createContext(null);function ia(e){const s=o.useContext(dn);o.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(e)},[e,s])}function oa(){const[e]=o.useState(()=>new Set),s=o.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[o.useCallback(r=>{let{type:a,event:i}=r;e.forEach(l=>{var u;return(u=l[a])==null?void 0:u.call(l,i)})},[e]),s]}const la={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ca={onDragStart(e){let{active:s}=e;return"Picked up draggable item "+s.id+"."},onDragOver(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(e){let{active:s}=e;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function da(e){let{announcements:s=ca,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=la}=e;const{announce:i,announcement:l}=aa(),u=mt("DndLiveRegion"),[d,f]=o.useState(!1);if(o.useEffect(()=>{f(!0)},[]),ia(o.useMemo(()=>({onDragStart(c){let{active:h}=c;i(s.onDragStart({active:h}))},onDragMove(c){let{active:h,over:x}=c;s.onDragMove&&i(s.onDragMove({active:h,over:x}))},onDragOver(c){let{active:h,over:x}=c;i(s.onDragOver({active:h,over:x}))},onDragEnd(c){let{active:h,over:x}=c;i(s.onDragEnd({active:h,over:x}))},onDragCancel(c){let{active:h,over:x}=c;i(s.onDragCancel({active:h,over:x}))}}),[i,s])),!d)return null;const m=Y.createElement(Y.Fragment,null,Y.createElement(na,{id:r,value:a.draggable}),Y.createElement(ra,{id:u,announcement:l}));return n?Ze.createPortal(m,n):m}var W;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(W||(W={}));function Nt(){}function Ds(e,s){return o.useMemo(()=>({sensor:e,options:s??{}}),[e,s])}function ua(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return o.useMemo(()=>[...s].filter(r=>r!=null),[...s])}const ue=Object.freeze({x:0,y:0});function un(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function mn(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return n-r}function ma(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return r-n}function ks(e){let{left:s,top:n,height:r,width:a}=e;return[{x:s,y:n},{x:s+a,y:n},{x:s,y:n+r},{x:s+a,y:n+r}]}function fn(e,s){if(!e||e.length===0)return null;const[n]=e;return n[s]}function Es(e,s,n){return s===void 0&&(s=e.left),n===void 0&&(n=e.top),{x:s+e.width*.5,y:n+e.height*.5}}const fa=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=Es(s,s.left,s.top),i=[];for(const l of r){const{id:u}=l,d=n.get(u);if(d){const f=un(Es(d),a);i.push({id:u,data:{droppableContainer:l,value:f}})}}return i.sort(mn)},ha=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=ks(s),i=[];for(const l of r){const{id:u}=l,d=n.get(u);if(d){const f=ks(d),m=a.reduce((h,x,N)=>h+un(f[N],x),0),c=Number((m/4).toFixed(4));i.push({id:u,data:{droppableContainer:l,value:c}})}}return i.sort(mn)};function xa(e,s){const n=Math.max(s.top,e.top),r=Math.max(s.left,e.left),a=Math.min(s.left+s.width,e.left+e.width),i=Math.min(s.top+s.height,e.top+e.height),l=a-r,u=i-n;if(r<a&&n<i){const d=s.width*s.height,f=e.width*e.height,m=l*u,c=m/(d+f-m);return Number(c.toFixed(4))}return 0}const pa=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=[];for(const i of r){const{id:l}=i,u=n.get(l);if(u){const d=xa(u,s);d>0&&a.push({id:l,data:{droppableContainer:i,value:d}})}}return a.sort(ma)};function ga(e,s,n){return{...e,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function hn(e,s){return e&&s?{x:e.left-s.left,y:e.top-s.top}:ue}function va(e){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return a.reduce((l,u)=>({...l,top:l.top+e*u.y,bottom:l.bottom+e*u.y,left:l.left+e*u.x,right:l.right+e*u.x}),{...n})}}const ba=va(1);function ya(e){if(e.startsWith("matrix3d(")){const s=e.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(e.startsWith("matrix(")){const s=e.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function ja(e,s,n){const r=ya(s);if(!r)return e;const{scaleX:a,scaleY:i,x:l,y:u}=r,d=e.left-l-(1-a)*parseFloat(n),f=e.top-u-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),m=a?e.width/a:e.width,c=i?e.height/i:e.height;return{width:m,height:c,top:f,right:d+m,bottom:f+c,left:d}}const Na={ignoreTransform:!1};function Ge(e,s){s===void 0&&(s=Na);let n=e.getBoundingClientRect();if(s.ignoreTransform){const{transform:f,transformOrigin:m}=ee(e).getComputedStyle(e);f&&(n=ja(n,f,m))}const{top:r,left:a,width:i,height:l,bottom:u,right:d}=n;return{top:r,left:a,width:i,height:l,bottom:u,right:d}}function Is(e){return Ge(e,{ignoreTransform:!0})}function wa(e){const s=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function Ca(e,s){return s===void 0&&(s=ee(e).getComputedStyle(e)),s.position==="fixed"}function Sa(e,s){s===void 0&&(s=ee(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=s[a];return typeof i=="string"?n.test(i):!1})}function kt(e,s){const n=[];function r(a){if(s!=null&&n.length>=s||!a)return n;if(ns(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!dt(a)||ln(a)||n.includes(a))return n;const i=ee(e).getComputedStyle(a);return a!==e&&Sa(a,i)&&n.push(a),Ca(a,i)?n:r(a.parentNode)}return e?r(e):n}function xn(e){const[s]=kt(e,1);return s??null}function Bt(e){return!Dt||!e?null:$e(e)?e:ss(e)?ns(e)||e===_e(e).scrollingElement?window:dt(e)?e:null:null}function pn(e){return $e(e)?e.scrollX:e.scrollLeft}function gn(e){return $e(e)?e.scrollY:e.scrollTop}function Gt(e){return{x:pn(e),y:gn(e)}}var F;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(F||(F={}));function vn(e){return!Dt||!e?!1:e===document.scrollingElement}function bn(e){const s={x:0,y:0},n=vn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=s.y,i=e.scrollLeft<=s.x,l=e.scrollTop>=r.y,u=e.scrollLeft>=r.x;return{isTop:a,isLeft:i,isBottom:l,isRight:u,maxScroll:r,minScroll:s}}const Da={x:.2,y:.2};function ka(e,s,n,r,a){let{top:i,left:l,right:u,bottom:d}=n;r===void 0&&(r=10),a===void 0&&(a=Da);const{isTop:f,isBottom:m,isLeft:c,isRight:h}=bn(e),x={x:0,y:0},N={x:0,y:0},p={height:s.height*a.y,width:s.width*a.x};return!f&&i<=s.top+p.height?(x.y=F.Backward,N.y=r*Math.abs((s.top+p.height-i)/p.height)):!m&&d>=s.bottom-p.height&&(x.y=F.Forward,N.y=r*Math.abs((s.bottom-p.height-d)/p.height)),!h&&u>=s.right-p.width?(x.x=F.Forward,N.x=r*Math.abs((s.right-p.width-u)/p.width)):!c&&l<=s.left+p.width&&(x.x=F.Backward,N.x=r*Math.abs((s.left+p.width-l)/p.width)),{direction:x,speed:N}}function Ea(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:s,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:s,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function yn(e){return e.reduce((s,n)=>Fe(s,Gt(n)),ue)}function Ia(e){return e.reduce((s,n)=>s+pn(n),0)}function Aa(e){return e.reduce((s,n)=>s+gn(n),0)}function Ma(e,s){if(s===void 0&&(s=Ge),!e)return;const{top:n,left:r,bottom:a,right:i}=s(e);xn(e)&&(a<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ra=[["x",["left","right"],Ia],["y",["top","bottom"],Aa]];class is{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=kt(n),a=yn(r);this.rect={...s},this.width=s.width,this.height=s.height;for(const[i,l,u]of Ra)for(const d of l)Object.defineProperty(this,d,{get:()=>{const f=u(r),m=a[i]-f;return this.rect[d]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Qe{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=s}add(s,n,r){var a;(a=this.target)==null||a.addEventListener(s,n,r),this.listeners.push([s,n,r])}}function Ta(e){const{EventTarget:s}=ee(e);return e instanceof s?e:_e(e)}function Ut(e,s){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof s=="number"?Math.sqrt(n**2+r**2)>s:"x"in s&&"y"in s?n>s.x&&r>s.y:"x"in s?n>s.x:"y"in s?r>s.y:!1}var oe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(oe||(oe={}));function As(e){e.preventDefault()}function za(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const jn={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},Oa=(e,s)=>{let{currentCoordinates:n}=s;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class os{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new Qe(_e(n)),this.windowListeners=new Qe(ee(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(oe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,r=s.node.current;r&&Ma(r),n(ue)}handleKeyDown(s){if(as(s)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:i=jn,coordinateGetter:l=Oa,scrollBehavior:u="smooth"}=a,{code:d}=s;if(i.end.includes(d)){this.handleEnd(s);return}if(i.cancel.includes(d)){this.handleCancel(s);return}const{collisionRect:f}=r.current,m=f?{x:f.left,y:f.top}:ue;this.referenceCoordinates||(this.referenceCoordinates=m);const c=l(s,{active:n,context:r.current,currentCoordinates:m});if(c){const h=rt(c,m),x={x:0,y:0},{scrollableAncestors:N}=r.current;for(const p of N){const g=s.code,{isTop:y,isRight:v,isLeft:j,isBottom:w,maxScroll:b,minScroll:S}=bn(p),k=Ea(p),C={x:Math.min(g===E.Right?k.right-k.width/2:k.right,Math.max(g===E.Right?k.left:k.left+k.width/2,c.x)),y:Math.min(g===E.Down?k.bottom-k.height/2:k.bottom,Math.max(g===E.Down?k.top:k.top+k.height/2,c.y))},I=g===E.Right&&!v||g===E.Left&&!j,M=g===E.Down&&!w||g===E.Up&&!y;if(I&&C.x!==c.x){const A=p.scrollLeft+h.x,L=g===E.Right&&A<=b.x||g===E.Left&&A>=S.x;if(L&&!h.y){p.scrollTo({left:A,behavior:u});return}L?x.x=p.scrollLeft-A:x.x=g===E.Right?p.scrollLeft-b.x:p.scrollLeft-S.x,x.x&&p.scrollBy({left:-x.x,behavior:u});break}else if(M&&C.y!==c.y){const A=p.scrollTop+h.y,L=g===E.Down&&A<=b.y||g===E.Up&&A>=S.y;if(L&&!h.x){p.scrollTo({top:A,behavior:u});return}L?x.y=p.scrollTop-A:x.y=g===E.Down?p.scrollTop-b.y:p.scrollTop-S.y,x.y&&p.scrollBy({top:-x.y,behavior:u});break}}this.handleMove(s,Fe(rt(c,this.referenceCoordinates),x))}}}handleMove(s,n){const{onMove:r}=this.props;s.preventDefault(),r(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}os.activators=[{eventName:"onKeyDown",handler:(e,s,n)=>{let{keyboardCodes:r=jn,onActivation:a}=s,{active:i}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const u=i.activatorNode.current;return u&&e.target!==u?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Ms(e){return!!(e&&"distance"in e)}function Rs(e){return!!(e&&"delay"in e)}class ls{constructor(s,n,r){var a;r===void 0&&(r=Ta(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:i}=s,{target:l}=i;this.props=s,this.events=n,this.document=_e(l),this.documentListeners=new Qe(this.document),this.listeners=new Qe(r),this.windowListeners=new Qe(ee(l)),this.initialCoordinates=(a=_t(i))!=null?a:ue,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.DragStart,As),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),this.windowListeners.add(oe.ContextMenu,As),this.documentListeners.add(oe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Rs(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ms(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:r,onPending:a}=this.props;a(r,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(oe.Click,za,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(oe.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:r,initialCoordinates:a,props:i}=this,{onMove:l,options:{activationConstraint:u}}=i;if(!a)return;const d=(n=_t(s))!=null?n:ue,f=rt(a,d);if(!r&&u){if(Ms(u)){if(u.tolerance!=null&&Ut(f,u.tolerance))return this.handleCancel();if(Ut(f,u.distance))return this.handleStart()}if(Rs(u)&&Ut(f,u.tolerance))return this.handleCancel();this.handlePending(u,f);return}s.cancelable&&s.preventDefault(),l(d)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===E.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const Pa={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class cs extends ls{constructor(s){const{event:n}=s,r=_e(n.target);super(s,Pa,r)}}cs.activators=[{eventName:"onPointerDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const La={move:{name:"mousemove"},end:{name:"mouseup"}};var Ht;(function(e){e[e.RightClick=2]="RightClick"})(Ht||(Ht={}));class Ba extends ls{constructor(s){super(s,La,_e(s.event.target))}}Ba.activators=[{eventName:"onMouseDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return n.button===Ht.RightClick?!1:(r==null||r({event:n}),!0)}}];const Wt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ua extends ls{constructor(s){super(s,Wt)}static setup(){return window.addEventListener(Wt.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(Wt.move.name,s)};function s(){}}}Ua.activators=[{eventName:"onTouchStart",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;const{touches:a}=n;return a.length>1?!1:(r==null||r({event:n}),!0)}}];var et;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(et||(et={}));var wt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(wt||(wt={}));function Wa(e){let{acceleration:s,activator:n=et.Pointer,canScroll:r,draggingRect:a,enabled:i,interval:l=5,order:u=wt.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:m,delta:c,threshold:h}=e;const x=Fa({delta:c,disabled:!i}),[N,p]=Jr(),g=o.useRef({x:0,y:0}),y=o.useRef({x:0,y:0}),v=o.useMemo(()=>{switch(n){case et.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case et.DraggableRect:return a}},[n,a,d]),j=o.useRef(null),w=o.useCallback(()=>{const S=j.current;if(!S)return;const k=g.current.x*y.current.x,C=g.current.y*y.current.y;S.scrollBy(k,C)},[]),b=o.useMemo(()=>u===wt.TreeOrder?[...f].reverse():f,[u,f]);o.useEffect(()=>{if(!i||!f.length||!v){p();return}for(const S of b){if((r==null?void 0:r(S))===!1)continue;const k=f.indexOf(S),C=m[k];if(!C)continue;const{direction:I,speed:M}=ka(S,C,v,s,h);for(const A of["x","y"])x[A][I[A]]||(M[A]=0,I[A]=0);if(M.x>0||M.y>0){p(),j.current=S,N(w,l),g.current=M,y.current=I;return}}g.current={x:0,y:0},y.current={x:0,y:0},p()},[s,w,r,p,i,l,JSON.stringify(v),JSON.stringify(x),N,f,b,m,JSON.stringify(h)])}const Va={x:{[F.Backward]:!1,[F.Forward]:!1},y:{[F.Backward]:!1,[F.Forward]:!1}};function Fa(e){let{delta:s,disabled:n}=e;const r=$t(s);return ut(a=>{if(n||!r||!a)return Va;const i={x:Math.sign(s.x-r.x),y:Math.sign(s.y-r.y)};return{x:{[F.Backward]:a.x[F.Backward]||i.x===-1,[F.Forward]:a.x[F.Forward]||i.x===1},y:{[F.Backward]:a.y[F.Backward]||i.y===-1,[F.Forward]:a.y[F.Forward]||i.y===1}}},[n,s,r])}function $a(e,s){const n=s!=null?e.get(s):void 0,r=n?n.node.current:null;return ut(a=>{var i;return s==null?null:(i=r??a)!=null?i:null},[r,s])}function _a(e,s){return o.useMemo(()=>e.reduce((n,r)=>{const{sensor:a}=r,i=a.activators.map(l=>({eventName:l.eventName,handler:s(l.handler,r)}));return[...n,...i]},[]),[e,s])}var it;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(it||(it={}));var qt;(function(e){e.Optimized="optimized"})(qt||(qt={}));const Ts=new Map;function Ga(e,s){let{dragging:n,dependencies:r,config:a}=s;const[i,l]=o.useState(null),{frequency:u,measure:d,strategy:f}=a,m=o.useRef(e),c=g(),h=nt(c),x=o.useCallback(function(y){y===void 0&&(y=[]),!h.current&&l(v=>v===null?y:v.concat(y.filter(j=>!v.includes(j))))},[h]),N=o.useRef(null),p=ut(y=>{if(c&&!n)return Ts;if(!y||y===Ts||m.current!==e||i!=null){const v=new Map;for(let j of e){if(!j)continue;if(i&&i.length>0&&!i.includes(j.id)&&j.rect.current){v.set(j.id,j.rect.current);continue}const w=j.node.current,b=w?new is(d(w),w):null;j.rect.current=b,b&&v.set(j.id,b)}return v}return y},[e,i,n,c,d]);return o.useEffect(()=>{m.current=e},[e]),o.useEffect(()=>{c||x()},[n,c]),o.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),o.useEffect(()=>{c||typeof u!="number"||N.current!==null||(N.current=setTimeout(()=>{x(),N.current=null},u))},[u,c,x,...r]),{droppableRects:p,measureDroppableContainers:x,measuringScheduled:i!=null};function g(){switch(f){case it.Always:return!1;case it.BeforeDragging:return n;default:return!n}}}function Nn(e,s){return ut(n=>e?n||(typeof s=="function"?s(e):e):null,[s,e])}function Ha(e,s){return Nn(e,s)}function qa(e){let{callback:s,disabled:n}=e;const r=rs(s),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Et(e){let{callback:s,disabled:n}=e;const r=rs(s),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Ya(e){return new is(Ge(e),e)}function zs(e,s,n){s===void 0&&(s=Ya);const[r,a]=o.useState(null);function i(){a(d=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=d??n)!=null?f:null}const m=s(e);return JSON.stringify(d)===JSON.stringify(m)?d:m})}const l=qa({callback(d){if(e)for(const f of d){const{type:m,target:c}=f;if(m==="childList"&&c instanceof HTMLElement&&c.contains(e)){i();break}}}}),u=Et({callback:i});return pe(()=>{i(),e?(u==null||u.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(u==null||u.disconnect(),l==null||l.disconnect())},[e]),r}function Xa(e){const s=Nn(e);return hn(e,s)}const Os=[];function Ka(e){const s=o.useRef(e),n=ut(r=>e?r&&r!==Os&&e&&s.current&&e.parentNode===s.current.parentNode?r:kt(e):Os,[e]);return o.useEffect(()=>{s.current=e},[e]),n}function Za(e){const[s,n]=o.useState(null),r=o.useRef(e),a=o.useCallback(i=>{const l=Bt(i.target);l&&n(u=>u?(u.set(l,Gt(l)),new Map(u)):null)},[]);return o.useEffect(()=>{const i=r.current;if(e!==i){l(i);const u=e.map(d=>{const f=Bt(d);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,Gt(f)]):null}).filter(d=>d!=null);n(u.length?new Map(u):null),r.current=e}return()=>{l(e),l(i)};function l(u){u.forEach(d=>{const f=Bt(d);f==null||f.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?s?Array.from(s.values()).reduce((i,l)=>Fe(i,l),ue):yn(e):ue,[e,s])}function Ps(e,s){s===void 0&&(s=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},s),o.useEffect(()=>{const r=e!==ue;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?rt(e,n.current):ue}function Ja(e){o.useEffect(()=>{if(!Dt)return;const s=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of s)n==null||n()}},e.map(s=>{let{sensor:n}=s;return n}))}function Qa(e,s){return o.useMemo(()=>e.reduce((n,r)=>{let{eventName:a,handler:i}=r;return n[a]=l=>{i(l,s)},n},{}),[e,s])}function wn(e){return o.useMemo(()=>e?wa(e):null,[e])}const Ls=[];function ei(e,s){s===void 0&&(s=Ge);const[n]=e,r=wn(n?ee(n):null),[a,i]=o.useState(Ls);function l(){i(()=>e.length?e.map(d=>vn(d)?r:new is(s(d),d)):Ls)}const u=Et({callback:l});return pe(()=>{u==null||u.disconnect(),l(),e.forEach(d=>u==null?void 0:u.observe(d))},[e]),a}function ti(e){if(!e)return null;if(e.children.length>1)return e;const s=e.children[0];return dt(s)?s:e}function si(e){let{measure:s}=e;const[n,r]=o.useState(null),a=o.useCallback(f=>{for(const{target:m}of f)if(dt(m)){r(c=>{const h=s(m);return c?{...c,width:h.width,height:h.height}:h});break}},[s]),i=Et({callback:a}),l=o.useCallback(f=>{const m=ti(f);i==null||i.disconnect(),m&&(i==null||i.observe(m)),r(m?s(m):null)},[s,i]),[u,d]=jt(l);return o.useMemo(()=>({nodeRef:u,rect:n,setRef:d}),[n,u,d])}const ni=[{sensor:cs,options:{}},{sensor:os,options:{}}],ri={current:{}},bt={draggable:{measure:Is},droppable:{measure:Is,strategy:it.WhileDragging,frequency:qt.Optimized},dragOverlay:{measure:Ge}};class tt extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,r;return(n=(r=this.get(s))==null?void 0:r.node.current)!=null?n:void 0}}const ai={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new tt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Nt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:bt,measureDroppableContainers:Nt,windowRect:null,measuringScheduled:!1},ii={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Nt,draggableNodes:new Map,over:null,measureDroppableContainers:Nt},It=o.createContext(ii),Cn=o.createContext(ai);function oi(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new tt}}}function li(e,s){switch(s.type){case W.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case W.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:s.coordinates.x-e.draggable.initialCoordinates.x,y:s.coordinates.y-e.draggable.initialCoordinates.y}}};case W.DragEnd:case W.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case W.RegisterDroppable:{const{element:n}=s,{id:r}=n,a=new tt(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case W.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=s,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const l=new tt(e.droppable.containers);return l.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case W.UnregisterDroppable:{const{id:n,key:r}=s,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const i=new tt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function ci(e){let{disabled:s}=e;const{active:n,activatorEvent:r,draggableNodes:a}=o.useContext(It),i=$t(r),l=$t(n==null?void 0:n.id);return o.useEffect(()=>{if(!s&&!r&&i&&l!=null){if(!as(i)||document.activeElement===i.target)return;const u=a.get(l);if(!u)return;const{activatorNode:d,node:f}=u;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const m of[d.current,f.current]){if(!m)continue;const c=ta(m);if(c){c.focus();break}}})}},[r,s,a,l,i]),null}function di(e,s){let{transform:n,...r}=s;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...r}),n):n}function ui(e){return o.useMemo(()=>({draggable:{...bt.draggable,...e==null?void 0:e.draggable},droppable:{...bt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...bt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function mi(e){let{activeNode:s,measure:n,initialRect:r,config:a=!0}=e;const i=o.useRef(!1),{x:l,y:u}=typeof a=="boolean"?{x:a,y:a}:a;pe(()=>{if(!l&&!u||!s){i.current=!1;return}if(i.current||!r)return;const f=s==null?void 0:s.node.current;if(!f||f.isConnected===!1)return;const m=n(f),c=hn(m,r);if(l||(c.x=0),u||(c.y=0),i.current=!0,Math.abs(c.x)>0||Math.abs(c.y)>0){const h=xn(f);h&&h.scrollBy({top:c.y,left:c.x})}},[s,l,u,r,n])}const Sn=o.createContext({...ue,scaleX:1,scaleY:1});var Ie;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ie||(Ie={}));const fi=o.memo(function(s){var n,r,a,i;let{id:l,accessibility:u,autoScroll:d=!0,children:f,sensors:m=ni,collisionDetection:c=pa,measuring:h,modifiers:x,...N}=s;const p=o.useReducer(li,void 0,oi),[g,y]=p,[v,j]=oa(),[w,b]=o.useState(Ie.Uninitialized),S=w===Ie.Initialized,{draggable:{active:k,nodes:C,translate:I},droppable:{containers:M}}=g,A=k!=null?C.get(k):null,L=o.useRef({initial:null,translated:null}),H=o.useMemo(()=>{var K;return k!=null?{id:k,data:(K=A==null?void 0:A.data)!=null?K:ri,rect:L}:null},[k,A]),Z=o.useRef(null),[ge,Te]=o.useState(null),[J,ze]=o.useState(null),ce=nt(N,Object.values(N)),D=mt("DndDescribedBy",l),z=o.useMemo(()=>M.getEnabled(),[M]),T=ui(h),{droppableRects:B,measureDroppableContainers:X,measuringScheduled:re}=Ga(z,{dragging:S,dependencies:[I.x,I.y],config:T.droppable}),ae=$a(C,k),ft=o.useMemo(()=>J?_t(J):null,[J]),we=Un(),ve=Ha(ae,T.draggable.measure);mi({activeNode:k!=null?C.get(k):null,config:we.layoutShiftCompensation,initialRect:ve,measure:T.draggable.measure});const R=zs(ae,T.draggable.measure,ve),He=zs(ae?ae.parentElement:null),me=o.useRef({activatorEvent:null,active:null,activeNode:ae,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Oe=M.getNodeFor((n=me.current.over)==null?void 0:n.id),be=si({measure:T.dragOverlay.measure}),Pe=(r=be.nodeRef.current)!=null?r:ae,Le=S?(a=be.rect)!=null?a:R:null,ms=!!(be.nodeRef.current&&be.rect),fs=Xa(ms?null:R),At=wn(Pe?ee(Pe):null),Ce=Ka(S?Oe??ae:null),ht=ei(Ce),xt=di(x,{transform:{x:I.x-fs.x,y:I.y-fs.y,scaleX:1,scaleY:1},activatorEvent:J,active:H,activeNodeRect:R,containerNodeRect:He,draggingNodeRect:Le,over:me.current.over,overlayNodeRect:be.rect,scrollableAncestors:Ce,scrollableAncestorRects:ht,windowRect:At}),hs=ft?Fe(ft,I):null,xs=Za(Ce),Rn=Ps(xs),Tn=Ps(xs,[R]),Be=Fe(xt,Rn),Ue=Le?ba(Le,xt):null,qe=H&&Ue?c({active:H,collisionRect:Ue,droppableRects:B,droppableContainers:z,pointerCoordinates:hs}):null,ps=fn(qe,"id"),[Se,gs]=o.useState(null),zn=ms?xt:Fe(xt,Tn),On=ga(zn,(i=Se==null?void 0:Se.rect)!=null?i:null,R),Mt=o.useRef(null),vs=o.useCallback((K,te)=>{let{sensor:se,options:De}=te;if(Z.current==null)return;const ie=C.get(Z.current);if(!ie)return;const ne=K.nativeEvent,fe=new se({active:Z.current,activeNode:ie,event:ne,options:De,context:me,onAbort(q){if(!C.get(q))return;const{onDragAbort:he}=ce.current,ye={id:q};he==null||he(ye),v({type:"onDragAbort",event:ye})},onPending(q,ke,he,ye){if(!C.get(q))return;const{onDragPending:Xe}=ce.current,Ee={id:q,constraint:ke,initialCoordinates:he,offset:ye};Xe==null||Xe(Ee),v({type:"onDragPending",event:Ee})},onStart(q){const ke=Z.current;if(ke==null)return;const he=C.get(ke);if(!he)return;const{onDragStart:ye}=ce.current,Ye={activatorEvent:ne,active:{id:ke,data:he.data,rect:L}};Ze.unstable_batchedUpdates(()=>{ye==null||ye(Ye),b(Ie.Initializing),y({type:W.DragStart,initialCoordinates:q,active:ke}),v({type:"onDragStart",event:Ye}),Te(Mt.current),ze(ne)})},onMove(q){y({type:W.DragMove,coordinates:q})},onEnd:We(W.DragEnd),onCancel:We(W.DragCancel)});Mt.current=fe;function We(q){return async function(){const{active:he,collisions:ye,over:Ye,scrollAdjustedTranslate:Xe}=me.current;let Ee=null;if(he&&Xe){const{cancelDrop:Ke}=ce.current;Ee={activatorEvent:ne,active:he,collisions:ye,delta:Xe,over:Ye},q===W.DragEnd&&typeof Ke=="function"&&await Promise.resolve(Ke(Ee))&&(q=W.DragCancel)}Z.current=null,Ze.unstable_batchedUpdates(()=>{y({type:q}),b(Ie.Uninitialized),gs(null),Te(null),ze(null),Mt.current=null;const Ke=q===W.DragEnd?"onDragEnd":"onDragCancel";if(Ee){const Rt=ce.current[Ke];Rt==null||Rt(Ee),v({type:Ke,event:Ee})}})}}},[C]),Pn=o.useCallback((K,te)=>(se,De)=>{const ie=se.nativeEvent,ne=C.get(De);if(Z.current!==null||!ne||ie.dndKit||ie.defaultPrevented)return;const fe={active:ne};K(se,te.options,fe)===!0&&(ie.dndKit={capturedBy:te.sensor},Z.current=De,vs(se,te))},[C,vs]),bs=_a(m,Pn);Ja(m),pe(()=>{R&&w===Ie.Initializing&&b(Ie.Initialized)},[R,w]),o.useEffect(()=>{const{onDragMove:K}=ce.current,{active:te,activatorEvent:se,collisions:De,over:ie}=me.current;if(!te||!se)return;const ne={active:te,activatorEvent:se,collisions:De,delta:{x:Be.x,y:Be.y},over:ie};Ze.unstable_batchedUpdates(()=>{K==null||K(ne),v({type:"onDragMove",event:ne})})},[Be.x,Be.y]),o.useEffect(()=>{const{active:K,activatorEvent:te,collisions:se,droppableContainers:De,scrollAdjustedTranslate:ie}=me.current;if(!K||Z.current==null||!te||!ie)return;const{onDragOver:ne}=ce.current,fe=De.get(ps),We=fe&&fe.rect.current?{id:fe.id,rect:fe.rect.current,data:fe.data,disabled:fe.disabled}:null,q={active:K,activatorEvent:te,collisions:se,delta:{x:ie.x,y:ie.y},over:We};Ze.unstable_batchedUpdates(()=>{gs(We),ne==null||ne(q),v({type:"onDragOver",event:q})})},[ps]),pe(()=>{me.current={activatorEvent:J,active:H,activeNode:ae,collisionRect:Ue,collisions:qe,droppableRects:B,draggableNodes:C,draggingNode:Pe,draggingNodeRect:Le,droppableContainers:M,over:Se,scrollableAncestors:Ce,scrollAdjustedTranslate:Be},L.current={initial:Le,translated:Ue}},[H,ae,qe,Ue,C,Pe,Le,B,M,Se,Ce,Be]),Wa({...we,delta:I,draggingRect:Ue,pointerCoordinates:hs,scrollableAncestors:Ce,scrollableAncestorRects:ht});const Ln=o.useMemo(()=>({active:H,activeNode:ae,activeNodeRect:R,activatorEvent:J,collisions:qe,containerNodeRect:He,dragOverlay:be,draggableNodes:C,droppableContainers:M,droppableRects:B,over:Se,measureDroppableContainers:X,scrollableAncestors:Ce,scrollableAncestorRects:ht,measuringConfiguration:T,measuringScheduled:re,windowRect:At}),[H,ae,R,J,qe,He,be,C,M,B,Se,X,Ce,ht,T,re,At]),Bn=o.useMemo(()=>({activatorEvent:J,activators:bs,active:H,activeNodeRect:R,ariaDescribedById:{draggable:D},dispatch:y,draggableNodes:C,over:Se,measureDroppableContainers:X}),[J,bs,H,R,y,D,C,Se,X]);return Y.createElement(dn.Provider,{value:j},Y.createElement(It.Provider,{value:Bn},Y.createElement(Cn.Provider,{value:Ln},Y.createElement(Sn.Provider,{value:On},f)),Y.createElement(ci,{disabled:(u==null?void 0:u.restoreFocus)===!1})),Y.createElement(da,{...u,hiddenTextDescribedById:D}));function Un(){const K=(ge==null?void 0:ge.autoScrollEnabled)===!1,te=typeof d=="object"?d.enabled===!1:d===!1,se=S&&!K&&!te;return typeof d=="object"?{...d,enabled:se}:{enabled:se}}}),hi=o.createContext(null),Bs="button",xi="Draggable";function pi(e){let{id:s,data:n,disabled:r=!1,attributes:a}=e;const i=mt(xi),{activators:l,activatorEvent:u,active:d,activeNodeRect:f,ariaDescribedById:m,draggableNodes:c,over:h}=o.useContext(It),{role:x=Bs,roleDescription:N="draggable",tabIndex:p=0}=a??{},g=(d==null?void 0:d.id)===s,y=o.useContext(g?Sn:hi),[v,j]=jt(),[w,b]=jt(),S=Qa(l,s),k=nt(n);pe(()=>(c.set(s,{id:s,key:i,node:v,activatorNode:w,data:k}),()=>{const I=c.get(s);I&&I.key===i&&c.delete(s)}),[c,s]);const C=o.useMemo(()=>({role:x,tabIndex:p,"aria-disabled":r,"aria-pressed":g&&x===Bs?!0:void 0,"aria-roledescription":N,"aria-describedby":m.draggable}),[r,x,p,g,N,m.draggable]);return{active:d,activatorEvent:u,activeNodeRect:f,attributes:C,isDragging:g,listeners:r?void 0:S,node:v,over:h,setNodeRef:j,setActivatorNodeRef:b,transform:y}}function gi(){return o.useContext(Cn)}const vi="Droppable",bi={timeout:25};function yi(e){let{data:s,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const i=mt(vi),{active:l,dispatch:u,over:d,measureDroppableContainers:f}=o.useContext(It),m=o.useRef({disabled:n}),c=o.useRef(!1),h=o.useRef(null),x=o.useRef(null),{disabled:N,updateMeasurementsFor:p,timeout:g}={...bi,...a},y=nt(p??r),v=o.useCallback(()=>{if(!c.current){c.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(y.current)?y.current:[y.current]),x.current=null},g)},[g]),j=Et({callback:v,disabled:N||!l}),w=o.useCallback((C,I)=>{j&&(I&&(j.unobserve(I),c.current=!1),C&&j.observe(C))},[j]),[b,S]=jt(w),k=nt(s);return o.useEffect(()=>{!j||!b.current||(j.disconnect(),c.current=!1,j.observe(b.current))},[b,j]),o.useEffect(()=>(u({type:W.RegisterDroppable,element:{id:r,key:i,disabled:n,node:b,rect:h,data:k}}),()=>u({type:W.UnregisterDroppable,key:i,id:r})),[r]),o.useEffect(()=>{n!==m.current.disabled&&(u({type:W.SetDroppableDisabled,id:r,key:i,disabled:n}),m.current.disabled=n)},[r,i,n,u]),{active:l,rect:h,isOver:(d==null?void 0:d.id)===r,node:b,over:d,setNodeRef:S}}function ds(e,s,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(s,1)[0]),r}function ji(e,s){return e.reduce((n,r,a)=>{const i=s.get(r);return i&&(n[a]=i),n},Array(e.length))}function gt(e){return e!==null&&e>=0}function Ni(e,s){if(e===s)return!0;if(e.length!==s.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==s[n])return!1;return!0}function wi(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const us=e=>{let{rects:s,activeIndex:n,overIndex:r,index:a}=e;const i=ds(s,r,n),l=s[a],u=i[a];return!u||!l?null:{x:u.left-l.left,y:u.top-l.top,scaleX:u.width/l.width,scaleY:u.height/l.height}},Dn="Sortable",kn=Y.createContext({activeIndex:-1,containerId:Dn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:us,disabled:{draggable:!1,droppable:!1}});function Ci(e){let{children:s,id:n,items:r,strategy:a=us,disabled:i=!1}=e;const{active:l,dragOverlay:u,droppableRects:d,over:f,measureDroppableContainers:m}=gi(),c=mt(Dn,n),h=u.rect!==null,x=o.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),N=l!=null,p=l?x.indexOf(l.id):-1,g=f?x.indexOf(f.id):-1,y=o.useRef(x),v=!Ni(x,y.current),j=g!==-1&&p===-1||v,w=wi(i);pe(()=>{v&&N&&m(x)},[v,x,N,m]),o.useEffect(()=>{y.current=x},[x]);const b=o.useMemo(()=>({activeIndex:p,containerId:c,disabled:w,disableTransforms:j,items:x,overIndex:g,useDragOverlay:h,sortedRects:ji(x,d),strategy:a}),[p,c,w.draggable,w.droppable,j,x,g,d,h,a]);return Y.createElement(kn.Provider,{value:b},s)}const Si=e=>{let{id:s,items:n,activeIndex:r,overIndex:a}=e;return ds(n,r,a).indexOf(s)},Di=e=>{let{containerId:s,isSorting:n,wasDragging:r,index:a,items:i,newIndex:l,previousItems:u,previousContainerId:d,transition:f}=e;return!f||!r||u!==i&&a===l?!1:n?!0:l!==a&&s===d},ki={duration:200,easing:"ease"},En="transform",Ei=at.Transition.toString({property:En,duration:0,easing:"linear"}),Ii={roleDescription:"sortable"};function Ai(e){let{disabled:s,index:n,node:r,rect:a}=e;const[i,l]=o.useState(null),u=o.useRef(n);return pe(()=>{if(!s&&n!==u.current&&r.current){const d=a.current;if(d){const f=Ge(r.current,{ignoreTransform:!0}),m={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(m.x||m.y)&&l(m)}}n!==u.current&&(u.current=n)},[s,n,r,a]),o.useEffect(()=>{i&&l(null)},[i]),i}function Mi(e){let{animateLayoutChanges:s=Di,attributes:n,disabled:r,data:a,getNewIndex:i=Si,id:l,strategy:u,resizeObserverConfig:d,transition:f=ki}=e;const{items:m,containerId:c,activeIndex:h,disabled:x,disableTransforms:N,sortedRects:p,overIndex:g,useDragOverlay:y,strategy:v}=o.useContext(kn),j=Ri(r,x),w=m.indexOf(l),b=o.useMemo(()=>({sortable:{containerId:c,index:w,items:m},...a}),[c,a,w,m]),S=o.useMemo(()=>m.slice(m.indexOf(l)),[m,l]),{rect:k,node:C,isOver:I,setNodeRef:M}=yi({id:l,data:b,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...d}}),{active:A,activatorEvent:L,activeNodeRect:H,attributes:Z,setNodeRef:ge,listeners:Te,isDragging:J,over:ze,setActivatorNodeRef:ce,transform:D}=pi({id:l,data:b,attributes:{...Ii,...n},disabled:j.draggable}),z=Zr(M,ge),T=!!A,B=T&&!N&&gt(h)&&gt(g),X=!y&&J,re=X&&B?D:null,ft=B?re??(u??v)({rects:p,activeNodeRect:H,activeIndex:h,overIndex:g,index:w}):null,we=gt(h)&&gt(g)?i({id:l,items:m,activeIndex:h,overIndex:g}):w,ve=A==null?void 0:A.id,R=o.useRef({activeId:ve,items:m,newIndex:we,containerId:c}),He=m!==R.current.items,me=s({active:A,containerId:c,isDragging:J,isSorting:T,id:l,index:w,items:m,newIndex:R.current.newIndex,previousItems:R.current.items,previousContainerId:R.current.containerId,transition:f,wasDragging:R.current.activeId!=null}),Oe=Ai({disabled:!me,index:w,node:C,rect:k});return o.useEffect(()=>{T&&R.current.newIndex!==we&&(R.current.newIndex=we),c!==R.current.containerId&&(R.current.containerId=c),m!==R.current.items&&(R.current.items=m)},[T,we,c,m]),o.useEffect(()=>{if(ve===R.current.activeId)return;if(ve!=null&&R.current.activeId==null){R.current.activeId=ve;return}const Pe=setTimeout(()=>{R.current.activeId=ve},50);return()=>clearTimeout(Pe)},[ve]),{active:A,activeIndex:h,attributes:Z,data:b,rect:k,index:w,newIndex:we,items:m,isOver:I,isSorting:T,isDragging:J,listeners:Te,node:C,overIndex:g,over:ze,setNodeRef:z,setActivatorNodeRef:ce,setDroppableNodeRef:M,setDraggableNodeRef:ge,transform:Oe??ft,transition:be()};function be(){if(Oe||He&&R.current.newIndex===w)return Ei;if(!(X&&!as(L)||!f)&&(T||me))return at.Transition.toString({...f,property:En})}}function Ri(e,s){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:s.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:s.droppable}}function Ct(e){if(!e)return!1;const s=e.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const Ti=[E.Down,E.Right,E.Up,E.Left],zi=(e,s)=>{let{context:{active:n,collisionRect:r,droppableRects:a,droppableContainers:i,over:l,scrollableAncestors:u}}=s;if(Ti.includes(e.code)){if(e.preventDefault(),!n||!r)return;const d=[];i.getEnabled().forEach(c=>{if(!c||c!=null&&c.disabled)return;const h=a.get(c.id);if(h)switch(e.code){case E.Down:r.top<h.top&&d.push(c);break;case E.Up:r.top>h.top&&d.push(c);break;case E.Left:r.left>h.left&&d.push(c);break;case E.Right:r.left<h.left&&d.push(c);break}});const f=ha({active:n,collisionRect:r,droppableRects:a,droppableContainers:d,pointerCoordinates:null});let m=fn(f,"id");if(m===(l==null?void 0:l.id)&&f.length>1&&(m=f[1].id),m!=null){const c=i.get(n.id),h=i.get(m),x=h?a.get(h.id):null,N=h==null?void 0:h.node.current;if(N&&x&&c&&h){const g=kt(N).some((S,k)=>u[k]!==S),y=In(c,h),v=Oi(c,h),j=g||!y?{x:0,y:0}:{x:v?r.width-x.width:0,y:v?r.height-x.height:0},w={x:x.left,y:x.top};return j.x&&j.y?w:rt(w,j)}}}};function In(e,s){return!Ct(e)||!Ct(s)?!1:e.data.current.sortable.containerId===s.data.current.sortable.containerId}function Oi(e,s){return!Ct(e)||!Ct(s)||!In(e,s)?!1:e.data.current.sortable.index<s.data.current.sortable.index}const vt=[{id:"smart-analyst",type:"smart-analyst",title:"Analista Inteligente",description:"Anlisis automtico de inventario",icon:Vr,visible:!0,order:0,size:"small",span:2,row:"top"},{id:"metrics-carousel",type:"metrics-carousel",title:"Mtricas Financieras",description:"Diferencia neta, negativos y positivos",icon:st,visible:!0,order:1,size:"small",span:1,row:"top",mandatory:!0},{id:"active-products",type:"active-products",title:"Productos Activos",description:"Total de productos en inventarios",icon:es,visible:!0,order:2,size:"small",span:1,row:"top"},{id:"inventory-summary",type:"inventory-summary",title:"Resumen de Inventario",description:"Progreso de productos en stock",icon:St,visible:!1,order:10,size:"large",span:1,row:"middle"},{id:"inventory-alerts",type:"inventory-alerts",title:"Alertas de Inventario",description:"Notificaciones importantes",icon:Ve,visible:!0,order:6,size:"large",span:1,row:"middle"},{id:"upcoming-inventories",type:"upcoming-inventories",title:"Prximos Inventarios",description:"Inventarios programados",icon:rn,visible:!0,order:5,size:"large",span:1,row:"middle"},{id:"branches-table",type:"branches-table",title:"Tabla de Sucursales",description:"Listado completo de sucursales",icon:Fr,visible:!0,order:7,size:"full",span:1,row:"bottom"},{id:"inventory-progress",type:"inventory-progress",title:"Progreso de Inventarios",description:"Porcentaje de inventarios completados",icon:Re,visible:!1,order:6,size:"small",span:1,row:"top"},{id:"critical-products",type:"critical-products",title:"Productos Crticos",description:"Productos con stock bajo o agotados",icon:Fs,visible:!1,order:7,size:"small",span:1,row:"top"},{id:"total-stock-value",type:"total-stock-value",title:"Valor Total de Stock",description:"Valor monetario total del inventario",icon:st,visible:!1,order:8,size:"small",span:1,row:"top"},{id:"active-users",type:"active-users",title:"Usuarios Activos",description:"Usuarios trabajando en tiempo real",icon:on,visible:!1,order:9,size:"small",span:1,row:"top"},{id:"pending-inventories",type:"pending-inventories",title:"Inventarios Pendientes",description:"Inventarios sin completar",icon:lt,visible:!1,order:10,size:"small",span:1,row:"top"},{id:"trends-chart",type:"trends-chart",title:"Grfico de Tendencias",description:"Evolucin de diferencias en el tiempo",icon:$r,visible:!0,order:11,size:"large",span:1,row:"middle"},{id:"top-products",type:"top-products",title:"Top Productos con Diferencias",description:"Productos con mayores discrepancias",icon:Kr,visible:!1,order:12,size:"large",span:1,row:"middle"},{id:"activity-timeline",type:"activity-timeline",title:"Actividad Reciente",description:"Timeline de ltimas acciones",icon:ar,visible:!1,order:13,size:"large",span:1,row:"middle"},{id:"category-distribution",type:"category-distribution",title:"Distribucin por Categora",description:"Porcentaje de productos por categora",icon:ws,visible:!1,order:14,size:"large",span:1,row:"middle"},{id:"monthly-goals",type:"monthly-goals",title:"Objetivos del Mes",description:"Progreso hacia metas mensuales",icon:Ks,visible:!1,order:15,size:"large",span:1,row:"middle"},{id:"sync-status",type:"sync-status",title:"Estado de Sincronizacin",description:"Conexin y datos pendientes",icon:Zs,visible:!1,order:16,size:"large",span:1,row:"middle"},{id:"quick-actions",type:"quick-actions",title:"Acciones Rpidas",description:"Tareas frecuentes",icon:ts,visible:!1,order:17,size:"large",span:1,row:"middle"},{id:"countdown",type:"countdown",title:"Contador de Das",description:"Das restantes para finalizar conteo cclico",icon:yt,visible:!0,order:3,size:"small",span:1,row:"top"},{id:"category-progress",type:"category-progress",title:"Progreso por Rubros",description:"Avance de inventario por categora",icon:ws,visible:!0,order:4,size:"large",span:1,row:"middle"}];function Pi(e){const s=`dashboard - layout - v5 - ${e||"default"} `,[n,r]=o.useState(()=>{try{const N=localStorage.getItem(s);if(N){const p=JSON.parse(N);return vt.map(y=>{const v=p.widgets.find(j=>j.id===y.id);return v?{...y,visible:v.visible,order:v.order,...y.mandatory?{visible:!0}:{}}:y}).sort((y,v)=>y.order-v.order)}}catch(N){console.error("Error loading dashboard layout:",N)}return vt}),[a,i]=o.useState(!1);o.useEffect(()=>{const p={widgets:n.map(({id:g,visible:y,order:v})=>({id:g,visible:y,order:v})),lastUpdated:Date.now()};localStorage.setItem(s,JSON.stringify(p))},[n,s]);const l=(N,p)=>{r(g=>{const y=g.findIndex(w=>w.id===N),v=g.findIndex(w=>w.id===p);return ds(g,y,v).map((w,b)=>({...w,order:b}))})},u=N=>{r(p=>p.map(g=>g.id===N&&!g.mandatory?{...g,visible:!g.visible}:g))},d=()=>{r(vt),i(!1)},f=(N,p)=>{r(g=>g.map(y=>y.id===N?{...y,size:p}:y))},m=(N,p)=>{r(g=>g.map(y=>y.id===N?{...y,span:p}:y))},c=N=>{r(p=>p.map(g=>({...g,visible:g.mandatory||N.includes(g.id)})))};o.useEffect(()=>{n.every(p=>p.title&&p.icon)||(console.warn("Detected corrupted widget state, resetting to defaults"),r(vt))},[n]);const h=n.filter(N=>N.visible).sort((N,p)=>N.order-p.order),x=n.filter(N=>!N.visible).sort((N,p)=>(N.title||"").localeCompare(p.title||""));return{widgets:n,visibleWidgets:h,hiddenWidgets:x,isEditMode:a,setIsEditMode:i,reorderWidgets:l,toggleWidgetVisibility:u,updateWidgetSize:f,updateWidgetSpan:m,applyPreset:c,resetLayout:d}}const Li={small:"h-[200px]",medium:"h-[300px]",large:"h-[400px]",full:"h-auto"},Bi={small:"col-span-1",medium:"col-span-1",large:"col-span-1",full:"col-span-full"},Us={small:{label:"Pequeo",icon:Gr,description:"1/4 ancho (3 cols)"},medium:{label:"Mediano",icon:Xr,description:"1/2 ancho (6 cols)"},large:{label:"Grande",icon:Cs,description:"1/3 ancho (4 cols)"},full:{label:"Ancho completo",icon:Cs,description:"Ancho completo (12 cols)"}};function Ui({currentSize:e,onChange:s,availableSizes:n=["small","medium","large"]}){const r=Us[e].icon;return t.jsxs(or,{children:[t.jsx(lr,{asChild:!0,children:t.jsx(O,{variant:"ghost",size:"icon",className:"h-6 w-6",title:"Cambiar tamao",children:t.jsx(r,{className:"h-4 w-4"})})}),t.jsx(cr,{align:"end",children:n.map(a=>{const i=Us[a],l=i.icon;return t.jsxs(dr,{onClick:()=>s(a),className:le("flex items-center gap-2",e===a&&"bg-accent"),children:[t.jsx(l,{className:"h-4 w-4"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-medium",children:i.label}),t.jsx("span",{className:"text-xs text-muted-foreground",children:i.description})]})]},a)})})]})}function Wi({widget:e,isEditMode:s,onRemove:n,onSizeChange:r,children:a}){const{attributes:i,listeners:l,setNodeRef:u,transform:d,transition:f,isDragging:m}=Mi({id:e.id,disabled:!s}),c={transform:at.Transform.toString(d),transition:f};return t.jsx("div",{ref:u,style:c,className:le(Bi[e.size],m&&"opacity-50 z-50",s&&"cursor-move",Li[e.size]),children:t.jsx(ir,{hoverEffect:s?"none":"lift",className:"h-full",children:t.jsxs("div",{className:le("relative h-full transition-all rounded-lg",s&&"ring-2 ring-primary/20 hover:ring-primary/40"),children:[s&&t.jsxs("div",{className:"absolute top-2 right-2 z-10 flex gap-1",children:[r&&t.jsx(Ui,{currentSize:e.size,onChange:r}),t.jsx(O,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-grab active:cursor-grabbing",...i,...l,children:t.jsx(_r,{className:"h-4 w-4"})}),!e.mandatory&&n&&t.jsx(O,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive hover:text-destructive-foreground",onClick:n,children:t.jsx($s,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"h-full",children:a})]})})})}const Ws={metrics:{id:"metrics",name:"Mtricas",icon:st,description:"Indicadores financieros y de rendimiento"},inventory:{id:"inventory",name:"Inventario",icon:Vn,description:"Gestin y control de inventarios"},analytics:{id:"analytics",name:"Anlisis",icon:St,description:"Grficos y reportes analticos"},actions:{id:"actions",name:"Acciones",icon:ts,description:"Acciones rpidas y utilidades"},alerts:{id:"alerts",name:"Alertas",icon:Ve,description:"Notificaciones y recordatorios"},activity:{id:"activity",name:"Actividad",icon:es,description:"Seguimiento de actividad y usuarios"}},Vt={"metrics-carousel":"metrics","active-products":"inventory","inventory-summary":"inventory","inventory-alerts":"alerts","upcoming-inventories":"inventory","branches-table":"activity","inventory-progress":"inventory","critical-products":"alerts","total-stock-value":"metrics","active-users":"activity","pending-inventories":"inventory","trends-chart":"analytics","top-products":"analytics","activity-timeline":"activity","category-distribution":"analytics","monthly-goals":"metrics","sync-status":"actions","quick-actions":"actions",countdown:"alerts","category-progress":"analytics",calendar:"actions"},Vi=new Set(["metrics-carousel","active-products","inventory-alerts","trends-chart","quick-actions"]);function Fi({open:e,onOpenChange:s,hiddenWidgets:n,onAddWidget:r}){const[a,i]=o.useState(""),[l,u]=o.useState(null),d=o.useMemo(()=>{let c=n;return a&&(c=c.filter(h=>h.title.toLowerCase().includes(a.toLowerCase())||h.description.toLowerCase().includes(a.toLowerCase()))),l&&(c=c.filter(h=>Vt[h.type]===l)),c},[n,a,l]),f=o.useMemo(()=>{const c={};return d.forEach(h=>{const x=Vt[h.type]||"other";c[x]||(c[x]=[]),c[x].push(h)}),c},[d]),m=c=>{r(c),n.length===1&&s(!1)};return t.jsx(_s,{open:e,onOpenChange:s,children:t.jsxs(Gs,{className:"max-h-[90vh]",children:[t.jsxs(Hs,{children:[t.jsx(qs,{children:"Galera de Widgets"}),t.jsx(Fn,{children:"Explora y agrega widgets para personalizar tu dashboard"})]}),t.jsxs("div",{className:"px-4 space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ys,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(de,{placeholder:"Buscar widgets...",value:a,onChange:c=>i(c.target.value),className:"pl-9"})]}),t.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[t.jsx(O,{variant:l===null?"default":"outline",size:"sm",onClick:()=>u(null),children:"Todos"}),Object.values(Ws).map(c=>{const h=c.icon,x=n.filter(N=>Vt[N.type]===c.id).length;return x===0?null:t.jsxs(O,{variant:l===c.id?"default":"outline",size:"sm",onClick:()=>u(c.id),className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-4 w-4"}),c.name,t.jsx(Q,{variant:"secondary",className:"ml-1",children:x})]},c.id)})]})]}),t.jsx("div",{className:"px-4 pb-4 max-h-[50vh] overflow-y-auto",children:d.length===0?t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx("p",{className:"text-lg font-medium",children:n.length===0?"Todos los widgets estn visibles":"No se encontraron widgets"}),a&&t.jsx("p",{className:"text-sm mt-2",children:"Intenta con otra bsqueda o categora"})]}):t.jsx("div",{className:"space-y-6",children:Object.entries(f).map(([c,h])=>{const x=Ws[c];if(!x||h.length===0)return null;const N=x.icon;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-background py-2 z-10",children:[t.jsx(N,{className:"h-5 w-5 text-primary"}),t.jsx("h3",{className:"font-semibold",children:x.name}),t.jsx(Q,{variant:"outline",children:h.length})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:h.map(p=>{const g=p.icon,y=Vi.has(p.id);return t.jsxs(P,{className:le("hover:border-primary transition-all hover:shadow-md",y&&"border-primary/50"),children:[t.jsx($,{className:"pb-3",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(g,{className:"h-4 w-4 text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(_,{className:"text-sm truncate",children:p.title}),y&&t.jsx(mr,{className:"h-3 w-3 fill-yellow-400 text-yellow-400 flex-shrink-0"})]}),t.jsx($n,{className:"text-xs mt-1 line-clamp-2",children:p.description})]})]})})}),t.jsx(G,{className:"pt-0",children:t.jsxs(O,{size:"sm",className:"w-full",onClick:()=>m(p.id),children:[t.jsx(ct,{className:"h-4 w-4 mr-2"}),"Agregar"]})})]},p.id)})})]},c)})})}),t.jsx(_n,{children:t.jsx(Gn,{asChild:!0,children:t.jsx(O,{variant:"outline",children:"Cerrar"})})})]})})}function $i(){const{user:e}=Me(),[s,n]=o.useState([]),[r,a]=o.useState(!0),[i,l]=o.useState(0),u=Wn();o.useEffect(()=>{d();const h=setInterval(d,5e3);return()=>clearInterval(h)},[e==null?void 0:e.branchName]),o.useEffect(()=>{if(s.length<=1)return;const h=setInterval(()=>{l(x=>(x+1)%s.length)},4e3);return()=>clearInterval(h)},[s.length]);const d=async()=>{try{const h=await fr(e==null?void 0:e.branchName),x=new Date,N=x.getMonth()+1,p=x.getFullYear(),g=p*100+N,y=[],v=new Map;h.forEach(j=>{const w=v.get(j.ean);(!w||j.timestamp>w.timestamp)&&v.set(j.ean,j)}),v.forEach(j=>{j.batches.forEach(w=>{if(w.quantity<=0||w.status&&w.status!=="active")return;const b=w.reminderMonths;if(!b)return;const S=w.expirationDate.split("/");if(S.length<2)return;let k=parseInt(S[0]),C=parseInt(S[1]);C<100&&(C+=2e3);const I=C*100+k,M=C*12+k,A=p*12+N;if(M-A<=b){const Z=new Date(C,k-1,1).getTime()-x.getTime(),ge=Math.ceil(Z/(1e3*60*60*24));y.push({productName:j.productName,batchNumber:w.batchNumber,expirationDate:w.expirationDate,reminderMonths:b,daysUntilExpiry:ge})}})}),y.sort((j,w)=>j.daysUntilExpiry-w.daysUntilExpiry),n(j=>JSON.stringify(j)===JSON.stringify(y)?j:y)}catch(h){console.error("Smart Analyst Error:",h)}finally{a(!1)}};if(r)return null;const f=s.length,m=f===0,c=s[i];return t.jsx(xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-full",children:t.jsxs(P,{className:"flex flex-col h-full bg-card border-border/50 shadow-sm relative overflow-hidden group hover:shadow-md transition-all cursor-pointer",onClick:()=>u("/smart-analyst"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-50"}),t.jsx($,{className:"pb-2 pt-4 px-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Control de Vencimientos"}),m?t.jsx(Yt,{className:"w-4 h-4 text-emerald-500"}):t.jsx(Wr,{className:"w-4 h-4 text-primary"})]})}),t.jsxs(G,{className:"flex-1 flex flex-col px-4 pb-4 pt-0 min-h-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[t.jsx("span",{className:`text-3xl font-bold ${m?"text-emerald-600 dark:text-emerald-400":"text-foreground"}`,children:m?"Todo en Orden":`${f}`}),!m&&t.jsx("span",{className:"text-sm text-muted-foreground",children:"Alertas"})]}),m&&t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:"No detectamos productos prximos a vencer segn tus recordatorios configurados."}),!m&&c&&t.jsx("div",{className:"flex-1 relative min-h-0 mb-2",children:t.jsx(Qs,{mode:"wait",children:t.jsxs(xe.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},className:"absolute inset-0 flex flex-col justify-center border-l-2 border-primary/50 pl-3 py-1",children:[t.jsx("p",{className:"font-medium text-sm truncate text-foreground leading-tight mb-1",title:c.productName,children:c.productName}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground/80",children:[t.jsxs("span",{className:"font-mono bg-muted/50 px-1 rounded text-[10px]",children:["Lote: ",c.batchNumber]}),t.jsx("span",{children:""}),t.jsxs("span",{className:c.daysUntilExpiry<=30?"text-red-500 font-medium":"text-amber-500",children:["Vence: ",c.expirationDate]})]})]},`${c.productName}-${c.batchNumber}`)})}),!m&&s.length>1&&t.jsx("div",{className:"flex gap-1 mb-2",children:s.slice(0,5).map((h,x)=>t.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${x===i%5?"w-4 bg-primary":"w-1.5 bg-primary/20"}`},x))}),!m&&t.jsxs(O,{className:"w-full h-8 text-xs mt-auto",size:"sm",variant:"outline",onClick:()=>u("/smart-analyst"),children:["Ver Detalles ",t.jsx(hr,{className:"w-3 h-3 ml-2"})]})]})]})})}function _i({metrics:e}){const s=(i,l)=>{if(l===0)return{value:0,isPositive:!0};const u=i/l*100;return{value:Math.abs(Number(u.toFixed(1))),isPositive:u>=0}},n=s(e.negativeUnits+e.positiveUnits,e.totalSystemUnits),r=s(e.negativeUnits,e.totalSystemUnits),a=s(e.positiveUnits,e.totalSystemUnits);return t.jsx(ur,{items:[{id:"net",label:"Diferencia Neta",value:e.totalStock,color:e.totalStock<0?"text-destructive":e.totalStock>0?"text-success":"text-foreground",icon:st,prefix:"$",trend:n},{id:"negative",label:"Negativo Total",value:e.negativeStock,color:"text-destructive",icon:Qt,prefix:"$",trend:r},{id:"positive",label:"Positivo Total",value:e.positiveStock,color:"text-success",icon:Re,prefix:"$",trend:a}]})}function Gi({activeProducts:e}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Productos Activos"}),t.jsx(es,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[(()=>{const s=new Intl.NumberFormat("es-AR").format(e);let n="text-3xl";return s.length>8?n="text-xl":s.length>6&&(n="text-2xl"),t.jsx("div",{className:`${n} font-bold`,children:t.jsx(en,{value:e})})})(),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total en base de datos"})]})]})}function Hi(){return t.jsxs(P,{className:"p-6 h-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Resumen de Inventario"}),t.jsx("button",{className:"text-sm text-muted-foreground hover:text-foreground",children:"Ver detalles"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos en Stock"}),t.jsx("span",{className:"text-sm font-medium",children:"85%"})]}),t.jsx(zt,{value:85})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos con Bajo Stock"}),t.jsx("span",{className:"text-sm font-medium text-warning",children:"12%"})]}),t.jsx(zt,{value:12,variant:"warning"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos Agotados"}),t.jsx("span",{className:"text-sm font-medium text-destructive",children:"3%"})]}),t.jsx(zt,{value:3,variant:"destructive"})]})]})]})}function qi(){return t.jsxs(P,{className:"p-6 h-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Alertas de Inventario"}),t.jsx("span",{className:"px-3 py-1 bg-warning/10 text-warning text-xs font-medium rounded-full",children:"3 Activas"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[t.jsx(Ve,{className:"w-5 h-5 text-warning mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-foreground",children:"Stock bajo en Sucursal Palermo II"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"15 productos necesitan reabastecimiento"})]})]}),t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[t.jsx(Ve,{className:"w-5 h-5 text-warning mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-foreground",children:"Inventario cclico pendiente"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sucursal Microcentro - Vence en 2 das"})]})]}),t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[t.jsx(Ve,{className:"w-5 h-5 text-destructive mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-foreground",children:"Diferencia significativa detectada"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sucursal Belgrano III - Revisar urgente"})]})]})]})]})}const ot={async getEvents(e,s=!1){let n=Tt.from("inventory_events").select("*").order("date",{ascending:!0});!s&&e&&(n=n.eq("branch_name",e));const{data:r,error:a}=await n;return a?(console.error("Error fetching events:",a),[]):r||[]},async addEvent(e){const{data:s,error:n}=await Tt.rpc("manage_inventory_event",{p_action:"CREATE",p_title:e.title,p_branch:e.branch_name,p_sector:e.sector,p_date:e.date});return n?(console.error("Error adding event via RPC:",n),null):s},async deleteEvent(e){const{error:s}=await Tt.rpc("manage_inventory_event",{p_action:"DELETE",p_id:e});return s?(console.error("Error deleting event via RPC:",s),!1):!0}};function Yi({onDateClick:e}){const{user:s}=Me(),n=(s==null?void 0:s.role)==="admin",[r,a]=o.useState([]),[i,l]=o.useState(!0);o.useState(!1),o.useEffect(()=>{u()},[s==null?void 0:s.branchName]);const u=async()=>{try{const d=await ot.getEvents(s==null?void 0:s.branchName,n),f=new Date().toISOString().slice(0,10),m=d.filter(c=>c.date>=f).sort((c,h)=>c.date.localeCompare(h.date)).slice(0,3).map(c=>({id:c.id,branch:c.branch_name||c.branchId,sector:c.sector||c.description,date:c.date,formattedDate:new Date(c.date+"T12:00:00").toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}));a(m)}catch(d){console.error("Error loading upcoming inventories:",d)}finally{l(!1)}};return t.jsxs(P,{className:"p-6 h-full flex flex-col relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Prximos Inventarios"}),t.jsx("div",{className:"flex gap-1"})]}),t.jsx("div",{className:"space-y-4 flex-1",children:i?t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"})]}):r.length===0?t.jsx("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 border rounded-lg border-dashed bg-muted/20",children:t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No hay inventarios prximos"})}):r.map(d=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg cursor-pointer hover:bg-muted transition-colors",onClick:()=>e==null?void 0:e(d.date),children:[t.jsx(rn,{className:"w-5 h-5 text-primary mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-foreground",children:[d.branch," - ",d.sector]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-left block",children:d.formattedDate})]})]},d.id))})]})}const Vs=8;function Xi({branches:e}){const{selectBranch:s,clearBranchSelection:n,user:r}=Me(),[a,i]=o.useState(""),[l,u]=o.useState(!1),[d,f]=o.useState([]),[m,c]=o.useState(!0),[h,x]=o.useState({key:"progress",direction:"descending"});o.useEffect(()=>{(async()=>{c(!0);try{const S=await Je.getBranchesSummary();f(S)}catch(S){console.error("Failed to load branch summaries",S)}finally{c(!1)}})()},[]);const N=o.useMemo(()=>d.filter(b=>b.branchName.toLowerCase().includes(a.toLowerCase())),[d,a]),p=o.useMemo(()=>{let b=[...N];return h.key&&b.sort((S,k)=>{const C=S[h.key],I=k[h.key];return C<I?h.direction==="ascending"?-1:1:C>I?h.direction==="ascending"?1:-1:0}),b},[N,h]),g=b=>{let S="ascending";h.key===b&&h.direction==="ascending"&&(S="descending"),x({key:b,direction:S})},y=l?p:p.slice(0,Vs),v=b=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(b),j=b=>{(r==null?void 0:r.branchName)===b?n==null||n():s&&(s(b),window.scrollTo({top:0,behavior:"smooth"}))},w=b=>(r==null?void 0:r.branchName)===b;return t.jsx(xe.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full",children:t.jsxs(P,{className:"p-6 overflow-hidden border-t-4 border-t-primary shadow-md",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[t.jsx(Re,{className:"w-6 h-6 text-primary"}),"Monitor de Sucursales"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Estado en tiempo real de inventarios cclicos y cumplimiento."})]}),t.jsxs("div",{className:"relative w-full md:w-72",children:[t.jsx(Ys,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(de,{placeholder:"Buscar sucursal...",value:a,onChange:b=>i(b.target.value),className:"pl-10 h-10 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary"})]})]}),t.jsx("div",{className:"rounded-xl border bg-card/50 overflow-hidden",children:t.jsxs(xr,{children:[t.jsx(pr,{className:"bg-muted/40 hover:bg-muted/50 transition-colors",children:t.jsxs(Ot,{children:[t.jsx(je,{className:"w-[200px] cursor-pointer",onClick:()=>g("branchName"),children:t.jsxs("div",{className:"flex items-center font-semibold text-foreground",children:["Sucursal",t.jsx(ys,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(je,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>g("deploymentDate"),children:"Fecha Inicio"}),t.jsx(je,{className:"text-center hidden lg:table-cell",children:"Vuelta"}),t.jsx(je,{className:"text-center hidden lg:table-cell",children:"Obj. Mensual"}),t.jsx(je,{className:"text-center cursor-pointer",onClick:()=>g("progress"),children:t.jsxs("div",{className:"flex items-center justify-center font-semibold text-foreground",children:["% Avance",t.jsx(ys,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(je,{className:"text-center hidden md:table-cell",children:"Un. Inventario"}),t.jsx(je,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>g("differenceUnits"),children:"Diferencia"}),t.jsx(je,{className:"text-right cursor-pointer",onClick:()=>g("adjustmentsValue"),children:"$ Ajustes"}),t.jsx(je,{className:"text-center w-[120px]",children:"Status"})]})}),t.jsx(gr,{children:m?Array.from({length:5}).map((b,S)=>t.jsxs(Ot,{children:[t.jsx(U,{children:t.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),t.jsx(U,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-20 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-10 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-12 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(U,{className:"text-right",children:t.jsx("div",{className:"h-5 w-24 bg-muted rounded animate-pulse ml-auto"})}),t.jsx(U,{children:t.jsx("div",{className:"h-6 w-20 bg-muted rounded-full animate-pulse mx-auto"})})]},S)):y.length>0?y.map((b,S)=>t.jsxs(xe.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:S*.05},onClick:()=>j(b.branchName),className:le("group cursor-pointer hover:bg-muted/50 transition-all border-b last:border-0",w(b.branchName)&&"bg-primary/5 hover:bg-primary/10 border-l-4 border-l-primary"),children:[t.jsxs(U,{className:"font-medium text-foreground relative",children:[w(b.branchName)&&t.jsx(xe.div,{layoutId:"active-indicator",className:"absolute left-0 top-0 bottom-0 w-1 bg-primary"}),b.branchName]}),t.jsx(U,{className:"text-center text-muted-foreground text-sm hidden md:table-cell",children:b.deploymentDate}),t.jsxs(U,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:[b.cyclicRound,""]}),t.jsx(U,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:b.monthlyGoal}),t.jsx(U,{className:"text-center",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:le("font-bold text-sm",b.progress>=b.monthlyGoal?"text-green-600":"text-foreground"),children:[b.progress,"%"]}),t.jsx("div",{className:"w-16 h-1.5 bg-muted rounded-full overflow-hidden mt-1",children:t.jsx("div",{className:le("h-full rounded-full transition-all",b.progress>=100?"bg-green-500":"bg-primary"),style:{width:`${Math.min(b.progress,100)}%`}})})]})}),t.jsx(U,{className:"text-center font-mono text-sm hidden md:table-cell",children:b.inventoryUnits}),t.jsx(U,{className:"text-center font-mono text-sm hidden md:table-cell",children:t.jsxs("span",{className:b.differenceUnits===0?"text-muted-foreground":b.differenceUnits>0?"text-green-600":"text-red-600",children:[b.differenceUnits>0?"+":"",b.differenceUnits]})}),t.jsx(U,{className:"text-right font-mono text-sm",children:t.jsx("span",{className:b.adjustmentsValue===0?"text-muted-foreground":b.adjustmentsValue>0?"text-green-600":"text-red-600",children:v(b.adjustmentsValue)})}),t.jsx(U,{className:"text-center",children:b.status==="controlado"?t.jsxs(Q,{variant:"outline",className:"font-normal border bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30",children:[t.jsx(Hn,{className:"w-3 h-3 mr-1"})," FINALIZADA"]}):b.status==="por_controlar"?t.jsxs(Q,{variant:"outline",className:"font-normal border bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30",children:[t.jsx(lt,{className:"w-3 h-3 mr-1"})," EN PROCESO"]}):t.jsxs(Q,{variant:"outline",className:"font-normal border bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30",children:[t.jsx(Ve,{className:"w-3 h-3 mr-1"})," PENDIENTE"]})})]},b.branchName)):t.jsx(Ot,{children:t.jsx(U,{colSpan:9,className:"h-24 text-center text-muted-foreground",children:"No se encontraron sucursales con esa bsqueda."})})})]})}),p.length>Vs&&t.jsx("div",{className:"mt-4 flex justify-center",children:t.jsx(O,{variant:"ghost",size:"sm",onClick:()=>u(!l),className:"text-muted-foreground hover:text-foreground",children:l?"Mostrar menos":`Ver todas las sucursales (${p.length})`})})]})})}function Ki({completedCount:e,totalCount:s}){const n=s>0?Math.round(e/s*100):0,r=()=>n>=80?"text-success":n>=50?"text-warning":"text-destructive";return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Progreso"}),t.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsxs("div",{className:`text-xl font-bold ${r()}`,children:[n,"%"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e," de ",s," completados"]}),t.jsx(Js,{value:n,className:"mt-2"})]})]})}function Zi({criticalCount:e,outOfStockCount:s}){const n=e>0||s>0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Crticos"}),t.jsx(Fs,{className:`h-4 w-4 ${n?"text-destructive":"text-muted-foreground"}`})]}),t.jsxs(G,{children:[t.jsx("div",{className:`text-xl font-bold ${n?"text-destructive":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Productos con stock bajo"}),s>0&&t.jsxs(Q,{variant:"destructive",className:"mt-2",children:[s," agotados"]})]})]})}function Ji({totalValue:e,changePercentage:s}){const n=s!==void 0&&s>=0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Valor Total"}),t.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsxs("div",{className:"text-xl font-bold",children:["$",t.jsx(en,{value:e})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Valor de inventario"}),s!==void 0&&t.jsxs("div",{className:`flex items-center gap-1 mt-2 text-xs ${n?"text-success":"text-destructive"}`,children:[n?t.jsx(Re,{className:"h-3 w-3"}):t.jsx(Qt,{className:"h-3 w-3"}),t.jsxs("span",{children:[Math.abs(s).toFixed(1),"% vs mes anterior"]})]})]})]})}function Qi({activeCount:e,activeBranches:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Activos"}),t.jsxs("div",{className:"relative",children:[t.jsx(on,{className:"h-4 w-4 text-muted-foreground"}),e>0&&t.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 bg-success rounded-full animate-pulse"})]})]}),t.jsxs(G,{children:[t.jsx("div",{className:"text-xl font-bold",children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usuarios trabajando"}),s.length>0&&t.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[s.slice(0,2).map((n,r)=>t.jsx(Q,{variant:"secondary",className:"text-xs",children:n},r)),s.length>2&&t.jsxs(Q,{variant:"secondary",className:"text-xs",children:["+",s.length-2]})]})]})]})}function eo({pendingCount:e,urgentCount:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Pendientes"}),t.jsx(lt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsx("div",{className:`text-xl font-bold ${e>0?"text-warning":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Inventarios sin completar"}),s>0&&t.jsxs(Q,{variant:"destructive",className:"mt-2",children:[s," urgentes"]})]})]})}function to({data:e=[]}){const[s,n]=o.useState("7d"),r=[{date:"01/12",negative:-1200,positive:800},{date:"02/12",negative:-950,positive:1100},{date:"03/12",negative:-1500,positive:900},{date:"04/12",negative:-800,positive:1300},{date:"05/12",negative:-1100,positive:950},{date:"06/12",negative:-900,positive:1200},{date:"07/12",negative:-1300,positive:1e3}],a=e.length>0?e:r;return t.jsxs(P,{className:"h-full",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Tendencias"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(O,{variant:s==="7d"?"default":"outline",size:"sm",onClick:()=>n("7d"),children:"7 das"}),t.jsx(O,{variant:s==="30d"?"default":"outline",size:"sm",onClick:()=>n("30d"),children:"30 das"})]})]}),t.jsx(G,{children:t.jsx(tn,{width:"100%",height:200,children:t.jsxs(vr,{data:a,children:[t.jsx(br,{strokeDasharray:"3 3"}),t.jsx(yr,{dataKey:"date",fontSize:12}),t.jsx(jr,{fontSize:12}),t.jsx(sn,{}),t.jsx(Nr,{}),t.jsx(js,{type:"monotone",dataKey:"negative",stroke:"hsl(var(--destructive))",name:"Negativo",strokeWidth:2}),t.jsx(js,{type:"monotone",dataKey:"positive",stroke:"hsl(var(--success))",name:"Positivo",strokeWidth:2})]})})})]})}function so({products:e=[]}){const s=[{name:"Ibuprofeno 600mg",ean:"7798140250685",difference:-45,value:-2250,type:"negative"},{name:"Paracetamol 500mg",ean:"7798140250692",difference:32,value:1600,type:"positive"},{name:"Amoxicilina 500mg",ean:"7798140250708",difference:-28,value:-1680,type:"negative"},{name:"Omeprazol 20mg",ean:"7798140250715",difference:25,value:1500,type:"positive"},{name:"Losartn 50mg",ean:"7798140250722",difference:-20,value:-1200,type:"negative"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs($,{className:"pb-3",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Top Diferencias"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos con mayores discrepancias"})]}),t.jsx(G,{children:t.jsx("div",{className:"space-y-3",children:n.map((r,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-sm font-medium",children:r.name}),t.jsx(Q,{variant:r.type==="negative"?"destructive":"default",className:"text-xs",children:r.type==="negative"?"Faltante":"Sobrante"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["EAN: ",r.ean]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:`flex items-center gap-1 ${r.type==="negative"?"text-destructive":"text-success"}`,children:[r.type==="negative"?t.jsx(Qt,{className:"h-3 w-3"}):t.jsx(Re,{className:"h-3 w-3"}),t.jsx("span",{className:"text-sm font-semibold",children:Math.abs(r.difference)})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Math.abs(r.value)]})]}),t.jsx(O,{variant:"ghost",size:"icon",className:"h-8 w-8",children:t.jsx(Dr,{className:"h-4 w-4"})})]})]},a))})})]})}function no({activities:e=[]}){const s=[{id:"1",type:"completed",title:"Inventario Farmacia completado",branch:"Belgrano IV",timestamp:"Hace 5 minutos",user:"Juan Prez"},{id:"2",type:"adjusted",title:"Ajustes realizados en Perfumera",branch:"Recoleta",timestamp:"Hace 15 minutos",user:"Mara Gonzlez"},{id:"3",type:"imported",title:"Inventario importado",branch:"Palermo II",timestamp:"Hace 1 hora",user:"Carlos Rodrguez"},{id:"4",type:"completed",title:"Pre-conteo finalizado",branch:"Microcentro",timestamp:"Hace 2 horas",user:"Ana Martnez"}],n=e.length>0?e:s,r=i=>{switch(i){case"completed":return t.jsx(Yt,{className:"h-4 w-4 text-success"});case"adjusted":return t.jsx(Yr,{className:"h-4 w-4 text-warning"});case"imported":return t.jsx(Xs,{className:"h-4 w-4 text-primary"})}},a=i=>{switch(i){case"completed":return"Completado";case"adjusted":return"Ajustado";case"imported":return"Importado"}};return t.jsxs(P,{className:"h-full",children:[t.jsxs($,{className:"pb-3",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Actividad Reciente"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"ltimas acciones realizadas"})]}),t.jsx(G,{children:t.jsx("div",{className:"space-y-4",children:n.map((i,l)=>t.jsxs("div",{className:"relative",children:[l<n.length-1&&t.jsx("div",{className:"absolute left-2 top-8 bottom-0 w-px bg-border"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"relative z-10 mt-1 rounded-full bg-background p-1 border",children:r(i.type)}),t.jsxs("div",{className:"flex-1 pb-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:i.title}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[i.branch,"  ",i.user]})]}),t.jsx(Q,{variant:"secondary",className:"text-xs",children:a(i.type)})]}),t.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[t.jsx(lt,{className:"h-3 w-3"}),t.jsx("span",{children:i.timestamp})]})]})]})]},i.id))})})]})}const Ne=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"];function ro({data:e=[]}){const s=[{name:"Farmacia",value:450,color:Ne[0]},{name:"Perfumera",value:280,color:Ne[1]},{name:"Higiene",value:180,color:Ne[2]},{name:"Bebs",value:120,color:Ne[3]},{name:"Otros",value:90,color:Ne[4]}],n=e.length>0?e:s,r=n.reduce((a,i)=>a+i.value,0);return t.jsxs(P,{className:"h-full",children:[t.jsxs($,{className:"pb-3",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Distribucin por Categora"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos por categora"})]}),t.jsxs(G,{children:[t.jsx(tn,{width:"100%",height:200,children:t.jsxs(wr,{children:[t.jsx(Cr,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:i})=>`${a} ${(i*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((a,i)=>t.jsx(Sr,{fill:a.color||Ne[i%Ne.length]},`cell-${i}`))}),t.jsx(sn,{})]})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2",children:n.map((a,i)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color||Ne[i%Ne.length]}}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.name,": ",a.value," (",(a.value/r*100).toFixed(1),"%)"]})]},i))})]})]})}function ao({goals:e=[]}){const s=[{title:"Inventarios Completados",current:45,target:60,badge:"75%"},{title:"Productos Controlados",current:1250,target:1500,badge:"83%"},{title:"Diferencias Resueltas",current:28,target:35,badge:"80%"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsx($,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(_,{className:"text-lg font-semibold",children:"Objetivos del Mes"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Progreso hacia metas"})]}),t.jsx(Ks,{className:"h-5 w-5 text-primary"})]})}),t.jsx(G,{children:t.jsx("div",{className:"space-y-4",children:n.map((r,a)=>{const i=Math.round(r.current/r.target*100),l=i>=100;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium",children:r.title}),l&&t.jsx(Ur,{className:"h-4 w-4 text-success"})]}),t.jsxs(Q,{variant:l?"default":"secondary",children:[r.current,"/",r.target]})]}),t.jsx(Js,{value:i,className:"h-2"}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[i,"% completado"]})]},a)})})})]})}function io({isOnline:e=!0,pendingCount:s=0,lastSync:n="Hace 5 minutos",onSync:r}){return t.jsxs(P,{className:"h-full",children:[t.jsx($,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Sincronizacin"}),e?t.jsx(Zs,{className:"h-5 w-5 text-success"}):t.jsx(qn,{className:"h-5 w-5 text-destructive"})]})}),t.jsxs(G,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Estado de Conexin"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e?"Conectado":"Sin conexin"})]}),t.jsx(Q,{variant:e?"default":"destructive",children:e?"Online":"Offline"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Datos Pendientes"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s>0?`${s} elementos`:"Todo sincronizado"})]}),s>0?t.jsx(Q,{variant:"warning",children:s}):t.jsx(Yt,{className:"h-5 w-5 text-success"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(lt,{className:"h-3 w-3"}),t.jsxs("span",{children:["ltima sincronizacin: ",n]})]}),t.jsxs(O,{className:"w-full",variant:s>0?"default":"outline",onClick:r,disabled:!e,children:[t.jsx(Yn,{className:"h-4 w-4 mr-2"}),s>0?"Sincronizar Ahora":"Actualizar"]})]})]})}function oo({actions:e=[]}){const s=[{title:"Nuevo Pre-Conteo",description:"Iniciar nuevo pre-conteo",icon:ct,onClick:()=>console.log("Nuevo Pre-Conteo"),variant:"default"},{title:"Importar Inventario",description:"Cargar desde Excel",icon:Xs,onClick:()=>console.log("Importar"),variant:"outline"},{title:"Ver Reportes",description:"Anlisis y estadsticas",icon:St,onClick:()=>console.log("Reportes"),variant:"outline"},{title:"Exportar Datos",description:"Descargar informacin",icon:Xn,onClick:()=>console.log("Exportar"),variant:"outline"},{title:"Configuracin",description:"Ajustes del sistema",icon:Kn,onClick:()=>console.log("Configuracin"),variant:"secondary"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs($,{className:"pb-3",children:[t.jsx(_,{className:"text-lg font-semibold",children:"Acciones Rpidas"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Tareas frecuentes"})]}),t.jsx(G,{children:t.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.map((r,a)=>{const i=r.icon;return t.jsxs(O,{variant:r.variant||"outline",className:"h-auto flex-col items-start p-4 gap-2",onClick:r.onClick,children:[t.jsx(i,{className:"h-5 w-5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"text-sm font-medium",children:r.title}),t.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:r.description})]})]},a)})})})]})}function lo({assignedDays:e=0,daysRemaining:s=0,totalProgress:n=0,monthlyProgress:r=[],isEditable:a=!1,onEdit:i}){const l=e>0?Math.ceil(e/30):3,u=Array.from({length:l});return t.jsxs(P,{className:"h-full flex flex-col overflow-hidden relative group/card",children:[t.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 px-5 pt-4 pb-2",children:[t.jsx(_,{className:"text-sm font-medium",children:"Plazo de Inventario"}),t.jsxs("div",{className:"flex items-center gap-2",children:[a&&t.jsx("button",{onPointerDown:d=>d.stopPropagation(),onClick:d=>{d.stopPropagation(),i==null||i()},className:"relative z-50 text-muted-foreground hover:text-primary transition-colors opacity-0 group-hover/card:opacity-100 cursor-pointer",title:"Configurar plazo",children:t.jsx(yt,{className:"h-4 w-4"})}),!a&&t.jsx(yt,{className:"h-4 w-4 text-muted-foreground"})]})]}),t.jsxs(G,{className:"flex flex-col justify-between flex-1 px-5 pb-4 pt-1 gap-4",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-3xl font-bold tracking-tight text-foreground",children:e>0?e:"-"}),t.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide",children:"Das Asignados"})]}),t.jsx("div",{className:"h-8 w-px bg-border/60 mx-2 mb-1"}),t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsx("span",{className:"text-3xl font-bold tracking-tight text-foreground",children:e>0?s:"-"}),t.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide text-right",children:"Das Restantes"})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Avance Global"}),t.jsxs("span",{className:"text-sm font-bold text-primary",children:[n,"%"]})]}),t.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${l}, 1fr)`},children:u.map((d,f)=>{const m=r[f]||0,c=e===0;return t.jsxs("div",{className:"space-y-1.5 group",children:[t.jsx("div",{className:"h-2 w-full bg-muted/50 rounded-full overflow-hidden relative",children:t.jsx("div",{className:le("h-full bg-primary transition-all duration-500 rounded-full",c&&"w-0"),style:{width:c?"0%":`${Math.min(m,100)}%`}})}),t.jsx("div",{className:"text-[10px] text-center text-muted-foreground font-medium",children:c?"-":`${m}%`})]},f)})})]})]})]})}const co=e=>{const s=Math.min(120,Math.max(0,e*1.2));return{background:`linear-gradient(135deg, hsl(${s}, 85%, 60%), hsl(${s}, 90%, 40%))`,color:"white"}};function uo(){const{user:e}=Me(),[s,n]=o.useState([]),[r,a]=o.useState(null),[i,l]=o.useState(!0);o.useEffect(()=>{const d=async()=>{if(!(e!=null&&e.branchSheet)){l(!1);return}try{const m=await Jn(e.branchSheet),c=await Je.getAllCyclicInventories(e.branchSheet)||[],h=new Map(c.map(v=>[v.labName,v.status])),x={Farmacia:{total:0,controlled:0},Perfumera:{total:0,controlled:0},Accesorios:{total:0,controlled:0},Varios:{total:0,controlled:0}};let N=0,p=0;m.forEach(v=>{let j="Varios";const w=v.category.toUpperCase();w==="MEDICAMENTOS"?j="Farmacia":w==="PERFUMERIA"?j="Perfumera":w==="ACCESORIOS"&&(j="Accesorios");const S=h.get(v.name)==="controlado";x[j]?(x[j].total+=1,S&&(x[j].controlled+=1)):(x.Varios.total+=1,S&&(x.Varios.controlled+=1)),N+=1,S&&(p+=1)});const g=Object.entries(x).map(([v,j])=>{const w=j.total>0?Math.round(j.controlled/j.total*100):0;return{name:v,totalItems:j.total,controlledItems:j.controlled,percentage:w,pendingPercentage:100-w}}),y=N>0?Math.round(p/N*100):0;a({name:"Global",totalItems:N,controlledItems:p,percentage:y,pendingPercentage:100-y}),n(g)}catch(m){console.error("Error loading category progress:",m)}finally{l(!1)}};d();const f=setInterval(d,3e4);return()=>clearInterval(f)},[e]);const u=[...s].sort((d,f)=>d.percentage-f.percentage);return i?t.jsx(P,{className:"h-full flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t.jsxs(P,{className:"h-full flex flex-col border-border/50 shadow-sm bg-card/50 backdrop-blur-sm",children:[t.jsx($,{className:"pb-2 px-4 pt-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(_,{className:"text-base font-semibold tracking-tight",children:"Progreso de Inventario"}),t.jsxs("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded-full",children:[r==null?void 0:r.totalItems," Laboratorios"]})]})}),t.jsx(G,{className:"flex-1 p-4 pt-2",children:t.jsxs("div",{className:"grid grid-cols-12 gap-3 h-full",children:[t.jsx("div",{className:"col-span-7 h-full",children:t.jsxs("div",{className:"h-full rounded-xl bg-muted/30 border border-border/50 p-5 flex flex-col justify-between relative overflow-hidden group hover:bg-muted/50 transition-colors",children:[t.jsx("div",{className:"flex justify-between items-start z-10",children:t.jsx("div",{className:"p-2 bg-background/50 backdrop-blur rounded-lg",children:t.jsx(Zn,{className:"h-5 w-5 text-muted-foreground"})})}),t.jsxs("div",{className:"z-10",children:[t.jsxs("h3",{className:"text-4xl font-bold tracking-tighter text-foreground mb-1",children:[r==null?void 0:r.percentage,"%"]}),t.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"AVANCE TOTAL"})]}),t.jsx("div",{className:"absolute -right-4 -bottom-4 w-32 h-32 bg-foreground/5 rounded-full blur-3xl group-hover:bg-foreground/10 transition-colors"})]})}),t.jsx("div",{className:"col-span-5 grid grid-cols-1 grid-rows-4 gap-2 h-full",children:u.map(d=>t.jsxs("div",{className:"relative overflow-hidden rounded-lg p-3 flex items-center justify-between transition-all hover:scale-[1.02] cursor-pointer group shadow-sm",style:co(d.percentage),children:[t.jsxs("div",{className:"z-10 flex flex-col",children:[t.jsx("span",{className:"text-[10px] font-bold uppercase text-white/90 tracking-wider",children:d.name}),t.jsxs("span",{className:"text-lg font-bold text-white drop-shadow-sm",children:[d.percentage,"%"]})]}),t.jsx("div",{className:"z-10 text-right",children:t.jsxs("span",{className:"text-[10px] font-medium text-white/90 bg-black/20 px-1.5 py-0.5 rounded backdrop-blur-sm",children:[d.controlledItems,"/",d.totalItems]})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shimmer"})]},d.name))})]})})]})}function An({events:e=[],selected:s,onSelect:n}){const[r,a]=Y.useState(s||new Date);Y.useEffect(()=>{s&&a(s)},[s]);const i=kr(r),l=Er(i),u=Ir(i,{locale:pt,weekStartsOn:1}),d=Ar(l,{locale:pt,weekStartsOn:1}),f=[];let m=u;for(;m<=d;){const g=[];for(let y=0;y<7;y++)g.push(m),m=Mr(m,1);f.push(g)}const c=Y.useMemo(()=>{const g=new Map;return e.forEach(y=>{const v=y.date;g.has(v)||g.set(v,[]),g.get(v).push(y)}),g},[e]),h=new Date,x=()=>a(g=>Pr(g,1)),N=()=>a(g=>Lr(g,1)),p="h-10 w-10";return t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between px-2 pb-2",children:[t.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-muted/50",children:t.jsx(Br,{className:"h-5 w-5 text-muted-foreground"})}),t.jsx("div",{className:"text-sm font-semibold",children:Ns(i,"LLLL yyyy",{locale:pt})}),t.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-muted/50",children:t.jsx(Qn,{className:"h-5 w-5 text-muted-foreground"})})]}),t.jsx("div",{className:"grid grid-cols-7 gap-1 px-1 text-xs text-muted-foreground mb-1",children:["LU","MA","MI","JU","VI","SA","DO"].map((g,y)=>t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"h-10 w-10 flex items-center justify-center font-medium uppercase",children:g})},y))}),t.jsx("div",{className:"space-y-1",children:f.map((g,y)=>t.jsx("div",{className:"grid grid-cols-7 gap-1",children:g.map(v=>{const j=v.toISOString().slice(0,10),w=Rr(v,i),b=c.get(j)||[],S=b.length>0,k=s?Tr(v,s):!1,C=b.some(A=>{const L=zr(A.date),H=Or(L,h);return H>=2&&H<=5}),I=k?"bg-primary text-primary-foreground":C?"hover:bg-primary/10 ring-2 ring-accent":"hover:bg-primary/10",M=t.jsx("button",{onClick:()=>n&&n(v),className:`flex items-center justify-center ${p} rounded-full transition-colors focus:outline-none ${w?"text-foreground":"text-muted-foreground"} ${I}`,children:t.jsxs("div",{className:"relative flex items-center justify-center w-full h-full",children:[t.jsx("span",{className:"text-sm font-medium",children:Ns(v,"d",{locale:pt})}),S&&t.jsx("span",{className:"absolute bottom-1.5 h-1.5 w-1.5 rounded-full bg-blue-500"})]})},j);if(S){const A=t.jsxs("div",{className:"space-y-1",children:[b.slice(0,5).map(L=>t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-medium",children:L.title}),t.jsxs("div",{className:"text-muted-foreground",children:[L.branch,"  ",L.sector]})]},L.id)),b.length>5&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",b.length-5," ms"]})]});return t.jsxs(er,{children:[t.jsx(tr,{asChild:!0,children:M}),t.jsx(sr,{side:"top",children:A})]},j)}return M})},y))})]})}function mo(){const{user:e}=Me(),[s,n]=o.useState(new Date),[r,a]=o.useState([]),[i,l]=o.useState(!1),[u,d]=o.useState(""),[f,m]=o.useState(""),[c,h]=o.useState(""),[x,N]=o.useState(new Date().toISOString().slice(0,10));o.useEffect(()=>{p()},[e==null?void 0:e.branchName]);const p=async()=>{try{const j=(await ot.getEvents()).map(w=>({id:w.id,title:w.title,branch:w.branch_name||w.branchId||"General",sector:w.sector||w.description||"",date:w.date.split("T")[0]}));a(j)}catch(v){console.error("Error loading events:",v)}},g=async()=>{if(!u||!f||!c||!x){Ae.error("Error","Por favor completa todos los campos");return}try{await ot.addEvent({title:u,branch_name:f,sector:c,date:x}),Ae.success("Operacin exitosa","Evento agregado"),l(!1),d(""),m(""),h(""),N(new Date().toISOString().slice(0,10)),p()}catch{Ae.error("Error","Error al crear evento")}},y=v=>{const j=v.toISOString().split("T")[0];return r.filter(w=>w.date===j)};return t.jsxs(P,{className:"h-full flex flex-col",children:[t.jsx($,{className:"pb-2",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(yt,{className:"w-5 h-5 text-primary"}),t.jsx(_,{children:"Calendario"})]})})}),t.jsx(G,{className:"flex-1 p-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-full",children:[t.jsx("div",{className:"flex-1",children:t.jsx(An,{selected:s,onSelect:n,events:r})}),t.jsxs("div",{className:"w-full md:w-80 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-semibold capitalize",children:s.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),t.jsx(O,{size:"sm",variant:i?"ghost":"outline",onClick:()=>l(!i),children:i?"Cancelar":t.jsxs(t.Fragment,{children:[t.jsx(ct,{className:"w-4 h-4 mr-1"})," Evento"]})})]}),i?t.jsxs("div",{className:"p-3 bg-muted/50 border rounded-md space-y-3 mb-4 animate-in slide-in-from-top-2",children:[t.jsx(de,{placeholder:"Ttulo",value:u,onChange:v=>d(v.target.value),className:"bg-background h-8"}),t.jsx(de,{placeholder:"Sucursal",value:f,onChange:v=>m(v.target.value),className:"bg-background h-8"}),t.jsx(de,{placeholder:"Sector",value:c,onChange:v=>h(v.target.value),className:"bg-background h-8"}),t.jsx(de,{type:"date",value:x,onChange:v=>N(v.target.value),className:"bg-background h-8"}),t.jsx(O,{size:"sm",className:"w-full",onClick:g,children:"Guardar Evento"})]}):t.jsx("div",{className:"flex-1 overflow-auto space-y-2 pr-1",children:y(s).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground text-sm border-2 border-dashed rounded-lg",children:"No hay eventos"}):y(s).map(v=>t.jsxs("div",{className:"p-3 bg-muted/50 hover:bg-muted border rounded-md transition-colors text-sm",children:[t.jsx("p",{className:"font-medium text-foreground",children:v.title}),t.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[t.jsx("span",{children:v.branch}),t.jsx("span",{children:v.sector})]})]},v.id))})]})]})})]})}function fo(e){const[s,n]=o.useState(!1);return o.useEffect(()=>{function r(i){n(i.matches)}const a=matchMedia(e);return a.addEventListener("change",r),n(a.matches),()=>a.removeEventListener("change",r)},[e]),s}function ho({open:e,onOpenChange:s,initialDate:n}){const r=fo("(min-width: 768px)"),{user:a}=Me(),i=(a==null?void 0:a.role)==="admin",[l,u]=o.useState(n||new Date),[d,f]=o.useState([]),[m,c]=o.useState(!1),[h,x]=o.useState(""),[N,p]=o.useState(""),[g,y]=o.useState(""),[v,j]=o.useState(new Date().toISOString().slice(0,10));o.useEffect(()=>{e&&(w(),n&&(u(n),j(n.toISOString().slice(0,10))))},[e,n,a==null?void 0:a.branchName]);const w=async()=>{try{const C=await ot.getEvents(a==null?void 0:a.branchName,i);f(C)}catch(C){console.error("Error loading events",C)}},b=async()=>{if(!h||!N||!g||!v){Ae.error("Error","Completa todos los campos");return}try{const C=await ot.addEvent({title:h,branch_name:N,sector:g,date:v});C&&(Ae.success("Operacin exitosa","Evento creado"),f(I=>[...I,C]),c(!1),x(""),p(""),y(""))}catch{Ae.error("Error","Error al crear evento")}},S=C=>{const I=C.toISOString().slice(0,10);return d.filter(M=>M.date===I)},k=()=>t.jsxs("div",{className:`flex ${r?"flex-row gap-6":"flex-col gap-4"} mt-4 h-full`,children:[t.jsx("div",{className:r?"w-1/2":"w-full",children:t.jsx(An,{events:d.map(C=>({...C,branch:C.branch_name})),selected:l,onSelect:C=>{C&&(u(C),j(C.toISOString().slice(0,10)))}})}),t.jsxs("div",{className:r?"w-1/2 flex flex-col":"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-medium capitalize",children:l.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),i&&t.jsxs(O,{size:"sm",onClick:()=>c(!m),variant:m?"ghost":"default",children:[m?t.jsx($s,{className:"w-4 h-4"}):t.jsx(ct,{className:"w-4 h-4 mr-2"}),m?"Cancelar":"Evento"]})]}),m?t.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/40 animate-in slide-in-from-top-2",children:[t.jsx("h4",{className:"font-medium text-sm",children:"Nuevo Evento"}),t.jsx(de,{placeholder:"Ttulo",value:h,onChange:C=>x(C.target.value)}),t.jsx(de,{placeholder:"Sucursal",value:N,onChange:C=>p(C.target.value)}),t.jsx(de,{placeholder:"Sector",value:g,onChange:C=>y(C.target.value)}),t.jsx(de,{type:"date",value:v,onChange:C=>j(C.target.value)}),t.jsx(O,{className:"w-full",onClick:b,children:"Guardar"})]}):t.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 max-h-[500px]",children:S(l).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center py-10 text-muted-foreground border-2 border-dashed rounded-lg",children:t.jsx("p",{children:"No hay eventos para este da"})}):S(l).map(C=>t.jsx("div",{className:"p-3 bg-card border rounded-lg shadow-sm",children:t.jsx("div",{className:"flex justify-between items-start",children:t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-foreground",children:C.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[C.branch_name," - ",C.sector]})]})})},C.id))})]})]});return r?t.jsx(Xt,{open:e,onOpenChange:s,children:t.jsxs(Kt,{className:"max-w-4xl w-[90vw] h-[80vh] flex flex-col",children:[t.jsx(Zt,{children:t.jsx(Jt,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"flex-1 overflow-hidden",children:t.jsx(k,{})})]})}):t.jsx(_s,{open:e,onOpenChange:s,children:t.jsxs(Gs,{className:"h-[90vh]",children:[t.jsx(Hs,{children:t.jsx(qs,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"px-4 pb-8 h-full overflow-y-auto",children:t.jsx(k,{})})]})})}const xo={admin:["VIEW_ADMIN_DASHBOARD","MANAGE_INVENTORY_CONFIG","VIEW_BRANCH_MONITOR","EDIT_SETTINGS","IMPERSONATE_BRANCH"],branch:[]};function Ft(e,s){return e?(xo[e.role]||[]).includes(s):!1}const Mn=[{id:"executive",name:"Ejecutivo",description:"Vista enfocada en mtricas financieras y tendencias",icon:Re,widgetIds:["metrics-carousel","total-stock-value","trends-chart","category-distribution","monthly-goals","branches-table"]},{id:"operational",name:"Operativo",description:"Vista para operaciones diarias e inventarios",icon:ts,widgetIds:["metrics-carousel","active-products","countdown","inventory-alerts","upcoming-inventories","pending-inventories","quick-actions","category-progress"]},{id:"analytical",name:"Analtico",description:"Vista con grficos y anlisis detallados",icon:St,widgetIds:["metrics-carousel","trends-chart","category-distribution","top-products","category-progress","inventory-progress","critical-products"]},{id:"complete",name:"Completo",description:"Todos los widgets disponibles",icon:an,widgetIds:["metrics-carousel","active-products","countdown","inventory-summary","inventory-alerts","upcoming-inventories","branches-table","inventory-progress","critical-products","total-stock-value","active-users","pending-inventories","trends-chart","top-products","activity-timeline","category-distribution","monthly-goals","sync-status","quick-actions","category-progress"]}];function po({open:e,onOpenChange:s,onApplyPreset:n}){const r=a=>{n(a),s(!1)};return t.jsx(Xt,{open:e,onOpenChange:s,children:t.jsxs(Kt,{className:"max-w-3xl",children:[t.jsxs(Zt,{children:[t.jsx(Jt,{children:"Layouts Predefinidos"}),t.jsx(nr,{children:"Selecciona un layout predefinido para configurar tu dashboard rpidamente"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:Mn.map(a=>{const i=a.icon;return t.jsxs(P,{className:le("p-4 cursor-pointer transition-all hover:border-primary hover:shadow-md","flex flex-col gap-3"),onClick:()=>r(a.id),children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(i,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-base",children:a.name}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.description})]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(nn,{className:"h-3 w-3"}),t.jsxs("span",{children:[a.widgetIds.length," widgets incluidos"]})]}),t.jsx(O,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:l=>{l.stopPropagation(),r(a.id)},children:"Aplicar Layout"})]},a.id)})}),t.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t",children:t.jsx(O,{variant:"outline",onClick:()=>s(!1),children:"Cancelar"})})]})})}const go=[{name:"Belgrano IV",address:"Av. Cabildo 2040",zonal:"Zona Norte",email:"belgrano4@farmaplus.com"},{name:"Recoleta",address:"Av. Santa Fe 1860",zonal:"Zona Centro",email:"recoleta@farmaplus.com"},{name:"Palermo II",address:"Av. Las Heras 3520",zonal:"Zona Norte",email:"palermo2@farmaplus.com"},{name:"Microcentro",address:"Florida 520",zonal:"Zona Centro",email:"microcentro@farmaplus.com"},{name:"Belgrano III",address:"Av. Cabildo 1520",zonal:"Zona Norte",email:"belgrano3@farmaplus.com"},{name:"Villa Urquiza II",address:"Av. Triunvirato 4280",zonal:"Zona Norte",email:"villaurquiza2@farmaplus.com"}],vo={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},bo={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function Xo(){const{user:e}=Me(),{visibleWidgets:s,hiddenWidgets:n,isEditMode:r,setIsEditMode:a,reorderWidgets:i,toggleWidgetVisibility:l,updateWidgetSize:u,applyPreset:d,resetLayout:f}=Pi(e==null?void 0:e.branchName),[m,c]=o.useState(!1),[h,x]=o.useState(!1),N=ua(Ds(cs,{activationConstraint:{distance:8}}),Ds(os,{coordinateGetter:zi})),p=o.useMemo(()=>s.filter(D=>D.type==="branches-table"?Ft(e,"VIEW_BRANCH_MONITOR"):!0),[s,e]),g=D=>{const{active:z,over:T}=D;T&&z.id!==T.id&&i(z.id,T.id)},[y,v]=o.useState({totalStock:0,activeProducts:0,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0}),[j,w]=o.useState(0),[b,S]=o.useState(!1),[k,C]=o.useState(""),[I,M]=o.useState(90),[A,L]=o.useState(0),[H,Z]=o.useState(!1),[ge,Te]=o.useState(void 0),J=D=>{const z=D?new Date(D):new Date;z.setHours(12,0,0,0),Te(z),Z(!0)};o.useEffect(()=>{(async()=>{if(e!=null&&e.branchName){const z=await Je.getBranchConfig(e.branchName);w(z)}})()},[e]),o.useEffect(()=>{(async()=>{let z=0;try{z=await rr()}catch(T){console.error("Error fetching product count:",T)}if(!(e!=null&&e.branchSheet)){v({totalStock:0,activeProducts:z,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});return}try{const B=(await Je.getAllCyclicInventories(e.branchSheet)).reduce((X,re)=>({negativeStock:X.negativeStock+re.negativeValue,positiveStock:X.positiveStock+re.positiveValue,totalStock:X.totalStock+re.differenceValue,negativeUnits:X.negativeUnits+re.negativeUnits,positiveUnits:X.positiveUnits+re.positiveUnits,totalSystemUnits:X.totalSystemUnits+re.totalSystemUnits}),{negativeStock:0,positiveStock:0,totalStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});v({totalStock:B.totalStock,activeProducts:z,negativeStock:B.negativeStock,positiveStock:B.positiveStock,negativeUnits:B.negativeUnits,positiveUnits:B.positiveUnits,totalSystemUnits:B.totalSystemUnits})}catch(T){console.error("Error loading metrics:",T)}})()},[e]);const ze=()=>{const D=new Date().getHours();return D>=6&&D<12?"Buenos das":D>=12&&D<20?"Buenas tardes":"Buenas noches"},ce=D=>{switch(D){case"smart-analyst":return t.jsx($i,{});case"metrics-carousel":return t.jsx(_i,{metrics:y});case"active-products":return t.jsx(Gi,{activeProducts:y.activeProducts});case"inventory-summary":return t.jsx(Hi,{});case"inventory-alerts":return t.jsx(qi,{});case"upcoming-inventories":return t.jsx(Yi,{onDateClick:J});case"branches-table":return Ft(e,"VIEW_BRANCH_MONITOR")?t.jsx(Xi,{branches:go}):null;case"inventory-progress":return t.jsx(Ki,{completedCount:3,totalCount:10});case"critical-products":return t.jsx(Zi,{criticalCount:15,outOfStockCount:3});case"total-stock-value":return t.jsx(Ji,{totalValue:y.totalStock,changePercentage:5.2});case"active-users":return t.jsx(Qi,{activeCount:5,activeBranches:["Belgrano IV","Recoleta","Palermo II"]});case"pending-inventories":return t.jsx(eo,{pendingCount:7,urgentCount:2});case"trends-chart":return t.jsx(to,{});case"top-products":return t.jsx(so,{});case"activity-timeline":return t.jsx(no,{});case"category-distribution":return t.jsx(ro,{});case"monthly-goals":return t.jsx(ao,{});case"sync-status":return t.jsx(io,{isOnline:navigator.onLine,pendingCount:0});case"quick-actions":return t.jsx(oo,{});case"calendar":return t.jsx(mo,{});case"countdown":return t.jsx(lo,{assignedDays:j,daysRemaining:j,totalProgress:0,monthlyProgress:[],isEditable:Ft(e,"MANAGE_INVENTORY_CONFIG"),onEdit:()=>S(!0)});case"category-progress":return t.jsx(uo,{});default:return null}};return t.jsxs(xe.div,{className:"pt-3 pb-6 px-6 space-y-6",variants:vo,initial:"hidden",animate:"show",children:[t.jsxs(xe.div,{variants:bo,className:"space-y-1",children:[t.jsx("div",{className:"text-muted-foreground text-xs font-normal",children:new Date().toLocaleDateString("es-AR",{weekday:"long",month:"short",day:"2-digit",year:"numeric"})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-2xl font-medium tracking-tight text-foreground",children:[ze(),", ",(e==null?void 0:e.role)==="admin"?e==null?void 0:e.name.split(" ")[0]:(e==null?void 0:e.branchName)||"Sucursal"," "]}),t.jsxs("div",{className:"flex gap-2",children:[r&&t.jsxs(t.Fragment,{children:[t.jsxs(O,{variant:"outline",size:"sm",onClick:()=>x(!0),children:[t.jsx(an,{className:"h-4 w-4 mr-2"}),"Presets"]}),t.jsxs(O,{variant:"outline",size:"sm",onClick:()=>c(!0),disabled:n.length===0,children:[t.jsx(ct,{className:"h-4 w-4 mr-2"}),"Agregar Widget"]}),t.jsxs(O,{variant:"outline",size:"sm",onClick:f,children:[t.jsx(qr,{className:"h-4 w-4 mr-2"}),"Resetear"]})]}),t.jsx(xe.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(O,{variant:r?"default":"outline",size:"sm",onClick:()=>a(!r),className:le("relative overflow-hidden transition-all duration-300",r&&"bg-green-600 hover:bg-green-700"),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Qs,{mode:"wait",children:r?t.jsx(xe.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(nn,{className:"h-4 w-4"})},"check"):t.jsx(xe.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(Hr,{className:"h-4 w-4"})},"edit")}),t.jsx("span",{children:r?"Guardar":"Editar Dashboard"})]})})})]})]})]}),t.jsx(fi,{sensors:N,collisionDetection:fa,onDragEnd:g,children:t.jsx(Ci,{items:p.map(D=>D.id),strategy:us,children:t.jsx("div",{className:"grid grid-cols-12 gap-6 auto-rows-auto",children:p.map(D=>t.jsx("div",{className:le(D.size==="small"&&"col-span-12 md:col-span-6 lg:col-span-3",D.size==="large"&&"col-span-12 md:col-span-6 lg:col-span-4",D.size==="full"&&"col-span-12"),children:t.jsx(Wi,{widget:D,isEditMode:r,onRemove:()=>l(D.id),onSizeChange:z=>u(D.id,z),children:ce(D.type)})},D.id))})})}),t.jsx(po,{open:h,onOpenChange:x,onApplyPreset:D=>{const z=Mn.find(T=>T.id===D);z&&d(z.widgetIds)}}),t.jsx(Fi,{open:m,onOpenChange:c,hiddenWidgets:n,onAddWidget:l}),t.jsx(Xt,{open:b,onOpenChange:D=>{if(S(D),D){const z=j||90,B=[180,150,120,90].find(X=>X<=z)||90;C((e==null?void 0:e.branchName)||""),M(B),L(Math.max(0,z-B))}},children:t.jsxs(Kt,{className:"max-w-md",children:[t.jsx(Zt,{children:t.jsx(Jt,{children:"Configurar Plazo de Inventario"})}),t.jsxs("div",{className:"space-y-6 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Pt,{className:"text-muted-foreground",children:"Sucursal Seleccionada"}),t.jsx("div",{className:"text-lg font-semibold border p-3 rounded-md bg-muted/50",children:(e==null?void 0:e.branchName)||"Sin sucursal asignada"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(Pt,{children:"Das Base"}),t.jsx("div",{className:"grid grid-cols-4 gap-3",children:[90,120,150,180].map(D=>t.jsx("button",{onClick:()=>M(D),className:le("flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all",I===D?"border-primary bg-primary/10 text-primary font-bold":"border-muted hover:border-primary/50 text-muted-foreground"),children:t.jsx("span",{className:"text-xl",children:D})},D))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Pt,{children:"Prroga (Das adicionales)"}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(de,{type:"number",placeholder:"0",className:"text-lg font-medium",value:A,onChange:D=>L(Number(D.target.value)),min:0}),t.jsxs("div",{className:"text-sm text-muted-foreground text-nowrap",children:["Total: ",t.jsx("span",{className:"font-bold text-foreground mx-1 text-lg",children:I+A})," das"]})]})]}),t.jsx(O,{className:"w-full mt-2",onClick:async()=>{if(!(e!=null&&e.branchName))return;const D=I+A;try{await Je.saveBranchConfig(e.branchName,D),Ae.success("Operacin exitosa",`Plazo actualizado a ${D} das`),S(!1),w(D)}catch{Ae.error("Error","Error al guardar")}},children:"Guardar Configuracin"})]})]})}),t.jsx(ho,{open:H,onOpenChange:Z,initialDate:ge})]})}export{Xo as default};
