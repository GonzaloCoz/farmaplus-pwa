import{j as t}from"./ui-vendor-CwIRxpyq.js";import{r as i,c as J,a as Qe,u as Vn}from"./react-vendor-ylmX0jv_.js";import{c as O,C as Dt,a as It,T as Kt,B as T,b as $,X as _s,P as Fn,D as qs,d as Gs,e as Ys,f as Xs,g as Hn,S as Ks,h as ne,i as P,j as _,k as q,l as _n,m as G,n as qn,o as Gn,u as Te,p as nt,s as Pt,q as Yn,U as Zs,W as Xn,R as Kn,r as Zn,t as Jn,v as Qn,I as er,w as tr,x as Se,y as sr,z as nr,A as rr,E as ar,F as Zt,G as Jt,H as Qt,J as es,K as Js,L as or}from"./index-CRCrhKU4.js";import{D as rt,c as Ce}from"./cyclicInventoryService-BO2R7mmW.js";import{T as Le}from"./trending-up-CTSS2IcW.js";import{C as dt}from"./clock-BTk_q2A-.js";import{H as ir}from"./history-DtK1qlT7.js";import{T as Qs}from"./target-kRlWbOQM.js";import{W as en}from"./wifi-Cacx2EdQ.js";import{C as wt,e as gt}from"./es-bGAlbXQo.js";import{A as lr}from"./AnimatedCard-Cg8W9f5Q.js";import{D as cr,a as dr,b as ur,c as mr,M as fr,A as Ns,P as tn}from"./progress-DDOFxFPs.js";import{I as ce}from"./input-DJmmUFgp.js";import{S as hr,A as Lt}from"./AnimatedProgressBar-CrK9Ej9L.js";import{P as ut}from"./plus-csKbdJUo.js";import{g as xr}from"./expirationDB-_X_jzNjL.js";import{m as W,A as ts}from"./animation-DbfETv0H.js";import{A as pr}from"./arrow-right-DGwCY7FB.js";import{T as ss}from"./trending-down-Co7a-Bcz.js";import{C as sn}from"./CounterAnimation-DSOCKTOo.js";import{T as gr,a as vr,b as Bt,c as we,d as br,e as F}from"./table-DOjZO2A_.js";import{R as nn,L as yr,C as jr,X as wr,Y as Nr,T as rn,a as Cr,b as Cs,P as Sr,c as kr,d as Dr}from"./chart-vendor-DCWeqmYi.js";import{E as Ir}from"./eye-DiFJMDBV.js";import{s as Er,e as Mr,a as Ar,b as Rr,g as Tr,f as Ss,i as zr,h as Or,p as Pr,d as Lr,j as Br,k as Ur}from"./utils-DNiwW225.js";import{C as $r}from"./chevron-left-LKOD8GbL.js";import{L as vt}from"./label-BdVcOHK8.js";import{C as an}from"./check-BnCQlVy3.js";import"./excel-uoQkVabA.js";import"./circle-D73eJr_k.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=O("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=O("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=O("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=O("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=O("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=O("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=O("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=O("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=O("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=O("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=O("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=O("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=O("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=O("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=O("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=O("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=O("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=O("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=O("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=O("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=O("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=O("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=O("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=O("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=O("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function aa(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i.useMemo(()=>r=>{s.forEach(a=>a(r))},s)}const Et=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function qe(e){const s=Object.prototype.toString.call(e);return s==="[object Window]"||s==="[object global]"}function as(e){return"nodeType"in e}function re(e){var s,n;return e?qe(e)?e:as(e)&&(s=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function os(e){const{Document:s}=re(e);return e instanceof s}function mt(e){return qe(e)?!1:e instanceof re(e).HTMLElement}function dn(e){return e instanceof re(e).SVGElement}function Ge(e){return e?qe(e)?e.document:as(e)?os(e)?e:mt(e)||dn(e)?e.ownerDocument:document:document:document}const ve=Et?i.useLayoutEffect:i.useEffect;function is(e){const s=i.useRef(e);return ve(()=>{s.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return s.current==null?void 0:s.current(...r)},[])}function oa(){const e=i.useRef(null),s=i.useCallback((r,a)=>{e.current=setInterval(r,a)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[s,n]}function at(e,s){s===void 0&&(s=[e]);const n=i.useRef(e);return ve(()=>{n.current!==e&&(n.current=e)},s),n}function ft(e,s){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...s])}function Nt(e){const s=is(e),n=i.useRef(null),r=i.useCallback(a=>{a!==n.current&&(s==null||s(a,n.current)),n.current=a},[]);return[n,r]}function _t(e){const s=i.useRef();return i.useEffect(()=>{s.current=e},[e]),s.current}let Ut={};function ht(e,s){return i.useMemo(()=>{if(s)return s;const n=Ut[e]==null?0:Ut[e]+1;return Ut[e]=n,e+"-"+n},[e,s])}function un(e){return function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((o,c)=>{const d=Object.entries(c);for(const[u,m]of d){const f=o[u];f!=null&&(o[u]=f+e*m)}return o},{...s})}}const _e=un(1),ot=un(-1);function ia(e){return"clientX"in e&&"clientY"in e}function ls(e){if(!e)return!1;const{KeyboardEvent:s}=re(e.target);return s&&e instanceof s}function la(e){if(!e)return!1;const{TouchEvent:s}=re(e.target);return s&&e instanceof s}function qt(e){if(la(e)){if(e.touches&&e.touches.length){const{clientX:s,clientY:n}=e.touches[0];return{x:s,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:s,clientY:n}=e.changedTouches[0];return{x:s,y:n}}}return ia(e)?{x:e.clientX,y:e.clientY}:null}const it=Object.freeze({Translate:{toString(e){if(!e)return;const{x:s,y:n}=e;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:s,scaleY:n}=e;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[it.Translate.toString(e),it.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:s,duration:n,easing:r}=e;return s+" "+n+"ms "+r}}}),Is="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ca(e){return e.matches(Is)?e:e.querySelector(Is)}const da={display:"none"};function ua(e){let{id:s,value:n}=e;return J.createElement("div",{id:s,style:da},n)}function ma(e){let{id:s,announcement:n,ariaLiveType:r="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return J.createElement("div",{id:s,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function fa(){const[e,s]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&s(r)},[]),announcement:e}}const mn=i.createContext(null);function ha(e){const s=i.useContext(mn);i.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(e)},[e,s])}function xa(){const[e]=i.useState(()=>new Set),s=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:a,event:o}=r;e.forEach(c=>{var d;return(d=c[a])==null?void 0:d.call(c,o)})},[e]),s]}const pa={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ga={onDragStart(e){let{active:s}=e;return"Picked up draggable item "+s.id+"."},onDragOver(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(e){let{active:s}=e;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function va(e){let{announcements:s=ga,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=pa}=e;const{announce:o,announcement:c}=fa(),d=ht("DndLiveRegion"),[u,m]=i.useState(!1);if(i.useEffect(()=>{m(!0)},[]),ha(i.useMemo(()=>({onDragStart(l){let{active:h}=l;o(s.onDragStart({active:h}))},onDragMove(l){let{active:h,over:x}=l;s.onDragMove&&o(s.onDragMove({active:h,over:x}))},onDragOver(l){let{active:h,over:x}=l;o(s.onDragOver({active:h,over:x}))},onDragEnd(l){let{active:h,over:x}=l;o(s.onDragEnd({active:h,over:x}))},onDragCancel(l){let{active:h,over:x}=l;o(s.onDragCancel({active:h,over:x}))}}),[o,s])),!u)return null;const f=J.createElement(J.Fragment,null,J.createElement(ua,{id:r,value:a.draggable}),J.createElement(ma,{id:d,announcement:c}));return n?Qe.createPortal(f,n):f}var H;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(H||(H={}));function Ct(){}function Es(e,s){return i.useMemo(()=>({sensor:e,options:s??{}}),[e,s])}function ba(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i.useMemo(()=>[...s].filter(r=>r!=null),[...s])}const xe=Object.freeze({x:0,y:0});function fn(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function hn(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return n-r}function ya(e,s){let{data:{value:n}}=e,{data:{value:r}}=s;return r-n}function Ms(e){let{left:s,top:n,height:r,width:a}=e;return[{x:s,y:n},{x:s+a,y:n},{x:s,y:n+r},{x:s+a,y:n+r}]}function xn(e,s){if(!e||e.length===0)return null;const[n]=e;return n[s]}function As(e,s,n){return s===void 0&&(s=e.left),n===void 0&&(n=e.top),{x:s+e.width*.5,y:n+e.height*.5}}const ja=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=As(s,s.left,s.top),o=[];for(const c of r){const{id:d}=c,u=n.get(d);if(u){const m=fn(As(u),a);o.push({id:d,data:{droppableContainer:c,value:m}})}}return o.sort(hn)},wa=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=Ms(s),o=[];for(const c of r){const{id:d}=c,u=n.get(d);if(u){const m=Ms(u),f=a.reduce((h,x,N)=>h+fn(m[N],x),0),l=Number((f/4).toFixed(4));o.push({id:d,data:{droppableContainer:c,value:l}})}}return o.sort(hn)};function Na(e,s){const n=Math.max(s.top,e.top),r=Math.max(s.left,e.left),a=Math.min(s.left+s.width,e.left+e.width),o=Math.min(s.top+s.height,e.top+e.height),c=a-r,d=o-n;if(r<a&&n<o){const u=s.width*s.height,m=e.width*e.height,f=c*d,l=f/(u+m-f);return Number(l.toFixed(4))}return 0}const Ca=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=e;const a=[];for(const o of r){const{id:c}=o,d=n.get(c);if(d){const u=Na(d,s);u>0&&a.push({id:c,data:{droppableContainer:o,value:u}})}}return a.sort(ya)};function Sa(e,s,n){return{...e,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function pn(e,s){return e&&s?{x:e.left-s.left,y:e.top-s.top}:xe}function ka(e){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return a.reduce((c,d)=>({...c,top:c.top+e*d.y,bottom:c.bottom+e*d.y,left:c.left+e*d.x,right:c.right+e*d.x}),{...n})}}const Da=ka(1);function Ia(e){if(e.startsWith("matrix3d(")){const s=e.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(e.startsWith("matrix(")){const s=e.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function Ea(e,s,n){const r=Ia(s);if(!r)return e;const{scaleX:a,scaleY:o,x:c,y:d}=r,u=e.left-c-(1-a)*parseFloat(n),m=e.top-d-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),f=a?e.width/a:e.width,l=o?e.height/o:e.height;return{width:f,height:l,top:m,right:u+f,bottom:m+l,left:u}}const Ma={ignoreTransform:!1};function Ye(e,s){s===void 0&&(s=Ma);let n=e.getBoundingClientRect();if(s.ignoreTransform){const{transform:m,transformOrigin:f}=re(e).getComputedStyle(e);m&&(n=Ea(n,m,f))}const{top:r,left:a,width:o,height:c,bottom:d,right:u}=n;return{top:r,left:a,width:o,height:c,bottom:d,right:u}}function Rs(e){return Ye(e,{ignoreTransform:!0})}function Aa(e){const s=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function Ra(e,s){return s===void 0&&(s=re(e).getComputedStyle(e)),s.position==="fixed"}function Ta(e,s){s===void 0&&(s=re(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=s[a];return typeof o=="string"?n.test(o):!1})}function Mt(e,s){const n=[];function r(a){if(s!=null&&n.length>=s||!a)return n;if(os(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!mt(a)||dn(a)||n.includes(a))return n;const o=re(e).getComputedStyle(a);return a!==e&&Ta(a,o)&&n.push(a),Ra(a,o)?n:r(a.parentNode)}return e?r(e):n}function gn(e){const[s]=Mt(e,1);return s??null}function $t(e){return!Et||!e?null:qe(e)?e:as(e)?os(e)||e===Ge(e).scrollingElement?window:mt(e)?e:null:null}function vn(e){return qe(e)?e.scrollX:e.scrollLeft}function bn(e){return qe(e)?e.scrollY:e.scrollTop}function Gt(e){return{x:vn(e),y:bn(e)}}var X;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(X||(X={}));function yn(e){return!Et||!e?!1:e===document.scrollingElement}function jn(e){const s={x:0,y:0},n=yn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=s.y,o=e.scrollLeft<=s.x,c=e.scrollTop>=r.y,d=e.scrollLeft>=r.x;return{isTop:a,isLeft:o,isBottom:c,isRight:d,maxScroll:r,minScroll:s}}const za={x:.2,y:.2};function Oa(e,s,n,r,a){let{top:o,left:c,right:d,bottom:u}=n;r===void 0&&(r=10),a===void 0&&(a=za);const{isTop:m,isBottom:f,isLeft:l,isRight:h}=jn(e),x={x:0,y:0},N={x:0,y:0},p={height:s.height*a.y,width:s.width*a.x};return!m&&o<=s.top+p.height?(x.y=X.Backward,N.y=r*Math.abs((s.top+p.height-o)/p.height)):!f&&u>=s.bottom-p.height&&(x.y=X.Forward,N.y=r*Math.abs((s.bottom-p.height-u)/p.height)),!h&&d>=s.right-p.width?(x.x=X.Forward,N.x=r*Math.abs((s.right-p.width-d)/p.width)):!l&&c<=s.left+p.width&&(x.x=X.Backward,N.x=r*Math.abs((s.left+p.width-c)/p.width)),{direction:x,speed:N}}function Pa(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:s,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:s,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function wn(e){return e.reduce((s,n)=>_e(s,Gt(n)),xe)}function La(e){return e.reduce((s,n)=>s+vn(n),0)}function Ba(e){return e.reduce((s,n)=>s+bn(n),0)}function Ua(e,s){if(s===void 0&&(s=Ye),!e)return;const{top:n,left:r,bottom:a,right:o}=s(e);gn(e)&&(a<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const $a=[["x",["left","right"],La],["y",["top","bottom"],Ba]];class cs{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Mt(n),a=wn(r);this.rect={...s},this.width=s.width,this.height=s.height;for(const[o,c,d]of $a)for(const u of c)Object.defineProperty(this,u,{get:()=>{const m=d(r),f=a[o]-m;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class et{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=s}add(s,n,r){var a;(a=this.target)==null||a.addEventListener(s,n,r),this.listeners.push([s,n,r])}}function Wa(e){const{EventTarget:s}=re(e);return e instanceof s?e:Ge(e)}function Wt(e,s){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof s=="number"?Math.sqrt(n**2+r**2)>s:"x"in s&&"y"in s?n>s.x&&r>s.y:"x"in s?n>s.x:"y"in s?r>s.y:!1}var ue;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ue||(ue={}));function Ts(e){e.preventDefault()}function Va(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const Nn={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},Fa=(e,s)=>{let{currentCoordinates:n}=s;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class ds{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new et(Ge(n)),this.windowListeners=new et(re(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ue.Resize,this.handleCancel),this.windowListeners.add(ue.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ue.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,r=s.node.current;r&&Ua(r),n(xe)}handleKeyDown(s){if(ls(s)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:o=Nn,coordinateGetter:c=Fa,scrollBehavior:d="smooth"}=a,{code:u}=s;if(o.end.includes(u)){this.handleEnd(s);return}if(o.cancel.includes(u)){this.handleCancel(s);return}const{collisionRect:m}=r.current,f=m?{x:m.left,y:m.top}:xe;this.referenceCoordinates||(this.referenceCoordinates=f);const l=c(s,{active:n,context:r.current,currentCoordinates:f});if(l){const h=ot(l,f),x={x:0,y:0},{scrollableAncestors:N}=r.current;for(const p of N){const v=s.code,{isTop:j,isRight:g,isLeft:y,isBottom:w,maxScroll:b,minScroll:S}=jn(p),D=Pa(p),C={x:Math.min(v===E.Right?D.right-D.width/2:D.right,Math.max(v===E.Right?D.left:D.left+D.width/2,l.x)),y:Math.min(v===E.Down?D.bottom-D.height/2:D.bottom,Math.max(v===E.Down?D.top:D.top+D.height/2,l.y))},I=v===E.Right&&!g||v===E.Left&&!y,R=v===E.Down&&!w||v===E.Up&&!j;if(I&&C.x!==l.x){const A=p.scrollLeft+h.x,B=v===E.Right&&A<=b.x||v===E.Left&&A>=S.x;if(B&&!h.y){p.scrollTo({left:A,behavior:d});return}B?x.x=p.scrollLeft-A:x.x=v===E.Right?p.scrollLeft-b.x:p.scrollLeft-S.x,x.x&&p.scrollBy({left:-x.x,behavior:d});break}else if(R&&C.y!==l.y){const A=p.scrollTop+h.y,B=v===E.Down&&A<=b.y||v===E.Up&&A>=S.y;if(B&&!h.x){p.scrollTo({top:A,behavior:d});return}B?x.y=p.scrollTop-A:x.y=v===E.Down?p.scrollTop-b.y:p.scrollTop-S.y,x.y&&p.scrollBy({top:-x.y,behavior:d});break}}this.handleMove(s,_e(ot(l,this.referenceCoordinates),x))}}}handleMove(s,n){const{onMove:r}=this.props;s.preventDefault(),r(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ds.activators=[{eventName:"onKeyDown",handler:(e,s,n)=>{let{keyboardCodes:r=Nn,onActivation:a}=s,{active:o}=n;const{code:c}=e.nativeEvent;if(r.start.includes(c)){const d=o.activatorNode.current;return d&&e.target!==d?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function zs(e){return!!(e&&"distance"in e)}function Os(e){return!!(e&&"delay"in e)}class us{constructor(s,n,r){var a;r===void 0&&(r=Wa(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:o}=s,{target:c}=o;this.props=s,this.events=n,this.document=Ge(c),this.documentListeners=new et(this.document),this.listeners=new et(r),this.windowListeners=new et(re(c)),this.initialCoordinates=(a=qt(o))!=null?a:xe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(ue.Resize,this.handleCancel),this.windowListeners.add(ue.DragStart,Ts),this.windowListeners.add(ue.VisibilityChange,this.handleCancel),this.windowListeners.add(ue.ContextMenu,Ts),this.documentListeners.add(ue.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Os(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(zs(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:r,onPending:a}=this.props;a(r,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(ue.Click,Va,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ue.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:r,initialCoordinates:a,props:o}=this,{onMove:c,options:{activationConstraint:d}}=o;if(!a)return;const u=(n=qt(s))!=null?n:xe,m=ot(a,u);if(!r&&d){if(zs(d)){if(d.tolerance!=null&&Wt(m,d.tolerance))return this.handleCancel();if(Wt(m,d.distance))return this.handleStart()}if(Os(d)&&Wt(m,d.tolerance))return this.handleCancel();this.handlePending(d,m);return}s.cancelable&&s.preventDefault(),c(u)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===E.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const Ha={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ms extends us{constructor(s){const{event:n}=s,r=Ge(n.target);super(s,Ha,r)}}ms.activators=[{eventName:"onPointerDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const _a={move:{name:"mousemove"},end:{name:"mouseup"}};var Yt;(function(e){e[e.RightClick=2]="RightClick"})(Yt||(Yt={}));class qa extends us{constructor(s){super(s,_a,Ge(s.event.target))}}qa.activators=[{eventName:"onMouseDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;return n.button===Yt.RightClick?!1:(r==null||r({event:n}),!0)}}];const Vt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ga extends us{constructor(s){super(s,Vt)}static setup(){return window.addEventListener(Vt.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(Vt.move.name,s)};function s(){}}}Ga.activators=[{eventName:"onTouchStart",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:r}=s;const{touches:a}=n;return a.length>1?!1:(r==null||r({event:n}),!0)}}];var tt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(tt||(tt={}));var St;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(St||(St={}));function Ya(e){let{acceleration:s,activator:n=tt.Pointer,canScroll:r,draggingRect:a,enabled:o,interval:c=5,order:d=St.TreeOrder,pointerCoordinates:u,scrollableAncestors:m,scrollableAncestorRects:f,delta:l,threshold:h}=e;const x=Ka({delta:l,disabled:!o}),[N,p]=oa(),v=i.useRef({x:0,y:0}),j=i.useRef({x:0,y:0}),g=i.useMemo(()=>{switch(n){case tt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case tt.DraggableRect:return a}},[n,a,u]),y=i.useRef(null),w=i.useCallback(()=>{const S=y.current;if(!S)return;const D=v.current.x*j.current.x,C=v.current.y*j.current.y;S.scrollBy(D,C)},[]),b=i.useMemo(()=>d===St.TreeOrder?[...m].reverse():m,[d,m]);i.useEffect(()=>{if(!o||!m.length||!g){p();return}for(const S of b){if((r==null?void 0:r(S))===!1)continue;const D=m.indexOf(S),C=f[D];if(!C)continue;const{direction:I,speed:R}=Oa(S,C,g,s,h);for(const A of["x","y"])x[A][I[A]]||(R[A]=0,I[A]=0);if(R.x>0||R.y>0){p(),y.current=S,N(w,c),v.current=R,j.current=I;return}}v.current={x:0,y:0},j.current={x:0,y:0},p()},[s,w,r,p,o,c,JSON.stringify(g),JSON.stringify(x),N,m,b,f,JSON.stringify(h)])}const Xa={x:{[X.Backward]:!1,[X.Forward]:!1},y:{[X.Backward]:!1,[X.Forward]:!1}};function Ka(e){let{delta:s,disabled:n}=e;const r=_t(s);return ft(a=>{if(n||!r||!a)return Xa;const o={x:Math.sign(s.x-r.x),y:Math.sign(s.y-r.y)};return{x:{[X.Backward]:a.x[X.Backward]||o.x===-1,[X.Forward]:a.x[X.Forward]||o.x===1},y:{[X.Backward]:a.y[X.Backward]||o.y===-1,[X.Forward]:a.y[X.Forward]||o.y===1}}},[n,s,r])}function Za(e,s){const n=s!=null?e.get(s):void 0,r=n?n.node.current:null;return ft(a=>{var o;return s==null?null:(o=r??a)!=null?o:null},[r,s])}function Ja(e,s){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:a}=r,o=a.activators.map(c=>({eventName:c.eventName,handler:s(c.handler,r)}));return[...n,...o]},[]),[e,s])}var lt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(lt||(lt={}));var Xt;(function(e){e.Optimized="optimized"})(Xt||(Xt={}));const Ps=new Map;function Qa(e,s){let{dragging:n,dependencies:r,config:a}=s;const[o,c]=i.useState(null),{frequency:d,measure:u,strategy:m}=a,f=i.useRef(e),l=v(),h=at(l),x=i.useCallback(function(j){j===void 0&&(j=[]),!h.current&&c(g=>g===null?j:g.concat(j.filter(y=>!g.includes(y))))},[h]),N=i.useRef(null),p=ft(j=>{if(l&&!n)return Ps;if(!j||j===Ps||f.current!==e||o!=null){const g=new Map;for(let y of e){if(!y)continue;if(o&&o.length>0&&!o.includes(y.id)&&y.rect.current){g.set(y.id,y.rect.current);continue}const w=y.node.current,b=w?new cs(u(w),w):null;y.rect.current=b,b&&g.set(y.id,b)}return g}return j},[e,o,n,l,u]);return i.useEffect(()=>{f.current=e},[e]),i.useEffect(()=>{l||x()},[n,l]),i.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),i.useEffect(()=>{l||typeof d!="number"||N.current!==null||(N.current=setTimeout(()=>{x(),N.current=null},d))},[d,l,x,...r]),{droppableRects:p,measureDroppableContainers:x,measuringScheduled:o!=null};function v(){switch(m){case lt.Always:return!1;case lt.BeforeDragging:return n;default:return!n}}}function Cn(e,s){return ft(n=>e?n||(typeof s=="function"?s(e):e):null,[s,e])}function eo(e,s){return Cn(e,s)}function to(e){let{callback:s,disabled:n}=e;const r=is(s),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function At(e){let{callback:s,disabled:n}=e;const r=is(s),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function so(e){return new cs(Ye(e),e)}function Ls(e,s,n){s===void 0&&(s=so);const[r,a]=i.useState(null);function o(){a(u=>{if(!e)return null;if(e.isConnected===!1){var m;return(m=u??n)!=null?m:null}const f=s(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const c=to({callback(u){if(e)for(const m of u){const{type:f,target:l}=m;if(f==="childList"&&l instanceof HTMLElement&&l.contains(e)){o();break}}}}),d=At({callback:o});return ve(()=>{o(),e?(d==null||d.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(d==null||d.disconnect(),c==null||c.disconnect())},[e]),r}function no(e){const s=Cn(e);return pn(e,s)}const Bs=[];function ro(e){const s=i.useRef(e),n=ft(r=>e?r&&r!==Bs&&e&&s.current&&e.parentNode===s.current.parentNode?r:Mt(e):Bs,[e]);return i.useEffect(()=>{s.current=e},[e]),n}function ao(e){const[s,n]=i.useState(null),r=i.useRef(e),a=i.useCallback(o=>{const c=$t(o.target);c&&n(d=>d?(d.set(c,Gt(c)),new Map(d)):null)},[]);return i.useEffect(()=>{const o=r.current;if(e!==o){c(o);const d=e.map(u=>{const m=$t(u);return m?(m.addEventListener("scroll",a,{passive:!0}),[m,Gt(m)]):null}).filter(u=>u!=null);n(d.length?new Map(d):null),r.current=e}return()=>{c(e),c(o)};function c(d){d.forEach(u=>{const m=$t(u);m==null||m.removeEventListener("scroll",a)})}},[a,e]),i.useMemo(()=>e.length?s?Array.from(s.values()).reduce((o,c)=>_e(o,c),xe):wn(e):xe,[e,s])}function Us(e,s){s===void 0&&(s=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},s),i.useEffect(()=>{const r=e!==xe;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?ot(e,n.current):xe}function oo(e){i.useEffect(()=>{if(!Et)return;const s=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of s)n==null||n()}},e.map(s=>{let{sensor:n}=s;return n}))}function io(e,s){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:a,handler:o}=r;return n[a]=c=>{o(c,s)},n},{}),[e,s])}function Sn(e){return i.useMemo(()=>e?Aa(e):null,[e])}const $s=[];function lo(e,s){s===void 0&&(s=Ye);const[n]=e,r=Sn(n?re(n):null),[a,o]=i.useState($s);function c(){o(()=>e.length?e.map(u=>yn(u)?r:new cs(s(u),u)):$s)}const d=At({callback:c});return ve(()=>{d==null||d.disconnect(),c(),e.forEach(u=>d==null?void 0:d.observe(u))},[e]),a}function co(e){if(!e)return null;if(e.children.length>1)return e;const s=e.children[0];return mt(s)?s:e}function uo(e){let{measure:s}=e;const[n,r]=i.useState(null),a=i.useCallback(m=>{for(const{target:f}of m)if(mt(f)){r(l=>{const h=s(f);return l?{...l,width:h.width,height:h.height}:h});break}},[s]),o=At({callback:a}),c=i.useCallback(m=>{const f=co(m);o==null||o.disconnect(),f&&(o==null||o.observe(f)),r(f?s(f):null)},[s,o]),[d,u]=Nt(c);return i.useMemo(()=>({nodeRef:d,rect:n,setRef:u}),[n,d,u])}const mo=[{sensor:ms,options:{}},{sensor:ds,options:{}}],fo={current:{}},jt={draggable:{measure:Rs},droppable:{measure:Rs,strategy:lt.WhileDragging,frequency:Xt.Optimized},dragOverlay:{measure:Ye}};class st extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,r;return(n=(r=this.get(s))==null?void 0:r.node.current)!=null?n:void 0}}const ho={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new st,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ct},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:jt,measureDroppableContainers:Ct,windowRect:null,measuringScheduled:!1},xo={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ct,draggableNodes:new Map,over:null,measureDroppableContainers:Ct},Rt=i.createContext(xo),kn=i.createContext(ho);function po(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new st}}}function go(e,s){switch(s.type){case H.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case H.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:s.coordinates.x-e.draggable.initialCoordinates.x,y:s.coordinates.y-e.draggable.initialCoordinates.y}}};case H.DragEnd:case H.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case H.RegisterDroppable:{const{element:n}=s,{id:r}=n,a=new st(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case H.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=s,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const c=new st(e.droppable.containers);return c.set(n,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:c}}}case H.UnregisterDroppable:{const{id:n,key:r}=s,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const o=new st(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function vo(e){let{disabled:s}=e;const{active:n,activatorEvent:r,draggableNodes:a}=i.useContext(Rt),o=_t(r),c=_t(n==null?void 0:n.id);return i.useEffect(()=>{if(!s&&!r&&o&&c!=null){if(!ls(o)||document.activeElement===o.target)return;const d=a.get(c);if(!d)return;const{activatorNode:u,node:m}=d;if(!u.current&&!m.current)return;requestAnimationFrame(()=>{for(const f of[u.current,m.current]){if(!f)continue;const l=ca(f);if(l){l.focus();break}}})}},[r,s,a,c,o]),null}function bo(e,s){let{transform:n,...r}=s;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...r}),n):n}function yo(e){return i.useMemo(()=>({draggable:{...jt.draggable,...e==null?void 0:e.draggable},droppable:{...jt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...jt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function jo(e){let{activeNode:s,measure:n,initialRect:r,config:a=!0}=e;const o=i.useRef(!1),{x:c,y:d}=typeof a=="boolean"?{x:a,y:a}:a;ve(()=>{if(!c&&!d||!s){o.current=!1;return}if(o.current||!r)return;const m=s==null?void 0:s.node.current;if(!m||m.isConnected===!1)return;const f=n(m),l=pn(f,r);if(c||(l.x=0),d||(l.y=0),o.current=!0,Math.abs(l.x)>0||Math.abs(l.y)>0){const h=gn(m);h&&h.scrollBy({top:l.y,left:l.x})}},[s,c,d,r,n])}const Dn=i.createContext({...xe,scaleX:1,scaleY:1});var Re;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Re||(Re={}));const wo=i.memo(function(s){var n,r,a,o;let{id:c,accessibility:d,autoScroll:u=!0,children:m,sensors:f=mo,collisionDetection:l=Ca,measuring:h,modifiers:x,...N}=s;const p=i.useReducer(go,void 0,po),[v,j]=p,[g,y]=xa(),[w,b]=i.useState(Re.Uninitialized),S=w===Re.Initialized,{draggable:{active:D,nodes:C,translate:I},droppable:{containers:R}}=v,A=D!=null?C.get(D):null,B=i.useRef({initial:null,translated:null}),V=i.useMemo(()=>{var ee;return D!=null?{id:D,data:(ee=A==null?void 0:A.data)!=null?ee:fo,rect:B}:null},[D,A]),se=i.useRef(null),[me,ze]=i.useState(null),[K,Oe]=i.useState(null),fe=at(N,Object.values(N)),ke=ht("DndDescribedBy",c),Be=i.useMemo(()=>R.getEnabled(),[R]),Q=yo(h),{droppableRects:he,measureDroppableContainers:be,measuringScheduled:Pe}=Qa(Be,{dragging:S,dependencies:[I.x,I.y],config:Q.droppable}),k=Za(C,D),z=i.useMemo(()=>K?qt(K):null,[K]),L=Wn(),U=eo(k,Q.draggable.measure);jo({activeNode:D!=null?C.get(D):null,config:L.layoutShiftCompensation,initialRect:U,measure:Q.draggable.measure});const M=Ls(k,Q.draggable.measure,U),ae=Ls(k?k.parentElement:null),Y=i.useRef({activatorEvent:null,active:null,activeNode:k,collisionRect:null,collisions:null,droppableRects:he,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ue=R.getNodeFor((n=Y.current.over)==null?void 0:n.id),ye=uo({measure:Q.dragOverlay.measure}),$e=(r=ye.nodeRef.current)!=null?r:k,We=S?(a=ye.rect)!=null?a:M:null,xs=!!(ye.nodeRef.current&&ye.rect),ps=no(xs?null:M),Tt=Sn($e?re($e):null),De=ro(S?Ue??k:null),xt=lo(De),pt=bo(x,{transform:{x:I.x-ps.x,y:I.y-ps.y,scaleX:1,scaleY:1},activatorEvent:K,active:V,activeNodeRect:M,containerNodeRect:ae,draggingNodeRect:We,over:Y.current.over,overlayNodeRect:ye.rect,scrollableAncestors:De,scrollableAncestorRects:xt,windowRect:Tt}),gs=z?_e(z,I):null,vs=ao(De),zn=Us(vs),On=Us(vs,[M]),Ve=_e(pt,zn),Fe=We?Da(We,pt):null,Xe=V&&Fe?l({active:V,collisionRect:Fe,droppableRects:he,droppableContainers:Be,pointerCoordinates:gs}):null,bs=xn(Xe,"id"),[Ie,ys]=i.useState(null),Pn=xs?pt:_e(pt,On),Ln=Sa(Pn,(o=Ie==null?void 0:Ie.rect)!=null?o:null,M),zt=i.useRef(null),js=i.useCallback((ee,oe)=>{let{sensor:ie,options:Ee}=oe;if(se.current==null)return;const de=C.get(se.current);if(!de)return;const le=ee.nativeEvent,pe=new ie({active:se.current,activeNode:de,event:le,options:Ee,context:Y,onAbort(Z){if(!C.get(Z))return;const{onDragAbort:ge}=fe.current,je={id:Z};ge==null||ge(je),g({type:"onDragAbort",event:je})},onPending(Z,Me,ge,je){if(!C.get(Z))return;const{onDragPending:Ze}=fe.current,Ae={id:Z,constraint:Me,initialCoordinates:ge,offset:je};Ze==null||Ze(Ae),g({type:"onDragPending",event:Ae})},onStart(Z){const Me=se.current;if(Me==null)return;const ge=C.get(Me);if(!ge)return;const{onDragStart:je}=fe.current,Ke={activatorEvent:le,active:{id:Me,data:ge.data,rect:B}};Qe.unstable_batchedUpdates(()=>{je==null||je(Ke),b(Re.Initializing),j({type:H.DragStart,initialCoordinates:Z,active:Me}),g({type:"onDragStart",event:Ke}),ze(zt.current),Oe(le)})},onMove(Z){j({type:H.DragMove,coordinates:Z})},onEnd:He(H.DragEnd),onCancel:He(H.DragCancel)});zt.current=pe;function He(Z){return async function(){const{active:ge,collisions:je,over:Ke,scrollAdjustedTranslate:Ze}=Y.current;let Ae=null;if(ge&&Ze){const{cancelDrop:Je}=fe.current;Ae={activatorEvent:le,active:ge,collisions:je,delta:Ze,over:Ke},Z===H.DragEnd&&typeof Je=="function"&&await Promise.resolve(Je(Ae))&&(Z=H.DragCancel)}se.current=null,Qe.unstable_batchedUpdates(()=>{j({type:Z}),b(Re.Uninitialized),ys(null),ze(null),Oe(null),zt.current=null;const Je=Z===H.DragEnd?"onDragEnd":"onDragCancel";if(Ae){const Ot=fe.current[Je];Ot==null||Ot(Ae),g({type:Je,event:Ae})}})}}},[C]),Bn=i.useCallback((ee,oe)=>(ie,Ee)=>{const de=ie.nativeEvent,le=C.get(Ee);if(se.current!==null||!le||de.dndKit||de.defaultPrevented)return;const pe={active:le};ee(ie,oe.options,pe)===!0&&(de.dndKit={capturedBy:oe.sensor},se.current=Ee,js(ie,oe))},[C,js]),ws=Ja(f,Bn);oo(f),ve(()=>{M&&w===Re.Initializing&&b(Re.Initialized)},[M,w]),i.useEffect(()=>{const{onDragMove:ee}=fe.current,{active:oe,activatorEvent:ie,collisions:Ee,over:de}=Y.current;if(!oe||!ie)return;const le={active:oe,activatorEvent:ie,collisions:Ee,delta:{x:Ve.x,y:Ve.y},over:de};Qe.unstable_batchedUpdates(()=>{ee==null||ee(le),g({type:"onDragMove",event:le})})},[Ve.x,Ve.y]),i.useEffect(()=>{const{active:ee,activatorEvent:oe,collisions:ie,droppableContainers:Ee,scrollAdjustedTranslate:de}=Y.current;if(!ee||se.current==null||!oe||!de)return;const{onDragOver:le}=fe.current,pe=Ee.get(bs),He=pe&&pe.rect.current?{id:pe.id,rect:pe.rect.current,data:pe.data,disabled:pe.disabled}:null,Z={active:ee,activatorEvent:oe,collisions:ie,delta:{x:de.x,y:de.y},over:He};Qe.unstable_batchedUpdates(()=>{ys(He),le==null||le(Z),g({type:"onDragOver",event:Z})})},[bs]),ve(()=>{Y.current={activatorEvent:K,active:V,activeNode:k,collisionRect:Fe,collisions:Xe,droppableRects:he,draggableNodes:C,draggingNode:$e,draggingNodeRect:We,droppableContainers:R,over:Ie,scrollableAncestors:De,scrollAdjustedTranslate:Ve},B.current={initial:We,translated:Fe}},[V,k,Xe,Fe,C,$e,We,he,R,Ie,De,Ve]),Ya({...L,delta:I,draggingRect:Fe,pointerCoordinates:gs,scrollableAncestors:De,scrollableAncestorRects:xt});const Un=i.useMemo(()=>({active:V,activeNode:k,activeNodeRect:M,activatorEvent:K,collisions:Xe,containerNodeRect:ae,dragOverlay:ye,draggableNodes:C,droppableContainers:R,droppableRects:he,over:Ie,measureDroppableContainers:be,scrollableAncestors:De,scrollableAncestorRects:xt,measuringConfiguration:Q,measuringScheduled:Pe,windowRect:Tt}),[V,k,M,K,Xe,ae,ye,C,R,he,Ie,be,De,xt,Q,Pe,Tt]),$n=i.useMemo(()=>({activatorEvent:K,activators:ws,active:V,activeNodeRect:M,ariaDescribedById:{draggable:ke},dispatch:j,draggableNodes:C,over:Ie,measureDroppableContainers:be}),[K,ws,V,M,j,ke,C,Ie,be]);return J.createElement(mn.Provider,{value:y},J.createElement(Rt.Provider,{value:$n},J.createElement(kn.Provider,{value:Un},J.createElement(Dn.Provider,{value:Ln},m)),J.createElement(vo,{disabled:(d==null?void 0:d.restoreFocus)===!1})),J.createElement(va,{...d,hiddenTextDescribedById:ke}));function Wn(){const ee=(me==null?void 0:me.autoScrollEnabled)===!1,oe=typeof u=="object"?u.enabled===!1:u===!1,ie=S&&!ee&&!oe;return typeof u=="object"?{...u,enabled:ie}:{enabled:ie}}}),No=i.createContext(null),Ws="button",Co="Draggable";function So(e){let{id:s,data:n,disabled:r=!1,attributes:a}=e;const o=ht(Co),{activators:c,activatorEvent:d,active:u,activeNodeRect:m,ariaDescribedById:f,draggableNodes:l,over:h}=i.useContext(Rt),{role:x=Ws,roleDescription:N="draggable",tabIndex:p=0}=a??{},v=(u==null?void 0:u.id)===s,j=i.useContext(v?Dn:No),[g,y]=Nt(),[w,b]=Nt(),S=io(c,s),D=at(n);ve(()=>(l.set(s,{id:s,key:o,node:g,activatorNode:w,data:D}),()=>{const I=l.get(s);I&&I.key===o&&l.delete(s)}),[l,s]);const C=i.useMemo(()=>({role:x,tabIndex:p,"aria-disabled":r,"aria-pressed":v&&x===Ws?!0:void 0,"aria-roledescription":N,"aria-describedby":f.draggable}),[r,x,p,v,N,f.draggable]);return{active:u,activatorEvent:d,activeNodeRect:m,attributes:C,isDragging:v,listeners:r?void 0:S,node:g,over:h,setNodeRef:y,setActivatorNodeRef:b,transform:j}}function ko(){return i.useContext(kn)}const Do="Droppable",Io={timeout:25};function Eo(e){let{data:s,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const o=ht(Do),{active:c,dispatch:d,over:u,measureDroppableContainers:m}=i.useContext(Rt),f=i.useRef({disabled:n}),l=i.useRef(!1),h=i.useRef(null),x=i.useRef(null),{disabled:N,updateMeasurementsFor:p,timeout:v}={...Io,...a},j=at(p??r),g=i.useCallback(()=>{if(!l.current){l.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{m(Array.isArray(j.current)?j.current:[j.current]),x.current=null},v)},[v]),y=At({callback:g,disabled:N||!c}),w=i.useCallback((C,I)=>{y&&(I&&(y.unobserve(I),l.current=!1),C&&y.observe(C))},[y]),[b,S]=Nt(w),D=at(s);return i.useEffect(()=>{!y||!b.current||(y.disconnect(),l.current=!1,y.observe(b.current))},[b,y]),i.useEffect(()=>(d({type:H.RegisterDroppable,element:{id:r,key:o,disabled:n,node:b,rect:h,data:D}}),()=>d({type:H.UnregisterDroppable,key:o,id:r})),[r]),i.useEffect(()=>{n!==f.current.disabled&&(d({type:H.SetDroppableDisabled,id:r,key:o,disabled:n}),f.current.disabled=n)},[r,o,n,d]),{active:c,rect:h,isOver:(u==null?void 0:u.id)===r,node:b,over:u,setNodeRef:S}}function fs(e,s,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(s,1)[0]),r}function Mo(e,s){return e.reduce((n,r,a)=>{const o=s.get(r);return o&&(n[a]=o),n},Array(e.length))}function bt(e){return e!==null&&e>=0}function Ao(e,s){if(e===s)return!0;if(e.length!==s.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==s[n])return!1;return!0}function Ro(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const hs=e=>{let{rects:s,activeIndex:n,overIndex:r,index:a}=e;const o=fs(s,r,n),c=s[a],d=o[a];return!d||!c?null:{x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height}},In="Sortable",En=J.createContext({activeIndex:-1,containerId:In,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:hs,disabled:{draggable:!1,droppable:!1}});function To(e){let{children:s,id:n,items:r,strategy:a=hs,disabled:o=!1}=e;const{active:c,dragOverlay:d,droppableRects:u,over:m,measureDroppableContainers:f}=ko(),l=ht(In,n),h=d.rect!==null,x=i.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),N=c!=null,p=c?x.indexOf(c.id):-1,v=m?x.indexOf(m.id):-1,j=i.useRef(x),g=!Ao(x,j.current),y=v!==-1&&p===-1||g,w=Ro(o);ve(()=>{g&&N&&f(x)},[g,x,N,f]),i.useEffect(()=>{j.current=x},[x]);const b=i.useMemo(()=>({activeIndex:p,containerId:l,disabled:w,disableTransforms:y,items:x,overIndex:v,useDragOverlay:h,sortedRects:Mo(x,u),strategy:a}),[p,l,w.draggable,w.droppable,y,x,v,u,h,a]);return J.createElement(En.Provider,{value:b},s)}const zo=e=>{let{id:s,items:n,activeIndex:r,overIndex:a}=e;return fs(n,r,a).indexOf(s)},Oo=e=>{let{containerId:s,isSorting:n,wasDragging:r,index:a,items:o,newIndex:c,previousItems:d,previousContainerId:u,transition:m}=e;return!m||!r||d!==o&&a===c?!1:n?!0:c!==a&&s===u},Po={duration:200,easing:"ease"},Mn="transform",Lo=it.Transition.toString({property:Mn,duration:0,easing:"linear"}),Bo={roleDescription:"sortable"};function Uo(e){let{disabled:s,index:n,node:r,rect:a}=e;const[o,c]=i.useState(null),d=i.useRef(n);return ve(()=>{if(!s&&n!==d.current&&r.current){const u=a.current;if(u){const m=Ye(r.current,{ignoreTransform:!0}),f={x:u.left-m.left,y:u.top-m.top,scaleX:u.width/m.width,scaleY:u.height/m.height};(f.x||f.y)&&c(f)}}n!==d.current&&(d.current=n)},[s,n,r,a]),i.useEffect(()=>{o&&c(null)},[o]),o}function $o(e){let{animateLayoutChanges:s=Oo,attributes:n,disabled:r,data:a,getNewIndex:o=zo,id:c,strategy:d,resizeObserverConfig:u,transition:m=Po}=e;const{items:f,containerId:l,activeIndex:h,disabled:x,disableTransforms:N,sortedRects:p,overIndex:v,useDragOverlay:j,strategy:g}=i.useContext(En),y=Wo(r,x),w=f.indexOf(c),b=i.useMemo(()=>({sortable:{containerId:l,index:w,items:f},...a}),[l,a,w,f]),S=i.useMemo(()=>f.slice(f.indexOf(c)),[f,c]),{rect:D,node:C,isOver:I,setNodeRef:R}=Eo({id:c,data:b,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...u}}),{active:A,activatorEvent:B,activeNodeRect:V,attributes:se,setNodeRef:me,listeners:ze,isDragging:K,over:Oe,setActivatorNodeRef:fe,transform:ke}=So({id:c,data:b,attributes:{...Bo,...n},disabled:y.draggable}),Be=aa(R,me),Q=!!A,he=Q&&!N&&bt(h)&&bt(v),be=!j&&K,Pe=be&&he?ke:null,z=he?Pe??(d??g)({rects:p,activeNodeRect:V,activeIndex:h,overIndex:v,index:w}):null,L=bt(h)&&bt(v)?o({id:c,items:f,activeIndex:h,overIndex:v}):w,U=A==null?void 0:A.id,M=i.useRef({activeId:U,items:f,newIndex:L,containerId:l}),ae=f!==M.current.items,Y=s({active:A,containerId:l,isDragging:K,isSorting:Q,id:c,index:w,items:f,newIndex:M.current.newIndex,previousItems:M.current.items,previousContainerId:M.current.containerId,transition:m,wasDragging:M.current.activeId!=null}),Ue=Uo({disabled:!Y,index:w,node:C,rect:D});return i.useEffect(()=>{Q&&M.current.newIndex!==L&&(M.current.newIndex=L),l!==M.current.containerId&&(M.current.containerId=l),f!==M.current.items&&(M.current.items=f)},[Q,L,l,f]),i.useEffect(()=>{if(U===M.current.activeId)return;if(U!=null&&M.current.activeId==null){M.current.activeId=U;return}const $e=setTimeout(()=>{M.current.activeId=U},50);return()=>clearTimeout($e)},[U]),{active:A,activeIndex:h,attributes:se,data:b,rect:D,index:w,newIndex:L,items:f,isOver:I,isSorting:Q,isDragging:K,listeners:ze,node:C,overIndex:v,over:Oe,setNodeRef:Be,setActivatorNodeRef:fe,setDroppableNodeRef:R,setDraggableNodeRef:me,transform:Ue??z,transition:ye()};function ye(){if(Ue||ae&&M.current.newIndex===w)return Lo;if(!(be&&!ls(B)||!m)&&(Q||Y))return it.Transition.toString({...m,property:Mn})}}function Wo(e,s){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:s.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:s.droppable}}function kt(e){if(!e)return!1;const s=e.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const Vo=[E.Down,E.Right,E.Up,E.Left],Fo=(e,s)=>{let{context:{active:n,collisionRect:r,droppableRects:a,droppableContainers:o,over:c,scrollableAncestors:d}}=s;if(Vo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const u=[];o.getEnabled().forEach(l=>{if(!l||l!=null&&l.disabled)return;const h=a.get(l.id);if(h)switch(e.code){case E.Down:r.top<h.top&&u.push(l);break;case E.Up:r.top>h.top&&u.push(l);break;case E.Left:r.left>h.left&&u.push(l);break;case E.Right:r.left<h.left&&u.push(l);break}});const m=wa({active:n,collisionRect:r,droppableRects:a,droppableContainers:u,pointerCoordinates:null});let f=xn(m,"id");if(f===(c==null?void 0:c.id)&&m.length>1&&(f=m[1].id),f!=null){const l=o.get(n.id),h=o.get(f),x=h?a.get(h.id):null,N=h==null?void 0:h.node.current;if(N&&x&&l&&h){const v=Mt(N).some((S,D)=>d[D]!==S),j=An(l,h),g=Ho(l,h),y=v||!j?{x:0,y:0}:{x:g?r.width-x.width:0,y:g?r.height-x.height:0},w={x:x.left,y:x.top};return y.x&&y.y?w:ot(w,y)}}}};function An(e,s){return!kt(e)||!kt(s)?!1:e.data.current.sortable.containerId===s.data.current.sortable.containerId}function Ho(e,s){return!kt(e)||!kt(s)||!An(e,s)?!1:e.data.current.sortable.index<s.data.current.sortable.index}const yt=[{id:"smart-analyst",type:"smart-analyst",title:"Analista Inteligente",description:"Anlisis automtico de inventario",icon:Fr,visible:!0,order:0,size:"small",span:2,row:"top"},{id:"metrics-carousel",type:"metrics-carousel",title:"Mtricas Financieras",description:"Diferencia neta, negativos y positivos",icon:rt,visible:!0,order:1,size:"small",span:1,row:"top",mandatory:!0},{id:"active-products",type:"active-products",title:"Productos Activos",description:"Total de productos en inventarios",icon:ns,visible:!0,order:2,size:"small",span:1,row:"top"},{id:"inventory-summary",type:"inventory-summary",title:"Resumen de Inventario",description:"Progreso de productos en stock",icon:Dt,visible:!1,order:10,size:"large",span:1,row:"middle"},{id:"inventory-alerts",type:"inventory-alerts",title:"Alertas de Inventario",description:"Notificaciones importantes",icon:It,visible:!0,order:6,size:"large",span:1,row:"middle"},{id:"upcoming-inventories",type:"upcoming-inventories",title:"Prximos Inventarios",description:"Inventarios programados",icon:on,visible:!0,order:5,size:"large",span:1,row:"middle"},{id:"branches-table",type:"branches-table",title:"Tabla de Sucursales",description:"Listado completo de sucursales",icon:Hr,visible:!0,order:7,size:"full",span:1,row:"bottom"},{id:"inventory-progress",type:"inventory-progress",title:"Progreso de Inventarios",description:"Porcentaje de inventarios completados",icon:Le,visible:!1,order:6,size:"small",span:1,row:"top"},{id:"critical-products",type:"critical-products",title:"Productos Crticos",description:"Productos con stock bajo o agotados",icon:Kt,visible:!1,order:7,size:"small",span:1,row:"top"},{id:"total-stock-value",type:"total-stock-value",title:"Valor Total de Stock",description:"Valor monetario total del inventario",icon:rt,visible:!1,order:8,size:"small",span:1,row:"top"},{id:"active-users",type:"active-users",title:"Usuarios Activos",description:"Usuarios trabajando en tiempo real",icon:cn,visible:!1,order:9,size:"small",span:1,row:"top"},{id:"pending-inventories",type:"pending-inventories",title:"Inventarios Pendientes",description:"Inventarios sin completar",icon:dt,visible:!1,order:10,size:"small",span:1,row:"top"},{id:"trends-chart",type:"trends-chart",title:"Grfico de Tendencias",description:"Evolucin de diferencias en el tiempo",icon:_r,visible:!0,order:11,size:"large",span:1,row:"middle"},{id:"top-products",type:"top-products",title:"Top Productos con Diferencias",description:"Productos con mayores discrepancias",icon:ra,visible:!1,order:12,size:"large",span:1,row:"middle"},{id:"activity-timeline",type:"activity-timeline",title:"Actividad Reciente",description:"Timeline de ltimas acciones",icon:ir,visible:!1,order:13,size:"large",span:1,row:"middle"},{id:"category-distribution",type:"category-distribution",title:"Distribucin por Categora",description:"Porcentaje de productos por categora",icon:ks,visible:!1,order:14,size:"large",span:1,row:"middle"},{id:"monthly-goals",type:"monthly-goals",title:"Objetivos del Mes",description:"Progreso hacia metas mensuales",icon:Qs,visible:!1,order:15,size:"large",span:1,row:"middle"},{id:"sync-status",type:"sync-status",title:"Estado de Sincronizacin",description:"Conexin y datos pendientes",icon:en,visible:!1,order:16,size:"large",span:1,row:"middle"},{id:"quick-actions",type:"quick-actions",title:"Acciones Rpidas",description:"Tareas frecuentes",icon:rs,visible:!1,order:17,size:"large",span:1,row:"middle"},{id:"countdown",type:"countdown",title:"Contador de Das",description:"Das restantes para finalizar conteo cclico",icon:wt,visible:!0,order:3,size:"small",span:1,row:"top"},{id:"category-progress",type:"category-progress",title:"Progreso por Rubros",description:"Avance de inventario por categora",icon:ks,visible:!0,order:4,size:"large",span:1,row:"middle"}];function _o(e){const s=`dashboard - layout - v5 - ${e||"default"} `,[n,r]=i.useState(()=>{try{const N=localStorage.getItem(s);if(N){const p=JSON.parse(N);return yt.map(j=>{const g=p.widgets.find(y=>y.id===j.id);return g?{...j,visible:g.visible,order:g.order,...j.mandatory?{visible:!0}:{}}:j}).sort((j,g)=>j.order-g.order)}}catch(N){console.error("Error loading dashboard layout:",N)}return yt}),[a,o]=i.useState(!1);i.useEffect(()=>{const p={widgets:n.map(({id:v,visible:j,order:g})=>({id:v,visible:j,order:g})),lastUpdated:Date.now()};localStorage.setItem(s,JSON.stringify(p))},[n,s]);const c=(N,p)=>{r(v=>{const j=v.findIndex(w=>w.id===N),g=v.findIndex(w=>w.id===p);return fs(v,j,g).map((w,b)=>({...w,order:b}))})},d=N=>{r(p=>p.map(v=>v.id===N&&!v.mandatory?{...v,visible:!v.visible}:v))},u=()=>{r(yt),o(!1)},m=(N,p)=>{r(v=>v.map(j=>j.id===N?{...j,size:p}:j))},f=(N,p)=>{r(v=>v.map(j=>j.id===N?{...j,span:p}:j))},l=N=>{r(p=>p.map(v=>({...v,visible:v.mandatory||N.includes(v.id)})))};i.useEffect(()=>{n.every(p=>p.title&&p.icon)||(console.warn("Detected corrupted widget state, resetting to defaults"),r(yt))},[n]);const h=n.filter(N=>N.visible).sort((N,p)=>N.order-p.order),x=n.filter(N=>!N.visible).sort((N,p)=>(N.title||"").localeCompare(p.title||""));return{widgets:n,visibleWidgets:h,hiddenWidgets:x,isEditMode:a,setIsEditMode:o,reorderWidgets:c,toggleWidgetVisibility:d,updateWidgetSize:m,updateWidgetSpan:f,applyPreset:l,resetLayout:u}}const qo={small:"h-[200px]",medium:"h-[300px]",large:"h-[400px]",full:"h-auto"},Go={small:"col-span-1",medium:"col-span-1",large:"col-span-1",full:"col-span-full"},Vs={small:{label:"Pequeo",icon:Kr,description:"1/4 ancho (3 cols)"},medium:{label:"Mediano",icon:sa,description:"1/2 ancho (6 cols)"},large:{label:"Grande",icon:Ds,description:"1/3 ancho (4 cols)"},full:{label:"Ancho completo",icon:Ds,description:"Ancho completo (12 cols)"}};function Yo({currentSize:e,onChange:s,availableSizes:n=["small","medium","large"]}){const r=Vs[e].icon;return t.jsxs(cr,{children:[t.jsx(dr,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-6 w-6",title:"Cambiar tamao",children:t.jsx(r,{className:"h-4 w-4"})})}),t.jsx(ur,{align:"end",children:n.map(a=>{const o=Vs[a],c=o.icon;return t.jsxs(mr,{onClick:()=>s(a),className:$("flex items-center gap-2",e===a&&"bg-accent"),children:[t.jsx(c,{className:"h-4 w-4"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-medium",children:o.label}),t.jsx("span",{className:"text-xs text-muted-foreground",children:o.description})]})]},a)})})]})}function Xo({widget:e,isEditMode:s,onRemove:n,onSizeChange:r,children:a}){const{attributes:o,listeners:c,setNodeRef:d,transform:u,transition:m,isDragging:f}=$o({id:e.id,disabled:!s}),l={transform:it.Transform.toString(u),transition:m};return t.jsx("div",{ref:d,style:l,className:$(Go[e.size],f&&"opacity-50 z-50",s&&"cursor-move",qo[e.size]),children:t.jsx(lr,{hoverEffect:s?"none":"lift",className:"h-full",children:t.jsxs("div",{className:$("relative h-full transition-all rounded-lg",s&&"ring-2 ring-primary/20 hover:ring-primary/40"),children:[s&&t.jsxs("div",{className:"absolute top-2 right-2 z-10 flex gap-1",children:[r&&t.jsx(Yo,{currentSize:e.size,onChange:r}),t.jsx(T,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-grab active:cursor-grabbing",...o,...c,children:t.jsx(Gr,{className:"h-4 w-4"})}),!e.mandatory&&n&&t.jsx(T,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive hover:text-destructive-foreground",onClick:n,children:t.jsx(_s,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"h-full",children:a})]})})})}const Fs={metrics:{id:"metrics",name:"Mtricas",icon:rt,description:"Indicadores financieros y de rendimiento"},inventory:{id:"inventory",name:"Inventario",icon:Fn,description:"Gestin y control de inventarios"},analytics:{id:"analytics",name:"Anlisis",icon:Dt,description:"Grficos y reportes analticos"},actions:{id:"actions",name:"Acciones",icon:rs,description:"Acciones rpidas y utilidades"},alerts:{id:"alerts",name:"Alertas",icon:It,description:"Notificaciones y recordatorios"},activity:{id:"activity",name:"Actividad",icon:ns,description:"Seguimiento de actividad y usuarios"}},Ft={"metrics-carousel":"metrics","active-products":"inventory","inventory-summary":"inventory","inventory-alerts":"alerts","upcoming-inventories":"inventory","branches-table":"activity","inventory-progress":"inventory","critical-products":"alerts","total-stock-value":"metrics","active-users":"activity","pending-inventories":"inventory","trends-chart":"analytics","top-products":"analytics","activity-timeline":"activity","category-distribution":"analytics","monthly-goals":"metrics","sync-status":"actions","quick-actions":"actions",countdown:"alerts","category-progress":"analytics",calendar:"actions"},Ko=new Set(["metrics-carousel","active-products","inventory-alerts","trends-chart","quick-actions"]);function Zo({open:e,onOpenChange:s,hiddenWidgets:n,onAddWidget:r}){const[a,o]=i.useState(""),[c,d]=i.useState(null),u=i.useMemo(()=>{let l=n;return a&&(l=l.filter(h=>h.title.toLowerCase().includes(a.toLowerCase())||h.description.toLowerCase().includes(a.toLowerCase()))),c&&(l=l.filter(h=>Ft[h.type]===c)),l},[n,a,c]),m=i.useMemo(()=>{const l={};return u.forEach(h=>{const x=Ft[h.type]||"other";l[x]||(l[x]=[]),l[x].push(h)}),l},[u]),f=l=>{r(l),n.length===1&&s(!1)};return t.jsx(qs,{open:e,onOpenChange:s,children:t.jsxs(Gs,{className:"max-h-[90vh]",children:[t.jsxs(Ys,{children:[t.jsx(Xs,{children:"Galera de Widgets"}),t.jsx(Hn,{children:"Explora y agrega widgets para personalizar tu dashboard"})]}),t.jsxs("div",{className:"px-4 space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(ce,{placeholder:"Buscar widgets...",value:a,onChange:l=>o(l.target.value),className:"pl-9"})]}),t.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[t.jsx(T,{variant:c===null?"default":"outline",size:"sm",onClick:()=>d(null),children:"Todos"}),Object.values(Fs).map(l=>{const h=l.icon,x=n.filter(N=>Ft[N.type]===l.id).length;return x===0?null:t.jsxs(T,{variant:c===l.id?"default":"outline",size:"sm",onClick:()=>d(l.id),className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-4 w-4"}),l.name,t.jsx(ne,{variant:"secondary",className:"ml-1",children:x})]},l.id)})]})]}),t.jsx("div",{className:"px-4 pb-4 max-h-[50vh] overflow-y-auto",children:u.length===0?t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx("p",{className:"text-lg font-medium",children:n.length===0?"Todos los widgets estn visibles":"No se encontraron widgets"}),a&&t.jsx("p",{className:"text-sm mt-2",children:"Intenta con otra bsqueda o categora"})]}):t.jsx("div",{className:"space-y-6",children:Object.entries(m).map(([l,h])=>{const x=Fs[l];if(!x||h.length===0)return null;const N=x.icon;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-background py-2 z-10",children:[t.jsx(N,{className:"h-5 w-5 text-primary"}),t.jsx("h3",{className:"font-semibold",children:x.name}),t.jsx(ne,{variant:"outline",children:h.length})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:h.map(p=>{const v=p.icon,j=Ko.has(p.id);return t.jsxs(P,{className:$("hover:border-primary transition-all hover:shadow-md",j&&"border-primary/50"),children:[t.jsx(_,{className:"pb-3",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(v,{className:"h-4 w-4 text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"text-sm truncate",children:p.title}),j&&t.jsx(hr,{className:"h-3 w-3 fill-yellow-400 text-yellow-400 flex-shrink-0"})]}),t.jsx(_n,{className:"text-xs mt-1 line-clamp-2",children:p.description})]})]})})}),t.jsx(G,{className:"pt-0",children:t.jsxs(T,{size:"sm",className:"w-full",onClick:()=>f(p.id),children:[t.jsx(ut,{className:"h-4 w-4 mr-2"}),"Agregar"]})})]},p.id)})})]},l)})})}),t.jsx(qn,{children:t.jsx(Gn,{asChild:!0,children:t.jsx(T,{variant:"outline",children:"Cerrar"})})})]})})}function Jo(){const{user:e}=Te(),[s,n]=i.useState([]),[r,a]=i.useState(!0),[o,c]=i.useState(0),d=Vn();i.useEffect(()=>{u();const h=setInterval(u,5e3);return()=>clearInterval(h)},[e==null?void 0:e.branchName]),i.useEffect(()=>{if(s.length<=1)return;const h=setInterval(()=>{c(x=>(x+1)%s.length)},4e3);return()=>clearInterval(h)},[s.length]);const u=async()=>{try{const h=await xr(e==null?void 0:e.branchName),x=new Date,N=x.getMonth()+1,p=x.getFullYear(),v=p*100+N,j=[],g=new Map;h.forEach(y=>{const w=g.get(y.ean);(!w||y.timestamp>w.timestamp)&&g.set(y.ean,y)}),g.forEach(y=>{y.batches.forEach(w=>{if(w.quantity<=0||w.status&&w.status!=="active")return;const b=w.reminderMonths;if(!b)return;const S=w.expirationDate.split("/");if(S.length<2)return;let D=parseInt(S[0]),C=parseInt(S[1]);C<100&&(C+=2e3);const I=C*100+D,R=C*12+D,A=p*12+N;if(R-A<=b){const se=new Date(C,D-1,1).getTime()-x.getTime(),me=Math.ceil(se/(1e3*60*60*24));j.push({productName:y.productName,batchNumber:w.batchNumber,expirationDate:w.expirationDate,reminderMonths:b,daysUntilExpiry:me})}})}),j.sort((y,w)=>y.daysUntilExpiry-w.daysUntilExpiry),n(y=>JSON.stringify(y)===JSON.stringify(j)?y:j)}catch(h){console.error("Smart Analyst Error:",h)}finally{a(!1)}};if(r)return null;const m=s.length,f=m===0,l=s[o];return t.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-full",children:t.jsxs(P,{className:"flex flex-col h-full bg-card border-border/50 shadow-sm relative overflow-hidden group hover:shadow-md transition-all cursor-pointer",onClick:()=>d("/smart-analyst"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-50"}),t.jsx(_,{className:"pb-2 pt-4 px-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx(q,{className:"text-sm font-medium text-muted-foreground",children:"Control de Vencimientos"}),f?t.jsx(nt,{className:"w-4 h-4 text-emerald-500"}):t.jsx(Vr,{className:"w-4 h-4 text-primary"})]})}),t.jsxs(G,{className:"flex-1 flex flex-col px-4 pb-4 pt-0 min-h-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[t.jsx("span",{className:`text-3xl font-bold ${f?"text-emerald-600 dark:text-emerald-400":"text-foreground"}`,children:f?"Todo en Orden":`${m}`}),!f&&t.jsx("span",{className:"text-sm text-muted-foreground",children:"Alertas"})]}),f&&t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:"No detectamos productos prximos a vencer segn tus recordatorios configurados."}),!f&&l&&t.jsx("div",{className:"flex-1 relative min-h-0 mb-2",children:t.jsx(ts,{mode:"wait",children:t.jsxs(W.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},className:"absolute inset-0 flex flex-col justify-center border-l-2 border-primary/50 pl-3 py-1",children:[t.jsx("p",{className:"font-medium text-sm truncate text-foreground leading-tight mb-1",title:l.productName,children:l.productName}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground/80",children:[t.jsxs("span",{className:"font-mono bg-muted/50 px-1 rounded text-[10px]",children:["Lote: ",l.batchNumber]}),t.jsx("span",{children:""}),t.jsxs("span",{className:l.daysUntilExpiry<=30?"text-red-500 font-medium":"text-amber-500",children:["Vence: ",l.expirationDate]})]})]},`${l.productName}-${l.batchNumber}`)})}),!f&&s.length>1&&t.jsx("div",{className:"flex gap-1 mb-2",children:s.slice(0,5).map((h,x)=>t.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${x===o%5?"w-4 bg-primary":"w-1.5 bg-primary/20"}`},x))}),!f&&t.jsxs(T,{className:"w-full h-8 text-xs mt-auto",size:"sm",variant:"outline",onClick:()=>d("/smart-analyst"),children:["Ver Detalles ",t.jsx(pr,{className:"w-3 h-3 ml-2"})]})]})]})})}function Qo({metrics:e}){const s=(o,c)=>{if(c===0)return{value:0,isPositive:!0};const d=o/c*100;return{value:Math.abs(Number(d.toFixed(1))),isPositive:d>=0}},n=s(e.negativeUnits+e.positiveUnits,e.totalSystemUnits),r=s(e.negativeUnits,e.totalSystemUnits),a=s(e.positiveUnits,e.totalSystemUnits);return t.jsx(fr,{items:[{id:"net",label:"Diferencia Neta",value:e.totalStock,color:e.totalStock<0?"text-destructive":e.totalStock>0?"text-success":"text-foreground",icon:rt,prefix:"$",trend:n},{id:"negative",label:"Negativo Total",value:e.negativeStock,color:"text-destructive",icon:ss,prefix:"$",trend:r},{id:"positive",label:"Positivo Total",value:e.positiveStock,color:"text-success",icon:Le,prefix:"$",trend:a}]})}function ei({activeProducts:e}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Productos Activos"}),t.jsx(ns,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[(()=>{const s=new Intl.NumberFormat("es-AR").format(e);let n="text-3xl";return s.length>8?n="text-xl":s.length>6&&(n="text-2xl"),t.jsx("div",{className:`${n} font-bold`,children:t.jsx(sn,{value:e})})})(),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total en base de datos"})]})]})}function ti(){return t.jsxs(P,{className:"p-6 h-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Resumen de Inventario"}),t.jsx("button",{className:"text-sm text-muted-foreground hover:text-foreground",children:"Ver detalles"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos en Stock"}),t.jsx("span",{className:"text-sm font-medium",children:"85%"})]}),t.jsx(Lt,{value:85})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos con Bajo Stock"}),t.jsx("span",{className:"text-sm font-medium text-warning",children:"12%"})]}),t.jsx(Lt,{value:12,variant:"warning"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Productos Agotados"}),t.jsx("span",{className:"text-sm font-medium text-destructive",children:"3%"})]}),t.jsx(Lt,{value:3,variant:"destructive"})]})]})]})}const si=[{label:"Diferencia de Stock",icon:Kt,message:"Hola, he detectado una diferencia de stock importante en...",color:"bg-orange-500/10 text-orange-600 hover:bg-orange-500/20 border-orange-200"},{label:"Confirmar Cierre",icon:qr,message:"El cierre del inventario cclico ha sido completado y verificado.",color:"bg-green-500/10 text-green-600 hover:bg-green-500/20 border-green-200"},{label:"Solicitud Urgente",icon:Yr,message:"Necesito autorizacin urgente para...",color:"bg-blue-500/10 text-blue-600 hover:bg-blue-500/20 border-blue-200"}],te={dark:"#08102E",blue:"#045598",light:"#a5b1e1ff"},ni=()=>t.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center",children:[t.jsx(W.div,{className:"absolute inset-0 rounded-full blur-xl opacity-50",style:{background:`radial-gradient(circle at center, ${te.light}, ${te.blue})`},animate:{scale:[.8,1,.9,.8],opacity:[.4,.6,.5,.4]},transition:{duration:5,repeat:1/0,ease:"easeInOut",times:[0,.4,.8,1]}}),t.jsx(W.div,{className:"absolute w-28 h-28 rounded-full blur-lg mix-blend-screen",style:{background:`conic-gradient(from 0deg, ${te.dark}, ${te.blue}, ${te.light}, ${te.dark})`},animate:{rotate:360,scale:[.9,1.1,1,.9]},transition:{rotate:{duration:7,repeat:1/0,ease:"linear"},scale:{duration:6,repeat:1/0,ease:"easeInOut"}}}),t.jsx(W.div,{className:"absolute w-24 h-24 rounded-full blur-md mix-blend-overlay",style:{background:`conic-gradient(from 180deg, ${te.light}, ${te.blue}, ${te.dark}, ${te.light})`},animate:{rotate:-360,scale:[1.1,.9,.95,1.1]},transition:{rotate:{duration:9,repeat:1/0,ease:"linear"},scale:{duration:8,repeat:1/0,ease:"easeInOut"}}}),t.jsxs(W.div,{className:"absolute w-20 h-20 rounded-full backdrop-blur-md z-10 flex items-center justify-center overflow-hidden",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%)",border:"1px solid rgba(255,255,255,0.3)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37), inset 0 0 0 1px rgba(255,255,255,0.1)"},animate:{boxShadow:[`0 0 20px ${te.blue}40, inset 0 0 10px rgba(255,255,255,0.1)`,`0 0 35px ${te.light}50, inset 0 0 20px rgba(255,255,255,0.2)`,`0 0 20px ${te.blue}40, inset 0 0 10px rgba(255,255,255,0.1)`]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/20 to-transparent opacity-50 pointer-events-none"}),t.jsx(Xr,{className:"w-10 h-10 text-white drop-shadow-md relative z-10",strokeWidth:2})]})]});function ri(){var f;const{user:e}=Te(),[s,n]=i.useState(""),r=i.useRef(null),[a,o]=i.useState(!1),c=l=>{const h=encodeURIComponent(l),N=`https://teams.microsoft.com/l/chat/0/0?users=${(e==null?void 0:e.email)||"gcoz@farmaplus.com"}&message=${h}`;window.open(N,"_blank"),n("")},d=()=>{s.trim()&&c(s)},u=l=>{c(l)},m=l=>{l.key==="Enter"&&d()};return t.jsxs(P,{className:"h-full flex flex-col border-border/50 bg-gradient-to-br from-card/50 to-muted/20 backdrop-blur-sm overflow-hidden relative group",children:[t.jsx("div",{className:"absolute top-0 right-0 w-full h-full opacity-5 pointer-events-none",style:{background:`radial-gradient(circle at top right, ${te.light}, transparent 70%)`}}),t.jsx(_,{className:"pb-2 flex flex-row items-center justify-between space-y-0 relative z-10",children:t.jsx(q,{className:"text-lg font-medium tracking-tight",children:"Chat Teams"})}),t.jsxs(G,{className:"flex-1 flex flex-col gap-4 relative z-10 p-4",children:[t.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center text-center -mt-4",children:[t.jsx(ni,{}),t.jsxs(W.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"space-y-1 relative z-20 mt-2",children:[t.jsxs("h3",{className:"font-semibold text-lg",children:["Hola ",((f=e==null?void 0:e.name)==null?void 0:f.split(" ")[0])||"Gonzalo"]}),t.jsx("p",{className:"text-muted-foreground text-xs max-w-[200px] mx-auto",children:"En qu puedo ayudarte hoy?"})]})]}),t.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-1",children:si.map((l,h)=>t.jsxs(W.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.8+h*.1},onClick:()=>u(l.message),className:$("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[10px] font-medium border transition-all duration-200 hover:scale-105 active:scale-95 shadow-sm bg-background/50 backdrop-blur-sm",l.color),children:[t.jsx(l.icon,{className:"h-3 w-3"}),l.label]},l.label))}),t.jsx("div",{className:"relative mt-auto",children:t.jsxs("div",{className:"relative flex items-center bg-background/80 backdrop-blur border rounded-full shadow-sm focus-within:ring-2 transition-all group-hover:shadow-md",style:{borderColor:`${te.light}30`},children:[t.jsx(T,{variant:"ghost",size:"icon",className:"h-10 w-10 text-muted-foreground hover:text-primary rounded-full shrink-0 ml-1",onClick:()=>o(!a),title:"Adjuntar Reporte",children:t.jsx(Zr,{className:"h-4 w-4"})}),t.jsx(ce,{ref:r,value:s,onChange:l=>n(l.target.value),onKeyDown:m,placeholder:"Escribe tu mensaje...",className:"border-none shadow-none focus-visible:ring-0 bg-transparent h-10 px-2 text-sm"}),t.jsx(T,{onClick:d,size:"icon",className:"h-9 w-9 rounded-full mr-1 transition-all shrink-0",style:{backgroundColor:s.trim()?te.blue:void 0,opacity:s.trim()?1:.5},disabled:!s.trim(),children:t.jsx(ea,{className:"h-4 w-4 text-white"})})]})})]})]})}const ct={async getEvents(e,s=!1){let n=Pt.from("inventory_events").select("*").order("date",{ascending:!0});!s&&e&&(n=n.eq("branch_name",e));const{data:r,error:a}=await n;return a?(console.error("Error fetching events:",a),[]):r||[]},async addEvent(e){const{data:s,error:n}=await Pt.rpc("manage_inventory_event",{p_action:"CREATE",p_title:e.title,p_branch:e.branch_name,p_sector:e.sector,p_date:e.date});return n?(console.error("Error adding event via RPC:",n),null):s},async deleteEvent(e){const{error:s}=await Pt.rpc("manage_inventory_event",{p_action:"DELETE",p_id:e});return s?(console.error("Error deleting event via RPC:",s),!1):!0}};function ai({onDateClick:e}){const{user:s}=Te(),n=(s==null?void 0:s.role)==="admin",[r,a]=i.useState([]),[o,c]=i.useState(!0);i.useState(!1),i.useEffect(()=>{d()},[s==null?void 0:s.branchName]);const d=async()=>{try{const u=await ct.getEvents(s==null?void 0:s.branchName,n),m=new Date().toISOString().slice(0,10),f=u.filter(l=>l.date>=m).sort((l,h)=>l.date.localeCompare(h.date)).slice(0,5).map(l=>({id:l.id,branch:l.branch_name||l.branchId,sector:l.sector||l.description,date:l.date,formattedDate:new Date(l.date+"T12:00:00").toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}));a(f)}catch(u){console.error("Error loading upcoming inventories:",u)}finally{c(!1)}};return t.jsxs(P,{className:"p-6 h-full flex flex-col relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-sm font-medium text-muted-foreground",children:"Prximos Inventarios"}),t.jsx("div",{className:"flex gap-1"})]}),t.jsx("div",{className:"space-y-4 flex-1",children:o?t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"}),t.jsx("div",{className:"h-12 bg-muted/20 animate-pulse rounded-lg"})]}):r.length===0?t.jsx("div",{className:"h-full flex flex-col items-center justify-center text-center p-4 border rounded-lg border-dashed bg-muted/20",children:t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No hay inventarios prximos"})}):r.map(u=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg cursor-pointer hover:bg-muted transition-colors",onClick:()=>e==null?void 0:e(u.date),children:[t.jsx(on,{className:"w-5 h-5 text-primary mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-foreground",children:[u.branch," - ",u.sector]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-left block",children:u.formattedDate})]})]},u.id))})]})}const Hs=8;function oi({branches:e}){const{selectBranch:s,clearBranchSelection:n,user:r}=Te(),[a,o]=i.useState(""),[c,d]=i.useState(!1),[u,m]=i.useState([]),[f,l]=i.useState(!0),[h,x]=i.useState({key:"progress",direction:"descending"});i.useEffect(()=>{(async()=>{l(!0);try{const S=await Ce.getBranchesSummary();m(S)}catch(S){console.error("Failed to load branch summaries",S)}finally{l(!1)}})()},[]);const N=i.useMemo(()=>u.filter(b=>b.branchName.toLowerCase().includes(a.toLowerCase())),[u,a]),p=i.useMemo(()=>{let b=[...N];return h.key&&b.sort((S,D)=>{const C=S[h.key],I=D[h.key];return C<I?h.direction==="ascending"?-1:1:C>I?h.direction==="ascending"?1:-1:0}),b},[N,h]),v=b=>{let S="ascending";h.key===b&&h.direction==="ascending"&&(S="descending"),x({key:b,direction:S})},j=c?p:p.slice(0,Hs),g=b=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(b),y=b=>{(r==null?void 0:r.branchName)===b?n==null||n():s&&(s(b),window.scrollTo({top:0,behavior:"smooth"}))},w=b=>(r==null?void 0:r.branchName)===b;return t.jsx(W.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full",children:t.jsxs(P,{className:"p-6 overflow-hidden border-t-4 border-t-primary shadow-md",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[t.jsx(Le,{className:"w-6 h-6 text-primary"}),"Monitor de Sucursales"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Estado en tiempo real de inventarios cclicos y cumplimiento."})]}),t.jsxs("div",{className:"relative w-full md:w-72",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(ce,{placeholder:"Buscar sucursal...",value:a,onChange:b=>o(b.target.value),className:"pl-10 h-10 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary"})]})]}),t.jsx("div",{className:"rounded-xl border bg-card/50 overflow-hidden",children:t.jsxs(gr,{children:[t.jsx(vr,{className:"bg-muted/40 hover:bg-muted/50 transition-colors",children:t.jsxs(Bt,{children:[t.jsx(we,{className:"w-[200px] cursor-pointer",onClick:()=>v("branchName"),children:t.jsxs("div",{className:"flex items-center font-semibold text-foreground",children:["Sucursal",t.jsx(Ns,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(we,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>v("deploymentDate"),children:"Fecha Inicio"}),t.jsx(we,{className:"text-center hidden lg:table-cell",children:"Vuelta"}),t.jsx(we,{className:"text-center hidden lg:table-cell",children:"Obj. Mensual"}),t.jsx(we,{className:"text-center cursor-pointer",onClick:()=>v("progress"),children:t.jsxs("div",{className:"flex items-center justify-center font-semibold text-foreground",children:["% Avance",t.jsx(Ns,{className:"ml-2 h-3 w-3 opacity-50"})]})}),t.jsx(we,{className:"text-center hidden md:table-cell",children:"Un. Inventario"}),t.jsx(we,{className:"text-center cursor-pointer hidden md:table-cell",onClick:()=>v("differenceUnits"),children:"Diferencia"}),t.jsx(we,{className:"text-right cursor-pointer",onClick:()=>v("adjustmentsValue"),children:"$ Ajustes"}),t.jsx(we,{className:"text-center w-[120px]",children:"Status"})]})}),t.jsx(br,{children:f?Array.from({length:5}).map((b,S)=>t.jsxs(Bt,{children:[t.jsx(F,{children:t.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),t.jsx(F,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-20 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-10 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{className:"hidden lg:table-cell",children:t.jsx("div",{className:"h-5 w-12 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{className:"hidden md:table-cell",children:t.jsx("div",{className:"h-5 w-16 bg-muted rounded animate-pulse mx-auto"})}),t.jsx(F,{className:"text-right",children:t.jsx("div",{className:"h-5 w-24 bg-muted rounded animate-pulse ml-auto"})}),t.jsx(F,{children:t.jsx("div",{className:"h-6 w-20 bg-muted rounded-full animate-pulse mx-auto"})})]},S)):j.length>0?j.map((b,S)=>t.jsxs(W.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:S*.05},onClick:()=>y(b.branchName),className:$("group cursor-pointer hover:bg-muted/50 transition-all border-b last:border-0",w(b.branchName)&&"bg-primary/5 hover:bg-primary/10 border-l-4 border-l-primary"),children:[t.jsxs(F,{className:"font-medium text-foreground relative",children:[w(b.branchName)&&t.jsx(W.div,{layoutId:"active-indicator",className:"absolute left-0 top-0 bottom-0 w-1 bg-primary"}),b.branchName]}),t.jsx(F,{className:"text-center text-muted-foreground text-sm hidden md:table-cell",children:b.deploymentDate}),t.jsxs(F,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:[b.cyclicRound,""]}),t.jsx(F,{className:"text-center text-muted-foreground text-sm hidden lg:table-cell",children:b.monthlyGoal}),t.jsx(F,{className:"text-center",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:$("font-bold text-sm",b.progress>=b.monthlyGoal?"text-green-600":"text-foreground"),children:[b.progress,"%"]}),t.jsx("div",{className:"w-16 h-1.5 bg-muted rounded-full overflow-hidden mt-1",children:t.jsx("div",{className:$("h-full rounded-full transition-all",b.progress>=100?"bg-green-500":"bg-primary"),style:{width:`${Math.min(b.progress,100)}%`}})})]})}),t.jsx(F,{className:"text-center font-mono text-sm hidden md:table-cell",children:b.inventoryUnits}),t.jsx(F,{className:"text-center font-mono text-sm hidden md:table-cell",children:t.jsxs("span",{className:b.differenceUnits===0?"text-muted-foreground":b.differenceUnits>0?"text-green-600":"text-red-600",children:[b.differenceUnits>0?"+":"",b.differenceUnits]})}),t.jsx(F,{className:"text-right font-mono text-sm",children:t.jsx("span",{className:b.adjustmentsValue===0?"text-muted-foreground":b.adjustmentsValue>0?"text-green-600":"text-red-600",children:g(b.adjustmentsValue)})}),t.jsx(F,{className:"text-center",children:b.status==="controlado"?t.jsxs(ne,{variant:"outline",className:"font-normal border bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30",children:[t.jsx(Yn,{className:"w-3 h-3 mr-1"})," FINALIZADA"]}):b.status==="por_controlar"?t.jsxs(ne,{variant:"outline",className:"font-normal border bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30",children:[t.jsx(dt,{className:"w-3 h-3 mr-1"})," EN PROCESO"]}):t.jsxs(ne,{variant:"outline",className:"font-normal border bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30",children:[t.jsx(It,{className:"w-3 h-3 mr-1"})," PENDIENTE"]})})]},b.branchName)):t.jsx(Bt,{children:t.jsx(F,{colSpan:9,className:"h-24 text-center text-muted-foreground",children:"No se encontraron sucursales con esa bsqueda."})})})]})}),p.length>Hs&&t.jsx("div",{className:"mt-4 flex justify-center",children:t.jsx(T,{variant:"ghost",size:"sm",onClick:()=>d(!c),className:"text-muted-foreground hover:text-foreground",children:c?"Mostrar menos":`Ver todas las sucursales (${p.length})`})})]})})}function ii({completedCount:e,totalCount:s}){const n=s>0?Math.round(e/s*100):0,r=()=>n>=80?"text-success":n>=50?"text-warning":"text-destructive";return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Progreso"}),t.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsxs("div",{className:`text-xl font-bold ${r()}`,children:[n,"%"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e," de ",s," completados"]}),t.jsx(tn,{value:n,className:"mt-2"})]})]})}function li({criticalCount:e,outOfStockCount:s}){const n=e>0||s>0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Crticos"}),t.jsx(Kt,{className:`h-4 w-4 ${n?"text-destructive":"text-muted-foreground"}`})]}),t.jsxs(G,{children:[t.jsx("div",{className:`text-xl font-bold ${n?"text-destructive":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Productos con stock bajo"}),s>0&&t.jsxs(ne,{variant:"destructive",className:"mt-2",children:[s," agotados"]})]})]})}function ci({totalValue:e,changePercentage:s}){const n=s!==void 0&&s>=0;return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium text-muted-foreground",children:"Valor Total"}),t.jsx(rt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsxs("div",{className:"text-xl font-bold",children:["$",t.jsx(sn,{value:e})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Valor de inventario"}),s!==void 0&&t.jsxs("div",{className:`flex items-center gap-1 mt-2 text-xs ${n?"text-success":"text-destructive"}`,children:[n?t.jsx(Le,{className:"h-3 w-3"}):t.jsx(ss,{className:"h-3 w-3"}),t.jsxs("span",{children:[Math.abs(s).toFixed(1),"% vs mes anterior"]})]})]})]})}function di({activeCount:e,activeBranches:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Activos"}),t.jsxs("div",{className:"relative",children:[t.jsx(cn,{className:"h-4 w-4 text-muted-foreground"}),e>0&&t.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 bg-success rounded-full animate-pulse"})]})]}),t.jsxs(G,{children:[t.jsx("div",{className:"text-xl font-bold",children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usuarios trabajando"}),s.length>0&&t.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[s.slice(0,2).map((n,r)=>t.jsx(ne,{variant:"secondary",className:"text-xs",children:n},r)),s.length>2&&t.jsxs(ne,{variant:"secondary",className:"text-xs",children:["+",s.length-2]})]})]})]})}function ui({pendingCount:e,urgentCount:s}){return t.jsxs(P,{className:"h-full flex flex-col justify-between",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Pendientes"}),t.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(G,{children:[t.jsx("div",{className:`text-xl font-bold ${e>0?"text-warning":"text-foreground"}`,children:e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Inventarios sin completar"}),s>0&&t.jsxs(ne,{variant:"destructive",className:"mt-2",children:[s," urgentes"]})]})]})}function mi({data:e=[]}){const[s,n]=i.useState("7d"),r=[{date:"01/12",negative:-1200,positive:800},{date:"02/12",negative:-950,positive:1100},{date:"03/12",negative:-1500,positive:900},{date:"04/12",negative:-800,positive:1300},{date:"05/12",negative:-1100,positive:950},{date:"06/12",negative:-900,positive:1200},{date:"07/12",negative:-1300,positive:1e3}],a=e.length>0?e:r;return t.jsxs(P,{className:"h-full",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Tendencias"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(T,{variant:s==="7d"?"default":"outline",size:"sm",onClick:()=>n("7d"),children:"7 das"}),t.jsx(T,{variant:s==="30d"?"default":"outline",size:"sm",onClick:()=>n("30d"),children:"30 das"})]})]}),t.jsx(G,{children:t.jsx(nn,{width:"100%",height:200,children:t.jsxs(yr,{data:a,children:[t.jsx(jr,{strokeDasharray:"3 3"}),t.jsx(wr,{dataKey:"date",fontSize:12}),t.jsx(Nr,{fontSize:12}),t.jsx(rn,{}),t.jsx(Cr,{}),t.jsx(Cs,{type:"monotone",dataKey:"negative",stroke:"hsl(var(--destructive))",name:"Negativo",strokeWidth:2}),t.jsx(Cs,{type:"monotone",dataKey:"positive",stroke:"hsl(var(--success))",name:"Positivo",strokeWidth:2})]})})})]})}function fi({products:e=[]}){const s=[{name:"Ibuprofeno 600mg",ean:"7798140250685",difference:-45,value:-2250,type:"negative"},{name:"Paracetamol 500mg",ean:"7798140250692",difference:32,value:1600,type:"positive"},{name:"Amoxicilina 500mg",ean:"7798140250708",difference:-28,value:-1680,type:"negative"},{name:"Omeprazol 20mg",ean:"7798140250715",difference:25,value:1500,type:"positive"},{name:"Losartn 50mg",ean:"7798140250722",difference:-20,value:-1200,type:"negative"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs(_,{className:"pb-3",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Top Diferencias"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos con mayores discrepancias"})]}),t.jsx(G,{children:t.jsx("div",{className:"space-y-3",children:n.map((r,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-sm font-medium",children:r.name}),t.jsx(ne,{variant:r.type==="negative"?"destructive":"default",className:"text-xs",children:r.type==="negative"?"Faltante":"Sobrante"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["EAN: ",r.ean]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:`flex items-center gap-1 ${r.type==="negative"?"text-destructive":"text-success"}`,children:[r.type==="negative"?t.jsx(ss,{className:"h-3 w-3"}):t.jsx(Le,{className:"h-3 w-3"}),t.jsx("span",{className:"text-sm font-semibold",children:Math.abs(r.difference)})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Math.abs(r.value)]})]}),t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",children:t.jsx(Ir,{className:"h-4 w-4"})})]})]},a))})})]})}function hi({activities:e=[]}){const s=[{id:"1",type:"completed",title:"Inventario Farmacia completado",branch:"Belgrano IV",timestamp:"Hace 5 minutos",user:"Juan Prez"},{id:"2",type:"adjusted",title:"Ajustes realizados en Perfumera",branch:"Recoleta",timestamp:"Hace 15 minutos",user:"Mara Gonzlez"},{id:"3",type:"imported",title:"Inventario importado",branch:"Palermo II",timestamp:"Hace 1 hora",user:"Carlos Rodrguez"},{id:"4",type:"completed",title:"Pre-conteo finalizado",branch:"Microcentro",timestamp:"Hace 2 horas",user:"Ana Martnez"}],n=e.length>0?e:s,r=o=>{switch(o){case"completed":return t.jsx(nt,{className:"h-4 w-4 text-success"});case"adjusted":return t.jsx(ta,{className:"h-4 w-4 text-warning"});case"imported":return t.jsx(Zs,{className:"h-4 w-4 text-primary"})}},a=o=>{switch(o){case"completed":return"Completado";case"adjusted":return"Ajustado";case"imported":return"Importado"}};return t.jsxs(P,{className:"h-full",children:[t.jsxs(_,{className:"pb-3",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Actividad Reciente"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"ltimas acciones realizadas"})]}),t.jsx(G,{children:t.jsx("div",{className:"space-y-4",children:n.map((o,c)=>t.jsxs("div",{className:"relative",children:[c<n.length-1&&t.jsx("div",{className:"absolute left-2 top-8 bottom-0 w-px bg-border"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"relative z-10 mt-1 rounded-full bg-background p-1 border",children:r(o.type)}),t.jsxs("div",{className:"flex-1 pb-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:o.title}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.branch,"  ",o.user]})]}),t.jsx(ne,{variant:"secondary",className:"text-xs",children:a(o.type)})]}),t.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[t.jsx(dt,{className:"h-3 w-3"}),t.jsx("span",{children:o.timestamp})]})]})]})]},o.id))})})]})}const Ne=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"];function xi({data:e=[]}){const s=[{name:"Farmacia",value:450,color:Ne[0]},{name:"Perfumera",value:280,color:Ne[1]},{name:"Higiene",value:180,color:Ne[2]},{name:"Bebs",value:120,color:Ne[3]},{name:"Otros",value:90,color:Ne[4]}],n=e.length>0?e:s,r=n.reduce((a,o)=>a+o.value,0);return t.jsxs(P,{className:"h-full",children:[t.jsxs(_,{className:"pb-3",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Distribucin por Categora"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos por categora"})]}),t.jsxs(G,{children:[t.jsx(nn,{width:"100%",height:200,children:t.jsxs(Sr,{children:[t.jsx(kr,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:o})=>`${a} ${(o*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((a,o)=>t.jsx(Dr,{fill:a.color||Ne[o%Ne.length]},`cell-${o}`))}),t.jsx(rn,{})]})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2",children:n.map((a,o)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color||Ne[o%Ne.length]}}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.name,": ",a.value," (",(a.value/r*100).toFixed(1),"%)"]})]},o))})]})]})}function pi({goals:e=[]}){const s=[{title:"Inventarios Completados",current:45,target:60,badge:"75%"},{title:"Productos Controlados",current:1250,target:1500,badge:"83%"},{title:"Diferencias Resueltas",current:28,target:35,badge:"80%"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsx(_,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(q,{className:"text-lg font-semibold",children:"Objetivos del Mes"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Progreso hacia metas"})]}),t.jsx(Qs,{className:"h-5 w-5 text-primary"})]})}),t.jsx(G,{children:t.jsx("div",{className:"space-y-4",children:n.map((r,a)=>{const o=Math.round(r.current/r.target*100),c=o>=100;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium",children:r.title}),c&&t.jsx(Wr,{className:"h-4 w-4 text-success"})]}),t.jsxs(ne,{variant:c?"default":"secondary",children:[r.current,"/",r.target]})]}),t.jsx(tn,{value:o,className:"h-2"}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[o,"% completado"]})]},a)})})})]})}function gi({isOnline:e=!0,pendingCount:s=0,lastSync:n="Hace 5 minutos",onSync:r}){return t.jsxs(P,{className:"h-full",children:[t.jsx(_,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Sincronizacin"}),e?t.jsx(en,{className:"h-5 w-5 text-success"}):t.jsx(Xn,{className:"h-5 w-5 text-destructive"})]})}),t.jsxs(G,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Estado de Conexin"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e?"Conectado":"Sin conexin"})]}),t.jsx(ne,{variant:e?"default":"destructive",children:e?"Online":"Offline"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Datos Pendientes"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s>0?`${s} elementos`:"Todo sincronizado"})]}),s>0?t.jsx(ne,{variant:"warning",children:s}):t.jsx(nt,{className:"h-5 w-5 text-success"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(dt,{className:"h-3 w-3"}),t.jsxs("span",{children:["ltima sincronizacin: ",n]})]}),t.jsxs(T,{className:"w-full",variant:s>0?"default":"outline",onClick:r,disabled:!e,children:[t.jsx(Kn,{className:"h-4 w-4 mr-2"}),s>0?"Sincronizar Ahora":"Actualizar"]})]})]})}function vi({actions:e=[]}){const s=[{title:"Nuevo Pre-Conteo",description:"Iniciar nuevo pre-conteo",icon:ut,onClick:()=>console.log("Nuevo Pre-Conteo"),variant:"default"},{title:"Importar Inventario",description:"Cargar desde Excel",icon:Zs,onClick:()=>console.log("Importar"),variant:"outline"},{title:"Ver Reportes",description:"Anlisis y estadsticas",icon:Dt,onClick:()=>console.log("Reportes"),variant:"outline"},{title:"Exportar Datos",description:"Descargar informacin",icon:Zn,onClick:()=>console.log("Exportar"),variant:"outline"},{title:"Configuracin",description:"Ajustes del sistema",icon:Jn,onClick:()=>console.log("Configuracin"),variant:"secondary"}],n=e.length>0?e:s;return t.jsxs(P,{className:"h-full",children:[t.jsxs(_,{className:"pb-3",children:[t.jsx(q,{className:"text-lg font-semibold",children:"Acciones Rpidas"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Tareas frecuentes"})]}),t.jsx(G,{children:t.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.map((r,a)=>{const o=r.icon;return t.jsxs(T,{variant:r.variant||"outline",className:"h-auto flex-col items-start p-4 gap-2",onClick:r.onClick,children:[t.jsx(o,{className:"h-5 w-5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"text-sm font-medium",children:r.title}),t.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:r.description})]})]},a)})})})]})}function bi({assignedDays:e=0,startDate:s,totalProgress:n=0,isEditable:r=!1,onEdit:a}){const o=i.useMemo(()=>{if(!s||e===0)return{daysRemaining:0,daysElapsed:0,timeProgress:0,status:"pending",expectedProgress:0,isDelayed:!1,segments:[0,0,0]};const m=new Date(s),l=new Date().getTime()-m.getTime(),h=Math.max(0,Math.floor(l/(1e3*60*60*24))),x=Math.max(0,e-h),N=Math.min(100,h/e*100),p=Math.round(N),v=n<p-5,j=n>p+15;let g="on-track";v?g="behind":j&&(g="ahead");const y=3,w=100/y,b=Array.from({length:y}).map((S,D)=>{const C=(D+1)*w;return n>=C?100:n<=D*w?0:(n-D*w)/w*100});return{daysRemaining:x,daysElapsed:h,timeProgress:N,status:g,expectedProgress:p,isDelayed:v,segments:b}},[s,e,n]),c=()=>e===0?"text-muted-foreground":o.status==="behind"?"text-destructive":o.status==="ahead"?"text-blue-500":"text-green-500",d=()=>e===0?"Sin configurar":o.status==="behind"?"Retrasado":o.status==="ahead"?"Adelantado":"Al da",u=()=>e===0?t.jsx(na,{className:"h-4 w-4"}):o.status==="behind"?t.jsx(It,{className:"h-4 w-4"}):o.status==="ahead"?t.jsx(nt,{className:"h-4 w-4"}):t.jsx(nt,{className:"h-4 w-4"});return t.jsxs(P,{className:"h-full flex flex-col overflow-hidden relative group/card border-border/50 bg-card/50 backdrop-blur-sm",children:[t.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 px-5 pt-4 pb-2",children:[t.jsx(q,{className:"text-sm font-semibold tracking-tight",children:"Plazo de Inventario"}),t.jsxs("div",{className:"flex items-center gap-2",children:[r&&t.jsx("button",{onPointerDown:m=>m.stopPropagation(),onClick:m=>{m.stopPropagation(),a==null||a()},className:"relative z-50 text-muted-foreground hover:text-primary transition-colors opacity-0 group-hover/card:opacity-100 cursor-pointer",title:"Configurar plazo",children:t.jsx(wt,{className:"h-4 w-4"})}),!r&&t.jsx(wt,{className:"h-4 w-4 text-muted-foreground"})]})]}),t.jsxs(G,{className:"flex flex-col justify-between flex-1 px-5 pb-5 pt-1 gap-4",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-widest mb-0.5",children:"Asignados"}),t.jsx("span",{className:"text-3xl font-black tracking-tighter text-foreground leading-none",children:e>0?e:"--"})]}),t.jsx("div",{className:"h-10 w-px bg-border/40 mx-2"}),t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsx("span",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-widest mb-0.5",children:"Restantes"}),t.jsx("span",{className:$("text-3xl font-black tracking-tighter leading-none",o.daysRemaining<7&&e>0?"text-destructive":"text-foreground"),children:e>0?o.daysRemaining:"--"})]})]}),t.jsxs("div",{className:"bg-muted/30 rounded-xl p-3 border border-border/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"flex items-center gap-1.5",children:t.jsxs("span",{className:$("flex items-center gap-1 text-[10px] font-bold uppercase tracking-wider",c()),children:[u(),d()]})}),t.jsxs("span",{className:"text-xs font-bold",children:[n,"% ",t.jsx("span",{className:"text-[10px] font-normal text-muted-foreground ml-1",children:"real"})]})]}),t.jsxs("div",{className:"h-1.5 w-full bg-muted/50 rounded-full overflow-hidden relative",children:[t.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-foreground/20 z-10",style:{left:`${o.expectedProgress}%`}}),t.jsx("div",{className:$("h-full transition-all duration-700 rounded-full",o.status==="behind"?"bg-destructive":"bg-primary"),style:{width:`${n}%`}})]}),t.jsxs("div",{className:"flex justify-between mt-1 text-[9px] text-muted-foreground font-medium uppercase tracking-tighter",children:[t.jsx("span",{children:"Inicio"}),t.jsx("span",{style:{marginLeft:`${o.expectedProgress-5}%`},children:"Objetivo Hoy"}),t.jsx("span",{children:"Meta"})]})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider block",children:"Avance por Periodos"}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:o.segments.map((m,f)=>t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"h-1 w-full bg-muted/50 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-foreground/40 transition-all duration-1000",style:{width:`${m}%`}})}),t.jsxs("div",{className:"text-[9px] text-center font-bold text-muted-foreground/70",children:["M",f+1,": ",Math.round(m),"%"]})]},f))})]})]})]})}function yi(){const{user:e}=Te(),[s,n]=i.useState([]),[r,a]=i.useState(!0),[o,c]=i.useState(null);i.useEffect(()=>{(async()=>{if(!(e!=null&&e.branchSheet)){a(!1);return}try{const m=await tr(e.branchSheet),f=await Ce.getAllCyclicInventories(e.branchSheet)||[],l=new Map(f.map(g=>[g.labName,g.status])),h=await Ce.getBranchConfig(e.branchSheet);let x=0;if(h.startDate){const g=new Date(h.startDate),w=Math.abs(new Date().getTime()-g.getTime());x=Math.ceil(w/864e5)}const N=async(g,y,w)=>{if(x>=y){const b=await Ce.getCycleClosures(e.branchSheet,g);if(!(Object.keys(b).length>0)){console.log(`Auto-closing Period ${g} (Day ${y} reached)`);const D=Object.entries(w).map(([C,I])=>({name:C,percentage:I.total>0?Math.round(I.controlled/I.total*100):0}));return await Ce.saveCycleClosure(e.branchSheet,g,D),Se.success(`Cierre automtico del Periodo ${g} completado.`),!0}}return!1},p={Medicamentos:{total:0,controlled:0},Perfumera:{total:0,controlled:0},Accesorios:{total:0,controlled:0},Varios:{total:0,controlled:0}};m.forEach(g=>{let y="Varios";const w=(g.category||"").toUpperCase();w==="MEDICAMENTOS"?y="Medicamentos":w==="PERFUMERIA"?y="Perfumera":w==="ACCESORIOS"&&(y="Accesorios");const S=l.get(g.name)==="controlado";p[y].total+=1,S&&(p[y].controlled+=1)}),await N(1,30,p),await N(2,60,p);const v=await Ce.getCycleClosures(e.branchSheet||"",1),j=Object.entries(p).map(([g,y])=>{const w=y.total>0?Math.round(y.controlled/y.total*100):0,b=v[g.toUpperCase()]||0;return{name:g,totalItems:y.total,controlledItems:y.controlled,percentage:w,previousPercentage:Math.min(b,w)}});n(j)}catch(m){console.error("Error loading category progress:",m)}finally{a(!1)}})()},[e]);const d=i.useMemo(()=>{if(o)return s.find(l=>l.name===o)||null;const u=s.reduce((l,h)=>l+h.totalItems,0),m=s.reduce((l,h)=>l+h.controlledItems,0);return{name:"Avance Global",percentage:u>0?Math.round(m/u*100):0,totalItems:u,controlledItems:m}},[s,o]);return r?t.jsx(P,{className:"h-full border-none shadow-none flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t.jsxs(P,{className:"h-full flex flex-col border-border/50 bg-card/50 backdrop-blur-sm overflow-hidden",children:[t.jsxs(_,{className:"pb-0 pt-4 px-5 flex flex-row items-center justify-between space-y-0 text-foreground",children:[t.jsx(q,{className:"text-xl font-medium tracking-tight",children:o?`Rubro: ${o}`:"Progreso de Inventario"}),t.jsx("div",{className:"flex items-center gap-1",children:t.jsx("button",{onClick:()=>c(null),className:"h-8 w-8 rounded-full bg-muted/50 flex items-center justify-center hover:bg-muted transition-colors",title:"Ver Avance Global",children:t.jsx(Qn,{className:$("h-4 w-4 transition-transform",!o&&"rotate-180")})})})]}),t.jsxs(G,{className:"flex-1 p-5 pt-4 flex flex-col gap-6",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"flex items-baseline gap-2",children:t.jsx(ts,{mode:"wait",children:t.jsxs(W.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-6xl font-bold tracking-tighter",children:[d==null?void 0:d.percentage,"%"]},d==null?void 0:d.percentage)})}),t.jsx("p",{className:"text-sm text-muted-foreground font-medium mt-1",children:o?`Avance en ${o}`:"Avance total acumulado"})]}),t.jsx("div",{className:"flex-1 flex flex-col justify-end",children:t.jsx("div",{className:"flex items-end justify-between gap-3 h-48 mb-2 px-1",children:s.map(u=>{const m=o===u.name,f=u.previousPercentage>0,l=Math.max(...s.map(x=>x.totalItems)),h=l>0?Math.max(20,u.totalItems/l*100):20;return t.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group cursor-pointer h-full justify-end",onClick:()=>c(o===u.name?null:u.name),children:[t.jsx("span",{className:$("text-[10px] font-bold transition-colors mb-1",m?"text-primary":"text-muted-foreground/70"),children:u.totalItems}),t.jsxs(W.div,{className:$("w-full rounded-2xl overflow-hidden flex flex-col justify-end relative transition-all duration-300 bg-secondary dark:bg-muted/20",m?"ring-2 ring-primary ring-offset-2 ring-offset-background":"hover:bg-secondary/80 dark:hover:bg-muted/30"),initial:{height:0},animate:{height:`${h}%`},transition:{type:"spring",stiffness:300,damping:30},children:[t.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-foreground text-background text-[10px] font-bold px-2 py-1 rounded-md opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20 shadow-lg pointer-events-none",children:[u.percentage,"% (",u.controlledItems,"/",u.totalItems,")"]}),t.jsx(W.div,{className:$("w-full absolute bottom-0 left-0 right-0 z-10 transition-colors duration-300",m?"bg-primary":"bg-muted-foreground/40 group-hover:bg-muted-foreground/50"),initial:{height:0},animate:{height:`${u.percentage}%`},transition:{duration:.5,delay:.1}}),f&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-20 opacity-30 pointer-events-none",style:{height:`${u.previousPercentage}%`,backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 4px, currentColor 4px, currentColor 8px)",color:m?"white":"inherit"}}),u.percentage>0&&t.jsx(W.div,{className:"absolute left-1/2 -translate-x-1/2 w-1.5 h-1.5 bg-white rounded-full z-30 shadow-sm",style:{bottom:`calc(${u.percentage}% - 3px)`}})]}),t.jsx("span",{className:$("text-[10px] font-bold uppercase tracking-wider transition-colors",m?"text-foreground":"text-muted-foreground"),children:u.name.substring(0,3)})]},u.name)})})}),t.jsxs("div",{className:"pt-2 border-t border-border/40 flex justify-between items-center h-10",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-widest leading-none",children:"Hechos"}),t.jsx("span",{className:"text-sm font-bold",children:d==null?void 0:d.controlledItems})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-widest leading-none",children:"Pendientes"}),t.jsx("span",{className:"text-sm font-bold",children:((d==null?void 0:d.totalItems)||0)-((d==null?void 0:d.controlledItems)||0)})]})]}),t.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-muted-foreground bg-muted/30 px-2 py-1 rounded-full border border-border/50",children:[t.jsx(er,{className:"h-3 w-3"}),"Refresca cada 30 min"]})]})]})]})}function Rn({events:e=[],selected:s,onSelect:n}){const[r,a]=J.useState(s||new Date);J.useEffect(()=>{s&&a(s)},[s]);const o=Er(r),c=Mr(o),d=Ar(o,{locale:gt,weekStartsOn:1}),u=Rr(c,{locale:gt,weekStartsOn:1}),m=[];let f=d;for(;f<=u;){const v=[];for(let j=0;j<7;j++)v.push(f),f=Tr(f,1);m.push(v)}const l=J.useMemo(()=>{const v=new Map;return e.forEach(j=>{const g=j.date;v.has(g)||v.set(g,[]),v.get(g).push(j)}),v},[e]),h=new Date,x=()=>a(v=>Br(v,1)),N=()=>a(v=>Ur(v,1)),p="h-10 w-10";return t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between px-2 pb-2",children:[t.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-muted/50",children:t.jsx($r,{className:"h-5 w-5 text-muted-foreground"})}),t.jsx("div",{className:"text-sm font-semibold",children:Ss(o,"LLLL yyyy",{locale:gt})}),t.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-muted/50",children:t.jsx(sr,{className:"h-5 w-5 text-muted-foreground"})})]}),t.jsx("div",{className:"grid grid-cols-7 gap-1 px-1 text-xs text-muted-foreground mb-1",children:["LU","MA","MI","JU","VI","SA","DO"].map((v,j)=>t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"h-10 w-10 flex items-center justify-center font-medium uppercase",children:v})},j))}),t.jsx("div",{className:"space-y-1",children:m.map((v,j)=>t.jsx("div",{className:"grid grid-cols-7 gap-1",children:v.map(g=>{const y=g.toISOString().slice(0,10),w=zr(g,o),b=l.get(y)||[],S=b.length>0,D=s?Or(g,s):!1,C=b.some(A=>{const B=Pr(A.date),V=Lr(B,h);return V>=2&&V<=5}),I=D?"bg-primary text-primary-foreground":C?"hover:bg-primary/10 ring-2 ring-accent":"hover:bg-primary/10",R=t.jsx("button",{onClick:()=>n&&n(g),className:`flex items-center justify-center ${p} rounded-full transition-colors focus:outline-none ${w?"text-foreground":"text-muted-foreground"} ${I}`,children:t.jsxs("div",{className:"relative flex items-center justify-center w-full h-full",children:[t.jsx("span",{className:"text-sm font-medium",children:Ss(g,"d",{locale:gt})}),S&&t.jsx("span",{className:"absolute bottom-1.5 h-1.5 w-1.5 rounded-full bg-blue-500"})]})},y);if(S){const A=t.jsxs("div",{className:"space-y-1",children:[b.slice(0,5).map(B=>t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-medium",children:B.title}),t.jsxs("div",{className:"text-muted-foreground",children:[B.branch,"  ",B.sector]})]},B.id)),b.length>5&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",b.length-5," ms"]})]});return t.jsxs(nr,{children:[t.jsx(rr,{asChild:!0,children:R}),t.jsx(ar,{side:"top",children:A})]},y)}return R})},j))})]})}function ji(){const{user:e}=Te(),[s,n]=i.useState(new Date),[r,a]=i.useState([]),[o,c]=i.useState(!1),[d,u]=i.useState(""),[m,f]=i.useState(""),[l,h]=i.useState(""),[x,N]=i.useState(new Date().toISOString().slice(0,10));i.useEffect(()=>{p()},[e==null?void 0:e.branchName]);const p=async()=>{try{const y=(await ct.getEvents()).map(w=>({id:w.id,title:w.title,branch:w.branch_name||w.branchId||"General",sector:w.sector||w.description||"",date:w.date.split("T")[0]}));a(y)}catch(g){console.error("Error loading events:",g)}},v=async()=>{if(!d||!m||!l||!x){Se.error("Error","Por favor completa todos los campos");return}try{await ct.addEvent({title:d,branch_name:m,sector:l,date:x}),Se.success("Operacin exitosa","Evento agregado"),c(!1),u(""),f(""),h(""),N(new Date().toISOString().slice(0,10)),p()}catch{Se.error("Error","Error al crear evento")}},j=g=>{const y=g.toISOString().split("T")[0];return r.filter(w=>w.date===y)};return t.jsxs(P,{className:"h-full flex flex-col",children:[t.jsx(_,{className:"pb-2",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(wt,{className:"w-5 h-5 text-primary"}),t.jsx(q,{children:"Calendario"})]})})}),t.jsx(G,{className:"flex-1 p-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-full",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Rn,{selected:s,onSelect:n,events:r})}),t.jsxs("div",{className:"w-full md:w-80 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-semibold capitalize",children:s.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),t.jsx(T,{size:"sm",variant:o?"ghost":"outline",onClick:()=>c(!o),children:o?"Cancelar":t.jsxs(t.Fragment,{children:[t.jsx(ut,{className:"w-4 h-4 mr-1"})," Evento"]})})]}),o?t.jsxs("div",{className:"p-3 bg-muted/50 border rounded-md space-y-3 mb-4 animate-in slide-in-from-top-2",children:[t.jsx(ce,{placeholder:"Ttulo",value:d,onChange:g=>u(g.target.value),className:"bg-background h-8"}),t.jsx(ce,{placeholder:"Sucursal",value:m,onChange:g=>f(g.target.value),className:"bg-background h-8"}),t.jsx(ce,{placeholder:"Sector",value:l,onChange:g=>h(g.target.value),className:"bg-background h-8"}),t.jsx(ce,{type:"date",value:x,onChange:g=>N(g.target.value),className:"bg-background h-8"}),t.jsx(T,{size:"sm",className:"w-full",onClick:v,children:"Guardar Evento"})]}):t.jsx("div",{className:"flex-1 overflow-auto space-y-2 pr-1",children:j(s).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground text-sm border-2 border-dashed rounded-lg",children:"No hay eventos"}):j(s).map(g=>t.jsxs("div",{className:"p-3 bg-muted/50 hover:bg-muted border rounded-md transition-colors text-sm",children:[t.jsx("p",{className:"font-medium text-foreground",children:g.title}),t.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[t.jsx("span",{children:g.branch}),t.jsx("span",{children:g.sector})]})]},g.id))})]})]})})]})}function wi(e){const[s,n]=i.useState(!1);return i.useEffect(()=>{function r(o){n(o.matches)}const a=matchMedia(e);return a.addEventListener("change",r),n(a.matches),()=>a.removeEventListener("change",r)},[e]),s}function Ni({open:e,onOpenChange:s,initialDate:n}){const r=wi("(min-width: 768px)"),{user:a}=Te(),o=(a==null?void 0:a.role)==="admin",[c,d]=i.useState(n||new Date),[u,m]=i.useState([]),[f,l]=i.useState(!1),[h,x]=i.useState(""),[N,p]=i.useState(""),[v,j]=i.useState(""),[g,y]=i.useState(new Date().toISOString().slice(0,10));i.useEffect(()=>{e&&(w(),n&&(d(n),y(n.toISOString().slice(0,10))))},[e,n,a==null?void 0:a.branchName]);const w=async()=>{try{const C=await ct.getEvents(a==null?void 0:a.branchName,o);m(C)}catch(C){console.error("Error loading events",C)}},b=async()=>{if(!h||!N||!v||!g){Se.error("Error","Completa todos los campos");return}try{const C=await ct.addEvent({title:h,branch_name:N,sector:v,date:g});C&&(Se.success("Operacin exitosa","Evento creado"),m(I=>[...I,C]),l(!1),x(""),p(""),j(""))}catch{Se.error("Error","Error al crear evento")}},S=C=>{const I=C.toISOString().slice(0,10);return u.filter(R=>R.date===I)},D=()=>t.jsxs("div",{className:`flex ${r?"flex-row gap-6":"flex-col gap-4"} mt-4 h-full`,children:[t.jsx("div",{className:r?"w-1/2":"w-full",children:t.jsx(Rn,{events:u.map(C=>({...C,branch:C.branch_name})),selected:c,onSelect:C=>{C&&(d(C),y(C.toISOString().slice(0,10)))}})}),t.jsxs("div",{className:r?"w-1/2 flex flex-col":"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-medium capitalize",children:c.toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"})}),o&&t.jsxs(T,{size:"sm",onClick:()=>l(!f),variant:f?"ghost":"default",children:[f?t.jsx(_s,{className:"w-4 h-4"}):t.jsx(ut,{className:"w-4 h-4 mr-2"}),f?"Cancelar":"Evento"]})]}),f?t.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/40 animate-in slide-in-from-top-2",children:[t.jsx("h4",{className:"font-medium text-sm",children:"Nuevo Evento"}),t.jsx(ce,{placeholder:"Ttulo",value:h,onChange:C=>x(C.target.value)}),t.jsx(ce,{placeholder:"Sucursal",value:N,onChange:C=>p(C.target.value)}),t.jsx(ce,{placeholder:"Sector",value:v,onChange:C=>j(C.target.value)}),t.jsx(ce,{type:"date",value:g,onChange:C=>y(C.target.value)}),t.jsx(T,{className:"w-full",onClick:b,children:"Guardar"})]}):t.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 max-h-[500px]",children:S(c).length===0?t.jsx("div",{className:"flex flex-col items-center justify-center py-10 text-muted-foreground border-2 border-dashed rounded-lg",children:t.jsx("p",{children:"No hay eventos para este da"})}):S(c).map(C=>t.jsx("div",{className:"p-3 bg-card border rounded-lg shadow-sm",children:t.jsx("div",{className:"flex justify-between items-start",children:t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-foreground",children:C.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[C.branch_name," - ",C.sector]})]})})},C.id))})]})]});return r?t.jsx(Zt,{open:e,onOpenChange:s,children:t.jsxs(Jt,{className:"max-w-4xl w-[90vw] h-[80vh] flex flex-col",children:[t.jsx(Qt,{children:t.jsx(es,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"flex-1 overflow-hidden",children:t.jsx(D,{})})]})}):t.jsx(qs,{open:e,onOpenChange:s,children:t.jsxs(Gs,{className:"h-[90vh]",children:[t.jsx(Ys,{children:t.jsx(Xs,{children:"Calendario de Inventarios"})}),t.jsx("div",{className:"px-4 pb-8 h-full overflow-y-auto",children:t.jsx(D,{})})]})})}const Ci={admin:["VIEW_ADMIN_DASHBOARD","MANAGE_INVENTORY_CONFIG","VIEW_BRANCH_MONITOR","EDIT_SETTINGS","IMPERSONATE_BRANCH"],branch:[]};function Ht(e,s){return e?(Ci[e.role]||[]).includes(s):!1}const Tn=[{id:"executive",name:"Ejecutivo",description:"Vista enfocada en mtricas financieras y tendencias",icon:Le,widgetIds:["metrics-carousel","total-stock-value","trends-chart","category-distribution","monthly-goals","branches-table"]},{id:"operational",name:"Operativo",description:"Vista para operaciones diarias e inventarios",icon:rs,widgetIds:["metrics-carousel","active-products","countdown","inventory-alerts","upcoming-inventories","pending-inventories","quick-actions","category-progress"]},{id:"analytical",name:"Analtico",description:"Vista con grficos y anlisis detallados",icon:Dt,widgetIds:["metrics-carousel","trends-chart","category-distribution","top-products","category-progress","inventory-progress","critical-products"]},{id:"complete",name:"Completo",description:"Todos los widgets disponibles",icon:ln,widgetIds:["metrics-carousel","active-products","countdown","inventory-summary","inventory-alerts","upcoming-inventories","branches-table","inventory-progress","critical-products","total-stock-value","active-users","pending-inventories","trends-chart","top-products","activity-timeline","category-distribution","monthly-goals","sync-status","quick-actions","category-progress"]}];function Si({open:e,onOpenChange:s,onApplyPreset:n}){const r=a=>{n(a),s(!1)};return t.jsx(Zt,{open:e,onOpenChange:s,children:t.jsxs(Jt,{className:"max-w-3xl",children:[t.jsxs(Qt,{children:[t.jsx(es,{children:"Layouts Predefinidos"}),t.jsx(Js,{children:"Selecciona un layout predefinido para configurar tu dashboard rpidamente"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:Tn.map(a=>{const o=a.icon;return t.jsxs(P,{className:$("p-4 cursor-pointer transition-all hover:border-primary hover:shadow-md","flex flex-col gap-3"),onClick:()=>r(a.id),children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(o,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-base",children:a.name}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.description})]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(an,{className:"h-3 w-3"}),t.jsxs("span",{children:[a.widgetIds.length," widgets incluidos"]})]}),t.jsx(T,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:c=>{c.stopPropagation(),r(a.id)},children:"Aplicar Layout"})]},a.id)})}),t.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t",children:t.jsx(T,{variant:"outline",onClick:()=>s(!1),children:"Cancelar"})})]})})}const ki=[{name:"Belgrano IV",address:"Av. Cabildo 2040",zonal:"Zona Norte",email:"belgrano4@farmaplus.com"},{name:"Recoleta",address:"Av. Santa Fe 1860",zonal:"Zona Centro",email:"recoleta@farmaplus.com"},{name:"Palermo II",address:"Av. Las Heras 3520",zonal:"Zona Norte",email:"palermo2@farmaplus.com"},{name:"Microcentro",address:"Florida 520",zonal:"Zona Centro",email:"microcentro@farmaplus.com"},{name:"Belgrano III",address:"Av. Cabildo 1520",zonal:"Zona Norte",email:"belgrano3@farmaplus.com"},{name:"Villa Urquiza II",address:"Av. Triunvirato 4280",zonal:"Zona Norte",email:"villaurquiza2@farmaplus.com"}],Di={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},Ii={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function rl(){const{user:e}=Te(),{visibleWidgets:s,hiddenWidgets:n,isEditMode:r,setIsEditMode:a,reorderWidgets:o,toggleWidgetVisibility:c,updateWidgetSize:d,applyPreset:u,resetLayout:m}=_o(e==null?void 0:e.branchName),[f,l]=i.useState(!1),[h,x]=i.useState(!1),N=ba(Es(ms,{activationConstraint:{distance:8}}),Es(ds,{coordinateGetter:Fo})),p=i.useMemo(()=>s.filter(k=>k.type==="branches-table"?Ht(e,"VIEW_BRANCH_MONITOR"):!0),[s,e]),v=k=>{const{active:z,over:L}=k;L&&z.id!==L.id&&o(z.id,L.id)},[j,g]=i.useState({totalStock:0,activeProducts:0,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0}),[y,w]=i.useState(0),[b,S]=i.useState(null),[D,C]=i.useState(0),[I,R]=i.useState(!1),[A,B]=i.useState(""),[V,se]=i.useState(90),[me,ze]=i.useState(new Date().toISOString().split("T")[0]),[K,Oe]=i.useState(0),[fe,ke]=i.useState(!1),[Be,Q]=i.useState(void 0),he=k=>{const z=k?new Date(k):new Date;z.setHours(12,0,0,0),Q(z),ke(!0)};i.useEffect(()=>{(async()=>{if(e!=null&&e.branchName){const z=await Ce.getBranchConfig(e.branchName);w(z.days),S(z.startDate)}})()},[e]),i.useEffect(()=>{(async()=>{let z=0;try{z=await or()}catch(L){console.error("Error fetching product count:",L)}if(!(e!=null&&e.branchSheet)){g({totalStock:0,activeProducts:z,negativeStock:0,positiveStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0});return}try{const L=await Ce.getAllCyclicInventories(e.branchSheet),U=L.reduce((ae,Y)=>({negativeStock:ae.negativeStock+Y.negativeValue,positiveStock:ae.positiveStock+Y.positiveValue,totalStock:ae.totalStock+Y.differenceValue,negativeUnits:ae.negativeUnits+Y.negativeUnits,positiveUnits:ae.positiveUnits+Y.positiveUnits,totalSystemUnits:ae.totalSystemUnits+Y.totalSystemUnits,controlledCount:ae.controlledCount+(Y.status==="controlado"?1:0)}),{negativeStock:0,positiveStock:0,totalStock:0,negativeUnits:0,positiveUnits:0,totalSystemUnits:0,controlledCount:0}),M=L.length>0?Math.round(U.controlledCount/L.length*100):0;C(M),g({totalStock:U.totalStock,activeProducts:z,negativeStock:U.negativeStock,positiveStock:U.positiveStock,negativeUnits:U.negativeUnits,positiveUnits:U.positiveUnits,totalSystemUnits:U.totalSystemUnits})}catch(L){console.error("Error loading metrics:",L)}})()},[e]);const be=()=>{const k=new Date().getHours();return k>=6&&k<12?"Buenos das":k>=12&&k<20?"Buenas tardes":"Buenas noches"},Pe=k=>{switch(k){case"smart-analyst":return t.jsx(Jo,{});case"metrics-carousel":return t.jsx(Qo,{metrics:j});case"active-products":return t.jsx(ei,{activeProducts:j.activeProducts});case"inventory-summary":return t.jsx(ti,{});case"inventory-alerts":return t.jsx(ri,{});case"upcoming-inventories":return t.jsx(ai,{onDateClick:he});case"branches-table":return Ht(e,"VIEW_BRANCH_MONITOR")?t.jsx(oi,{branches:ki}):null;case"inventory-progress":return t.jsx(ii,{completedCount:D,totalCount:100});case"critical-products":return t.jsx(li,{criticalCount:15,outOfStockCount:3});case"total-stock-value":return t.jsx(ci,{totalValue:j.totalStock,changePercentage:5.2});case"active-users":return t.jsx(di,{activeCount:5,activeBranches:["Belgrano IV","Recoleta","Palermo II"]});case"pending-inventories":return t.jsx(ui,{pendingCount:7,urgentCount:2});case"trends-chart":return t.jsx(mi,{});case"top-products":return t.jsx(fi,{});case"activity-timeline":return t.jsx(hi,{});case"category-distribution":return t.jsx(xi,{});case"monthly-goals":return t.jsx(pi,{});case"sync-status":return t.jsx(gi,{isOnline:navigator.onLine,pendingCount:0});case"quick-actions":return t.jsx(vi,{});case"calendar":return t.jsx(ji,{});case"countdown":return t.jsx(bi,{assignedDays:y,startDate:b,totalProgress:D,isEditable:Ht(e,"MANAGE_INVENTORY_CONFIG"),onEdit:()=>R(!0)});case"category-progress":return t.jsx(yi,{});default:return null}};return t.jsxs(W.div,{className:"pt-3 pb-6 px-6 space-y-6",variants:Di,initial:"hidden",animate:"show",children:[t.jsxs(W.div,{variants:Ii,className:"space-y-1",children:[t.jsx("div",{className:"text-muted-foreground text-xs font-normal",children:new Date().toLocaleDateString("es-AR",{weekday:"long",month:"short",day:"2-digit",year:"numeric"})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-2xl font-medium tracking-tight text-foreground",children:[be(),", ",(e==null?void 0:e.role)==="admin"?e==null?void 0:e.name.split(" ")[0]:(e==null?void 0:e.branchName)||"Sucursal"," "]}),t.jsxs("div",{className:"flex gap-2",children:[r&&t.jsxs(t.Fragment,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>x(!0),children:[t.jsx(ln,{className:"h-4 w-4 mr-2"}),"Presets"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>l(!0),disabled:n.length===0,children:[t.jsx(ut,{className:"h-4 w-4 mr-2"}),"Agregar Widget"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:m,children:[t.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Resetear"]})]}),t.jsx(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(T,{variant:r?"default":"outline",size:"sm",onClick:()=>a(!r),className:$("relative overflow-hidden transition-all duration-300",r&&"bg-green-600 hover:bg-green-700"),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ts,{mode:"wait",children:r?t.jsx(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(an,{className:"h-4 w-4"})},"check"):t.jsx(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:t.jsx(Jr,{className:"h-4 w-4"})},"edit")}),t.jsx("span",{children:r?"Guardar":"Editar Dashboard"})]})})})]})]})]}),t.jsx(wo,{sensors:N,collisionDetection:ja,onDragEnd:v,children:t.jsx(To,{items:p.map(k=>k.id),strategy:hs,children:t.jsx("div",{className:"grid grid-cols-12 gap-6 auto-rows-auto",children:p.map(k=>t.jsx("div",{className:$(k.size==="small"&&"col-span-12 md:col-span-6 lg:col-span-3",k.size==="large"&&"col-span-12 md:col-span-6 lg:col-span-4",k.size==="full"&&"col-span-12"),children:t.jsx(Xo,{widget:k,isEditMode:r,onRemove:()=>c(k.id),onSizeChange:z=>d(k.id,z),children:Pe(k.type)})},k.id))})})}),t.jsx(Si,{open:h,onOpenChange:x,onApplyPreset:k=>{const z=Tn.find(L=>L.id===k);z&&u(z.widgetIds)}}),t.jsx(Zo,{open:f,onOpenChange:l,hiddenWidgets:n,onAddWidget:c}),t.jsx(Zt,{open:I,onOpenChange:k=>{if(R(k),k){const z=y||90,U=[180,150,120,90].find(M=>M<=z)||90;B((e==null?void 0:e.branchName)||""),se(U),Oe(Math.max(0,z-U)),ze(b?b.split("T")[0]:new Date().toISOString().split("T")[0])}},children:t.jsxs(Jt,{className:"max-w-md",children:[t.jsxs(Qt,{children:[t.jsx(es,{children:"Configurar Plazo de Inventario"}),t.jsx(Js,{children:"Ajusta los parmetros del ciclo de inventario para esta sucursal."})]}),t.jsxs("div",{className:"space-y-6 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(vt,{className:"text-muted-foreground",children:"Sucursal Seleccionada"}),t.jsx("div",{className:"text-lg font-semibold border p-3 rounded-md bg-muted/50",children:(e==null?void 0:e.branchName)||"Sin sucursal asignada"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(vt,{children:"Das Base"}),t.jsx("div",{className:"grid grid-cols-4 gap-3",children:[90,120,150,180].map(k=>t.jsx("button",{onClick:()=>se(k),className:$("flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all",V===k?"border-primary bg-primary/10 text-primary font-bold":"border-muted hover:border-primary/50 text-muted-foreground"),children:t.jsx("span",{className:"text-xl",children:k})},k))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(vt,{children:"Prroga (Das adicionales)"}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(ce,{type:"number",placeholder:"0",className:"text-lg font-medium",value:K,onChange:k=>Oe(Number(k.target.value)),min:0}),t.jsxs("div",{className:"text-sm text-muted-foreground text-nowrap",children:["Total: ",t.jsx("span",{className:"font-bold text-foreground mx-1 text-lg",children:V+K})," das"]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(vt,{children:"Fecha de Inicio del Ciclo"}),t.jsx(ce,{type:"date",value:me,onChange:k=>ze(k.target.value),className:"bg-background"}),t.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Esta fecha se usa para calcular los das restantes y el ritmo de avance."})]}),t.jsx(T,{className:"w-full mt-2",onClick:async()=>{if(!(e!=null&&e.branchName))return;const k=V+K;try{await Ce.saveBranchConfig(e.branchName,k,me),Se.success("Operacin exitosa",`Plazo actualizado a ${k} das`),R(!1),w(k),S(me)}catch{Se.error("Error","Error al guardar")}},children:"Guardar Configuracin"})]})]})}),t.jsx(Ni,{open:fe,onOpenChange:ke,initialDate:Be})]})}export{rl as default};
