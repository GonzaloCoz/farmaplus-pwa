import{j as e,h as ce,i as le,k as de,l as me,A as ue,m as xe,n as $e,o as He}from"./ui-vendor-B9YtwGJ-.js";import{r as s,u as We}from"./react-vendor-DdjUaGoS.js";import{c as Ue,s as qe,o as N,P as H,p as fe,C as O,B as C,q as Ye,D as Me,h as Ge,i as Ke,j as Qe,r as Je,u as Ve,t as ee,v as l,w as Xe,x as te,y as _e,z as Ze,A as et,E as se,F as tt,G as ae,H as st,W as at,I as rt,J as re,K as nt}from"./index-CfsGIlE1.js";import{I as T}from"./input-BNQlWmVc.js";import{S as ot,P as it,C as ct,B as lt}from"./SwipeableItem-DjTRjrVQ.js";import{S as dt}from"./search-DovExvO1.js";import{A as W,m as k}from"./animation-CvwzMRXu.js";import{C as ne}from"./CounterAnimation-CLeRA1eU.js";import{E as mt}from"./jspdf.es.min-Cm0kf70i.js";import{J as oe}from"./JsBarcode-B9pOLHC9.js";import{A as ut}from"./arrow-left-DrhDRTh-.js";import{W as xt}from"./wifi-nkNoWsl8.js";import{C as ie}from"./circle-check-CwNOYbMh.js";import{P as ft}from"./plus-B9-dOtMn.js";import"./utils-CUsTgaRG.js";import"./excel-uoQkVabA.js";import"./scanner-ThRrwOEs.js";import"./switch-BNp0sC_2.js";import"./label-BY2Z0kLh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Ue("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);function ht({onSelect:o,placeholder:i="Buscar producto por nombre o EAN...",className:a}){const[p,y]=s.useState(""),[h,u]=s.useState([]),[m,c]=s.useState(!1),[g,j]=s.useState(0),v=s.useRef(null),S=s.useRef(null);s.useEffect(()=>{const r=setTimeout(async()=>{if(p.trim().length>=2)try{const n=await qe(p,8);u(n),c(n.length>0),j(0)}catch(n){console.error("Error searching products:",n),u([])}else u([]),c(!1)},300);return()=>clearTimeout(r)},[p]),s.useEffect(()=>{const r=n=>{var w;S.current&&!S.current.contains(n.target)&&!((w=v.current)!=null&&w.contains(n.target))&&c(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const d=r=>{if(!(!m||h.length===0))switch(r.key){case"ArrowDown":r.preventDefault(),j(n=>(n+1)%h.length);break;case"ArrowUp":r.preventDefault(),j(n=>(n-1+h.length)%h.length);break;case"Enter":r.preventDefault(),h[g]&&x(h[g]);break;case"Escape":c(!1);break}},x=r=>{var n;o(r),y(""),u([]),c(!1),(n=v.current)==null||n.blur()},f=(r,n)=>n.trim()?r.split(new RegExp(`(${n})`,"gi")).map((P,D)=>P.toLowerCase()===n.toLowerCase()?e.jsx("mark",{className:"bg-primary/20 text-primary font-semibold",children:P},D):P):r;return e.jsxs("div",{className:N("relative",a),children:[e.jsxs("div",{className:"relative",children:[e.jsx(dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(T,{ref:v,type:"text",value:p,onChange:r=>y(r.target.value),onKeyDown:d,onFocus:()=>{h.length>0&&c(!0)},placeholder:i,className:"pl-10 pr-4"})]}),e.jsx(W,{children:m&&h.length>0&&e.jsxs(k.div,{ref:S,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute z-50 w-full mt-2 bg-card border border-border rounded-lg shadow-lg elevation-3 max-h-[400px] overflow-y-auto",children:[e.jsx("div",{className:"p-2 space-y-1",children:h.map((r,n)=>e.jsx(k.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:n*.05},onClick:()=>x(r),onMouseEnter:()=>j(n),className:N("w-full text-left p-3 rounded-lg transition-colors","hover:bg-primary hover:text-primary-foreground","focus:outline-none focus:ring-2 focus:ring-ring",g===n&&"bg-primary text-primary-foreground"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:N("p-2 rounded-lg flex-shrink-0",g===n?"bg-primary-foreground/20":"bg-muted"),children:e.jsx(H,{className:N("w-5 h-5",g===n?"text-primary-foreground":"text-muted-foreground")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:f(r.name,p)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:N("text-xs font-mono",g===n?"text-primary-foreground/80":"text-muted-foreground"),children:["EAN: ",f(r.ean,p)]}),r.salePrice>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:N("text-xs",g===n?"text-primary-foreground/60":"text-muted-foreground"),children:"•"}),e.jsxs("span",{className:N("text-xs font-semibold",g===n?"text-primary-foreground/80":"text-muted-foreground"),children:["$",r.salePrice.toLocaleString()]})]})]})]})]})},r.ean))}),e.jsx("div",{className:"border-t border-border p-2 bg-muted/30",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Usa ↑↓ para navegar, Enter para seleccionar"})})]})}),m&&p.trim().length>=2&&h.length===0&&e.jsx(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute z-50 w-full mt-2 bg-card border border-border rounded-lg shadow-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"No se encontraron productos"})})]})}const gt=$e,yt=He,pe=s.forwardRef(({className:o,...i},a)=>e.jsx(ce,{className:N("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",o),...i,ref:a}));pe.displayName=ce.displayName;const he=s.forwardRef(({className:o,...i},a)=>e.jsxs(yt,{children:[e.jsx(pe,{}),e.jsx(le,{ref:a,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),...i})]}));he.displayName=le.displayName;const ge=({className:o,...i})=>e.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",o),...i});ge.displayName="AlertDialogHeader";const ye=({className:o,...i})=>e.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",o),...i});ye.displayName="AlertDialogFooter";const je=s.forwardRef(({className:o,...i},a)=>e.jsx(de,{ref:a,className:N("text-lg font-semibold",o),...i}));je.displayName=de.displayName;const Ne=s.forwardRef(({className:o,...i},a)=>e.jsx(me,{ref:a,className:N("text-sm text-muted-foreground",o),...i}));Ne.displayName=me.displayName;const ve=s.forwardRef(({className:o,...i},a)=>e.jsx(ue,{ref:a,className:N(fe(),o),...i}));ve.displayName=ue.displayName;const be=s.forwardRef(({className:o,...i},a)=>e.jsx(xe,{ref:a,className:N(fe({variant:"outline"}),"mt-2 sm:mt-0",o),...i}));be.displayName=xe.displayName;function jt({items:o,onUpdate:i,onDelete:a}){const[p,y]=s.useState(null),[h,u]=s.useState(""),[m,c]=s.useState(null),g=d=>{y(d.id),u(d.quantity.toString())},j=()=>{if(p&&h){const d=parseInt(h,10);d>0&&(i(p,d),y(null),u(""))}},v=()=>{y(null),u("")},S=()=>{m&&(a(m),c(null))};return o.length===0?e.jsxs(O,{className:"p-8 text-center",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No hay productos agregados aún"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Escanea o busca productos para comenzar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:e.jsx(W,{mode:"popLayout",children:o.map((d,x)=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{delay:x*.05},layout:!0,children:e.jsx(ot,{className:"mb-3",onEdit:()=>g(d),onDelete:()=>c(d.id),children:e.jsx(O,{className:"p-4 hover:shadow-md transition-shadow border-0 rounded-none sm:rounded-xl sm:border",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg flex-shrink-0",children:e.jsx(H,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-foreground truncate",children:d.productName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground font-mono",children:["EAN: ",d.ean]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"•"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[d.quantity," uds."]})]})]}),d.synced===0&&e.jsxs("span",{className:"inline-flex items-center gap-1 mt-2 px-2 py-0.5 bg-warning/10 text-warning text-xs rounded-full",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-warning rounded-full"}),"Pendiente de sincronizar"]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 flex-shrink-0",children:[e.jsx(C,{size:"sm",variant:"ghost",onClick:()=>g(d),className:"hover:bg-primary hover:text-primary-foreground",children:e.jsx(it,{className:"w-4 h-4"})}),e.jsx(C,{size:"sm",variant:"ghost",onClick:()=>c(d.id),className:"hover:bg-destructive hover:text-destructive-foreground",children:e.jsx(Ye,{className:"w-4 h-4"})})]})]})})})},d.id))})}),e.jsx(Me,{open:p!==null,onOpenChange:d=>!d&&v(),children:e.jsxs(Ge,{children:[e.jsx(Ke,{children:e.jsx(Qe,{children:"Editar Cantidad"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Nueva cantidad"}),e.jsx(T,{type:"number",min:"1",value:h,onChange:d=>u(d.target.value),onKeyDown:d=>{d.key==="Enter"&&j()},placeholder:"Ingresa la cantidad",autoFocus:!0})]})}),e.jsxs(Je,{children:[e.jsx(C,{variant:"outline",onClick:v,children:"Cancelar"}),e.jsx(C,{onClick:j,disabled:!h||parseInt(h)<=0,children:"Guardar"})]})]})}),e.jsx(gt,{open:m!==null,onOpenChange:d=>!d&&c(null),children:e.jsxs(he,{children:[e.jsxs(ge,{children:[e.jsx(je,{children:"¿Eliminar producto?"}),e.jsx(Ne,{children:"Esta acción no se puede deshacer. El producto será eliminado del pre-conteo."})]}),e.jsxs(ye,{children:[e.jsx(be,{children:"Cancelar"}),e.jsx(ve,{onClick:S,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})})]})}function Nt(){const[o,i]=s.useState([]),[a,p]=s.useState(null),[y,h]=s.useState(!0);s.useEffect(()=>{(async()=>{try{await tt();const f=await ee();if(f){p(f);const r=await se(f.sector);i(r)}}catch(f){console.error("Error initializing pre-count:",f),l.error("Error al inicializar el sistema de pre-conteo")}finally{h(!1)}})()},[]);const u=o.length,m=o.reduce((x,f)=>x+f.quantity,0);s.useEffect(()=>{a&&!a.endTime&&Ve(a.id,{totalProducts:u,totalUnits:m}).catch(x=>{console.error("Error updating session:",x)})},[a,u,m]);const c=s.useCallback(async x=>{try{if(h(!0),await ee()){l.error("Ya existe una sesión activa. Por favor, finalízala primero.");return}const r=await Xe(x);p(r),i([]),l.success(`Sesión iniciada para el sector: ${x}`)}catch(f){console.error("Error starting session:",f),l.error("Error al iniciar la sesión")}finally{h(!1)}},[]),g=s.useCallback(async(x,f,r)=>{if(!a){l.error("No hay una sesión activa");return}if(r<=0){l.error("La cantidad debe ser mayor a 0");return}try{const n=o.find(w=>w.ean===x);if(n){const w=n.quantity+r;await te(n.id,{quantity:w}),i(P=>P.map(D=>D.id===n.id?{...D,quantity:w,synced:0}:D)),l.success(`Cantidad actualizada: ${f} (+${r})`)}else{const w=await _e({sector:a.sector,ean:x,productName:f,quantity:r});i(P=>[...P,w]),l.success(`Producto agregado: ${f}`)}}catch(n){console.error("Error adding item:",n),l.error("Error al agregar el producto")}},[a,o]),j=s.useCallback(async(x,f)=>{if(f<=0){l.error("La cantidad debe ser mayor a 0");return}try{await te(x,{quantity:f}),i(r=>r.map(n=>n.id===x?{...n,quantity:f,synced:0}:n)),l.success("Cantidad actualizada")}catch(r){console.error("Error updating item:",r),l.error("Error al actualizar el producto")}},[]),v=s.useCallback(async x=>{try{await Ze(x),i(f=>f.filter(r=>r.id!==x)),l.success("Producto eliminado")}catch(f){console.error("Error removing item:",f),l.error("Error al eliminar el producto")}},[]),S=s.useCallback(async()=>{if(!a){l.error("No hay una sesión activa");return}try{await et(a.id),p(null),i([]),l.success("Sesión finalizada correctamente")}catch(x){console.error("Error finishing session:",x),l.error("Error al finalizar la sesión")}},[a]),d=s.useCallback(async()=>{if(a)try{const x=await se(a.sector);i(x)}catch(x){console.error("Error refreshing items:",x),l.error("Error al actualizar los productos")}},[a]);return{items:o,session:a,totalProducts:u,totalUnits:m,isLoading:y,startSession:c,addItem:g,updateItem:j,removeItem:v,finishSession:S,refreshItems:d}}function vt(){const[o,i]=s.useState(navigator.onLine),[a,p]=s.useState(!1),[y,h]=s.useState(0);s.useEffect(()=>{const c=()=>{i(!0),l.success("Conexión restaurada",{description:"Los datos se sincronizarán automáticamente"}),m()},g=()=>{i(!1),l.warning("Sin conexión",{description:"Los datos se guardarán localmente"})};return window.addEventListener("online",c),window.addEventListener("offline",g),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",g)}},[]);const u=s.useCallback(async()=>{try{const c=await ae();h(c.length)}catch(c){console.error("Error counting unsynced items:",c)}},[]);s.useEffect(()=>{u();const c=setInterval(u,3e4);return()=>clearInterval(c)},[u]);const m=s.useCallback(async()=>{if(!o){l.error("No hay conexión a internet");return}if(!a)try{p(!0);const c=await ae();if(c.length===0){l.info("No hay datos pendientes de sincronización");return}console.log("Syncing items:",c),await new Promise(j=>setTimeout(j,1e3));const g=c.map(j=>j.id);await st(g),await u(),l.success("Sincronización completada",{description:`${c.length} productos sincronizados`})}catch(c){console.error("Error syncing data:",c),l.error("Error al sincronizar datos",{description:"Se reintentará automáticamente"})}finally{p(!1)}},[o,a,u]);return s.useEffect(()=>{if(o&&y>0&&!a){const c=setTimeout(()=>{m()},2e3);return()=>clearTimeout(c)}},[o,y,a,m]),{isOnline:o,isSyncing:a,unsyncedCount:y,syncNow:m}}function bt({actions:o,className:i}){const[a,p]=s.useState(!0),[y,h]=s.useState(0);return s.useEffect(()=>{const u=()=>{const m=window.scrollY;m<y||m<50?p(!0):m>y&&m>50&&p(!1),h(m)};return window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[y]),e.jsx(W,{children:a&&e.jsx(k.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{duration:.3},className:N("fixed bottom-24 right-6 flex flex-col gap-3 z-40",i),children:o.map((u,m)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"bg-background/80 backdrop-blur-sm text-foreground text-xs font-medium px-2 py-1 rounded-md shadow-sm",children:u.label}),e.jsx(C,{variant:u.variant||"default",size:"icon",className:"h-12 w-12 rounded-full shadow-lg",onClick:u.onClick,children:u.icon})]},m))})})}function qt(){const o=We(),[i,a]=s.useState("config"),[p,y]=s.useState(""),[h,u]=s.useState(!1),[m,c]=s.useState(""),[g,j]=s.useState("1"),[v,S]=s.useState(null),{items:d,session:x,totalProducts:f,totalUnits:r,isLoading:n,startSession:w,addItem:P,updateItem:D,removeItem:we,finishSession:Se}=Nt(),{isOnline:M,isSyncing:G,unsyncedCount:K,syncNow:Ce}=vt(),Q=async()=>{if(!p.trim()){l.error("Por favor, ingresa el nombre del sector");return}await w(p.trim()),a("counting")},Ee=async t=>{try{const b=await re(t);b?(S(b),c(t),l.success(`Producto encontrado: ${b.name}`)):(c(t),l.warning("Producto no encontrado en la base de datos",{description:"Puedes agregarlo manualmente"}))}catch(b){console.error("Error fetching product:",b),l.error("Error al buscar el producto")}},Pe=t=>{S(t),c(t.ean)},ke=async()=>{if(!m.trim()){l.error("Por favor, ingresa o escanea un código EAN");return}const t=parseInt(g,10);if(isNaN(t)||t<=0){l.error("Por favor, ingresa una cantidad válida");return}let b=v==null?void 0:v.name;if(!b)try{const I=await re(m.trim());I&&(b=I.name)}catch(I){console.error("Error fetching product by EAN:",I)}b||(b=`Producto ${m}`),await P(m,b,t),c(""),j("1"),S(null)},De=async()=>{if(d.length===0){l.error("No hay productos para finalizar");return}await Se(),o("/stock")},ze=()=>{if(d.length===0){l.error("No hay productos para exportar");return}try{const t=new mt,b=t.internal.pageSize.getWidth(),I=t.internal.pageSize.getHeight(),E=10,U=3,q=3,L=(b-E*2-q*(U-1))/U,R=28;let A=E,z=E+15;t.setFontSize(14),t.text(`Pre-Conteo: ${p}`,E,E+5),t.setFontSize(8),t.text(`Fecha: ${new Date().toLocaleDateString()}`,b-E-30,E+5),d.forEach((B,Fe)=>{z+R>I-E&&(t.addPage(),z=E),t.setDrawColor(200),t.setLineWidth(.1),t.roundedRect(A,z,L,R,2,2,"S");const J=L-4,Le=A+2,Oe=z+5;t.setFontSize(9),t.setFont("helvetica","bold");let $=B.productName;if(t.getTextWidth($)>J){const F=Math.floor(J/2);$=$.substring(0,F)+"..."}t.text($,Le,Oe);const Te=L*.65,Re=15,V=A+2,X=z+8,Y=document.createElement("canvas");try{const F={displayValue:!0,fontSize:14,fontOptions:"bold",margin:0,height:40,width:2,background:"#ffffff",lineColor:"#000000",textMargin:0};try{oe(Y,B.ean,{...F,format:"EAN13"})}catch{oe(Y,B.ean,{...F,format:"CODE128"})}const Be=Y.toDataURL("image/png");t.addImage(Be,"PNG",V,X,Te,Re)}catch(F){console.error("Error generating barcode:",F),t.setFontSize(8),t.setTextColor(255,0,0),t.text("Error Barcode",V,X+10),t.setTextColor(0,0,0)}const _=A+L-2,Z=z+R-6;t.setFontSize(24),t.setFont("helvetica","bold"),t.text(B.quantity.toString(),_,Z,{align:"right"}),t.setFontSize(6),t.setFont("helvetica","normal"),t.setTextColor(100),t.text("CANT",_,Z-10,{align:"right"}),t.setTextColor(0),(Fe+1)%U===0?(A=E,z+=R+q):A+=L+q});const Ae=`PreConteo_${p}_${new Date().toISOString().split("T")[0]}.pdf`;t.save(Ae),l.success("PDF generado correctamente")}catch(t){console.error("Error generating PDF:",t),l.error("Error al generar el PDF")}},Ie=async()=>{await nt([{ean:"7790001234567",name:"Shampoo Dove 400ml",cost:850,salePrice:1200},{ean:"7790002345678",name:"Acondicionador Pantene 300ml",cost:920,salePrice:1350},{ean:"7790003456789",name:"Jabón Dove 90g",cost:180,salePrice:280},{ean:"7790004567890",name:"Desodorante Rexona 150ml",cost:650,salePrice:950},{ean:"7790005678901",name:"Crema Dental Colgate 90g",cost:420,salePrice:620},{ean:"7790006789012",name:"Enjuague Bucal Listerine 500ml",cost:1100,salePrice:1580},{ean:"7790007890123",name:"Papel Higiénico Elite x4",cost:890,salePrice:1250},{ean:"7790008901234",name:"Toallas Femeninas Always x8",cost:520,salePrice:780},{ean:"7790009012345",name:"Pañales Pampers M x30",cost:3200,salePrice:4500},{ean:"7790010123456",name:"Algodón Estrella 100g",cost:280,salePrice:420}]),l.success("Productos de ejemplo cargados")};return n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(k.div,{className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-4 flex-col sm:flex-row",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>i==="config"?o("/stock"):a("config"),className:"flex-shrink-0",children:e.jsx(ut,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Pre-Conteo Sucursal"}),x&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Sector: ",e.jsx("span",{className:"font-semibold text-foreground",children:x.sector})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:M?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-success/10 text-success rounded-full text-sm",children:[e.jsx(xt,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium hidden sm:inline",children:"En línea"})]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-warning/10 text-warning rounded-full text-sm",children:[e.jsx(at,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium hidden sm:inline",children:"Sin conexión"})]})})]}),e.jsx(W,{mode:"wait",children:i==="config"?e.jsx(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"max-w-2xl mx-auto",children:e.jsx(O,{className:"p-6 sm:p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-4 bg-primary/10 rounded-2xl mb-4",children:e.jsx(H,{className:"w-12 h-12 text-primary"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-foreground mb-2",children:"Configuración del Pre-Conteo"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Ingresa el nombre del sector o estantería que vas a contar"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Nombre del Sector / Estantería *"}),e.jsx(T,{type:"text",value:p,onChange:t=>y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Q()},placeholder:"Ej: Bebidas, Perfumería, Góndola 1, etc.",className:"text-base sm:text-lg",autoFocus:!0})]}),e.jsx(C,{onClick:Q,disabled:!p.trim(),className:"w-full",size:"lg",children:"Comenzar Pre-Conteo"}),e.jsx(C,{onClick:Ie,variant:"outline",className:"w-full",size:"sm",children:"Cargar productos de ejemplo"})]})]})})},"config"):e.jsxs(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[e.jsx(O,{className:"p-6 sm:p-8 bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20 elevation-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Llevas"}),e.jsx("div",{className:"text-5xl sm:text-6xl font-bold text-primary mb-2",children:e.jsx(ne,{value:f})}),e.jsxs("p",{className:"text-xl sm:text-2xl font-semibold text-foreground",children:[f===1?"producto":"productos"," pre-contados"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Total de unidades: ",e.jsx("span",{className:"font-semibold text-foreground",children:e.jsx(ne,{value:r})})]})]})}),e.jsxs(O,{className:"p-4 sm:p-6 elevation-1",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-4",children:"Agregar Producto"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(C,{onClick:()=>u(!0),className:"w-full",size:"lg",variant:"default",children:[e.jsx(ct,{className:"w-5 h-5 mr-2"}),"Escanear Código de Barras"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"O busca manualmente"})})]}),e.jsx(ht,{onSelect:Pe,placeholder:"Buscar producto por nombre o EAN..."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Código EAN"}),e.jsx(T,{type:"text",value:m,onChange:t=>c(t.target.value),placeholder:"Ingresa el código EAN"}),v&&e.jsxs("p",{className:"text-sm text-success mt-1 flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),v.name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Cantidad"}),e.jsx(T,{type:"number",min:"1",value:g,onChange:t=>j(t.target.value),placeholder:"Cantidad"})]}),e.jsxs(C,{onClick:ke,disabled:!m.trim()||!g,className:"w-full",size:"lg",children:[e.jsx(ft,{className:"w-5 h-5 mr-2"}),"Guardar y Siguiente"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-foreground",children:["Productos Agregados (",f,")"]}),K>0&&e.jsx(C,{onClick:Ce,disabled:!M||G,variant:"outline",size:"sm",className:"flex-shrink-0",children:G?"Sincronizando...":`Sincronizar (${K})`})]}),e.jsx(jt,{items:d,onUpdate:D,onDelete:we})]})]},"counting")})]}),d.length>0&&i==="counting"&&e.jsx(bt,{actions:[{icon:e.jsx(rt,{className:"w-5 h-5"}),label:"Exportar a PDF",onClick:ze},{icon:e.jsx(ie,{className:"w-5 h-5"}),label:"Finalizar Pre-Conteo",onClick:De}]}),e.jsx(lt,{open:h,onOpenChange:u,onScan:Ee},h?"open":"closed")]})}export{qt as default};
