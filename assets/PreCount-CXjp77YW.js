import{j as e,l as he,m as ge,n as fe,o as je,A as ye,p as Ne,q as Ye,r as Ke}from"./ui-vendor-DWmIoBIJ.js";import{r as c,u as Ge}from"./react-vendor-ylmX0jv_.js";import{b as P,z as ve,d as F,A as Je,B as y,E as be,t as Ve,v as Xe,w as _e,x as Ze,F as es,G as ss,r,H as ne,J as ts,K as as,L as oe,M as rs,N as ns,O as os,Q as is,V as ls,W as ie,i as le,Y as cs,Z as ce,h as de,e as ds,f as ms}from"./index-WTpjueDr.js";import{I as G}from"./input-Cw2nBV2E.js";import{u as xs,A as me,S as us,B as ps}from"./AnimatedCounter-juQ8GfTm.js";import{A as M,m as I}from"./animation-Ch0GoCcm.js";import{P as hs}from"./pencil-C26RoZiE.js";import{C as gs}from"./Calculator-2Rk5z9Vt.js";import{E as fs}from"./jspdf.es.min-DfvSSlu6.js";import{J as xe}from"./JsBarcode-BPRqDEDi.js";import{F as js}from"./FabMenu-WRyQGBU3.js";import{W as ue}from"./wifi-B2KHsGm2.js";import{C as ys}from"./calculator-lrCifLGr.js";import{P as pe}from"./plus-B2BzAFO4.js";import{H as Ns}from"./history-DlyZEBv5.js";import{C as vs,e as bs}from"./es-BB0dKGuV.js";import{A as ws}from"./arrow-right-D8B7iH8y.js";import{f as Ss}from"./utils-CUsTgaRG.js";import"./excel-uoQkVabA.js";import"./scanner-D4NToCeH.js";import"./switch--bWBiUOz.js";import"./label-IThIXzsi.js";import"./loader-circle-g467miAt.js";import"./barcode-CPVnGsHG.js";const Cs=Ye,Es=Ke,we=c.forwardRef(({className:l,...n},a)=>e.jsx(he,{className:P("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...n,ref:a}));we.displayName=he.displayName;const Se=c.forwardRef(({className:l,...n},a)=>e.jsxs(Es,{children:[e.jsx(we,{}),e.jsx(ge,{ref:a,className:P("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...n})]}));Se.displayName=ge.displayName;const Ce=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col space-y-2 text-center sm:text-left",l),...n});Ce.displayName="AlertDialogHeader";const Ee=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",l),...n});Ee.displayName="AlertDialogFooter";const Pe=c.forwardRef(({className:l,...n},a)=>e.jsx(fe,{ref:a,className:P("text-lg font-semibold",l),...n}));Pe.displayName=fe.displayName;const ke=c.forwardRef(({className:l,...n},a)=>e.jsx(je,{ref:a,className:P("text-sm text-muted-foreground",l),...n}));ke.displayName=je.displayName;const ze=c.forwardRef(({className:l,...n},a)=>e.jsx(ye,{ref:a,className:P(ve(),l),...n}));ze.displayName=ye.displayName;const De=c.forwardRef(({className:l,...n},a)=>e.jsx(Ne,{ref:a,className:P(ve({variant:"outline"}),"mt-2 sm:mt-0",l),...n}));De.displayName=Ne.displayName;function Ps({items:l,onUpdate:n,onDelete:a}){const[u,v]=c.useState(null),[p,b]=c.useState(""),[h,g]=c.useState(null),w=i=>{v(i.id),b(i.quantity.toString())},S=()=>{if(u&&p){const i=parseInt(p,10);i>0&&(n(u,i),v(null),b(""))}},j=()=>{v(null),b("")},C=()=>{h&&(a(h),g(null))};return l.length===0?e.jsxs(F,{className:"p-8 text-center",children:[e.jsx(Je,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No hay productos agregados aún"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Escanea o busca productos para comenzar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.jsx(M,{mode:"popLayout",children:l.map((i,T)=>e.jsx(I.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},layout:!0,children:e.jsxs(F,{className:"h-full relative overflow-hidden group border-muted/60 shadow-sm hover:shadow-md transition-all",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${i.synced===0?"bg-warning/50":"bg-primary/20 group-hover:bg-primary transition-colors"}`}),e.jsxs("div",{className:"p-3 pl-4 flex flex-col h-full gap-2",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h4",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground/90",title:i.productName,children:i.productName}),e.jsx("div",{className:"flex flex-col items-end gap-1"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-muted-foreground bg-muted/40 px-2 py-1 rounded-md border border-border/40",children:[e.jsx("span",{className:"text-[10px] font-bold opacity-70 uppercase tracking-widest",children:"EAN"}),e.jsx("span",{className:"text-xs sm:text-sm font-mono tracking-wide font-medium border-l border-border/30 pl-1.5 ml-0.5",children:i.ean})]}),i.synced===0&&e.jsxs("span",{className:"text-[10px] text-warning flex items-center gap-1 font-medium bg-warning/5 px-1.5 rounded",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-warning animate-pulse"}),"Sin sinc."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 mt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-2xl font-bold tracking-tight text-foreground",children:i.quantity}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"unid."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground hover:text-primary hover:bg-primary/5",onClick:()=>w(i),children:e.jsx(hs,{className:"w-4 h-4"})}),e.jsx(y,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground hover:text-destructive hover:bg-destructive/5",onClick:()=>g(i.id),children:e.jsx(be,{className:"w-4 h-4"})})]})]})]})]})},i.id))})}),e.jsx(Ve,{open:u!==null,onOpenChange:i=>!i&&j(),children:e.jsxs(Xe,{children:[e.jsx(_e,{children:e.jsx(Ze,{children:"Editar Cantidad"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Nueva cantidad"}),e.jsx(G,{type:"number",min:"1",value:p,onChange:i=>b(i.target.value),onKeyDown:i=>{i.key==="Enter"&&S()},placeholder:"Ingresa la cantidad",autoFocus:!0})]})}),e.jsxs(es,{children:[e.jsx(y,{variant:"outline",onClick:j,children:"Cancelar"}),e.jsx(y,{onClick:S,disabled:!p||parseInt(p)<=0,children:"Guardar"})]})]})}),e.jsx(Cs,{open:h!==null,onOpenChange:i=>!i&&g(null),children:e.jsxs(Se,{children:[e.jsxs(Ce,{children:[e.jsx(Pe,{children:"¿Eliminar producto?"}),e.jsx(ke,{children:"Esta acción no se puede deshacer. El producto será eliminado del pre-conteo."})]}),e.jsxs(Ee,{children:[e.jsx(De,{children:"Cancelar"}),e.jsx(ze,{onClick:C,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})})]})}function ks(){const[l,n]=c.useState([]),[a,u]=c.useState(null),[v,p]=c.useState([]),[b,h]=c.useState(!0);c.useEffect(()=>{const o=setTimeout(async()=>{try{await rs();const d=await ns();p(d)}catch(d){console.error("Error initializing pre-count:",d),r.error("Error al inicializar el sistema de pre-conteo")}finally{h(!1)}},100);return()=>clearTimeout(o)},[]);const g=l.length,w=l.reduce((t,o)=>t+o.quantity,0);c.useEffect(()=>{a&&!a.endTime&&ss(a.id,{totalProducts:g,totalUnits:w}).catch(t=>{console.error("Error updating session:",t)})},[a,g,w]);const S=async t=>{try{if(h(!0),v.find(x=>x.sector===t)){r.error("Ya existe una sesión abierta para este sector");return}const d=await os(t);u(d),n([]),p(x=>[d,...x]),r.success(`Sesión iniciada: ${t}`)}catch(o){console.error("Error starting session:",o),r.error("Error al iniciar la sesión")}finally{h(!1)}},j=async t=>{try{u(t);const o=await oe(t.sector);n(o),r.success(`Sesión retomada: ${t.sector}`)}catch(o){console.error("Error resuming session:",o),r.error("Error al retomar la sesión")}},C=async t=>{if(confirm("¿Estás seguro de eliminar esta sesión? Se perderán todos los datos escaneados."))try{await is(t),p(o=>o.filter(d=>d.id!==t)),(a==null?void 0:a.id)===t&&(u(null),n([])),r.success("Sesión eliminada")}catch(o){console.error("Error deleting session:",o),r.error("Error al eliminar la sesión")}},i=c.useCallback(async(t,o,d)=>{if(!a){r.error("No hay una sesión activa");return}if(d<=0){r.error("La cantidad debe ser mayor a 0");return}try{const x=l.find(E=>E.ean===t);if(x){const E=x.quantity+d;await ne(x.id,{quantity:E}),n(O=>O.map(H=>H.id===x.id?{...H,quantity:E,synced:0}:H)),r.success(`Cantidad actualizada: ${o} (+${d})`)}else{const E=await ts({sector:a.sector,ean:t,productName:o,quantity:d});n(O=>[...O,E]),r.success(`Producto agregado: ${o}`)}}catch(x){console.error("Error adding item:",x),r.error("Error al agregar el producto")}},[a,l]),T=c.useCallback(async(t,o)=>{if(o<=0){r.error("La cantidad debe ser mayor a 0");return}try{await ne(t,{quantity:o}),n(d=>d.map(x=>x.id===t?{...x,quantity:o,synced:0}:x)),r.success("Cantidad actualizada")}catch(d){console.error("Error updating item:",d),r.error("Error al actualizar el producto")}},[]),U=c.useCallback(async t=>{try{await as(t),n(o=>o.filter(d=>d.id!==t)),r.success("Producto eliminado")}catch(o){console.error("Error removing item:",o),r.error("Error al eliminar el producto")}},[]),k=async()=>{if(a&&confirm("¿Finalizar sesión de conteo?"))try{await ls(a.id),u(null),n([]),p(t=>t.filter(o=>o.id!==a.id)),r.success("Sesión finalizada correctamente")}catch(t){console.error("Error finishing session:",t),r.error("Error al finalizar la sesión")}},$=c.useCallback(async()=>{if(a)try{const t=await oe(a.sector);n(t)}catch(t){console.error("Error refreshing items:",t),r.error("Error al actualizar los productos")}},[a]);return{items:l,session:a,totalProducts:g,totalUnits:w,isLoading:b,availableSessions:v,startSession:S,resumeSession:j,deleteSession:C,addItem:i,updateItem:T,removeItem:U,finishSession:k,refreshItems:$}}function et(){const l=Ge(),[n,a]=c.useState("config"),[u,v]=c.useState(""),[p,b]=c.useState(!1),[h,g]=c.useState(""),[w,S]=c.useState("1"),[j,C]=c.useState(null),[i,T]=c.useState(!1),U=s=>{S(Math.floor(s).toString())},{items:k,session:$,totalProducts:t,totalUnits:o,isLoading:d,startSession:x,addItem:E,updateItem:O,removeItem:H,finishSession:Ae,availableSessions:J,deleteSession:Ie,resumeSession:Fe}=ks(),{isOnline:B,isSyncing:V,unsyncedCount:X,syncNow:Te}=xs(),_=async()=>{if(!u.trim()){r.error("Por favor, ingresa el nombre del sector");return}await x(u.trim()),a("counting")},$e=async s=>{try{const m=await ce(s);m?(C(m),g(s),r.success(`Producto encontrado: ${m.name}`)):(g(s),r.warning("Producto no encontrado en la base de datos",{description:"Puedes agregarlo manualmente"}))}catch(m){console.error("Error fetching product:",m),r.error("Error al buscar el producto")}},Z=async()=>{if(!h.trim()){r.error("Por favor, ingresa o escanea un código EAN");return}const s=parseInt(w,10);if(isNaN(s)||s<=0){r.error("Por favor, ingresa una cantidad válida");return}let m=j==null?void 0:j.name;if(!m)try{const f=await ce(h.trim());f&&(m=f.name)}catch(f){console.error("Error fetching product by EAN:",f)}m||(m=`Producto ${h}`),await E(h,m,s),g(""),S("1"),C(null),setTimeout(()=>{var f;(f=document.getElementById("smart-search-input"))==null||f.focus()},10)},Oe=async()=>{if(k.length===0){r.error("No hay productos para finalizar");return}await Ae(),l("/stock")},He=()=>{if(k.length===0){r.error("No hay productos para exportar");return}try{const s=new fs,m=s.internal.pageSize.getWidth(),f=s.internal.pageSize.getHeight(),N=10,Q=3,Y=3,L=(m-N*2-Y*(Q-1))/Q,R=28;let D=N,z=N+15;s.setFontSize(14),s.text(`Pre-Conteo: ${u}`,N,N+5),s.setFontSize(8),s.text(`Fecha: ${new Date().toLocaleDateString()}`,m-N-30,N+5),k.forEach((q,Re)=>{z+R>f-N&&(s.addPage(),z=N),s.setDrawColor(200),s.setLineWidth(.1),s.roundedRect(D,z,L,R,2,2,"S");const ee=L-4,qe=D+2,We=z+5;s.setFontSize(9),s.setFont("helvetica","bold");let W=q.productName;if(s.getTextWidth(W)>ee){const A=Math.floor(ee/2);W=W.substring(0,A)+"..."}s.text(W,qe,We);const Me=L*.65,Ue=15,se=D+2,te=z+8,K=document.createElement("canvas");try{const A={displayValue:!0,fontSize:14,fontOptions:"bold",margin:0,height:40,width:2,background:"#ffffff",lineColor:"#000000",textMargin:0};try{xe(K,q.ean,{...A,format:"EAN13"})}catch{xe(K,q.ean,{...A,format:"CODE128"})}const Qe=K.toDataURL("image/png");s.addImage(Qe,"PNG",se,te,Me,Ue)}catch(A){console.error("Error generating barcode:",A),s.setFontSize(8),s.setTextColor(255,0,0),s.text("Error Barcode",se,te+10),s.setTextColor(0,0,0)}const ae=D+L-2,re=z+R-6;s.setFontSize(24),s.setFont("helvetica","bold"),s.text(q.quantity.toString(),ae,re,{align:"right"}),s.setFontSize(6),s.setFont("helvetica","normal"),s.setTextColor(100),s.text("CANT",ae,re-10,{align:"right"}),s.setTextColor(0),(Re+1)%Q===0?(D=N,z+=R+Y):D+=L+Y});const Le=`PreConteo_${u}_${new Date().toISOString().split("T")[0]}.pdf`;s.save(Le),r.success("PDF generado correctamente")}catch(s){console.error("Error generating PDF:",s),r.error("Error al generar el PDF")}},Be=()=>e.jsx("div",{className:"max-w-5xl mx-auto space-y-8 animate-in fade-in duration-500",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[e.jsxs(F,{className:"border-muted/50 shadow-lg overflow-hidden relative group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-primary/20 group-hover:bg-primary transition-colors"}),e.jsxs(de,{className:"p-6 md:p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-primary",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-xl",children:e.jsx(pe,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Nueva Sesión"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Crea un nuevo espacio de trabajo para comenzar a escanear productos en un sector específico."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground ml-1",children:"Nombre del Sector"}),e.jsx(G,{value:u,onChange:s=>v(s.target.value),placeholder:"Ej: Estantería A1 - Farmacia",className:"h-12 text-lg bg-muted/30 border-muted-foreground/20 focus:border-primary transition-all",autoFocus:!0,onKeyDown:s=>s.key==="Enter"&&_()})]}),e.jsx(y,{className:"w-full h-12 text-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:_,disabled:!u.trim()||d,children:d?"Iniciando...":"Comenzar Control"})]})]})]}),e.jsxs(F,{className:"border-muted/50 shadow-lg h-full",children:[e.jsx(ds,{className:"pb-4 border-b border-border/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-secondary rounded-lg text-secondary-foreground",children:e.jsx(Ns,{className:"w-5 h-5"})}),e.jsx(ms,{className:"text-lg",children:"Sesiones Abiertas"})]})}),e.jsx(de,{className:"p-0",children:J.length===0?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:e.jsx("p",{children:"No hay sesiones activas"})}):e.jsx("div",{className:"divide-y divide-border/50 max-h-[400px] overflow-y-auto",children:J.map(s=>e.jsxs("div",{className:"p-4 hover:bg-muted/30 transition-colors flex items-center justify-between group",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-lg leading-none group-hover:text-primary transition-colors",children:s.sector}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(vs,{className:"w-3 h-3"}),e.jsx("span",{children:Ss(new Date(s.startTime),"d MMM yyyy, HH:mm",{locale:bs})})]}),e.jsxs("div",{className:"flex gap-3 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:"bg-primary/5 px-2 py-0.5 rounded text-primary font-medium",children:[s.totalProducts||0," prod."]}),e.jsxs("span",{className:"bg-secondary px-2 py-0.5 rounded text-secondary-foreground font-medium",children:[s.totalUnits||0," unid."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10",onClick:()=>Ie(s.id),title:"Eliminar sesión",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsxs(y,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",onClick:()=>{Fe(s),a("counting")},children:["Retomar",e.jsx(ws,{className:"w-4 h-4"})]})]})]},s.id))})})]})]})});return d?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(I.div,{className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsx(M,{mode:"wait",children:n==="config"?e.jsxs(I.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"p-4 md:p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex justify-end mb-4",children:B?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-success/10 text-success rounded-full text-sm",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"En línea"})]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-warning/10 text-warning rounded-full text-sm",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Sin conexión"})]})}),Be()]},"config"):e.jsxs(I.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"p-4 md:p-6 space-y-4 max-w-7xl mx-auto",children:[e.jsx(F,{className:"min-h-[120px] flex flex-col justify-center px-6 sm:px-8 bg-gradient-to-br from-secondary/40 to-secondary/20 border-muted/50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0",children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground uppercase tracking-widest font-bold whitespace-nowrap",children:"Sector"}),e.jsx("span",{className:"font-bold text-foreground text-lg sm:text-xl truncate",children:$==null?void 0:$.sector})]}),e.jsx("div",{className:"h-10 sm:h-12 w-px bg-border/40 flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-8 sm:gap-12 flex-1 justify-center",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground uppercase tracking-widest font-bold whitespace-nowrap",children:"Productos"}),e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary",children:e.jsx(me,{value:t,digits:4})})]}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground uppercase tracking-widest font-bold whitespace-nowrap",children:"Unidades"}),e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:e.jsx(me,{value:o,digits:4})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[X>0&&e.jsxs(y,{onClick:Te,disabled:!B||V,variant:"ghost",size:"sm",className:"h-8 px-2 text-xs gap-1.5 text-warning hover:text-warning hover:bg-warning/10",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-warning animate-pulse"}),V?"Sincronizando":`${X} Pend.`]}),e.jsx("div",{className:`p-2 rounded-full ${B?"bg-success/10 text-success":"bg-warning/10 text-warning"}`,title:B?"En línea":"Sin conexión",children:B?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(ie,{className:"w-4 h-4"})})]})]})}),e.jsx(F,{className:"p-2 sm:p-3 shadow-md border-primary/20 bg-card/80 backdrop-blur-sm relative z-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("div",{className:"flex-1 relative z-20",children:e.jsx(us,{onSelect:s=>{g(s.ean),C({...s,stock:0,salePrice:0,cost:0}),setTimeout(()=>{var m,f;(m=document.getElementById("quantity-input"))==null||m.focus(),(f=document.getElementById("quantity-input"))==null||f.select()},50)},autoFocus:!0,className:"w-full"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-20",children:e.jsx(G,{id:"quantity-input",type:"number",className:"h-12 text-center text-lg font-medium bg-muted/30 border-muted-foreground/20 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all",min:"1",value:w,onChange:s=>S(s.target.value),onKeyDown:s=>{s.key==="Enter"&&Z()},placeholder:"#"})}),e.jsx(y,{variant:i?"secondary":"outline",size:"icon",className:"h-12 w-12 border-dashed border-border/60 hover:border-primary/50",onClick:()=>T(!i),title:"Calculadora",children:e.jsx(ys,{className:"w-5 h-5 opacity-70"})})]}),e.jsx(y,{onClick:Z,size:"lg",className:"h-12 px-6 text-lg shadow-sm font-bold tracking-wide",disabled:!h.trim(),children:e.jsx(pe,{className:"w-6 h-6"})})]})]}),e.jsx(M,{children:i&&e.jsx(I.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border rounded-lg bg-muted/20",children:e.jsx(gs,{onResult:U,onClose:()=>T(!1)})})}),e.jsx(M,{children:j&&e.jsxs(I.div,{initial:{opacity:0,height:0,scale:.95},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0},className:"bg-primary/5 rounded border border-primary/10 flex items-center justify-between p-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(le,{className:"w-4 h-4 text-primary shrink-0"}),e.jsxs("div",{className:"min-w-0 flex flex-col sm:flex-row sm:items-baseline gap-1",children:[e.jsx("span",{className:"font-semibold text-foreground text-sm truncate",children:j.name}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-mono truncate",children:j.ean})]})]}),e.jsx(y,{size:"sm",variant:"ghost",className:"h-6 text-[10px] px-2 text-muted-foreground hover:text-destructive",onClick:()=>{C(null),g("")},children:"Limpiar"})]})})]})}),e.jsxs("div",{className:"space-y-2 relative z-10",children:[e.jsx("div",{className:"flex items-center justify-between px-1",children:e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:["Historial (",t,")"]})}),e.jsx(Ps,{items:k,onUpdate:O,onDelete:H})]})]},"counting")})}),k.length>0&&n==="counting"&&e.jsx(js,{actions:[{label:"Finalizar",icon:e.jsx(le,{className:"w-5 h-5"}),onClick:Oe,variant:"default",color:"bg-primary text-primary-foreground"},{label:"Exportar PDF",icon:e.jsx(cs,{className:"w-5 h-5"}),onClick:He,variant:"secondary"}]}),e.jsx(ps,{open:p,onOpenChange:b,onScan:$e},p?"open":"closed")]})}export{et as default};
