import{j as e}from"./ui-vendor-lsEhpTbO.js";import{r as l,u as Ze,L as es}from"./react-vendor-ylmX0jv_.js";import{c as ss,a4 as ts,y as m,B as f,S as me,Y as $,g as I,n as as,a5 as rs,E as he,D as ls,q as ue,r as fe,t as ge,v as pe,$ as je,a6 as os}from"./index-UWuEarZD.js";import{I as z}from"./input-BZuQPplQ.js";import{T as M,a as G,b as v,c as h,d as Q,e as u}from"./table-al5mgoIB.js";import{T as ns,a as is,b as Y,c as X}from"./tabs-CfFh9h3J.js";import{A as cs,L as Ne,E as be}from"./jspdf.es.min-DzJbVZuX.js";import{J as ds}from"./JsBarcode-BPRqDEDi.js";import{u as T,w as xs}from"./excel-uoQkVabA.js";import ms from"./html2canvas.esm-CBrSDip1.js";import{f as hs}from"./utils-CUsTgaRG.js";import{e as us,C as K,E as ve}from"./es-DWXFbJ1T.js";import{B as Se}from"./badge-BxTW-dgm.js";import{M as fs}from"./map-pin-DiVU9Gc-.js";import"./animation-DZFErbwn.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=ss("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),ye=l.forwardRef(({report:g},B)=>{if(!g)return null;const _=g.results.allShortages.sort((o,d)=>o.diffValue-d.diffValue).slice(0,15),A=g.results.allSurpluses.sort((o,d)=>d.diffValue-o.diffValue).slice(0,15),L=g.results.allShortages.reduce((o,d)=>o+d.diffValue,0),k=g.results.allSurpluses.reduce((o,d)=>o+d.diffValue,0),p=L+k;return e.jsxs("div",{ref:B,className:"bg-white p-8 w-[800px] text-black font-sans",children:[e.jsx("div",{className:"border-b-2 border-primary pb-4 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Reporte de Inventario"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Farmaplus Gestión"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-xl font-semibold",children:g.branch}),e.jsx("p",{className:"text-gray-600",children:g.sector}),e.jsx("p",{className:"text-sm text-gray-500",children:hs(new Date(g.date),"PPP",{locale:us})})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Total Faltante"}),e.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["$",Math.abs(L).toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Sobrante"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",k.toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${p<0?"bg-orange-50 border-orange-100":"bg-blue-50 border-blue-100"}`,children:[e.jsx("p",{className:`text-sm font-medium ${p<0?"text-orange-600":"text-blue-600"}`,children:"Diferencia Neta"}),e.jsxs("p",{className:`text-2xl font-bold ${p<0?"text-orange-700":"text-blue-700"}`,children:["$",p.toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-red-700 border-l-4 border-red-500 pl-2",children:"Top 15 Faltantes (por valor)"}),e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 rounded-tl-lg",children:"Producto"}),e.jsx("th",{className:"p-2 text-right",children:"Cant."}),e.jsx("th",{className:"p-2 text-right rounded-tr-lg",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:_.map((o,d)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 truncate max-w-[250px]",children:o.name}),e.jsx("td",{className:"p-2 text-right font-medium text-red-600",children:o.diffQty}),e.jsxs("td",{className:"p-2 text-right font-medium text-red-600",children:["$",o.diffValue.toLocaleString("es-AR",{minimumFractionDigits:2})]})]},d))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-700 border-l-4 border-green-500 pl-2",children:"Top 15 Sobrantes (por valor)"}),e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 rounded-tl-lg",children:"Producto"}),e.jsx("th",{className:"p-2 text-right",children:"Cant."}),e.jsx("th",{className:"p-2 text-right rounded-tr-lg",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:A.map((o,d)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 truncate max-w-[250px]",children:o.name}),e.jsxs("td",{className:"p-2 text-right font-medium text-green-600",children:["+",o.diffQty]}),e.jsxs("td",{className:"p-2 text-right font-medium text-green-600",children:["$",o.diffValue.toLocaleString("es-AR",{minimumFractionDigits:2})]})]},d))})]})]})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-400",children:["Generado por Farmaplus PWA - ",new Date().toLocaleString()]})]})});ye.displayName="ReportTemplate";function Es(){const g=Ze(),[B,_]=l.useState("pre-count"),[A,L]=l.useState([]),[k,p]=l.useState(!0),[o,d]=l.useState(""),[S,we]=l.useState(null),[O,Ce]=l.useState([]),[Z,ee]=l.useState(!1),[De,q]=l.useState(!1),[N,se]=l.useState([]),[te,Fe]=l.useState([]),[y,Te]=l.useState(""),[w,Le]=l.useState(""),[C,ke]=l.useState(""),U=l.useRef(null),[Re,ae]=l.useState(null),[H,re]=l.useState([]),[Ee,W]=l.useState(!1),[x,Ve]=l.useState(null);l.useEffect(()=>{Pe(),ze(),He()},[]);const Pe=async()=>{try{p(!0);const a=(await ts()).filter(t=>t.endTime).sort((t,c)=>c.startTime-t.startTime);L(a)}catch(s){console.error("Error loading sessions:",s),m.error("Error al cargar el historial de pre-conteos")}finally{p(!1)}},$e=async s=>{we(s),q(!0),ee(!0);try{const a=await os(s);Ce(a)}catch(a){console.error("Error loading session items:",a),m.error("Error al cargar los detalles")}finally{ee(!1)}},le=A.filter(s=>s.sector.toLowerCase().includes(o.toLowerCase())),Ie=(s,a)=>{if(a.length===0){m.error("No hay productos para exportar");return}try{const t=new be,c=t.internal.pageSize.getWidth(),n=t.internal.pageSize.getHeight(),r=10,i=3,J=3,F=(c-r*2-J*(i-1))/i,R=28;let b=r,j=r+15;t.setFontSize(14),t.text(`Pre-Conteo: ${s.sector}`,r,r+5),t.setFontSize(8),t.text(`Fecha: ${new Date(s.startTime).toLocaleDateString()}`,c-r-30,r+5),a.forEach((E,Ge)=>{j+R>n-r&&(t.addPage(),j=r),t.setDrawColor(200),t.setLineWidth(.1),t.roundedRect(b,j,F,R,2,2,"S");const oe=F-4,Qe=b+2,Ye=j+5;t.setFontSize(9),t.setFont("helvetica","bold");let V=E.productName;if(t.getTextWidth(V)>oe){const P=Math.floor(oe/2);V=V.substring(0,P)+"..."}t.text(V,Qe,Ye);const Xe=F*.65,Ke=15,ne=b+2,ie=j+8,ce=document.createElement("canvas");try{ds(ce,E.ean,{format:"EAN13",displayValue:!0,fontSize:14,fontOptions:"bold",margin:0,height:40,width:2,background:"#ffffff",lineColor:"#000000",textMargin:0});const P=ce.toDataURL("image/png");t.addImage(P,"PNG",ne,ie,Xe,Ke)}catch{t.setFontSize(8),t.text(E.ean,ne,ie+10)}const de=b+F-2,xe=j+R-6;t.setFontSize(24),t.setFont("helvetica","bold"),t.text(E.quantity.toString(),de,xe,{align:"right"}),t.setFontSize(6),t.setFont("helvetica","normal"),t.setTextColor(100),t.text("CANT",de,xe-10,{align:"right"}),t.setTextColor(0),(Ge+1)%i===0?(b=r,j+=R+J):b+=F+J});const Me=`PreConteo_${s.sector}_${new Date(s.startTime).toISOString().split("T")[0]}.pdf`;t.save(Me),m.success("PDF generado correctamente")}catch(t){console.error("Error generating PDF:",t),m.error("Error al generar el PDF")}},ze=()=>{const s=JSON.parse(localStorage.getItem("inventory-reports")||"[]");se(s),D(s,y,w,C)},D=(s,a,t,c)=>{let n=s;a&&(n=n.filter(r=>r.name.toLowerCase().includes(a.toLowerCase())||r.branch.toLowerCase().includes(a.toLowerCase())||r.sector.toLowerCase().includes(a.toLowerCase()))),t&&(n=n.filter(r=>r.branch.toLowerCase().includes(t.toLowerCase()))),c&&(n=n.filter(r=>r.sector.toLowerCase().includes(c.toLowerCase()))),Fe(n.reverse())},Be=s=>{Te(s),D(N,s,w,C)},_e=s=>{Le(s),D(N,y,s,C)},Ae=s=>{ke(s),D(N,y,w,s)},Oe=s=>{const a=N.filter(t=>t.id!==s);se(a),localStorage.setItem("inventory-reports",JSON.stringify(a)),D(a,y,w,C),m.success("Reporte eliminado")},qe=s=>{try{const a=r=>r.map(i=>({"Código de Barras":i.codebar,Producto:i.name,"Diferencia (Unidades)":i.diffQty,"Valor Diferencia ($)":i.diffValue,"Stock Sistema":i.systemStock,"Conteo Físico":i.physicalCount,"Costo Unitario ($)":i.cost,"Precio Venta ($)":i.salePrice})),t=s.results.allShortages.sort((r,i)=>r.diffValue-i.diffValue).slice(0,15),c=s.results.allSurpluses.sort((r,i)=>i.diffValue-r.diffValue).slice(0,15),n=T.book_new();T.book_append_sheet(n,T.json_to_sheet(a(t)),"Faltantes"),T.book_append_sheet(n,T.json_to_sheet(a(c)),"Sobrantes"),xs(n,`Reporte_${s.name}_${s.date}.xlsx`),m.success("Reporte exportado correctamente")}catch{m.error("Error al exportar el reporte")}},Ue=async s=>{ae(s),setTimeout(async()=>{if(U.current)try{const a=await ms(U.current,{scale:2,backgroundColor:"#ffffff"}),t=document.createElement("a");t.download=`Reporte_${s.name}_${s.date}.png`,t.href=a.toDataURL("image/png"),t.click(),m.success("Imagen generada correctamente")}catch(a){console.error("Error generating image:",a),m.error("Error al generar la imagen")}finally{ae(null)}},100)},He=()=>{const s=JSON.parse(localStorage.getItem("expiration-reports")||"[]");re(s)},We=s=>{const a=H.filter(t=>t.id!==s);re(a),localStorage.setItem("expiration-reports",JSON.stringify(a)),m.success("Reporte eliminado")},Je=s=>{const a=new be;let t=20;a.setFontSize(16),a.text("Control de Vencimientos",10,t),a.setFontSize(10),a.text(`Sector: ${s.sector}`,10,t+6),a.text(`Responsable: ${s.responsible}`,10,t+12),a.text(`Fecha: ${new Date(s.date).toLocaleDateString()} ${new Date(s.date).toLocaleTimeString()}`,10,t+18),t+=25,s.items.forEach(c=>{t>270&&(a.addPage(),t=20),a.setFont("helvetica","bold"),a.text(`${c.productName} (EAN: ${c.ean})`,10,t),a.text(`Total: ${c.totalQuantity}`,180,t,{align:"right"}),t+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("Lote",15,t),a.text("Vencimiento",80,t),a.text("Cantidad",150,t),t+=5,c.batches.forEach(n=>{a.text(n.batchNumber,15,t),a.text(n.expirationDate||"-",80,t),a.text(n.quantity.toString(),150,t),t+=5}),t+=5}),a.save(`Vencimientos_${s.sector}.pdf`),m.success("PDF Generado")};return e.jsxs("div",{className:"flex flex-col h-full bg-background p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>g("/"),children:e.jsx(cs,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Reportes"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Historial de controles y auditorías"})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(ns,{value:B,onValueChange:_,className:"h-full flex flex-col",children:[e.jsxs(is,{className:"grid w-full grid-cols-3 max-w-[600px] mb-6 mx-auto bg-muted/50 p-1 rounded-full",children:[e.jsx(Y,{value:"pre-count",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Pre-Conteos"}),e.jsx(Y,{value:"vencimientos",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Vencimientos"}),e.jsx(Y,{value:"audits",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Auditorías"})]}),e.jsxs(X,{value:"pre-count",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs("div",{className:"relative w-full max-w-xs",children:[e.jsx(me,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:"Buscar por sector...",value:o,onChange:s=>d(s.target.value),className:"pl-9 bg-card"})]})}),e.jsx("div",{className:"flex-1 overflow-auto rounded-xl border bg-card shadow-sm",children:k?e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{children:"Cargando historial..."})]}):le.length>0?e.jsxs(M,{children:[e.jsx(G,{className:"bg-muted/30",children:e.jsxs(v,{children:[e.jsx(h,{children:"Sector"}),e.jsx(h,{children:"Fecha"}),e.jsx(h,{className:"text-right",children:"Productos"}),e.jsx(h,{className:"text-right",children:"Unidades"}),e.jsx(h,{className:"w-[100px]"})]})}),e.jsx(Q,{children:le.map(s=>e.jsxs(v,{className:"hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-primary"}),s.sector]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[e.jsx(K,{className:"w-3 h-3"}),new Date(s.startTime).toLocaleDateString()]})}),e.jsx(u,{className:"text-right font-mono text-sm",children:s.totalProducts}),e.jsx(u,{className:"text-right font-mono text-sm",children:s.totalUnits}),e.jsx(u,{children:e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>$e(s),className:"hover:text-primary",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Ver"]})})]},s.id))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-20 text-center text-muted-foreground opacity-50",children:[e.jsx($,{className:"w-16 h-16 mb-4 stroke-1"}),e.jsx("p",{children:"No hay conteos finalizados aún."})]})})]}),e.jsx(X,{value:"vencimientos",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsx("div",{className:"flex-1 overflow-auto",children:H.length===0?e.jsxs(I,{className:"p-12 text-center border-dashed bg-muted/20",children:[e.jsx(as,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium",children:"Sin controles finalizados"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Los reportes de control de vencimientos aparecerán aquí."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pb-10",children:H.map(s=>e.jsxs(I,{className:"p-5 flex flex-col gap-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.sector}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[e.jsx(K,{className:"w-3 h-3"}),new Date(s.date).toLocaleDateString(),e.jsx("span",{children:"•"}),e.jsx(rs,{className:"w-3 h-3"}),s.responsible]})]}),e.jsxs(Se,{variant:"secondary",className:"font-mono",children:[s.stats.totalUnits," u."]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Productos"}),e.jsx("span",{className:"font-medium",children:s.stats.totalProducts})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Unidades"}),e.jsx("span",{className:"font-medium",children:s.stats.totalUnits})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto pt-2",children:[e.jsxs(f,{className:"flex-1",variant:"outline",size:"sm",onClick:()=>{Ve(s),W(!0)},children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Detalles"]}),e.jsx(f,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>We(s.id),children:e.jsx(he,{className:"w-4 h-4"})})]})]},s.id))})})}),e.jsxs(X,{value:"audits",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:"Buscar reporte...",value:y,onChange:s=>Be(s.target.value),className:"pl-9 bg-card"})]}),e.jsx(z,{placeholder:"Filtrar por sucursal...",value:w,onChange:s=>_e(s.target.value),className:"bg-card"}),e.jsx(z,{placeholder:"Filtrar por sector...",value:C,onChange:s=>Ae(s.target.value),className:"bg-card"})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:te.length===0?e.jsxs(I,{className:"p-12 text-center border-dashed bg-muted/20",children:[e.jsx($,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium text-foreground",children:N.length===0?"Sin reportes aún":"Sin resultados"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:N.length===0?"Los reportes de 'Importar Inventario' aparecerán aquí":"Intenta con otros filtros de búsqueda"})]}):e.jsx("div",{className:"space-y-3 pb-10",children:te.map(s=>e.jsx(es,{to:`/reports/${s.id}`,className:"block group",children:e.jsx(I,{className:"p-4 cursor-pointer hover:shadow-md transition-all border-l-4 border-l-primary/0 hover:border-l-primary",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground group-hover:text-primary transition-colors",children:s.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:s.branch})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:s.sector})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("es-ES")})]})]})]}),e.jsxs("div",{className:"flex gap-2",onClick:a=>a.preventDefault(),children:[e.jsx(f,{size:"sm",variant:"outline",onClick:()=>Ue(s),className:"hover:bg-primary hover:text-primary-foreground",title:"Exportar como Imagen",children:e.jsx(gs,{className:"h-4 w-4"})}),e.jsx(f,{size:"sm",variant:"outline",onClick:()=>qe(s),className:"hover:bg-success hover:text-success-foreground",title:"Exportar Excel",children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx(f,{size:"sm",variant:"outline",onClick:()=>Oe(s.id),className:"hover:bg-destructive hover:text-destructive-foreground",title:"Eliminar",children:e.jsx(he,{className:"h-4 w-4"})})]})]})})},s.id))})})]})]})}),e.jsx(ue,{open:De,onOpenChange:q,children:e.jsxs(fe,{className:"sm:max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(ge,{children:[e.jsx(pe,{children:"Detalle del Pre-Conteo"}),e.jsx(je,{children:S&&e.jsxs("span",{children:["Sector: ",e.jsx("strong",{children:S.sector})," - Fecha: ",new Date(S.startTime).toLocaleString()]})})]}),e.jsx("div",{className:"flex-1 overflow-auto min-h-[300px] border rounded-md",children:Z?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(M,{children:[e.jsx(G,{className:"sticky top-0 bg-background",children:e.jsxs(v,{children:[e.jsx(h,{children:"EAN"}),e.jsx(h,{children:"Producto"}),e.jsx(h,{className:"text-right",children:"Cant."})]})}),e.jsx(Q,{children:O.map(s=>e.jsxs(v,{children:[e.jsx(u,{className:"font-mono text-xs",children:s.ean}),e.jsx(u,{className:"text-sm",children:s.productName}),e.jsx(u,{className:"text-right font-bold",children:s.quantity})]},s.id))})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-auto",children:[e.jsxs(f,{variant:"outline",onClick:()=>S&&Ie(S,O),disabled:Z||O.length===0,children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Descargar PDF"]}),e.jsx(f,{onClick:()=>q(!1),children:"Cerrar"})]})]})}),e.jsx(ue,{open:Ee,onOpenChange:W,children:e.jsxs(fe,{className:"sm:max-w-3xl max-h-[90vh] flex flex-col",children:[e.jsxs(ge,{children:[e.jsxs(pe,{className:"flex justify-between items-center mr-6",children:[e.jsx("span",{children:"Reporte Vencimientos"}),e.jsx(Se,{variant:"outline",children:x==null?void 0:x.sector})]}),e.jsxs(je,{children:[e.jsxs("div",{children:["Fecha: ",x&&new Date(x.date).toLocaleString()]}),e.jsxs("div",{children:["Responsable: ",x==null?void 0:x.responsible]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto border rounded-xl bg-card p-0",children:e.jsxs(M,{children:[e.jsx(G,{className:"sticky top-0 bg-background z-10",children:e.jsxs(v,{children:[e.jsx(h,{children:"Producto"}),e.jsx(h,{children:"Lote"}),e.jsx(h,{children:"Vencimiento"}),e.jsx(h,{className:"text-right",children:"Cant."})]})}),e.jsx(Q,{children:x==null?void 0:x.items.map(s=>s.batches.map((a,t)=>e.jsxs(v,{children:[e.jsx(u,{className:"font-medium text-xs",children:t===0&&e.jsxs("div",{children:[e.jsx("div",{children:s.productName}),e.jsx("span",{className:"text-muted-foreground text-[10px]",children:s.ean})]})}),e.jsx(u,{className:"font-mono text-xs",children:a.batchNumber}),e.jsx(u,{className:"font-mono text-xs",children:a.expirationDate}),e.jsx(u,{className:"text-right font-bold",children:a.quantity})]},s.id+t)))})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-auto",children:[e.jsxs(f,{variant:"outline",onClick:()=>x&&Je(x),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Descargar PDF"]}),e.jsx(f,{onClick:()=>W(!1),children:"Cerrar"})]})]})}),e.jsx("div",{className:"fixed left-[-9999px] top-0",children:e.jsx(ye,{ref:U,report:Re})})]})}export{Es as default};
