import{c as g,r as n,j as s,M as B,N as V,B as N,H as D,O as M,G as p}from"./index-C8W0ga7e.js";import{C as y}from"./card-BmO70aqc.js";import{I as f}from"./input-1qsLHJCP.js";import{u as m,w as E}from"./xlsx-uoQkVabA.js";import{S as I}from"./search-DQ6cWLm2.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=g("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=g("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=g("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function U(){const[l,j]=n.useState([]),[v,S]=n.useState([]),[i,w]=n.useState(""),[d,C]=n.useState(""),[h,k]=n.useState("");n.useEffect(()=>{const e=JSON.parse(localStorage.getItem("inventory-reports")||"[]");j(e),u(e,i,d,h)},[]);const u=(e,t,c,x)=>{let o=e;t&&(o=o.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.branch.toLowerCase().includes(t.toLowerCase())||a.sector.toLowerCase().includes(t.toLowerCase()))),c&&(o=o.filter(a=>a.branch.toLowerCase().includes(c.toLowerCase()))),x&&(o=o.filter(a=>a.sector.toLowerCase().includes(x.toLowerCase()))),S(o.reverse())},b=e=>{w(e),u(l,e,d,h)},L=e=>{C(e),u(l,i,e,h)},F=e=>{k(e),u(l,i,d,e)},_=e=>{const t=l.filter(c=>c.id!==e);j(t),localStorage.setItem("inventory-reports",JSON.stringify(t)),u(t,i,d,h),p.success("Reporte eliminado")},R=e=>{try{const t=a=>a.map(r=>({"Código de Barras":r.codebar,Producto:r.name,"Diferencia (Unidades)":r.diffQty,"Valor Diferencia ($)":r.diffValue,"Stock Sistema":r.systemStock,"Conteo Físico":r.physicalCount,"Costo Unitario ($)":r.cost,"Precio Venta ($)":r.salePrice})),c=e.results.allShortages.sort((a,r)=>a.diffValue-r.diffValue).slice(0,15),x=e.results.allSurpluses.sort((a,r)=>r.diffValue-a.diffValue).slice(0,15),o=m.book_new();m.book_append_sheet(o,m.json_to_sheet(t(c)),"Faltantes"),m.book_append_sheet(o,m.json_to_sheet(t(x)),"Sobrantes"),E(o,`Reporte_${e.name}_${e.date}.xlsx`),p.success("Reporte exportado correctamente")}catch{p.error("Error al exportar el reporte")}};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Reportes"}),s.jsx("p",{className:"text-muted-foreground",children:"Historial de auditorías y reportes de inventario generados"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(I,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(f,{placeholder:"Buscar reporte...",value:i,onChange:e=>b(e.target.value),className:"pl-8"})]}),s.jsx(f,{placeholder:"Filtrar por sucursal...",value:d,onChange:e=>L(e.target.value)}),s.jsx(f,{placeholder:"Filtrar por sector...",value:h,onChange:e=>F(e.target.value)})]}),v.length===0?s.jsxs(y,{className:"p-12 text-center",children:[s.jsx(B,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-foreground",children:l.length===0?"Sin reportes aún":"Sin resultados"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l.length===0?"Los reportes que generes aparecerán aquí":"Intenta con otros filtros de búsqueda"})]}):s.jsx("div",{className:"space-y-3",children:v.map(e=>s.jsx(V,{to:`/reports/${e.id}`,className:"block hover:bg-muted/50 rounded-lg transition-colors",children:s.jsx(y,{className:"p-4 cursor-pointer",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-foreground",children:e.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(P,{className:"h-4 w-4"}),s.jsx("span",{children:e.branch})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(q,{className:"h-4 w-4"}),s.jsx("span",{children:e.sector})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($,{className:"h-4 w-4"}),s.jsx("span",{children:new Date(e.date).toLocaleDateString("es-ES")})]})]})]}),s.jsxs("div",{className:"flex gap-2",onClick:t=>t.preventDefault(),children:[s.jsx(N,{size:"sm",variant:"outline",onClick:()=>R(e),className:"hover:bg-success hover:text-success-foreground",children:s.jsx(D,{className:"h-4 w-4"})}),s.jsx(N,{size:"sm",variant:"outline",onClick:()=>_(e.id),className:"hover:bg-destructive hover:text-destructive-foreground",children:s.jsx(M,{className:"h-4 w-4"})})]})]})})},e.id))})]})}export{U as default};
