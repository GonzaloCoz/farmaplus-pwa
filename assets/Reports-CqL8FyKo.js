import{j as e}from"./ui-vendor-Bx5BjJRa.js";import{r as l,u as Ke,L as Ze}from"./react-vendor-ylmX0jv_.js";import{c as es,aj as ss,y as m,O as ts,S as xe,aa as me,B as g,a6 as P,i as $,p as as,ak as rs,h as he,V as ue,A as ls,q as fe,r as ge,t as pe,v as je,M as Ne,al as os}from"./index-D3hGVEr9.js";import{I}from"./input-xB-RaK2u.js";import{T as J,a as M,b as v,c as h,d as G,e as u}from"./table-Cfv5r2lZ.js";import{T as ns,a as is,b as Q,c as X}from"./tabs-BqJabdcE.js";import{E as be}from"./jspdf.es.min-BWv_GI5p.js";import{J as cs}from"./JsBarcode-BPRqDEDi.js";import{u as T,w as ds}from"./excel-uoQkVabA.js";import xs from"./html2canvas.esm-CBrSDip1.js";import{f as ms}from"./utils-Cem6hW2W.js";import{e as hs}from"./es-CtQxi55C.js";import{C as Y}from"./calendar-BW-a5hLB.js";import{E as ve}from"./eye-CGWuMscC.js";import{M as us}from"./map-pin-BkUx-z_G.js";import"./animation-B_tN6Csa.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=es("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Se=l.forwardRef(({report:f},z)=>{if(!f)return null;const O=f.results.allShortages.sort((o,n)=>o.diffValue-n.diffValue).slice(0,15),_=f.results.allSurpluses.sort((o,n)=>n.diffValue-o.diffValue).slice(0,15),L=f.results.allShortages.reduce((o,n)=>o+n.diffValue,0),S=f.results.allSurpluses.reduce((o,n)=>o+n.diffValue,0),p=L+S;return e.jsxs("div",{ref:z,className:"bg-white p-8 w-[800px] text-black font-sans",children:[e.jsx("div",{className:"border-b-2 border-primary pb-4 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Reporte de Inventario"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Farmaplus Gestión"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-xl font-semibold",children:f.branch}),e.jsx("p",{className:"text-gray-600",children:f.sector}),e.jsx("p",{className:"text-sm text-gray-500",children:ms(new Date(f.date),"PPP",{locale:hs})})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Total Faltante"}),e.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["$",Math.abs(L).toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Sobrante"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",S.toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${p<0?"bg-orange-50 border-orange-100":"bg-blue-50 border-blue-100"}`,children:[e.jsx("p",{className:`text-sm font-medium ${p<0?"text-orange-600":"text-blue-600"}`,children:"Diferencia Neta"}),e.jsxs("p",{className:`text-2xl font-bold ${p<0?"text-orange-700":"text-blue-700"}`,children:["$",p.toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-red-700 border-l-4 border-red-500 pl-2",children:"Top 15 Faltantes (por valor)"}),e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 rounded-tl-lg",children:"Producto"}),e.jsx("th",{className:"p-2 text-right",children:"Cant."}),e.jsx("th",{className:"p-2 text-right rounded-tr-lg",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:O.map((o,n)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 truncate max-w-[250px]",children:o.name}),e.jsx("td",{className:"p-2 text-right font-medium text-red-600",children:o.diffQty}),e.jsxs("td",{className:"p-2 text-right font-medium text-red-600",children:["$",o.diffValue.toLocaleString("es-AR",{minimumFractionDigits:2})]})]},n))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-700 border-l-4 border-green-500 pl-2",children:"Top 15 Sobrantes (por valor)"}),e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 rounded-tl-lg",children:"Producto"}),e.jsx("th",{className:"p-2 text-right",children:"Cant."}),e.jsx("th",{className:"p-2 text-right rounded-tr-lg",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:_.map((o,n)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 truncate max-w-[250px]",children:o.name}),e.jsxs("td",{className:"p-2 text-right font-medium text-green-600",children:["+",o.diffQty]}),e.jsxs("td",{className:"p-2 text-right font-medium text-green-600",children:["$",o.diffValue.toLocaleString("es-AR",{minimumFractionDigits:2})]})]},n))})]})]})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-400",children:["Generado por Farmaplus PWA - ",new Date().toLocaleString()]})]})});Se.displayName="ReportTemplate";function Rs(){Ke();const[f,z]=l.useState("pre-count"),[O,_]=l.useState([]),[L,S]=l.useState(!0),[p,o]=l.useState(""),[n,ye]=l.useState(null),[B,we]=l.useState([]),[K,Z]=l.useState(!1),[Ce,A]=l.useState(!1),[N,ee]=l.useState([]),[se,De]=l.useState([]),[y,Fe]=l.useState(""),[w,Te]=l.useState(""),[C,Le]=l.useState(""),q=l.useRef(null),[Ee,te]=l.useState(null),[U,ae]=l.useState([]),[ke,W]=l.useState(!1),[x,Re]=l.useState(null);l.useEffect(()=>{Ve(),Ie(),Ue()},[]);const Ve=async()=>{try{S(!0);const a=(await ss()).filter(t=>t.endTime).sort((t,d)=>d.startTime-t.startTime);_(a)}catch(s){console.error("Error loading sessions:",s),m.error("Error","Error al cargar el historial de pre-conteos")}finally{S(!1)}},Pe=async s=>{ye(s),A(!0),Z(!0);try{const a=await os(s);we(a)}catch(a){console.error("Error loading session items:",a),m.error("Error","Error al cargar los detalles")}finally{Z(!1)}},re=O.filter(s=>s.sector.toLowerCase().includes(p.toLowerCase())),$e=(s,a)=>{if(a.length===0){m.error("Error","No hay productos para exportar");return}try{const t=new be,d=t.internal.pageSize.getWidth(),i=t.internal.pageSize.getHeight(),r=10,c=3,H=3,F=(d-r*2-H*(c-1))/c,E=28;let b=r,j=r+15;t.setFontSize(14),t.text(`Pre-Conteo: ${s.sector}`,r,r+5),t.setFontSize(8),t.text(`Fecha: ${new Date(s.startTime).toLocaleDateString()}`,d-r-30,r+5),a.forEach((k,Me)=>{j+E>i-r&&(t.addPage(),j=r),t.setDrawColor(200),t.setLineWidth(.1),t.roundedRect(b,j,F,E,2,2,"S");const le=F-4,Ge=b+2,Qe=j+5;t.setFontSize(9),t.setFont("helvetica","bold");let R=k.productName;if(t.getTextWidth(R)>le){const V=Math.floor(le/2);R=R.substring(0,V)+"..."}t.text(R,Ge,Qe);const Xe=F*.65,Ye=15,oe=b+2,ne=j+8,ie=document.createElement("canvas");try{cs(ie,k.ean,{format:"CODE128",displayValue:!0,fontSize:14,fontOptions:"bold",margin:0,height:40,width:2,background:"#ffffff",lineColor:"#000000",textMargin:0});const V=ie.toDataURL("image/png");t.addImage(V,"PNG",oe,ne,Xe,Ye)}catch{t.setFontSize(8),t.text(k.ean,oe,ne+10)}const ce=b+F-2,de=j+E-6;t.setFontSize(24),t.setFont("helvetica","bold"),t.text(k.quantity.toString(),ce,de,{align:"right"}),t.setFontSize(6),t.setFont("helvetica","normal"),t.setTextColor(100),t.text("CANT",ce,de-10,{align:"right"}),t.setTextColor(0),(Me+1)%c===0?(b=r,j+=E+H):b+=F+H});const Je=`PreConteo_${s.sector}_${new Date(s.startTime).toISOString().split("T")[0]}.pdf`;t.save(Je),m.success("Operación exitosa","PDF generado correctamente")}catch(t){console.error("Error generating PDF:",t),m.error("Error","Error al generar el PDF")}},Ie=()=>{const s=JSON.parse(localStorage.getItem("inventory-reports")||"[]");ee(s),D(s,y,w,C)},D=(s,a,t,d)=>{let i=s;a&&(i=i.filter(r=>r.name.toLowerCase().includes(a.toLowerCase())||r.branch.toLowerCase().includes(a.toLowerCase())||r.sector.toLowerCase().includes(a.toLowerCase()))),t&&(i=i.filter(r=>r.branch.toLowerCase().includes(t.toLowerCase()))),d&&(i=i.filter(r=>r.sector.toLowerCase().includes(d.toLowerCase()))),De(i.reverse())},ze=s=>{Fe(s),D(N,s,w,C)},Oe=s=>{Te(s),D(N,y,s,C)},_e=s=>{Le(s),D(N,y,w,s)},Be=s=>{const a=N.filter(t=>t.id!==s);ee(a),localStorage.setItem("inventory-reports",JSON.stringify(a)),D(a,y,w,C),m.success("Operación exitosa","Reporte eliminado")},Ae=s=>{try{const a=r=>r.map(c=>({"Código de Barras":c.codebar,Producto:c.name,"Diferencia (Unidades)":c.diffQty,"Valor Diferencia ($)":c.diffValue,"Stock Sistema":c.systemStock,"Conteo Físico":c.physicalCount,"Costo Unitario ($)":c.cost,"Precio Venta ($)":c.salePrice})),t=s.results.allShortages.sort((r,c)=>r.diffValue-c.diffValue).slice(0,15),d=s.results.allSurpluses.sort((r,c)=>c.diffValue-r.diffValue).slice(0,15),i=T.book_new();T.book_append_sheet(i,T.json_to_sheet(a(t)),"Faltantes"),T.book_append_sheet(i,T.json_to_sheet(a(d)),"Sobrantes"),ds(i,`Reporte_${s.name}_${s.date}.xlsx`),m.success("Operación exitosa","Reporte exportado correctamente")}catch{m.error("Error","Error al exportar el reporte")}},qe=async s=>{te(s),setTimeout(async()=>{if(q.current)try{const a=await xs(q.current,{scale:2,backgroundColor:"#ffffff"}),t=document.createElement("a");t.download=`Reporte_${s.name}_${s.date}.png`,t.href=a.toDataURL("image/png"),t.click(),m.success("Operación exitosa","Imagen generada correctamente")}catch(a){console.error("Error generating image:",a),m.error("Error","Error al generar la imagen")}finally{te(null)}},100)},Ue=()=>{const s=JSON.parse(localStorage.getItem("expiration-reports")||"[]");ae(s)},We=s=>{const a=U.filter(t=>t.id!==s);ae(a),localStorage.setItem("expiration-reports",JSON.stringify(a)),m.success("Operación exitosa","Reporte eliminado")},He=s=>{const a=new be;let t=20;a.setFontSize(16),a.text("Control de Vencimientos",10,t),a.setFontSize(10),a.text(`Sector: ${s.sector}`,10,t+6),a.text(`Responsable: ${s.responsible}`,10,t+12),a.text(`Fecha: ${new Date(s.date).toLocaleDateString()} ${new Date(s.date).toLocaleTimeString()}`,10,t+18),t+=25,s.items.forEach(d=>{t>270&&(a.addPage(),t=20),a.setFont("helvetica","bold"),a.text(`${d.productName} (EAN: ${d.ean})`,10,t),a.text(`Total: ${d.totalQuantity}`,180,t,{align:"right"}),t+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("Lote",15,t),a.text("Vencimiento",80,t),a.text("Cantidad",150,t),t+=5,d.batches.forEach(i=>{a.text(i.batchNumber,15,t),a.text(i.expirationDate||"-",80,t),a.text(i.quantity.toString(),150,t),t+=5}),t+=5}),a.save(`Vencimientos_${s.sector}.pdf`),m.success("Operación exitosa","PDF Generado")};return e.jsx(ts,{children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(ns,{value:f,onValueChange:z,className:"h-full flex flex-col",children:[e.jsxs(is,{className:"grid w-full grid-cols-3 max-w-[600px] mb-6 mx-auto bg-muted/50 p-1 rounded-full",children:[e.jsx(Q,{value:"pre-count",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Pre-Conteos"}),e.jsx(Q,{value:"vencimientos",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Vencimientos"}),e.jsx(Q,{value:"audits",className:"rounded-full data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Auditorías"})]}),e.jsxs(X,{value:"pre-count",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs("div",{className:"relative w-full max-w-xs",children:[e.jsx(xe,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Buscar por sector...",value:p,onChange:s=>o(s.target.value),className:"pl-9 bg-card"})]})}),e.jsx("div",{className:"flex-1 overflow-auto rounded-xl border bg-card shadow-sm",children:L?e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{children:"Cargando historial..."})]}):re.length>0?e.jsxs(J,{children:[e.jsx(M,{className:"bg-muted/30",children:e.jsxs(v,{children:[e.jsx(h,{children:"Sector"}),e.jsx(h,{children:"Fecha"}),e.jsx(h,{className:"text-right",children:"Productos"}),e.jsx(h,{className:"text-right",children:"Unidades"}),e.jsx(h,{className:"w-[100px]"})]})}),e.jsx(G,{children:re.map(s=>e.jsxs(v,{className:"hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-primary"}),s.sector]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[e.jsx(Y,{className:"w-3 h-3"}),new Date(s.startTime).toLocaleDateString()]})}),e.jsx(u,{className:"text-right font-mono text-sm",children:s.totalProducts}),e.jsx(u,{className:"text-right font-mono text-sm",children:s.totalUnits}),e.jsx(u,{children:e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>Pe(s),className:"hover:text-primary",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Ver"]})})]},s.id))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-20 text-center text-muted-foreground opacity-50",children:[e.jsx(P,{className:"w-16 h-16 mb-4 stroke-1"}),e.jsx("p",{children:"No hay conteos finalizados aún."})]})})]}),e.jsx(X,{value:"vencimientos",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsx("div",{className:"flex-1 overflow-auto",children:U.length===0?e.jsxs($,{className:"p-12 text-center border-dashed bg-muted/20",children:[e.jsx(as,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium",children:"Sin controles finalizados"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Los reportes de control de vencimientos aparecerán aquí."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pb-10",children:U.map(s=>e.jsxs($,{className:"p-5 flex flex-col gap-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.sector}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[e.jsx(Y,{className:"w-3 h-3"}),new Date(s.date).toLocaleDateString(),e.jsx("span",{children:"•"}),e.jsx(rs,{className:"w-3 h-3"}),s.responsible]})]}),e.jsxs(he,{variant:"secondary",className:"font-mono",children:[s.stats.totalUnits," u."]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Productos"}),e.jsx("span",{className:"font-medium",children:s.stats.totalProducts})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Unidades"}),e.jsx("span",{className:"font-medium",children:s.stats.totalUnits})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto pt-2",children:[e.jsxs(g,{className:"flex-1",variant:"outline",size:"sm",onClick:()=>{Re(s),W(!0)},children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Detalles"]}),e.jsx(g,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>We(s.id),children:e.jsx(ue,{className:"w-4 h-4"})})]})]},s.id))})})}),e.jsxs(X,{value:"audits",className:"flex-1 overflow-hidden flex flex-col data-[state=inactive]:hidden motion-safe:animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Buscar reporte...",value:y,onChange:s=>ze(s.target.value),className:"pl-9 bg-card"})]}),e.jsx(I,{placeholder:"Filtrar por sucursal...",value:w,onChange:s=>Oe(s.target.value),className:"bg-card"}),e.jsx(I,{placeholder:"Filtrar por sector...",value:C,onChange:s=>_e(s.target.value),className:"bg-card"})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:se.length===0?e.jsxs($,{className:"p-12 text-center border-dashed bg-muted/20",children:[e.jsx(P,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium text-foreground",children:N.length===0?"Sin reportes aún":"Sin resultados"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:N.length===0?"Los reportes de 'Importar Inventario' aparecerán aquí":"Intenta con otros filtros de búsqueda"})]}):e.jsx("div",{className:"space-y-3 pb-10",children:se.map(s=>e.jsx(Ze,{to:`/reports/${s.id}`,className:"block group",children:e.jsx($,{className:"p-4 cursor-pointer hover:shadow-md transition-all border-l-4 border-l-primary/0 hover:border-l-primary",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground group-hover:text-primary transition-colors",children:s.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsx("span",{children:s.branch})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:s.sector})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("es-ES")})]})]})]}),e.jsxs("div",{className:"flex gap-2",onClick:a=>a.preventDefault(),children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>qe(s),className:"hover:bg-primary hover:text-primary-foreground",title:"Exportar como Imagen",children:e.jsx(fs,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>Ae(s),className:"hover:bg-success hover:text-success-foreground",title:"Exportar Excel",children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>Be(s.id),className:"hover:bg-destructive hover:text-destructive-foreground",title:"Eliminar",children:e.jsx(ue,{className:"h-4 w-4"})})]})]})})},s.id))})})]})]})}),e.jsx(fe,{open:Ce,onOpenChange:A,children:e.jsxs(ge,{className:"sm:max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(pe,{children:[e.jsx(je,{children:"Detalle del Pre-Conteo"}),e.jsx(Ne,{children:n&&e.jsxs("span",{children:["Sector: ",e.jsx("strong",{children:n.sector})," - Fecha: ",new Date(n.startTime).toLocaleString()]})})]}),e.jsx("div",{className:"flex-1 overflow-auto min-h-[300px] border rounded-md",children:K?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(J,{children:[e.jsx(M,{className:"sticky top-0 bg-background",children:e.jsxs(v,{children:[e.jsx(h,{children:"EAN"}),e.jsx(h,{children:"Producto"}),e.jsx(h,{className:"text-right",children:"Cant."})]})}),e.jsx(G,{children:B.map(s=>e.jsxs(v,{children:[e.jsx(u,{className:"font-mono text-xs",children:s.ean}),e.jsx(u,{className:"text-sm",children:s.productName}),e.jsx(u,{className:"text-right font-bold",children:s.quantity})]},s.id))})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-auto",children:[e.jsxs(g,{variant:"outline",onClick:()=>n&&$e(n,B),disabled:K||B.length===0,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Descargar PDF"]}),e.jsx(g,{onClick:()=>A(!1),children:"Cerrar"})]})]})}),e.jsx(fe,{open:ke,onOpenChange:W,children:e.jsxs(ge,{className:"sm:max-w-3xl max-h-[90vh] flex flex-col",children:[e.jsxs(pe,{children:[e.jsxs(je,{className:"flex justify-between items-center mr-6",children:[e.jsx("span",{children:"Reporte Vencimientos"}),e.jsx(he,{variant:"outline",children:x==null?void 0:x.sector})]}),e.jsxs(Ne,{children:[e.jsxs("div",{children:["Fecha: ",x&&new Date(x.date).toLocaleString()]}),e.jsxs("div",{children:["Responsable: ",x==null?void 0:x.responsible]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto border rounded-xl bg-card p-0",children:e.jsxs(J,{children:[e.jsx(M,{className:"sticky top-0 bg-background z-10",children:e.jsxs(v,{children:[e.jsx(h,{children:"Producto"}),e.jsx(h,{children:"Lote"}),e.jsx(h,{children:"Vencimiento"}),e.jsx(h,{className:"text-right",children:"Cant."})]})}),e.jsx(G,{children:x==null?void 0:x.items.map(s=>s.batches.map((a,t)=>e.jsxs(v,{children:[e.jsx(u,{className:"font-medium text-xs",children:t===0&&e.jsxs("div",{children:[e.jsx("div",{children:s.productName}),e.jsx("span",{className:"text-muted-foreground text-[10px]",children:s.ean})]})}),e.jsx(u,{className:"font-mono text-xs",children:a.batchNumber}),e.jsx(u,{className:"font-mono text-xs",children:a.expirationDate}),e.jsx(u,{className:"text-right font-bold",children:a.quantity})]},s.id+t)))})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-auto",children:[e.jsxs(g,{variant:"outline",onClick:()=>x&&He(x),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Descargar PDF"]}),e.jsx(g,{onClick:()=>W(!1),children:"Cerrar"})]})]})}),e.jsx("div",{className:"fixed left-[-9999px] top-0",children:e.jsx(Se,{ref:q,report:Ee})})]})})}export{Rs as default};
