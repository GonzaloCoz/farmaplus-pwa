import{j as e,a0 as W,a1 as ue,a2 as xe,a3 as he,O as $,a as F,b as fe,c as Q,D as _,d as pe,f as je,e as ge,a4 as X,a5 as Z,a6 as Ne}from"./ui-vendor-CwIRxpyq.js";import{r as n,u as be}from"./react-vendor-ylmX0jv_.js";import{c as J,b as o,X as ve,ad as ye,ab as we,B as m,am as Se,R as Ce,W as ke,p as Ee,x as d,an as K,u as Ie,ao as ze,M as Pe,i as x,j as h,k as f,l as p,m as j,O as Re,I as Ae,ap as Oe,aq as De,ai as Le}from"./index-CRCrhKU4.js";import{L as l}from"./label-BdVcOHK8.js";import{S as O}from"./switch-Dfiy9-aF.js";import{W as Y}from"./wifi-Cacx2EdQ.js";import{I as Te}from"./input-DJmmUFgp.js";import{r as Be,u as Ve}from"./excel-uoQkVabA.js";import{C as qe}from"./circle-D73eJr_k.js";import{D as M}from"./database-Csvbj3kG.js";import"./utils-DNiwW225.js";import"./animation-DbfETv0H.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=J("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=J("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ee=n.forwardRef(({className:s,...a},t)=>e.jsxs(W,{ref:t,className:o("relative flex w-full touch-none select-none items-center",s),...a,children:[e.jsx(ue,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(xe,{className:"absolute h-full bg-primary"})}),e.jsx(he,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ee.displayName=W.displayName;const Ge=pe,Ue=je,Me=ge,se=n.forwardRef(({className:s,...a},t)=>e.jsx($,{className:o("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));se.displayName=$.displayName;const We=ye("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ae=n.forwardRef(({side:s="right",className:a,children:t,...r},u)=>e.jsxs(Me,{children:[e.jsx(se,{}),e.jsxs(F,{ref:u,className:o(We({side:s}),a),...r,children:[t,e.jsxs(fe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ae.displayName=F.displayName;const te=({className:s,...a})=>e.jsx("div",{className:o("flex flex-col space-y-2 text-center sm:text-left",s),...a});te.displayName="SheetHeader";const re=n.forwardRef(({className:s,...a},t)=>e.jsx(Q,{ref:t,className:o("text-lg font-semibold text-foreground",s),...a}));re.displayName=Q.displayName;const $e=n.forwardRef(({className:s,...a},t)=>e.jsx(_,{ref:t,className:o("text-sm text-muted-foreground",s),...a}));$e.displayName=_.displayName;function Fe({children:s}){const[a,t]=n.useState(!1),[r,u]=n.useState(navigator.onLine),[c,E]=n.useState([]),[g,w]=n.useState(!1);n.useEffect(()=>{const i=()=>u(!0),S=()=>u(!1);window.addEventListener("online",i),window.addEventListener("offline",S),N();const C=setInterval(N,5e3);return()=>{window.removeEventListener("online",i),window.removeEventListener("offline",S),clearInterval(C)}},[]);const N=async()=>{try{const i=await we();E(i)}catch(i){console.error("Error loading unsynced items",i)}},I=async()=>{if(!r){d.error("Error","No hay conexión a internet");return}w(!0);try{await new Promise(i=>setTimeout(i,2e3)),d.success("Operación exitosa","Sincronización completada (Simulada)"),await N()}catch{d.error("Error","Error al sincronizar")}finally{w(!1)}};return e.jsxs(Ge,{open:a,onOpenChange:t,children:[e.jsx(Ue,{asChild:!0,children:s||e.jsxs(m,{variant:"ghost",size:"icon",className:"relative",children:[r?c.length>0?e.jsx(L,{className:"h-5 w-5 text-warning"}):e.jsx(L,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(Se,{className:"h-5 w-5 text-destructive"}),c.length>0&&e.jsx("span",{className:"absolute top-1 right-1 h-2 w-2 rounded-full bg-destructive animate-pulse"})]})}),e.jsxs(ae,{side:"bottom",className:"h-[50vh] rounded-t-3xl",children:[e.jsx(te,{className:"mb-6",children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:o("h-5 w-5",g&&"animate-spin")}),"Centro de Sincronización"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:o("p-4 rounded-xl border flex items-center justify-between",r?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[r?e.jsx(Y,{className:"h-5 w-5 text-success"}):e.jsx(ke,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r?"Conectado":"Sin conexión"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r?"Listo para sincronizar":"Los cambios se guardarán localmente"})]})]})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:["Pendientes de subida (",c.length,")"]}),c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(Ee,{className:"h-12 w-12 mb-2 opacity-20"}),e.jsx("p",{children:"Todo está sincronizado"})]}):e.jsxs("div",{className:"space-y-2 max-h-[150px] overflow-auto",children:[c.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg text-sm",children:[e.jsx("span",{className:"truncate max-w-[200px]",children:i.productName}),e.jsxs("span",{className:"font-mono text-xs",children:[i.quantity," un."]})]},i.id)),c.length>5&&e.jsxs("p",{className:"text-xs text-center text-muted-foreground pt-2",children:["+ ",c.length-5," más..."]})]})]}),e.jsx(m,{className:"w-full",size:"lg",onClick:I,disabled:!r||c.length===0||g,children:g?"Sincronizando...":"Sincronizar Ahora"})]})]})]})}const D=({position:s})=>e.jsx("div",{className:"relative w-full h-32 bg-muted/30 rounded-lg border overflow-hidden",children:e.jsxs("div",{className:"absolute inset-2 border-2 border-muted-foreground/20 rounded",children:[e.jsxs("div",{className:"h-3 bg-muted-foreground/10 border-b border-muted-foreground/20 flex items-center px-1.5 gap-1",children:[e.jsx(K,{className:"w-2 h-2 text-muted-foreground/40"}),e.jsxs("div",{className:"flex-1 flex gap-0.5",children:[e.jsx("div",{className:"h-1 w-8 bg-muted-foreground/20 rounded-full"}),e.jsx("div",{className:"h-1 w-6 bg-muted-foreground/20 rounded-full"})]})]}),e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsx("div",{className:"h-1.5 w-full bg-muted-foreground/10 rounded"}),e.jsx("div",{className:"h-1.5 w-3/4 bg-muted-foreground/10 rounded"}),e.jsx("div",{className:"h-1.5 w-5/6 bg-muted-foreground/10 rounded"}),e.jsx("div",{className:"h-1.5 w-2/3 bg-muted-foreground/10 rounded"})]}),e.jsx("div",{className:o("absolute w-16 h-6 bg-primary/90 rounded shadow-lg flex items-center justify-center",s==="top-right"&&"top-2 right-2",s==="bottom-right"&&"bottom-2 right-2",s==="bottom-center"&&"bottom-2 left-1/2 -translate-x-1/2"),children:e.jsx("div",{className:"w-10 h-3 bg-background/90 rounded-sm"})})]})});function Qe({value:s,onChange:a}){const t=[{value:"top-right",label:"Arriba a la derecha",preview:e.jsx(D,{position:"top-right"})},{value:"bottom-right",label:"Abajo a la derecha",preview:e.jsx(D,{position:"bottom-right"})},{value:"bottom-center",label:"Abajo al centro",preview:e.jsx(D,{position:"bottom-center"})}];return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:t.map(r=>e.jsxs("button",{onClick:()=>a(r.value),className:o("relative flex flex-col gap-3 p-4 rounded-xl border-2 transition-all hover:border-primary/50",s===r.value?"border-primary bg-primary/5":"border-border bg-background"),children:[r.preview,e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:o("w-4 h-4 rounded-full border-2 flex items-center justify-center transition-all",s===r.value?"border-primary":"border-muted-foreground/30"),children:s===r.value&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary"})}),e.jsx("span",{className:o("text-sm font-medium transition-colors",s===r.value?"text-foreground":"text-muted-foreground"),children:r.label})]})]},r.value))})}const ne=n.forwardRef(({className:s,...a},t)=>e.jsx(X,{className:o("grid gap-2",s),...a,ref:t}));ne.displayName=X.displayName;const k=n.forwardRef(({className:s,...a},t)=>e.jsx(Z,{ref:t,className:o("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(Ne,{className:"flex items-center justify-center",children:e.jsx(qe,{className:"h-2.5 w-2.5 fill-current text-current"})})}));k.displayName=Z.displayName;function cs(){const s=be(),{user:a}=Ie(),{preferences:t,setPosition:r,setReminderType:u}=ze(),[c,E]=n.useState(!0),[g,w]=n.useState(!1),[N,I]=n.useState(!0),[i,S]=n.useState([50]),[C,T]=n.useState(!1),ie=async()=>{if(confirm("¿Estás seguro de que deseas borrar todos los datos locales? Esta acción no se puede deshacer."))try{await Oe(),d.success("Operación exitosa","Datos locales eliminados correctamente"),window.location.reload()}catch{d.error("Error","Error al eliminar datos")}},oe=async b=>{var V;const B=(V=b.target.files)==null?void 0:V[0];if(B){T(!0);try{const z=await B.arrayBuffer(),q=Be(z),ce=q.SheetNames[0],le=q.Sheets[ce],P=Ve.sheet_to_json(le,{header:"A"}),v=[];for(let R=1;R<P.length;R++){const A=P[R],H=A.D,G=A.O,U=A.Q;if(!H||!U)continue;const de=String(H).trim(),me=G?String(G).trim():void 0;String(U).trim().split("-").map(y=>y.trim()).filter(y=>y.length>0).forEach(y=>{v.push({ean:y,name:de,cost:0,salePrice:0,laboratory:me,category:"",stock:0})})}if(v.length===0){d.error("Error","No se encontraron productos válidos. Verifica las columnas (D=Producto, Q=EAN).");return}confirm(`Se encontraron ${v.length} códigos EAN (de ${P.length-1} filas). ¿Deseas reemplazar la base de datos actual?`)&&(await De(),await Le(v),d.success("Operación exitosa",`${v.length} productos importados correctamente.`)),b.target.value=""}catch(z){console.error("Error importing products:",z),d.error("Error","Error al importar el archivo. Asegúrate de que sea un Excel válido.")}finally{T(!1)}}};return e.jsx(Pe,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Notificaciones"})]}),e.jsx(p,{children:"Personaliza cómo y dónde aparecen las notificaciones."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-base",children:"Recordatorios"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Estas son notificaciones para recordarte actividad que has perdido o citas próximas."})]}),e.jsxs(ne,{value:t.reminderType,onValueChange:b=>u(b),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:"center-only",id:"center-only"}),e.jsx(l,{htmlFor:"center-only",className:"font-normal cursor-pointer",children:"Mostrar nuevos recordatorios en el centro de notificaciones pero no como banners."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:"all",id:"all"}),e.jsx(l,{htmlFor:"all",className:"font-normal cursor-pointer",children:"Notificarme para todos los recordatorios"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:"none",id:"none"}),e.jsx(l,{htmlFor:"none",className:"font-normal cursor-pointer",children:"No notificarme."})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-base",children:"Posición de notificación"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>d.info("Notificación de prueba","Esta es una vista previa de cómo aparecerán tus notificaciones."),children:"Probar"})]}),e.jsx(Qe,{value:t.position,onChange:r})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Inventario y Escáner"})]}),e.jsx(p,{children:"Configuración del lector de código de barras y feedback."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Vibración (Haptics)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vibrar al escanear correctamente un producto."})]}),e.jsx(O,{checked:c,onCheckedChange:E})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Sonidos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reproducir sonido de confirmación."})]}),e.jsx(O,{checked:g,onCheckedChange:w})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(l,{children:"Sensibilidad del Escáner"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i,"%"]})]}),e.jsx(ee,{value:i,onValueChange:S,max:100,step:10,className:"w-full"})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Sincronización"})]}),e.jsx(p,{children:"Gestión de datos offline y subida."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Sincronización Automática"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subir cambios automáticamente cuando haya conexión."})]}),e.jsx(O,{checked:N,onCheckedChange:I})]}),e.jsx("div",{className:"pt-2",children:e.jsx(Fe,{children:e.jsxs(m,{variant:"outline",className:"w-full justify-start",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Abrir Centro de Sincronización"]})})})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Base de Datos de Productos"})]}),e.jsx(p,{children:"Gestiona el catálogo de productos local."})]}),e.jsx(j,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border rounded-lg bg-muted/30 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:"Importar Productos desde Excel"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:'Actualiza la base de datos con un archivo .xlsx. El archivo debe tener columnas "EAN" y "Descripcion".'}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Te,{type:"file",accept:".xlsx, .xls",onChange:oe,disabled:C,className:"cursor-pointer"})}),C&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 animate-pulse",children:"Procesando archivo..."})]})}),e.jsxs("div",{className:"pt-2",children:[e.jsxs(m,{variant:"destructive",className:"w-full sm:w-auto",onClick:ie,children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Borrar datos locales y caché"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Utiliza esto si experimentas problemas con la aplicación. Se borrarán los datos no sincronizados."})]})]})})]}),(a==null?void 0:a.role)==="admin"&&e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Administración"})]}),e.jsx(p,{children:"Gestión de sucursales y configuraciones globales (solo administradores)."})]}),e.jsx(j,{children:e.jsx(m,{variant:"outline",className:"w-full justify-start",onClick:()=>s("/admin/branches"),children:"Administrar Sucursales"})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-primary"}),e.jsx(f,{children:"Sistema"})]}),e.jsx(p,{children:"Información de la versión y mantenimiento."})]}),e.jsx(j,{className:"space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Versión de la App"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"v1.2.0 (Build 2025.11.24)"})]}),e.jsx(m,{variant:"outline",size:"sm",disabled:!0,children:"Actualizada"})]})})]})]})})}export{cs as default};
