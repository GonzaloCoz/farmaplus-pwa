import{j as e}from"./ui-vendor-yOY8nbWe.js";import{r as i}from"./react-vendor-ylmX0jv_.js";import{C as R}from"./CounterAnimation-B87AY37Y.js";import{c as M,q as ie,r as ce,t as de,v as ue,S as X,B as j,y as u,i as G,U as Ne,P as ye,z as re,h as we,A as Se,M as ke}from"./index-dksozvqM.js";import{I as V}from"./input-3SfPefy2.js";import{r as Ie,u as f,w as oe}from"./excel-uoQkVabA.js";import{L as H}from"./label-B5HQfrb8.js";import{C as Q}from"./check-UL6Yt11e.js";import{F as Ce}from"./FabMenu-DeLrZjBN.js";import{D as De,a as Ve,A as Ee,b as ze,d as Pe,e as Re,c as J,T as Me}from"./dropdown-menu-CK7LwPE1.js";import{m as le}from"./animation-B1XBg4Wj.js";import{F as ne}from"./file-spreadsheet-CxJwjsn2.js";import{T as Fe}from"./target-CEeyaPaW.js";import{C as Be}from"./calculator-YPvW4N2-.js";import{T as Ae}from"./trending-up-DnwAyW4d.js";import{P as Ue}from"./pencil-C_SsCx18.js";import{S as _e}from"./save-BE3yvQml.js";import"./utils-Cem6hW2W.js";import"./plus-CH5T3qs-.js";import"./circle-CrxGWpHd.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=M("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=M("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=M("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=M("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=M("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=M("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),Ge=["Belgrano VI","Barracas","Recoleta","Belgrano","Belgrano II","Belgrano III","Belgrano IV","Belgrano V","Belgrano VII","Belgrano VIII","Berazategui","Berazategui II","Caballito","Caballito II","Caballito III","Caballito IV","Chacarita","Devoto","Devoto II","Flores","Gonzalez Catan","Gonzalez Catan II","Gonzalez Catan III","Las Cañitas","Mercedes","Microcentro","Microcentro II","Morón","Nuñez","Padua","Palermo","Palermo II","Palermo III","Parque Centenario","Parque Patricios","Pilar","Pompeya","Quilmes","Ramos Mejia","Ramos Mejia II","Ramos Mejia III","Recoleta II","Recoleta III","Recoleta IV","Recoleta V","Retiro","Retiro II","Saladillo","San Isidro","San Isidro II","San Miguel","Tribunales","Villa Ballester","Villa Ballester II","Villa Crespo","Villa del Parque","Villa del Parque II","Villa Luro","Villa Urquiza","Villa Urquiza II","Villa Urquiza III"];function He({open:S,onOpenChange:F,onSave:T}){const[E,t]=i.useState(""),[N,y]=i.useState(""),[k,B]=i.useState(""),[W,A]=i.useState(!1),[I,$]=i.useState(""),[w,z]=i.useState(new Date().toISOString().split("T")[0]),[P,C]=i.useState(!1),q=i.useMemo(()=>Ge.filter(d=>d.toLowerCase().includes(k.toLowerCase())),[k]),v=()=>{if(!E.trim()){u.error("Datos incompletos","Por favor, ingresa un nombre para el reporte");return}if(!N){u.error("Datos incompletos","Por favor, selecciona una sucursal");return}if(!I.trim()){u.error("Datos incompletos","Por favor, ingresa el sector");return}if(!w){u.error("Datos incompletos","Por favor, selecciona una fecha");return}C(!0);try{T({name:E,branch:N,sector:I,date:w}),u.success("Reporte guardado","El reporte se guardó correctamente"),t(""),y(""),B(""),$(""),z(new Date().toISOString().split("T")[0]),F(!1)}catch{u.error("Error al guardar","No se pudo guardar el reporte")}finally{C(!1)}};return e.jsx(ie,{open:S,onOpenChange:F,children:e.jsxs(ce,{className:"w-[480px] p-0",children:[e.jsx(de,{className:"p-4 border-b",children:e.jsx(ue,{children:"Guardar Reporte"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(H,{htmlFor:"report-name",className:"text-sm font-medium",children:"Nombre del Reporte *"}),e.jsx(V,{id:"report-name",placeholder:"Ej: Auditoria - Nov 2025",value:E,onChange:d=>t(d.target.value),className:"mt-2"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{htmlFor:"report-branch",className:"text-sm font-medium",children:"Sucursal *"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(X,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(V,{id:"report-branch",placeholder:"Buscar sucursal...",value:k,onChange:d=>{B(d.target.value),A(!0)},onFocus:()=>A(!0),className:"pl-8"})]}),W&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-md shadow-lg z-50 max-h-48 overflow-auto",children:q.length>0?q.map(d=>e.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-accent flex items-center justify-between",onClick:()=>{y(d),B(""),A(!1)},children:[d,N===d&&e.jsx(Q,{className:"h-4 w-4 text-primary"})]},d)):e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No se encontraron sucursales"})}),N&&e.jsxs("div",{className:"mt-2 px-3 py-2 bg-accent rounded-md text-sm",children:["Seleccionada: ",e.jsx("span",{className:"font-medium",children:N})]})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"report-sector",className:"text-sm font-medium",children:"Sector *"}),e.jsx(V,{id:"report-sector",placeholder:"Ej: Farmacia, Perfumería, General",value:I,onChange:d=>$(d.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"report-date",className:"text-sm font-medium",children:"Fecha del Inventario *"}),e.jsx(V,{id:"report-date",type:"date",value:w,onChange:d=>z(d.target.value),className:"mt-2"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(j,{variant:"outline",onClick:()=>F(!1),disabled:P,className:"flex-1",children:"Cancelar"}),e.jsx(j,{onClick:v,disabled:P,className:"flex-1",children:P?"Guardando...":"Guardar Reporte"})]})]})]})})}function hs(){const[S,F]=i.useState(null),[T,E]=i.useState(!1),[t,N]=i.useState(null),[y,k]=i.useState({headers:[],rows:[]}),[B,W]=i.useState(!1),[A,I]=i.useState(!1),[$,w]=i.useState(!1),[z,P]=i.useState("Inventario"),[C,q]=i.useState(""),[v,d]=i.useState("all"),[U,me]=i.useState(!1),[g,L]=i.useState({field:"value",direction:"desc"}),[K,Y]=i.useState(null),[Z,ee]=i.useState(null),se=i.useRef(null),xe=s=>{var a;const o=(a=s.target.files)==null?void 0:a[0];o&&(o.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||o.type==="application/vnd.ms-excel"?(F(o),N(null),k({headers:[],rows:[]}),u.success("Operación exitosa","Archivo cargado correctamente")):u.error("Error","Por favor, selecciona un archivo Excel válido"))},ae=s=>{const o=s.map((r,p)=>({codebar:r[6],name:r[10],physicalCount:r[13]===""?"":Number(r[13])||0,systemStock:Number(r[15])||0,diffQty:Number(r[17])||0,cost:Number(r[19])||0,salePrice:Number(r[21])||0,diffValue:Number(r[22])||0,rowIndex:p})).filter(r=>r.codebar&&r.name),a=o.filter(r=>r.diffQty<0),n=o.filter(r=>r.diffQty>0),m=o.filter(r=>r.diffQty===0).length,h=o.length>0?m/o.length*100:100,c=a.reduce((r,p)=>r+p.diffValue,0),l=n.reduce((r,p)=>r+p.diffValue,0),x=a.reduce((r,p)=>r+p.diffQty,0),O=n.reduce((r,p)=>r+p.diffQty,0),D=[...a].sort((r,p)=>r.diffValue-p.diffValue).slice(0,10),b=[...n].sort((r,p)=>p.diffValue-r.diffValue).slice(0,10);N({totalProducts:o.length,allShortages:a,allSurpluses:n,topShortagesByValue:D,topSurplusesByValue:b,totalShortageValue:Math.abs(c),totalSurplusValue:l,totalShortageUnits:Math.abs(x),totalSurplusUnits:O,inventoryAccuracy:h,totalProductsNoDifference:m,netDiscrepancyValue:l+c,netDiscrepancyUnits:O+x,totalScannedUnits:o.reduce((r,p)=>r+(Number(p.physicalCount)||0),0),allProducts:o})},he=async()=>{if(!S){u.error("Error","Por favor, selecciona un archivo primero");return}E(!0),u.info("Información","Analizando archivo...",{id:"analysis-toast"});try{const s=await S.arrayBuffer(),o=Ie(s),a=o.SheetNames[0],n=o.Sheets[a],m=f.sheet_to_json(n,{header:1}),h=m[0],c=m.slice(1);k({headers:h,rows:c}),ae(c),u.success("Operación exitosa","Análisis completado",{id:"analysis-toast"}),setTimeout(()=>{var l;(l=se.current)==null||l.scrollIntoView({behavior:"smooth",block:"start"})},300)}catch(s){console.error("Error analyzing file:",s),u.error("Error","Hubo un error al analizar el archivo.",{id:"analysis-toast"})}finally{E(!1)}},pe=(s,o)=>{const a=[...y.rows],n=[...a[s]];a[s]=n,n[13]=o;const m=o===""?0:Number(o),h=Number(n[15])||0,c=m-h;n[17]=c;const l=Number(n[19])||0;n[22]=c*l,k(x=>({...x,rows:a})),ae(a)},fe=()=>{if(!t){u.error("Error","No hay resultados para exportar.");return}u.info("Información","Generando resumen en Excel...");const s=c=>c.map(l=>({"Código de Barras":l.codebar,Producto:l.name,"Diferencia (Unidades)":l.diffQty,"Valor Diferencia ($)":l.diffValue,"Stock Sistema":l.systemStock,"Conteo Físico":l.physicalCount,"Costo Unitario ($)":l.cost,"Precio Venta ($)":l.salePrice})),o=[...t.allShortages].sort((c,l)=>c.diffQty-l.diffQty).slice(0,15),a=[...t.allShortages].sort((c,l)=>c.diffValue-l.diffValue).slice(0,15),n=[...t.allSurpluses].sort((c,l)=>l.diffQty-c.diffQty).slice(0,15),m=[...t.allSurpluses].sort((c,l)=>l.diffValue-c.diffValue).slice(0,15),h=f.book_new();f.book_append_sheet(h,f.json_to_sheet(s(o)),"Faltantes por Cantidad"),f.book_append_sheet(h,f.json_to_sheet(s(a)),"Faltantes por Valor"),f.book_append_sheet(h,f.json_to_sheet(s(n)),"Sobrantes por Cantidad"),f.book_append_sheet(h,f.json_to_sheet(s(m)),"Sobrantes por Valor"),oe(h,"Resumen_Diferencias.xlsx"),u.success("Operación exitosa","Resumen Excel generado correctamente.")},ge=()=>{if(!t||y.rows.length===0){u.error("Error","No hay resultados para exportar.");return}w(!0)},je=()=>{if(!t||y.rows.length===0){u.error("Error","No hay resultados para exportar.");return}u.info("Información","Generando archivo Excel...");const s=[...y.headers];s[24]="ID DE AJUSTE",s[25]="CANTIDAD DE AJUSTE";const o=y.rows.map((x,O)=>{const D=O+2,b=[...x];return b[13]=Number(x[13])||0,b[15]=Number(x[15])||0,b[19]=Number(x[19])||0,b[21]=Number(x[21])||0,b[17]={f:`(N${D}+Z${D})-P${D}`},b[22]={f:`R${D}*T${D}`},b[24]="",b[25]=0,b}),a=f.aoa_to_sheet([s,...o]),n=s.length,m=[];for(let x=0;x<n;x++)m.push({hidden:!0});[6,10,13,15,17,19,21,22,24,25].forEach(x=>{m[x]&&(m[x]={hidden:!1,wch:20})}),a["!cols"]=m;const c=f.book_new();f.book_append_sheet(c,a,"Hoja de Ajuste");const l=`${z}.xlsx`;oe(c,l),u.success("Operación exitosa","Archivo Excel generado correctamente."),W(!0),w(!1),P("Inventario")},_=i.useMemo(()=>{if(!t)return[];t.allShortages.concat(t.allSurpluses);let s=[...t.allShortages,...t.allSurpluses];if(v==="shortage"?s=t.allShortages:v==="surplus"?s=t.allSurpluses:v==="match"?s=[]:v==="zero_stock"&&(s=t.allSurpluses.filter(a=>a.systemStock===0&&a.physicalCount>0)),C){const a=C.toLowerCase();s=s.filter(n=>n.name.toLowerCase().includes(a)||n.codebar.toLowerCase().includes(a))}const o=s.sort((a,n)=>{const m=g.field==="value"?a.diffValue:a.diffQty,h=g.field==="value"?n.diffValue:n.diffQty;return g.direction==="desc"?h-m:m-h});return K!==null&&Z&&t.allProducts?Z.map(a=>t.allProducts.find(n=>n.rowIndex===a)).filter(a=>a!==void 0):o},[t,v,C,g,K,Z]),ve=s=>{Y(s),ee(_.map(o=>o.rowIndex))},te=()=>{Y(null),ee(null)},be=s=>{if(!t){u.error("Error","No hay resultados para guardar");return}const o={id:Date.now().toString(),name:s.name,branch:s.branch,sector:s.sector,date:s.date,timestamp:new Date().toISOString(),results:t},a=JSON.parse(localStorage.getItem("inventory-reports")||"[]");a.push(o),localStorage.setItem("inventory-reports",JSON.stringify(a)),I(!1)};return e.jsxs(le.div,{className:"p-6 space-y-6 pb-32 lg:pb-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(G,{className:"p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-border border-dashed rounded-2xl cursor-pointer bg-muted/30 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Ne,{className:"w-12 h-12 mb-4 text-muted-foreground"}),e.jsx("p",{className:"mb-2 text-sm text-foreground font-medium",children:S?S.name:"Haz clic para cargar o arrastra el archivo"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Archivos Excel (.xlsx, .xls)"})]}),e.jsx("input",{id:"dropzone-file",type:"file",className:"hidden",accept:".xlsx,.xls",onChange:xe})]})}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-lg",children:[e.jsx(ne,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Formato requerido"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"El archivo debe contener las columnas: Código, Producto, Stock Sistema, Stock Físico, Diferencia"})]})]}),e.jsx(j,{onClick:he,disabled:!S||T,className:"w-full",size:"lg",children:T?"Analizando...":"Analizar Inventario"})]})}),t&&e.jsxs(le.div,{ref:se,className:"space-y-8",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(G,{className:"p-6 md:p-8 shadow-md border-muted/60 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5",children:e.jsx(Oe,{className:"w-32 h-32"})}),e.jsxs("div",{className:"relative z-10 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm font-semibold text-muted-foreground tracking-wide uppercase",children:U?"Total Discrepancia":"Balance de Inventario"})}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-muted/50 rounded-full",onClick:()=>me(!U),title:"Cambiar vista",children:e.jsx(Te,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-bold tracking-tight text-foreground transition-all duration-300",children:e.jsx(R,{value:U?t.totalShortageValue+t.totalSurplusValue:Math.abs(t.netDiscrepancyValue),prefix:"$"})}),!U&&e.jsx("span",{className:`text-xl font-bold ${t.netDiscrepancyValue>=0?"text-success":"text-destructive"}`,children:t.netDiscrepancyValue>=0?"(+)":"(-)"})]}),U&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Suma absoluta de todas las diferencias"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1 uppercase tracking-wider",children:"Total Faltante"}),e.jsx("p",{className:"text-xl font-bold text-destructive",children:e.jsx(R,{value:t.totalShortageValue,prefix:"$"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1 uppercase tracking-wider",children:"Total Sobrante"}),e.jsx("p",{className:"text-xl font-bold text-success",children:e.jsx(R,{value:t.totalSurplusValue,prefix:"$"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1 uppercase tracking-wider",children:"Precisión"}),e.jsx("p",{className:"text-xl font-bold text-primary",children:e.jsx(R,{value:t.inventoryAccuracy,decimals:1,suffix:"%"})})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4 border-t border-border/40",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Valor Faltante (Unidades)"}),e.jsxs("p",{className:"font-semibold text-foreground",children:[e.jsx(R,{value:t.totalShortageUnits})," ",e.jsx("span",{className:"text-destructive font-bold",children:"(-)"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Valor Sobrante (Unidades)"}),e.jsxs("p",{className:"font-semibold text-foreground",children:[e.jsx(R,{value:t.totalSurplusUnits})," ",e.jsx("span",{className:"text-success font-bold",children:"(+)"})]})]})]})]})]}),e.jsxs(G,{className:"p-6 md:p-8 shadow-md border-none bg-primary text-primary-foreground relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(ye,{className:"w-40 h-40 transform rotate-12 translate-x-10 -translate-y-10"})}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between space-y-6",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-2 opacity-90",children:e.jsx("span",{className:"text-sm font-semibold tracking-wide uppercase",children:"Estado del Proceso"})}),e.jsxs("div",{className:"flex items-baseline gap-3",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-bold tracking-tight",children:"Finalizado"}),e.jsx("div",{className:"bg-white/20 p-1.5 rounded-full backdrop-blur-sm",children:e.jsx(re,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"bg-white/10 rounded-2xl p-4 backdrop-blur-md border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Fe,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:t.totalProducts})]}),e.jsx("p",{className:"text-xs font-medium opacity-70 uppercase tracking-wider",children:"Total Productos"})]}),e.jsxs("div",{className:"bg-white/10 rounded-2xl p-4 backdrop-blur-md border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Le,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:t.totalScannedUnits})]}),e.jsx("p",{className:"text-xs font-medium opacity-70 uppercase tracking-wider",children:"Unidades Escaneadas"})]}),e.jsxs("div",{className:"bg-white/10 rounded-2xl p-4 backdrop-blur-md border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Be,{className:"w-8 h-8 opacity-80"}),e.jsx("div",{className:"flex items-baseline gap-1",children:e.jsxs("span",{className:"text-2xl font-bold",children:[t.netDiscrepancyUnits>0?"+":"",t.netDiscrepancyUnits]})})]}),e.jsx("p",{className:"text-xs font-medium opacity-70 uppercase tracking-wider",children:"Unidades Netas (Ajuste)"})]}),e.jsxs("div",{className:"bg-white/10 rounded-2xl p-4 backdrop-blur-md border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(re,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:t.totalProductsNoDifference})]}),e.jsx("p",{className:"text-xs font-medium opacity-70 uppercase tracking-wider",children:"Productos sin Diferencia"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 py-4 sticky top-0 z-20 bg-background/80 backdrop-blur-md border-b",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-muted/50 p-1 rounded-xl w-full md:w-auto overflow-x-auto",children:[e.jsx(j,{variant:v==="all"?"default":"ghost",size:"sm",onClick:()=>d("all"),className:"rounded-lg text-xs font-medium h-9 px-4",children:"Todos"}),e.jsxs(j,{variant:v==="shortage"?"default":"ghost",size:"sm",onClick:()=>d("shortage"),className:"rounded-lg text-xs font-medium h-9 px-4 hover:text-destructive hover:bg-destructive/10 data-[state=active]:bg-destructive data-[state=active]:text-destructive-foreground",children:["Faltantes (",t.allShortages.length,")"]}),e.jsxs(j,{variant:v==="surplus"?"default":"ghost",size:"sm",onClick:()=>d("surplus"),className:"rounded-lg text-xs font-medium h-9 px-4 hover:text-success hover:bg-success/10",children:["Sobrantes (",t.allSurpluses.length,")"]}),e.jsxs(j,{variant:v==="zero_stock"?"default":"ghost",size:"sm",onClick:()=>d("zero_stock"),className:"rounded-lg text-xs font-medium h-9 px-4 hover:text-blue-500 hover:bg-blue-500/10 data-[state=active]:bg-blue-600 data-[state=active]:text-white",children:["Stock 0 (",t.allSurpluses.filter(s=>s.systemStock===0).length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-80",children:[e.jsx(X,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Buscar producto, EAN...",value:C,onChange:s=>q(s.target.value),className:"pl-9 h-10 bg-muted/30 border-muted-foreground/20 rounded-xl focus-visible:ring-primary"})]}),e.jsxs(De,{children:[e.jsx(Ve,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl border-muted-foreground/20",children:e.jsx(Ee,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs(ze,{align:"end",className:"w-48",children:[e.jsx(Pe,{children:"Ordenar por"}),e.jsx(Re,{}),e.jsx(J,{onClick:()=>L({field:"quantity",direction:"desc"}),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:"Mayor Cantidad (+)"}),g.field==="quantity"&&g.direction==="desc"&&e.jsx(Q,{className:"w-4 h-4"})]})}),e.jsx(J,{onClick:()=>L({field:"quantity",direction:"asc"}),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:"Mayor Cantidad (-)"}),g.field==="quantity"&&g.direction==="asc"&&e.jsx(Q,{className:"w-4 h-4"})]})}),e.jsx(J,{onClick:()=>L({field:"value",direction:"desc"}),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:"Mayor Importe (+)"}),g.field==="value"&&g.direction==="desc"&&e.jsx(Q,{className:"w-4 h-4"})]})}),e.jsx(J,{onClick:()=>L({field:"value",direction:"asc"}),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:"Mayor Importe (-)"}),g.field==="value"&&g.direction==="asc"&&e.jsx(Q,{className:"w-4 h-4"})]})})]})]})]})]}),e.jsxs(G,{className:"border-muted/40 shadow-sm overflow-hidden bg-card",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 p-4 border-b bg-muted/30 text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-5 md:col-span-4 pl-2",children:"Producto"}),e.jsx("div",{className:"col-span-2 text-right hidden md:block",children:"Precio"}),e.jsx("div",{className:"col-span-3 md:col-span-2 text-center",children:"Diferencia"}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:"Físico / Sistema"}),e.jsx("div",{className:"col-span-2 md:col-span-2 text-right pr-2",children:"Total ($)"})]}),e.jsx("div",{className:"divide-y divide-border/40",children:_.length===0?e.jsxs("div",{className:"p-12 text-center text-muted-foreground",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No se encontraron productos"})]}):_.map((s,o)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 p-4 items-center hover:bg-muted/10 transition-colors group",children:[e.jsxs("div",{className:"col-span-5 md:col-span-4 flex items-center gap-3 pl-2 min-w-0",children:[e.jsx("div",{className:`p-2 rounded-lg shrink-0 ${s.diffQty<0?"bg-destructive/10 text-destructive":"bg-success/10 text-success"}`,children:s.diffQty<0?e.jsx(Me,{className:"w-5 h-5"}):e.jsx(Ae,{className:"w-5 h-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-sm text-foreground truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx(we,{variant:"outline",className:"text-[10px] h-5 font-mono text-muted-foreground border-border/60 font-normal hidden sm:inline-flex",children:s.codebar}),e.jsx("span",{className:"text-[10px] text-muted-foreground sm:hidden",children:s.codebar})]})]})]}),e.jsxs("div",{className:"col-span-2 text-right hidden md:block",children:[e.jsxs("p",{className:"text-sm font-medium",children:["$",s.cost.toLocaleString()]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Costo Unit."})]}),e.jsx("div",{className:"col-span-3 md:col-span-2 flex justify-center",children:e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${s.diffQty<0?"bg-destructive/10 text-destructive":"bg-success/10 text-success"}`,children:[s.diffQty>0?e.jsx($e,{className:"w-3 h-3"}):e.jsx(Qe,{className:"w-3 h-3"}),s.diffQty>0?"+":"",s.diffQty]})}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm relative",children:[K===s.rowIndex?e.jsx(V,{type:"number",autoFocus:!0,className:"w-16 h-7 text-right pr-2 font-bold p-0",value:s.physicalCount,onBlur:te,onKeyDown:a=>{a.key==="Enter"&&te()},onChange:a=>pe(s.rowIndex,a.target.value),onClick:a=>a.stopPropagation()}):e.jsxs("div",{className:"w-16 h-7 flex items-center justify-end pr-2 relative cursor-pointer group/edit rounded hover:bg-muted/50 transition-colors",onClick:a=>{a.stopPropagation(),ve(s.rowIndex)},children:[e.jsx("span",{className:"font-bold",children:s.physicalCount}),e.jsx(Ue,{className:"w-3 h-3 text-muted-foreground opacity-0 group-hover/edit:opacity-100 transition-opacity absolute left-1"})]}),e.jsx("span",{className:"text-muted-foreground mx-1",children:"/"}),e.jsx("span",{className:"text-muted-foreground",children:s.systemStock})]})}),e.jsxs("div",{className:"col-span-2 md:col-span-2 text-right pr-2",children:[e.jsxs("p",{className:`text-sm font-bold ${s.diffValue<0?"text-destructive":"text-success"}`,children:[s.diffValue>0?"+":"","$",Math.abs(s.diffValue).toLocaleString()]}),e.jsx("div",{className:"flex justify-end mt-1 md:hidden",children:e.jsx(qe,{className:"w-4 h-4 text-muted-foreground"})})]})]},s.rowIndex))}),e.jsxs("div",{className:"p-4 border-t bg-muted/20 flex justify-between items-center text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Mostrando ",_.length," registros"]}),_.length>20&&e.jsx(j,{variant:"ghost",size:"sm",className:"h-7 text-xs",children:"Ver más"})]})]}),e.jsx(Ce,{actions:[{label:"Guardar Reporte",icon:e.jsx(_e,{className:"w-5 h-5"}),onClick:()=>I(!0),variant:"default",color:"bg-primary text-primary-foreground",disabled:!B},{label:"Exportar Inventario",icon:e.jsx(Se,{className:"w-5 h-5"}),onClick:ge,variant:"secondary"},{label:"Exportar Resumen",icon:e.jsx(ne,{className:"w-5 h-5"}),onClick:fe,variant:"secondary",color:"text-green-600"}]})]}),e.jsx(He,{open:A,onOpenChange:I,onSave:be}),e.jsx(ie,{open:$,onOpenChange:w,children:e.jsxs(ce,{className:"w-[420px]",children:[e.jsxs(de,{children:[e.jsx(ue,{children:"Exportar Inventario"}),e.jsx(ke,{children:"Ingresa el nombre del archivo que deseas descargar. Se guardará como un archivo Excel (.xlsx)."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fileName",className:"block text-sm font-medium text-foreground mb-2",children:"Nombre del archivo"}),e.jsx(V,{id:"fileName",type:"text",placeholder:"Inventario",value:z,onChange:s=>P(s.target.value),className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"La extensión .xlsx se agregará automáticamente"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(j,{variant:"outline",onClick:()=>w(!1),children:"Cancelar"}),e.jsx(j,{onClick:je,disabled:!z.trim(),children:"Descargar"})]})]})]})})]})}export{hs as default};
