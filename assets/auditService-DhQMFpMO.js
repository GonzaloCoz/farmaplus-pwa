import{v as d}from"./index-nj5uYoc8.js";import"./ui-vendor-DpWgbapL.js";import"./react-vendor-ylmX0jv_.js";import"./utils-B3_ieZWp.js";import"./animation-D5s1b1Vs.js";import"./excel-uoQkVabA.js";const p={async logAction(t){try{let o=t.userId;if(!o){const{data:{user:a}}=await d.auth.getUser();o=a==null?void 0:a.id}if(!o){console.warn("Audit log attempted without user ID",t);return}const{error:i}=await d.from("audit_logs").insert({user_id:o,branch_id:t.branchId,action:t.action,entity_type:t.entityType,entity_id:t.entityId,details:t.details});if(i)throw i}catch(o){console.error("Failed to write audit log:",o)}},async getLogs(t){let o=d.from("audit_logs").select("*").order("created_at",{ascending:!1}).limit((t==null?void 0:t.limit)||50);t!=null&&t.userId&&(o=o.eq("user_id",t.userId)),t!=null&&t.action&&(o=o.eq("action",t.action));const{data:i,error:a}=await o;if(a)throw a;return i}};export{p as auditService};
